{"version":3,"file":"static/js/index.js","sources":["webpack://minecraft-web-client/./src/react/ArmorBar.css?ff76","webpack://minecraft-web-client/./src/react/Book.module.css?6eb5","webpack://minecraft-web-client/./src/react/BossBarOverlay.css?540c","webpack://minecraft-web-client/./src/react/BreathBar.css?434a","webpack://minecraft-web-client/./src/react/Chat.css?6440","webpack://minecraft-web-client/./src/react/Crosshair.css?e79d","webpack://minecraft-web-client/./src/react/DebugOverlay.module.css?b8b5","webpack://minecraft-web-client/./src/react/DiveTransition.module.css?fac2","webpack://minecraft-web-client/./src/react/FoodBar.css?d1fc","webpack://minecraft-web-client/./src/react/Fullmap.css?829e","webpack://minecraft-web-client/./src/react/GamepadUiCursor.module.css?1112","webpack://minecraft-web-client/./src/react/GoogleButton.css?d525","webpack://minecraft-web-client/./src/react/HealthBar.css?5fb5","webpack://minecraft-web-client/./src/react/IndicatorEffects.css?663c","webpack://minecraft-web-client/./src/react/KeybindingsScreen.module.css?1ad3","webpack://minecraft-web-client/./src/react/LoadingChunks.css?ad6d","webpack://minecraft-web-client/./src/react/MessageFormatted.css?1409","webpack://minecraft-web-client/./src/react/MineflayerPluginConsole.css?e4ba","webpack://minecraft-web-client/./src/react/MobileTopButtons.module.css?902d","webpack://minecraft-web-client/./src/react/NetworkStatus.module.css?cdce","webpack://minecraft-web-client/./src/react/PauseScreen.module.css?5d2b","webpack://minecraft-web-client/./src/react/PlayerListOverlay.css?a21d","webpack://minecraft-web-client/./src/react/Scoreboard.css?3aab","webpack://minecraft-web-client/./src/react/Select.css?b908","webpack://minecraft-web-client/./src/react/SignEditor.css?c5a7","webpack://minecraft-web-client/./src/react/Title.css?b7f3","webpack://minecraft-web-client/./src/react/TouchInteractionHint.module.css?c2b8","webpack://minecraft-web-client/./src/react/XPBar.module.css?af29","webpack://minecraft-web-client/./src/react/appStatus.module.css?a352","webpack://minecraft-web-client/./src/react/button.module.css?1f07","webpack://minecraft-web-client/./src/react/createWorld.module.css?e1be","webpack://minecraft-web-client/./src/react/deathScreen.css?6714","webpack://minecraft-web-client/./src/react/input.module.css?1e7f","webpack://minecraft-web-client/./src/react/mainMenu.module.css?62b7","webpack://minecraft-web-client/./src/react/select.module.css?d6d0","webpack://minecraft-web-client/./src/react/singleplayer.module.css?10a8","webpack://minecraft-web-client/./src/react/slider.module.css?920d","webpack://minecraft-web-client/./src/styles.css?314a","/workspaces/minecraft-web-client/generated/large-data-aliases.ts","/workspaces/minecraft-web-client/renderer/buildMesherConfig.mjs","/workspaces/minecraft-web-client/renderer/playground/shared.ts","/workspaces/minecraft-web-client/renderer/viewer/index.js","/workspaces/minecraft-web-client/renderer/viewer/lib/DebugGui.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/animationController.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/basePlayerState.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/cameraBobbing.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/cleanupDecorator.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/entities.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/entity/EntityMesh.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/entity/animations.js","/workspaces/minecraft-web-client/renderer/viewer/lib/entity/armorModels.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/entity/exportedModels.js","/workspaces/minecraft-web-client/renderer/viewer/lib/entity/objModels.js","/workspaces/minecraft-web-client/renderer/viewer/lib/guiRenderer.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/hand.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/holdingBlock.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/mesher/modelsGeometryCommon.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/mesher/shared.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/mesher/standaloneRenderer.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/mesher/worldConstants.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/simpleUtils.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/smoothSwitcher.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/threeJsUtils.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/ui/newStats.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/utils.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/utils/proxy.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/utils/skins.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/viewer.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/viewerWrapper.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/worldDataEmitter.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/worldrendererCommon.ts","/workspaces/minecraft-web-client/renderer/viewer/lib/worldrendererThree.ts","/workspaces/minecraft-web-client/renderer/viewer/prepare/utils.ts","/workspaces/minecraft-web-client/renderer/viewer/sign-renderer/index.ts","/workspaces/minecraft-web-client/src/api/mcStatusApi.ts","/workspaces/minecraft-web-client/src/appConfig.ts","/workspaces/minecraft-web-client/src/appParams.ts","/workspaces/minecraft-web-client/src/appStatus.ts","/workspaces/minecraft-web-client/src/basicSounds.ts","/workspaces/minecraft-web-client/src/botUtils.ts","/workspaces/minecraft-web-client/src/browserfs.ts","/workspaces/minecraft-web-client/src/builtinCommands.ts","/workspaces/minecraft-web-client/src/cameraRotationControls.ts","/workspaces/minecraft-web-client/src/chatUtils.ts","/workspaces/minecraft-web-client/src/connect.ts","/workspaces/minecraft-web-client/src/controls.ts","/workspaces/minecraft-web-client/src/core/progressReporter.ts","/workspaces/minecraft-web-client/src/createLocalServer.ts","/workspaces/minecraft-web-client/src/customChannels.ts","/workspaces/minecraft-web-client/src/customClient.js","/workspaces/minecraft-web-client/src/customCommands.ts","/workspaces/minecraft-web-client/src/customServer.ts","/workspaces/minecraft-web-client/src/dayCycle.ts","/workspaces/minecraft-web-client/src/defaultLocalServerOptions.js","/workspaces/minecraft-web-client/src/devReload.ts","/workspaces/minecraft-web-client/src/devtools.ts","/workspaces/minecraft-web-client/src/downloadAndOpenFile.ts","/workspaces/minecraft-web-client/src/dragndrop.ts","/workspaces/minecraft-web-client/src/entities.ts","/workspaces/minecraft-web-client/src/errorLoadingScreenHelpers.ts","/workspaces/minecraft-web-client/src/flyingSquidEvents.ts","/workspaces/minecraft-web-client/src/flyingSquidUtils.ts","/workspaces/minecraft-web-client/src/gameUnload.ts","/workspaces/minecraft-web-client/src/generated/resources.ts","/workspaces/minecraft-web-client/src/getCollisionInteractionShapes.ts","/workspaces/minecraft-web-client/src/getCollisionShapes.ts","/workspaces/minecraft-web-client/src/globalDomListeners.ts","/workspaces/minecraft-web-client/src/globalState.ts","/workspaces/minecraft-web-client/src/globals.js","/workspaces/minecraft-web-client/src/googledrive.ts","/workspaces/minecraft-web-client/src/importsWorkaround.js","/workspaces/minecraft-web-client/src/index.ts","/workspaces/minecraft-web-client/src/inventoryWindows.ts","/workspaces/minecraft-web-client/src/itemsDescriptions.ts","/workspaces/minecraft-web-client/src/loadSave.ts","/workspaces/minecraft-web-client/src/localServerMultiplayer.ts","/workspaces/minecraft-web-client/src/markdownToFormattedText.ts","/workspaces/minecraft-web-client/src/microsoftAuthflow.ts","/workspaces/minecraft-web-client/src/mineflayer/cameraShake.ts","/workspaces/minecraft-web-client/src/mineflayer/items.ts","/workspaces/minecraft-web-client/src/mineflayer/java-tester/commands.ts","/workspaces/minecraft-web-client/src/mineflayer/java-tester/index.ts","/workspaces/minecraft-web-client/src/mineflayer/maps.ts","/workspaces/minecraft-web-client/src/mineflayer/mc-protocol.ts","/workspaces/minecraft-web-client/src/mineflayer/minecraft-protocol-extra.ts","/workspaces/minecraft-web-client/src/mineflayer/playerState.ts","/workspaces/minecraft-web-client/src/mineflayer/plugins/mouse.ts","/workspaces/minecraft-web-client/src/mineflayer/plugins/packetsPatcher.ts","/workspaces/minecraft-web-client/src/mineflayer/plugins/packetsRecording.ts","/workspaces/minecraft-web-client/src/mineflayer/plugins/ping.ts","/workspaces/minecraft-web-client/src/mineflayer/userError.ts","/workspaces/minecraft-web-client/src/mineflayer/websocket-core.ts","/workspaces/minecraft-web-client/src/mobileShim.ts","/workspaces/minecraft-web-client/src/optimizeJson.ts","/workspaces/minecraft-web-client/src/optionsGuiScheme.tsx","/workspaces/minecraft-web-client/src/optionsStorage.ts","/workspaces/minecraft-web-client/src/packetsReplay/packetsReplayLegacy.ts","/workspaces/minecraft-web-client/src/packetsReplay/replayPackets.ts","/workspaces/minecraft-web-client/src/panorama.ts","/workspaces/minecraft-web-client/src/parseServerAddress.ts","/workspaces/minecraft-web-client/src/react/AddServerOrConnect.tsx","/workspaces/minecraft-web-client/src/react/AppStatus.tsx","/workspaces/minecraft-web-client/src/react/AppStatusProvider.tsx","/workspaces/minecraft-web-client/src/react/ArmorBar.tsx","/workspaces/minecraft-web-client/src/react/BarsCommon.tsx","/workspaces/minecraft-web-client/src/react/BedTime.tsx","/workspaces/minecraft-web-client/src/react/Book.tsx","/workspaces/minecraft-web-client/src/react/BookProvider.tsx","/workspaces/minecraft-web-client/src/react/BossBarOverlay.tsx","/workspaces/minecraft-web-client/src/react/BossBarOverlayProvider.tsx","/workspaces/minecraft-web-client/src/react/BreathBar.tsx","/workspaces/minecraft-web-client/src/react/Button.tsx","/workspaces/minecraft-web-client/src/react/ButtonAppProvider.tsx","/workspaces/minecraft-web-client/src/react/ButtonWithTooltip.tsx","/workspaces/minecraft-web-client/src/react/Chat.tsx","/workspaces/minecraft-web-client/src/react/ChatProvider.tsx","/workspaces/minecraft-web-client/src/react/CreateWorld.tsx","/workspaces/minecraft-web-client/src/react/CreateWorldProvider.tsx","/workspaces/minecraft-web-client/src/react/Crosshair.tsx","/workspaces/minecraft-web-client/src/react/DeathScreen.tsx","/workspaces/minecraft-web-client/src/react/DeathScreenProvider.tsx","/workspaces/minecraft-web-client/src/react/DebugEdges.tsx","/workspaces/minecraft-web-client/src/react/DebugOverlay.tsx","/workspaces/minecraft-web-client/src/react/DiscordButton.tsx","/workspaces/minecraft-web-client/src/react/DiveTransition.tsx","/workspaces/minecraft-web-client/src/react/EnterFullscreenButton.tsx","/workspaces/minecraft-web-client/src/react/FoodBar.tsx","/workspaces/minecraft-web-client/src/react/FullScreenWidget.tsx","/workspaces/minecraft-web-client/src/react/Fullmap.tsx","/workspaces/minecraft-web-client/src/react/GameInteractionOverlay.tsx","/workspaces/minecraft-web-client/src/react/GamepadUiCursor.tsx","/workspaces/minecraft-web-client/src/react/GlobalSearchInput.tsx","/workspaces/minecraft-web-client/src/react/GoogleButton.tsx","/workspaces/minecraft-web-client/src/react/HealthBar.tsx","/workspaces/minecraft-web-client/src/react/HeldMapUi.tsx","/workspaces/minecraft-web-client/src/react/HotbarRenderApp.tsx","/workspaces/minecraft-web-client/src/react/HudBarsProvider.tsx","/workspaces/minecraft-web-client/src/react/IndicatorEffects.tsx","/workspaces/minecraft-web-client/src/react/IndicatorEffectsProvider.tsx","/workspaces/minecraft-web-client/src/react/Input.tsx","/workspaces/minecraft-web-client/src/react/Keybinding.tsx","/workspaces/minecraft-web-client/src/react/KeybindingsCustom.tsx","/workspaces/minecraft-web-client/src/react/KeybindingsScreen.tsx","/workspaces/minecraft-web-client/src/react/KeybindingsScreenProvider.tsx","/workspaces/minecraft-web-client/src/react/LoadingChunks.tsx","/workspaces/minecraft-web-client/src/react/MainMenu.tsx","/workspaces/minecraft-web-client/src/react/MainMenuRenderApp.tsx","/workspaces/minecraft-web-client/src/react/MessageFormatted.tsx","/workspaces/minecraft-web-client/src/react/MessageFormattedString.tsx","/workspaces/minecraft-web-client/src/react/MineflayerPluginConsole.tsx","/workspaces/minecraft-web-client/src/react/MineflayerPluginHud.tsx","/workspaces/minecraft-web-client/src/react/Minimap.tsx","/workspaces/minecraft-web-client/src/react/MinimapDrawer.ts","/workspaces/minecraft-web-client/src/react/MinimapProvider.tsx","/workspaces/minecraft-web-client/src/react/MobileTopButtons.tsx","/workspaces/minecraft-web-client/src/react/ModuleSignsViewer.tsx","/workspaces/minecraft-web-client/src/react/NetworkStatus.tsx","/workspaces/minecraft-web-client/src/react/NoModalFoundProvider.tsx","/workspaces/minecraft-web-client/src/react/Notification.tsx","/workspaces/minecraft-web-client/src/react/NotificationProvider.tsx","/workspaces/minecraft-web-client/src/react/OptionsGroup.tsx","/workspaces/minecraft-web-client/src/react/OptionsItems.tsx","/workspaces/minecraft-web-client/src/react/OptionsRenderApp.tsx","/workspaces/minecraft-web-client/src/react/PacketsReplayProvider.tsx","/workspaces/minecraft-web-client/src/react/PauseLinkButtons.tsx","/workspaces/minecraft-web-client/src/react/PauseScreen.tsx","/workspaces/minecraft-web-client/src/react/PixelartIcon.tsx","/workspaces/minecraft-web-client/src/react/PlayerListOverlay.tsx","/workspaces/minecraft-web-client/src/react/PlayerListOverlayProvider.tsx","/workspaces/minecraft-web-client/src/react/ReplayPanel.tsx","/workspaces/minecraft-web-client/src/react/Scoreboard.tsx","/workspaces/minecraft-web-client/src/react/ScoreboardProvider.tsx","/workspaces/minecraft-web-client/src/react/Screen.tsx","/workspaces/minecraft-web-client/src/react/Select.tsx","/workspaces/minecraft-web-client/src/react/SelectGameVersion.tsx","/workspaces/minecraft-web-client/src/react/SelectOption.tsx","/workspaces/minecraft-web-client/src/react/ServersList.tsx","/workspaces/minecraft-web-client/src/react/ServersListProvider.tsx","/workspaces/minecraft-web-client/src/react/SharedHudVars.tsx","/workspaces/minecraft-web-client/src/react/SignEditor.tsx","/workspaces/minecraft-web-client/src/react/SignEditorProvider.tsx","/workspaces/minecraft-web-client/src/react/SignInMessage.tsx","/workspaces/minecraft-web-client/src/react/SignInMessageProvider.tsx","/workspaces/minecraft-web-client/src/react/Singleplayer.tsx","/workspaces/minecraft-web-client/src/react/SingleplayerProvider.tsx","/workspaces/minecraft-web-client/src/react/Slider.tsx","/workspaces/minecraft-web-client/src/react/SoundMuffler.tsx","/workspaces/minecraft-web-client/src/react/Tabs.tsx","/workspaces/minecraft-web-client/src/react/Title.tsx","/workspaces/minecraft-web-client/src/react/TitleProvider.tsx","/workspaces/minecraft-web-client/src/react/TouchAreasControls.tsx","/workspaces/minecraft-web-client/src/react/TouchAreasControlsProvider.tsx","/workspaces/minecraft-web-client/src/react/TouchControls.tsx","/workspaces/minecraft-web-client/src/react/TouchInteractionHint.tsx","/workspaces/minecraft-web-client/src/react/UIProvider.tsx","/workspaces/minecraft-web-client/src/react/XPBar.tsx","/workspaces/minecraft-web-client/src/react/XPBarProvider.tsx","/workspaces/minecraft-web-client/src/react/appStorageProvider.ts","/workspaces/minecraft-web-client/src/react/armorValues.ts","/workspaces/minecraft-web-client/src/react/components/replay/FilterInput.tsx","/workspaces/minecraft-web-client/src/react/components/replay/PacketList.tsx","/workspaces/minecraft-web-client/src/react/components/replay/ProgressBar.tsx","/workspaces/minecraft-web-client/src/react/components/replay/constants.ts","/workspaces/minecraft-web-client/src/react/effectsImages.ts","/workspaces/minecraft-web-client/src/react/hooks/useScrollBehavior.ts","/workspaces/minecraft-web-client/src/react/packetsFilter.ts","/workspaces/minecraft-web-client/src/react/parseKeybindingName.ts","/workspaces/minecraft-web-client/src/react/serversStorage.ts","/workspaces/minecraft-web-client/src/react/simpleHooks.ts","/workspaces/minecraft-web-client/src/react/simpleUtils.ts","/workspaces/minecraft-web-client/src/react/state/packetsReplayState.ts","/workspaces/minecraft-web-client/src/react/uiMotion.ts","/workspaces/minecraft-web-client/src/react/useLongPress.ts","/workspaces/minecraft-web-client/src/react/utils.ts","/workspaces/minecraft-web-client/src/react/utilsApp.ts","/workspaces/minecraft-web-client/src/react/widgets.ts","/workspaces/minecraft-web-client/src/reactUi.tsx","/workspaces/minecraft-web-client/src/rendererUtils.ts","/workspaces/minecraft-web-client/src/resourcePack.ts","/workspaces/minecraft-web-client/src/resourcesManager.ts","/workspaces/minecraft-web-client/src/scaleInterface.ts","/workspaces/minecraft-web-client/src/serviceWorker.ts","/workspaces/minecraft-web-client/src/shims/crypto.js","/workspaces/minecraft-web-client/src/shims/dns.js","/workspaces/minecraft-web-client/src/shims/empty.ts","/workspaces/minecraft-web-client/src/shims/fs.js","/workspaces/minecraft-web-client/src/shims/minecraftData.ts","/workspaces/minecraft-web-client/src/shims/patchShims.ts","/workspaces/minecraft-web-client/src/shims/perf_hooks_replacement.js","/workspaces/minecraft-web-client/src/shims/prismarineAuthReplacement.ts","/workspaces/minecraft-web-client/src/shims/yggdrasilReplacement.ts","/workspaces/minecraft-web-client/src/sounds/botSoundSystem.ts","/workspaces/minecraft-web-client/src/sounds/musicSystem.ts","/workspaces/minecraft-web-client/src/sounds/soundsMap.ts","/workspaces/minecraft-web-client/src/standaloneUtils.ts","/workspaces/minecraft-web-client/src/supportedVersions.mjs","/workspaces/minecraft-web-client/src/testCrasher.ts","/workspaces/minecraft-web-client/src/topRightStats.ts","/workspaces/minecraft-web-client/src/utils.ts","/workspaces/minecraft-web-client/src/viewerConnector.ts","/workspaces/minecraft-web-client/src/vr.ts","/workspaces/minecraft-web-client/src/watchOptions.ts","/workspaces/minecraft-web-client/src/water.ts"],"sourcesContent":["// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827509128\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"bookWrapper\":\"src-react-Book-module__bookWrapper-TEaT2a\",\"bookContainer\":\"src-react-Book-module__bookContainer-ozXOuS\",\"bookImages\":\"src-react-Book-module__bookImages-QIgUqp\",\"outSide\":\"src-react-Book-module__outSide-tdPk6N\",\"titleIcon\":\"src-react-Book-module__titleIcon-FuigMg\",\"titleContent\":\"src-react-Book-module__titleContent-HOFf9S\",\"insideIcon\":\"src-react-Book-module__insideIcon-mvWhHG\",\"insideHalfIcon\":\"src-react-Book-module__insideHalfIcon-oGVWWK\",\"inside\":\"src-react-Book-module__inside-PZ2fCX\",\"uneditable\":\"src-react-Book-module__uneditable-IHhvqQ\",\"page\":\"src-react-Book-module__page-1nUQUw\",\"messageFormattedString\":\"src-react-Book-module__messageFormattedString-MAym7w\",\"textArea\":\"src-react-Book-module__textArea-CTZEzD\",\"blink\":\"src-react-Book-module__blink-k8j9re\",\"controlPrev\":\"src-react-Book-module__controlPrev-lG4k_N\",\"controlNext\":\"src-react-Book-module__controlNext-KXyao4\",\"actions\":\"src-react-Book-module__actions-Puvqtl\",\"pageAnimation\":\"src-react-Book-module__pageAnimation-A9GdFI\",\"titleAnimation\":\"src-react-Book-module__titleAnimation-DE4b6h\",\"titleContentAnimation\":\"src-react-Book-module__titleContentAnimation-VkNFpG\",\"insideAnimation\":\"src-react-Book-module__insideAnimation-ztZegY\",\"pageTextAnimation\":\"src-react-Book-module__pageTextAnimation-FFgFRV\",\"pageSecondTextAnimation\":\"src-react-Book-module__pageSecondTextAnimation-II5__1\",\"hidden\":\"src-react-Book-module__hidden-W0KfLq\",\"titleAnimationReverse\":\"src-react-Book-module__titleAnimationReverse-FRokqy\",\"titleContentAnimationReverse\":\"src-react-Book-module__titleContentAnimationReverse-UxVYyT\",\"insideAnimationReverse\":\"src-react-Book-module__insideAnimationReverse-wRiH6k\",\"pageAnimationReverse\":\"src-react-Book-module__pageAnimationReverse-I_oYqS\",\"pageTextAnimationReverse\":\"src-react-Book-module__pageTextAnimationReverse-OqcZ1i\",\"pageSecondTextAnimationReverse\":\"src-react-Book-module__pageSecondTextAnimationReverse-iU27Jz\",\"pageButtonAnimationReverse\":\"src-react-Book-module__pageButtonAnimationReverse-lx7O3V\",\"text\":\"src-react-Book-module__text-PsAhko\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"bookWrapper\\\":\\\"src-react-Book-module__bookWrapper-TEaT2a\\\",\\\"bookContainer\\\":\\\"src-react-Book-module__bookContainer-ozXOuS\\\",\\\"bookImages\\\":\\\"src-react-Book-module__bookImages-QIgUqp\\\",\\\"outSide\\\":\\\"src-react-Book-module__outSide-tdPk6N\\\",\\\"titleIcon\\\":\\\"src-react-Book-module__titleIcon-FuigMg\\\",\\\"titleContent\\\":\\\"src-react-Book-module__titleContent-HOFf9S\\\",\\\"insideIcon\\\":\\\"src-react-Book-module__insideIcon-mvWhHG\\\",\\\"insideHalfIcon\\\":\\\"src-react-Book-module__insideHalfIcon-oGVWWK\\\",\\\"inside\\\":\\\"src-react-Book-module__inside-PZ2fCX\\\",\\\"uneditable\\\":\\\"src-react-Book-module__uneditable-IHhvqQ\\\",\\\"page\\\":\\\"src-react-Book-module__page-1nUQUw\\\",\\\"messageFormattedString\\\":\\\"src-react-Book-module__messageFormattedString-MAym7w\\\",\\\"textArea\\\":\\\"src-react-Book-module__textArea-CTZEzD\\\",\\\"blink\\\":\\\"src-react-Book-module__blink-k8j9re\\\",\\\"controlPrev\\\":\\\"src-react-Book-module__controlPrev-lG4k_N\\\",\\\"controlNext\\\":\\\"src-react-Book-module__controlNext-KXyao4\\\",\\\"actions\\\":\\\"src-react-Book-module__actions-Puvqtl\\\",\\\"pageAnimation\\\":\\\"src-react-Book-module__pageAnimation-A9GdFI\\\",\\\"titleAnimation\\\":\\\"src-react-Book-module__titleAnimation-DE4b6h\\\",\\\"titleContentAnimation\\\":\\\"src-react-Book-module__titleContentAnimation-VkNFpG\\\",\\\"insideAnimation\\\":\\\"src-react-Book-module__insideAnimation-ztZegY\\\",\\\"pageTextAnimation\\\":\\\"src-react-Book-module__pageTextAnimation-FFgFRV\\\",\\\"pageSecondTextAnimation\\\":\\\"src-react-Book-module__pageSecondTextAnimation-II5__1\\\",\\\"hidden\\\":\\\"src-react-Book-module__hidden-W0KfLq\\\",\\\"titleAnimationReverse\\\":\\\"src-react-Book-module__titleAnimationReverse-FRokqy\\\",\\\"titleContentAnimationReverse\\\":\\\"src-react-Book-module__titleContentAnimationReverse-UxVYyT\\\",\\\"insideAnimationReverse\\\":\\\"src-react-Book-module__insideAnimationReverse-wRiH6k\\\",\\\"pageAnimationReverse\\\":\\\"src-react-Book-module__pageAnimationReverse-I_oYqS\\\",\\\"pageTextAnimationReverse\\\":\\\"src-react-Book-module__pageTextAnimationReverse-OqcZ1i\\\",\\\"pageSecondTextAnimationReverse\\\":\\\"src-react-Book-module__pageSecondTextAnimationReverse-iU27Jz\\\",\\\"pageButtonAnimationReverse\\\":\\\"src-react-Book-module__pageButtonAnimationReverse-lx7O3V\\\",\\\"text\\\":\\\"src-react-Book-module__text-PsAhko\\\"}\";\n        // 1742827511138\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827507321\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827509131\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827506240\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827507635\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"debug-left-side\":\"src-react-DebugOverlay-module__debug-left-side-L_D95v\",\"debugLeftSide\":\"src-react-DebugOverlay-module__debug-left-side-L_D95v\",\"debug-right-side\":\"src-react-DebugOverlay-module__debug-right-side-mFhvHG\",\"debugRightSide\":\"src-react-DebugOverlay-module__debug-right-side-mFhvHG\",\"empty\":\"src-react-DebugOverlay-module__empty-x7G63G\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"debug-left-side\\\":\\\"src-react-DebugOverlay-module__debug-left-side-L_D95v\\\",\\\"debugLeftSide\\\":\\\"src-react-DebugOverlay-module__debug-left-side-L_D95v\\\",\\\"debug-right-side\\\":\\\"src-react-DebugOverlay-module__debug-right-side-mFhvHG\\\",\\\"debugRightSide\\\":\\\"src-react-DebugOverlay-module__debug-right-side-mFhvHG\\\",\\\"empty\\\":\\\"src-react-DebugOverlay-module__empty-x7G63G\\\"}\";\n        // 1742827506549\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"container\":\"src-react-DiveTransition-module__container-HLYI5E\",\"main\":\"src-react-DiveTransition-module__main-i6FZfW\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"container\\\":\\\"src-react-DiveTransition-module__container-HLYI5E\\\",\\\"main\\\":\\\"src-react-DiveTransition-module__main-i6FZfW\\\"}\";\n        // 1742827506340\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827507637\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827510103\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"crosshair\":\"src-react-GamepadUiCursor-module__crosshair-eLqfh9\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"crosshair\\\":\\\"src-react-GamepadUiCursor-module__crosshair-eLqfh9\\\"}\";\n        // 1742827506601\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827506372\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827506373\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827506249\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"container\":\"src-react-KeybindingsScreen-module__container-dRiZZT\",\"group\":\"src-react-KeybindingsScreen-module__group-haorh2\",\"group-category\":\"src-react-KeybindingsScreen-module__group-category-HNSIFU\",\"groupCategory\":\"src-react-KeybindingsScreen-module__group-category-HNSIFU\",\"actionBinds\":\"src-react-KeybindingsScreen-module__actionBinds-MbRkMv\",\"warning-container\":\"src-react-KeybindingsScreen-module__warning-container-mgiK4D\",\"warningContainer\":\"src-react-KeybindingsScreen-module__warning-container-mgiK4D\",\"actionName\":\"src-react-KeybindingsScreen-module__actionName-uFJWW2\",\"undo-keyboard\":\"src-react-KeybindingsScreen-module__undo-keyboard-fjpyGp\",\"undoKeyboard\":\"src-react-KeybindingsScreen-module__undo-keyboard-fjpyGp\",\"undo-gamepad\":\"src-react-KeybindingsScreen-module__undo-gamepad-ZNUg28\",\"undoGamepad\":\"src-react-KeybindingsScreen-module__undo-gamepad-ZNUg28\",\"button\":\"src-react-KeybindingsScreen-module__button-AF2rj4\",\"margin-left\":\"src-react-KeybindingsScreen-module__margin-left-ugrmlI\",\"marginLeft\":\"src-react-KeybindingsScreen-module__margin-left-ugrmlI\",\"matched-bind\":\"src-react-KeybindingsScreen-module__matched-bind-GFWOr1\",\"matchedBind\":\"src-react-KeybindingsScreen-module__matched-bind-GFWOr1\",\"matched-bind-warning\":\"src-react-KeybindingsScreen-module__matched-bind-warning-WdXyU1\",\"matchedBindWarning\":\"src-react-KeybindingsScreen-module__matched-bind-warning-WdXyU1\",\"chat-command\":\"src-react-KeybindingsScreen-module__chat-command-onMok2\",\"chatCommand\":\"src-react-KeybindingsScreen-module__chat-command-onMok2\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"container\\\":\\\"src-react-KeybindingsScreen-module__container-dRiZZT\\\",\\\"group\\\":\\\"src-react-KeybindingsScreen-module__group-haorh2\\\",\\\"group-category\\\":\\\"src-react-KeybindingsScreen-module__group-category-HNSIFU\\\",\\\"groupCategory\\\":\\\"src-react-KeybindingsScreen-module__group-category-HNSIFU\\\",\\\"actionBinds\\\":\\\"src-react-KeybindingsScreen-module__actionBinds-MbRkMv\\\",\\\"warning-container\\\":\\\"src-react-KeybindingsScreen-module__warning-container-mgiK4D\\\",\\\"warningContainer\\\":\\\"src-react-KeybindingsScreen-module__warning-container-mgiK4D\\\",\\\"actionName\\\":\\\"src-react-KeybindingsScreen-module__actionName-uFJWW2\\\",\\\"undo-keyboard\\\":\\\"src-react-KeybindingsScreen-module__undo-keyboard-fjpyGp\\\",\\\"undoKeyboard\\\":\\\"src-react-KeybindingsScreen-module__undo-keyboard-fjpyGp\\\",\\\"undo-gamepad\\\":\\\"src-react-KeybindingsScreen-module__undo-gamepad-ZNUg28\\\",\\\"undoGamepad\\\":\\\"src-react-KeybindingsScreen-module__undo-gamepad-ZNUg28\\\",\\\"button\\\":\\\"src-react-KeybindingsScreen-module__button-AF2rj4\\\",\\\"margin-left\\\":\\\"src-react-KeybindingsScreen-module__margin-left-ugrmlI\\\",\\\"marginLeft\\\":\\\"src-react-KeybindingsScreen-module__margin-left-ugrmlI\\\",\\\"matched-bind\\\":\\\"src-react-KeybindingsScreen-module__matched-bind-GFWOr1\\\",\\\"matchedBind\\\":\\\"src-react-KeybindingsScreen-module__matched-bind-GFWOr1\\\",\\\"matched-bind-warning\\\":\\\"src-react-KeybindingsScreen-module__matched-bind-warning-WdXyU1\\\",\\\"matchedBindWarning\\\":\\\"src-react-KeybindingsScreen-module__matched-bind-warning-WdXyU1\\\",\\\"chat-command\\\":\\\"src-react-KeybindingsScreen-module__chat-command-onMok2\\\",\\\"chatCommand\\\":\\\"src-react-KeybindingsScreen-module__chat-command-onMok2\\\"}\";\n        // 1742827510634\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827506373\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827506345\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827505987\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"mobile-top-btns\":\"src-react-MobileTopButtons-module__mobile-top-btns-LkVyKp\",\"mobileTopBtns\":\"src-react-MobileTopButtons-module__mobile-top-btns-LkVyKp\",\"pause-btn\":\"src-react-MobileTopButtons-module__pause-btn-tfjBzl\",\"pauseBtn\":\"src-react-MobileTopButtons-module__pause-btn-tfjBzl\",\"chat-btn\":\"src-react-MobileTopButtons-module__chat-btn-BNyPws\",\"chatBtn\":\"src-react-MobileTopButtons-module__chat-btn-BNyPws\",\"debug-btn\":\"src-react-MobileTopButtons-module__debug-btn-aSsISO\",\"debugBtn\":\"src-react-MobileTopButtons-module__debug-btn-aSsISO\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"mobile-top-btns\\\":\\\"src-react-MobileTopButtons-module__mobile-top-btns-LkVyKp\\\",\\\"mobileTopBtns\\\":\\\"src-react-MobileTopButtons-module__mobile-top-btns-LkVyKp\\\",\\\"pause-btn\\\":\\\"src-react-MobileTopButtons-module__pause-btn-tfjBzl\\\",\\\"pauseBtn\\\":\\\"src-react-MobileTopButtons-module__pause-btn-tfjBzl\\\",\\\"chat-btn\\\":\\\"src-react-MobileTopButtons-module__chat-btn-BNyPws\\\",\\\"chatBtn\\\":\\\"src-react-MobileTopButtons-module__chat-btn-BNyPws\\\",\\\"debug-btn\\\":\\\"src-react-MobileTopButtons-module__debug-btn-aSsISO\\\",\\\"debugBtn\\\":\\\"src-react-MobileTopButtons-module__debug-btn-aSsISO\\\"}\";\n        // 1742827508271\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"container\":\"src-react-NetworkStatus-module__container-CbtoYq\",\"websocket\":\"src-react-NetworkStatus-module__websocket-ukuvQ1\",\"iconRow\":\"src-react-NetworkStatus-module__iconRow-Rj9AHI\",\"arrowRow\":\"src-react-NetworkStatus-module__arrowRow-mPYqMH\",\"dataRow\":\"src-react-NetworkStatus-module__dataRow-vkErq6\",\"ping\":\"src-react-NetworkStatus-module__ping-axxvVG\",\"totalRow\":\"src-react-NetworkStatus-module__totalRow-tXKyyD\",\"stale\":\"src-react-NetworkStatus-module__stale-QydKzb\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"container\\\":\\\"src-react-NetworkStatus-module__container-CbtoYq\\\",\\\"websocket\\\":\\\"src-react-NetworkStatus-module__websocket-ukuvQ1\\\",\\\"iconRow\\\":\\\"src-react-NetworkStatus-module__iconRow-Rj9AHI\\\",\\\"arrowRow\\\":\\\"src-react-NetworkStatus-module__arrowRow-mPYqMH\\\",\\\"dataRow\\\":\\\"src-react-NetworkStatus-module__dataRow-vkErq6\\\",\\\"ping\\\":\\\"src-react-NetworkStatus-module__ping-axxvVG\\\",\\\"totalRow\\\":\\\"src-react-NetworkStatus-module__totalRow-tXKyyD\\\",\\\"stale\\\":\\\"src-react-NetworkStatus-module__stale-QydKzb\\\"}\";\n        // 1742827505631\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"title\":\"src-react-PauseScreen-module__title-rz05ZX\",\"pause_container\":\"src-react-PauseScreen-module__pause_container-lI8D2f\",\"pauseContainer\":\"src-react-PauseScreen-module__pause_container-lI8D2f\",\"row\":\"src-react-PauseScreen-module__row-IKim4t\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"title\\\":\\\"src-react-PauseScreen-module__title-rz05ZX\\\",\\\"pause_container\\\":\\\"src-react-PauseScreen-module__pause_container-lI8D2f\\\",\\\"pauseContainer\\\":\\\"src-react-PauseScreen-module__pause_container-lI8D2f\\\",\\\"row\\\":\\\"src-react-PauseScreen-module__row-IKim4t\\\"}\";\n        // 1742827508015\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827506276\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827506367\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827507636\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827509132\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827510536\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"hint_container\":\"src-react-TouchInteractionHint-module__hint_container-TtFMXH\",\"hintContainer\":\"src-react-TouchInteractionHint-module__hint_container-TtFMXH\",\"hint_text\":\"src-react-TouchInteractionHint-module__hint_text-sDZkR9\",\"hintText\":\"src-react-TouchInteractionHint-module__hint_text-sDZkR9\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"hint_container\\\":\\\"src-react-TouchInteractionHint-module__hint_container-TtFMXH\\\",\\\"hintContainer\\\":\\\"src-react-TouchInteractionHint-module__hint_container-TtFMXH\\\",\\\"hint_text\\\":\\\"src-react-TouchInteractionHint-module__hint_text-sDZkR9\\\",\\\"hintText\\\":\\\"src-react-TouchInteractionHint-module__hint_text-sDZkR9\\\"}\";\n        // 1742827506338\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"xp-bar-bg\":\"src-react-XPBar-module__xp-bar-bg-Ugs21v\",\"xpBarBg\":\"src-react-XPBar-module__xp-bar-bg-Ugs21v\",\"xp-bar\":\"src-react-XPBar-module__xp-bar-Vg4hn0\",\"xpBar\":\"src-react-XPBar-module__xp-bar-Vg4hn0\",\"xp-label\":\"src-react-XPBar-module__xp-label-omcEHZ\",\"xpLabel\":\"src-react-XPBar-module__xp-label-omcEHZ\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"xp-bar-bg\\\":\\\"src-react-XPBar-module__xp-bar-bg-Ugs21v\\\",\\\"xpBarBg\\\":\\\"src-react-XPBar-module__xp-bar-bg-Ugs21v\\\",\\\"xp-bar\\\":\\\"src-react-XPBar-module__xp-bar-Vg4hn0\\\",\\\"xpBar\\\":\\\"src-react-XPBar-module__xp-bar-Vg4hn0\\\",\\\"xp-label\\\":\\\"src-react-XPBar-module__xp-label-omcEHZ\\\",\\\"xpLabel\\\":\\\"src-react-XPBar-module__xp-label-omcEHZ\\\"}\";\n        // 1742827505990\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"description\":\"src-react-appStatus-module__description-CKQUPy\",\"last-status\":\"src-react-appStatus-module__last-status-js4NpE\",\"lastStatus\":\"src-react-appStatus-module__last-status-js4NpE\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"description\\\":\\\"src-react-appStatus-module__description-CKQUPy\\\",\\\"last-status\\\":\\\"src-react-appStatus-module__last-status-js4NpE\\\",\\\"lastStatus\\\":\\\"src-react-appStatus-module__last-status-js4NpE\\\"}\";\n        // 1742827506345\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"button\":\"src-react-button-module__button-KqXTeV\",\"icon\":\"src-react-button-module__icon-rzxum4\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"button\\\":\\\"src-react-button-module__button-KqXTeV\\\",\\\"icon\\\":\\\"src-react-button-module__icon-rzxum4\\\"}\";\n        // 1742827505630\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"world_layers_container\":\"src-react-createWorld-module__world_layers_container-YYXzJi\",\"worldLayersContainer\":\"src-react-createWorld-module__world_layers_container-YYXzJi\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"world_layers_container\\\":\\\"src-react-createWorld-module__world_layers_container-YYXzJi\\\",\\\"worldLayersContainer\\\":\\\"src-react-createWorld-module__world_layers_container-YYXzJi\\\"}\";\n        // 1742827509696\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827509913\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"container\":\"src-react-input-module__container-GXglqr\",\"input\":\"src-react-input-module__input-Mraw77\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"container\\\":\\\"src-react-input-module__container-GXglqr\\\",\\\"input\\\":\\\"src-react-input-module__input-Mraw77\\\"}\";\n        // 1742827507635\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"root\":\"src-react-mainMenu-module__root-ZQcBnP\",\"game-title\":\"src-react-mainMenu-module__game-title-HS2Boh\",\"gameTitle\":\"src-react-mainMenu-module__game-title-HS2Boh\",\"minec\":\"src-react-mainMenu-module__minec-LtvUe5\",\"minecraft\":\"src-react-mainMenu-module__minecraft-WAwwet\",\"raft\":\"src-react-mainMenu-module__raft-pGttvN\",\"edition\":\"src-react-mainMenu-module__edition-X71qt9\",\"splash\":\"src-react-mainMenu-module__splash-T86ZOq\",\"splashAnim\":\"src-react-mainMenu-module__splashAnim-hJpV1p\",\"menu\":\"src-react-mainMenu-module__menu-AViyuB\",\"menu-row\":\"src-react-mainMenu-module__menu-row-Ua3i92\",\"menuRow\":\"src-react-mainMenu-module__menu-row-Ua3i92\",\"bottom-info\":\"src-react-mainMenu-module__bottom-info-XUJ4_b\",\"bottomInfo\":\"src-react-mainMenu-module__bottom-info-XUJ4_b\",\"product-description\":\"src-react-mainMenu-module__product-description-mpFNW4\",\"productDescription\":\"src-react-mainMenu-module__product-description-mpFNW4\",\"product-link\":\"src-react-mainMenu-module__product-link-iL2GHi\",\"productLink\":\"src-react-mainMenu-module__product-link-iL2GHi\",\"maps-provider\":\"src-react-mainMenu-module__maps-provider-JGaNCh\",\"mapsProvider\":\"src-react-mainMenu-module__maps-provider-JGaNCh\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"root\\\":\\\"src-react-mainMenu-module__root-ZQcBnP\\\",\\\"game-title\\\":\\\"src-react-mainMenu-module__game-title-HS2Boh\\\",\\\"gameTitle\\\":\\\"src-react-mainMenu-module__game-title-HS2Boh\\\",\\\"minec\\\":\\\"src-react-mainMenu-module__minec-LtvUe5\\\",\\\"minecraft\\\":\\\"src-react-mainMenu-module__minecraft-WAwwet\\\",\\\"raft\\\":\\\"src-react-mainMenu-module__raft-pGttvN\\\",\\\"edition\\\":\\\"src-react-mainMenu-module__edition-X71qt9\\\",\\\"splash\\\":\\\"src-react-mainMenu-module__splash-T86ZOq\\\",\\\"splashAnim\\\":\\\"src-react-mainMenu-module__splashAnim-hJpV1p\\\",\\\"menu\\\":\\\"src-react-mainMenu-module__menu-AViyuB\\\",\\\"menu-row\\\":\\\"src-react-mainMenu-module__menu-row-Ua3i92\\\",\\\"menuRow\\\":\\\"src-react-mainMenu-module__menu-row-Ua3i92\\\",\\\"bottom-info\\\":\\\"src-react-mainMenu-module__bottom-info-XUJ4_b\\\",\\\"bottomInfo\\\":\\\"src-react-mainMenu-module__bottom-info-XUJ4_b\\\",\\\"product-description\\\":\\\"src-react-mainMenu-module__product-description-mpFNW4\\\",\\\"productDescription\\\":\\\"src-react-mainMenu-module__product-description-mpFNW4\\\",\\\"product-link\\\":\\\"src-react-mainMenu-module__product-link-iL2GHi\\\",\\\"productLink\\\":\\\"src-react-mainMenu-module__product-link-iL2GHi\\\",\\\"maps-provider\\\":\\\"src-react-mainMenu-module__maps-provider-JGaNCh\\\",\\\"mapsProvider\\\":\\\"src-react-mainMenu-module__maps-provider-JGaNCh\\\"}\";\n        // 1742827507322\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"container\":\"src-react-select-module__container-Y5gFld\",\"input\":\"src-react-select-module__input-Vt4rMm\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"container\\\":\\\"src-react-select-module__container-Y5gFld\\\",\\\"input\\\":\\\"src-react-select-module__input-Vt4rMm\\\"}\";\n        // 1742827508420\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"root\":\"src-react-singleplayer-module__root-HBZyzP\",\"content\":\"src-react-singleplayer-module__content-C05XsQ\",\"content_loading\":\"src-react-singleplayer-module__content_loading-whQTDO\",\"contentLoading\":\"src-react-singleplayer-module__content_loading-whQTDO\",\"world_root\":\"src-react-singleplayer-module__world_root-HUO6kD\",\"worldRoot\":\"src-react-singleplayer-module__world_root-HUO6kD\",\"world_title\":\"src-react-singleplayer-module__world_title-ZeGEbR\",\"worldTitle\":\"src-react-singleplayer-module__world_title-ZeGEbR\",\"world_title_right\":\"src-react-singleplayer-module__world_title_right-_QaLaq\",\"worldTitleRight\":\"src-react-singleplayer-module__world_title_right-_QaLaq\",\"world_info\":\"src-react-singleplayer-module__world_info-aesWwe\",\"worldInfo\":\"src-react-singleplayer-module__world_info-aesWwe\",\"world_info_formatted\":\"src-react-singleplayer-module__world_info_formatted-T9yz4t\",\"worldInfoFormatted\":\"src-react-singleplayer-module__world_info_formatted-T9yz4t\",\"world_info_description_line\":\"src-react-singleplayer-module__world_info_description_line-m_UAFX\",\"worldInfoDescriptionLine\":\"src-react-singleplayer-module__world_info_description_line-m_UAFX\",\"world_image\":\"src-react-singleplayer-module__world_image-RCHVi3\",\"worldImage\":\"src-react-singleplayer-module__world_image-RCHVi3\",\"image_missing\":\"src-react-singleplayer-module__image_missing-kzcgld\",\"imageMissing\":\"src-react-singleplayer-module__image_missing-kzcgld\",\"world_focused\":\"src-react-singleplayer-module__world_focused-KhkWMT\",\"worldFocused\":\"src-react-singleplayer-module__world_focused-KhkWMT\",\"title\":\"src-react-singleplayer-module__title-zNQMwq\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"root\\\":\\\"src-react-singleplayer-module__root-HBZyzP\\\",\\\"content\\\":\\\"src-react-singleplayer-module__content-C05XsQ\\\",\\\"content_loading\\\":\\\"src-react-singleplayer-module__content_loading-whQTDO\\\",\\\"contentLoading\\\":\\\"src-react-singleplayer-module__content_loading-whQTDO\\\",\\\"world_root\\\":\\\"src-react-singleplayer-module__world_root-HUO6kD\\\",\\\"worldRoot\\\":\\\"src-react-singleplayer-module__world_root-HUO6kD\\\",\\\"world_title\\\":\\\"src-react-singleplayer-module__world_title-ZeGEbR\\\",\\\"worldTitle\\\":\\\"src-react-singleplayer-module__world_title-ZeGEbR\\\",\\\"world_title_right\\\":\\\"src-react-singleplayer-module__world_title_right-_QaLaq\\\",\\\"worldTitleRight\\\":\\\"src-react-singleplayer-module__world_title_right-_QaLaq\\\",\\\"world_info\\\":\\\"src-react-singleplayer-module__world_info-aesWwe\\\",\\\"worldInfo\\\":\\\"src-react-singleplayer-module__world_info-aesWwe\\\",\\\"world_info_formatted\\\":\\\"src-react-singleplayer-module__world_info_formatted-T9yz4t\\\",\\\"worldInfoFormatted\\\":\\\"src-react-singleplayer-module__world_info_formatted-T9yz4t\\\",\\\"world_info_description_line\\\":\\\"src-react-singleplayer-module__world_info_description_line-m_UAFX\\\",\\\"worldInfoDescriptionLine\\\":\\\"src-react-singleplayer-module__world_info_description_line-m_UAFX\\\",\\\"world_image\\\":\\\"src-react-singleplayer-module__world_image-RCHVi3\\\",\\\"worldImage\\\":\\\"src-react-singleplayer-module__world_image-RCHVi3\\\",\\\"image_missing\\\":\\\"src-react-singleplayer-module__image_missing-kzcgld\\\",\\\"imageMissing\\\":\\\"src-react-singleplayer-module__image_missing-kzcgld\\\",\\\"world_focused\\\":\\\"src-react-singleplayer-module__world_focused-KhkWMT\\\",\\\"worldFocused\\\":\\\"src-react-singleplayer-module__world_focused-KhkWMT\\\",\\\"title\\\":\\\"src-react-singleplayer-module__title-zNQMwq\\\"}\";\n        // 1742827506340\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport default {\"slider-container\":\"src-react-slider-module__slider-container-k26jGw\",\"sliderContainer\":\"src-react-slider-module__slider-container-k26jGw\",\"slider-thumb\":\"src-react-slider-module__slider-thumb-kWeJYr\",\"sliderThumb\":\"src-react-slider-module__slider-thumb-kWeJYr\",\"slider\":\"src-react-slider-module__slider-pQg1Tc\",\"disabled\":\"src-react-slider-module__disabled-vWN9n8\",\"label\":\"src-react-slider-module__label-My4K1P\"};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = \"{\\\"slider-container\\\":\\\"src-react-slider-module__slider-container-k26jGw\\\",\\\"sliderContainer\\\":\\\"src-react-slider-module__slider-container-k26jGw\\\",\\\"slider-thumb\\\":\\\"src-react-slider-module__slider-thumb-kWeJYr\\\",\\\"sliderThumb\\\":\\\"src-react-slider-module__slider-thumb-kWeJYr\\\",\\\"slider\\\":\\\"src-react-slider-module__slider-pQg1Tc\\\",\\\"disabled\\\":\\\"src-react-slider-module__disabled-vWN9n8\\\",\\\"label\\\":\\\"src-react-slider-module__label-My4K1P\\\"}\";\n        // 1742827510341\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1742827510023\n        var cssReload = require(\"../node_modules/.pnpm/@rspack+core@1.0.0-beta.1_@swc+helpers@0.5.11/node_modules/@rspack/core/dist/builtin-plugin/css-extract/hmr/hotModuleReplacement.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","\nimport pako from 'pako';\n\nfunction decompressFromBase64(input) {\n    console.time('decompressFromBase64')\n    // Decode the Base64 string\n    const binaryString = atob(input);\n    const len = binaryString.length;\n    const bytes = new Uint8Array(len);\n\n    // Convert the binary string to a byte array\n    for (let i = 0; i < len; i++) {\n        bytes[i] = binaryString.charCodeAt(i);\n    }\n\n    // Decompress the byte array\n    const decompressedData = pako.inflate(bytes, { to: 'string' });\n\n    console.timeEnd('decompressFromBase64')\n    return decompressedData;\n}\n\nexport const importLargeData = async (mod: 'mcData' | 'blockStatesModels') => {\n  if (mod === 'mcData') return (await import('../generated/minecraft-data-optimized.json')).default\n  if (mod === 'blockStatesModels') return (await import('mc-assets/dist/blockStatesModels.json')).default\n}\n","export const dynamicMcDataFiles = ['blocks', 'blockCollisionShapes', 'biomes', 'version']\r\n","import WorldLoader, { world } from 'prismarine-world'\r\nimport ChunkLoader from 'prismarine-chunk'\r\n\r\nexport type BlockFaceType = {\r\n  side: number\r\n  textureIndex: number\r\n  tint?: [number, number, number]\r\n  isTransparent?: boolean\r\n\r\n  // for testing\r\n  face?: string\r\n  neighbor?: string\r\n  light?: number\r\n}\r\n\r\nexport type BlockType = {\r\n  faces: BlockFaceType[]\r\n\r\n  // for testing\r\n  block: string\r\n}\r\n\r\nexport const makeError = (str: string) => {\r\n  reportError?.(str)\r\n}\r\nexport const makeErrorCritical = (str: string) => {\r\n  throw new Error(str)\r\n}\r\n\r\nexport const getSyncWorld = (version: string): world.WorldSync => {\r\n  const World = (WorldLoader as any)(version)\r\n  const Chunk = (ChunkLoader as any)(version)\r\n\r\n  const world = new World(version).sync\r\n\r\n  const methods = getAllMethods(world)\r\n  for (const method of methods) {\r\n    if (method.startsWith('set') && method !== 'setColumn') {\r\n      const oldMethod = world[method].bind(world)\r\n      world[method] = (...args) => {\r\n        const arg = args[0]\r\n        if (arg.x !== undefined && !world.getColumnAt(arg)) {\r\n          world.setColumn(Math.floor(arg.x / 16), Math.floor(arg.z / 16), new Chunk(undefined as any))\r\n        }\r\n        oldMethod(...args)\r\n      }\r\n    }\r\n  }\r\n\r\n  return world\r\n}\r\n\r\nfunction getAllMethods (obj) {\r\n  const methods = new Set()\r\n  let currentObj = obj\r\n\r\n  do {\r\n    for (const name of Object.getOwnPropertyNames(currentObj)) {\r\n      if (typeof obj[name] === 'function' && name !== 'constructor') {\r\n        methods.add(name)\r\n      }\r\n    }\r\n  } while ((currentObj = Object.getPrototypeOf(currentObj)))\r\n\r\n  return [...methods] as string[]\r\n}\r\n\r\nexport const delayedIterator = async <T> (arr: T[], delay: number, exec: (item: T, index: number) => void, chunkSize = 1) => {\r\n  // if delay is 0 then don't use setTimeout\r\n  for (let i = 0; i < arr.length; i += chunkSize) {\r\n    if (delay) {\r\n      // eslint-disable-next-line no-await-in-loop\r\n      await new Promise(resolve => {\r\n        setTimeout(resolve, delay)\r\n      })\r\n    }\r\n    exec(arr[i], i)\r\n  }\r\n}\r\n","module.exports = {\r\n  Viewer: require('./lib/viewer').Viewer,\r\n  WorldDataEmitter: require('./lib/worldDataEmitter').WorldDataEmitter,\r\n  Entity: require('./lib/entity/EntityMesh'),\r\n  getBufferFromStream: require('./lib/simpleUtils').getBufferFromStream\r\n}\r\n","// eslint-disable-next-line import/no-named-as-default\r\nimport GUI from 'lil-gui'\r\n\r\nexport interface ParamMeta {\r\n  min?: number\r\n  max?: number\r\n  step?: number\r\n}\r\n\r\nexport class DebugGui {\r\n  private gui: GUI\r\n  private readonly storageKey: string\r\n  private target: any\r\n  private readonly params: string[]\r\n  private readonly paramsMeta: Record<string, ParamMeta>\r\n  private _visible = false // Default to not visible\r\n  private readonly initialValues: Record<string, any> = {} // Store initial values\r\n  private initialized = false\r\n\r\n  constructor (id: string, target: any, params?: string[], paramsMeta?: Record<string, ParamMeta>) {\r\n    this.gui = new GUI()\r\n    this.storageKey = `debug_params_${id}`\r\n    this.target = target\r\n    this.paramsMeta = paramsMeta ?? {}\r\n    this.params = params ?? Object.keys(target)\r\n\r\n    // Store initial values\r\n    for (const param of this.params) {\r\n      this.initialValues[param] = target[param]\r\n    }\r\n\r\n    // Hide by default\r\n    this.gui.domElement.style.display = 'none'\r\n  }\r\n\r\n  // Initialize and show the GUI\r\n  activate () {\r\n    if (!this.initialized) {\r\n      this.loadSavedValues()\r\n      this.setupControls()\r\n      this.initialized = true\r\n    }\r\n    this.show()\r\n    return this\r\n  }\r\n\r\n  // Getter for visibility\r\n  get visible (): boolean {\r\n    return this._visible\r\n  }\r\n\r\n  // Setter for visibility\r\n  set visible (value: boolean) {\r\n    this._visible = value\r\n    this.gui.domElement.style.display = value ? 'block' : 'none'\r\n    this.saveVisibility()\r\n  }\r\n\r\n  private loadSavedValues () {\r\n    try {\r\n      const saved = localStorage.getItem(this.storageKey)\r\n      if (saved) {\r\n        const values = JSON.parse(saved)\r\n        // Apply saved values to target\r\n        for (const param of this.params) {\r\n          if (param in values) {\r\n            const value = values[param]\r\n            if (value !== null) {\r\n              this.target[param] = value\r\n            }\r\n          }\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.warn('Failed to load debug values:', e)\r\n    }\r\n  }\r\n\r\n  private saveValues (deleteKey = false) {\r\n    try {\r\n      const values = {}\r\n      for (const param of this.params) {\r\n        values[param] = this.target[param]\r\n      }\r\n      if (deleteKey) {\r\n        localStorage.removeItem(this.storageKey)\r\n      } else {\r\n        localStorage.setItem(this.storageKey, JSON.stringify(values))\r\n      }\r\n    } catch (e) {\r\n      console.warn('Failed to save debug values:', e)\r\n    }\r\n  }\r\n\r\n  private saveVisibility () {\r\n    try {\r\n      localStorage.setItem(`${this.storageKey}_visible`, this._visible.toString())\r\n    } catch (e) {\r\n      console.warn('Failed to save debug visibility:', e)\r\n    }\r\n  }\r\n\r\n  private setupControls () {\r\n    // Add visibility toggle at the top\r\n    this.gui.add(this, 'visible').name('Show Controls')\r\n    this.gui.add({ resetAll: () => {\r\n      for (const param of this.params) {\r\n        this.target[param] = this.initialValues[param]\r\n      }\r\n      this.saveValues(true)\r\n      this.gui.destroy()\r\n      this.gui = new GUI()\r\n      this.setupControls()\r\n    } }, 'resetAll').name('Reset All Parameters')\r\n\r\n    for (const param of this.params) {\r\n      const value = this.target[param]\r\n      const meta = this.paramsMeta[param] ?? {}\r\n\r\n      if (typeof value === 'number') {\r\n        // For numbers, use meta values or calculate reasonable defaults\r\n        const min = meta.min ?? value - Math.abs(value * 2)\r\n        const max = meta.max ?? value + Math.abs(value * 2)\r\n        const step = meta.step ?? Math.abs(value) / 100\r\n\r\n        this.gui.add(this.target, param, min, max, step)\r\n          .onChange(() => this.saveValues())\r\n      } else if (typeof value === 'boolean') {\r\n        // For booleans, create a checkbox\r\n        this.gui.add(this.target, param)\r\n          .onChange(() => this.saveValues())\r\n      } else if (typeof value === 'string' && ['x', 'y', 'z'].includes(param)) {\r\n        // Special case for xyz coordinates\r\n        const min = meta.min ?? -10\r\n        const max = meta.max ?? 10\r\n        const step = meta.step ?? 0.1\r\n\r\n        this.gui.add(this.target, param, min, max, step)\r\n          .onChange(() => this.saveValues())\r\n      } else if (Array.isArray(value)) {\r\n        // For arrays, create a dropdown\r\n        this.gui.add(this.target, param, value)\r\n          .onChange(() => this.saveValues())\r\n      }\r\n    }\r\n  }\r\n\r\n  // Method to manually trigger save\r\n  save () {\r\n    this.saveValues()\r\n    this.saveVisibility()\r\n  }\r\n\r\n  // Method to destroy the GUI and clean up\r\n  destroy () {\r\n    this.saveVisibility()\r\n    this.gui.destroy()\r\n  }\r\n\r\n  // Toggle visibility\r\n  toggle () {\r\n    this.visible = !this.visible\r\n  }\r\n\r\n  // Show the GUI\r\n  show () {\r\n    this.visible = true\r\n  }\r\n\r\n  // Hide the GUI\r\n  hide () {\r\n    this.visible = false\r\n  }\r\n}\r\n","import * as tweenJs from '@tweenjs/tween.js'\r\n\r\nexport class AnimationController {\r\n  private currentAnimation: tweenJs.Group | null = null\r\n  private isAnimating = false\r\n  private cancelRequested = false\r\n  private completionCallbacks: Array<() => void> = []\r\n  private currentCancelCallback: (() => void) | null = null\r\n\r\n  /** Main method */\r\n  async startAnimation (createAnimation: () => tweenJs.Group, onCancelled?: () => void): Promise<void> {\r\n    if (this.isAnimating) {\r\n      await this.cancelCurrentAnimation()\r\n    }\r\n\r\n    return new Promise((resolve) => {\r\n      this.isAnimating = true\r\n      this.cancelRequested = false\r\n      this.currentCancelCallback = onCancelled ?? null\r\n      this.currentAnimation = createAnimation()\r\n\r\n      this.completionCallbacks.push(() => {\r\n        this.isAnimating = false\r\n        this.currentAnimation = null\r\n        resolve()\r\n      })\r\n    })\r\n  }\r\n\r\n  /** Main method */\r\n  async cancelCurrentAnimation (): Promise<void> {\r\n    if (!this.isAnimating) return\r\n\r\n    if (this.currentCancelCallback) {\r\n      const callback = this.currentCancelCallback\r\n      this.currentCancelCallback = null\r\n      callback()\r\n    }\r\n\r\n    return new Promise((resolve) => {\r\n      this.cancelRequested = true\r\n      this.completionCallbacks.push(() => {\r\n        resolve()\r\n      })\r\n    })\r\n  }\r\n\r\n  animationCycleFinish () {\r\n    if (this.cancelRequested) this.forceFinish()\r\n  }\r\n\r\n  forceFinish (callComplete = true) {\r\n    if (!this.isAnimating) return\r\n\r\n    if (this.currentAnimation) {\r\n      for (const tween of this.currentAnimation.getAll()) tween.stop()\r\n      this.currentAnimation.removeAll()\r\n      this.currentAnimation = null\r\n    }\r\n\r\n    this.isAnimating = false\r\n    this.cancelRequested = false\r\n\r\n    const callbacks = [...this.completionCallbacks]\r\n    this.completionCallbacks = []\r\n    if (callComplete) {\r\n      for (const cb of callbacks) cb()\r\n    }\r\n  }\r\n\r\n  /** Required method */\r\n  update () {\r\n    if (this.currentAnimation) {\r\n      this.currentAnimation.update()\r\n    }\r\n  }\r\n\r\n  get isActive () {\r\n    return this.isAnimating\r\n  }\r\n\r\n  get shouldCancel () {\r\n    return this.cancelRequested\r\n  }\r\n}\r\n","import { EventEmitter } from 'events'\r\nimport { Vec3 } from 'vec3'\r\nimport TypedEmitter from 'typed-emitter'\r\nimport { ItemSelector } from 'mc-assets/dist/itemDefinitions'\r\nimport { proxy } from 'valtio'\r\nimport { HandItemBlock } from './holdingBlock'\r\n\r\nexport type MovementState = 'NOT_MOVING' | 'WALKING' | 'SPRINTING' | 'SNEAKING'\r\nexport type ItemSpecificContextProperties = Partial<Pick<ItemSelector['properties'], 'minecraft:using_item' | 'minecraft:use_duration' | 'minecraft:use_cycle' | 'minecraft:display_context'>>\r\n\r\n\r\nexport type PlayerStateEvents = {\r\n  heldItemChanged: (item: HandItemBlock | undefined, isLeftHand: boolean) => void\r\n}\r\n\r\nexport interface IPlayerState {\r\n  getEyeHeight(): number\r\n  getMovementState(): MovementState\r\n  getVelocity(): Vec3\r\n  isOnGround(): boolean\r\n  isSneaking(): boolean\r\n  isFlying(): boolean\r\n  isSprinting (): boolean\r\n  getItemUsageTicks?(): number\r\n  // isUsingItem?(): boolean\r\n  getHeldItem?(isLeftHand: boolean): HandItemBlock | undefined\r\n  username?: string\r\n  onlineMode?: boolean\r\n\r\n  events: TypedEmitter<PlayerStateEvents>\r\n\r\n  reactive: {\r\n    playerSkin: string | undefined\r\n  }\r\n}\r\n\r\nexport class BasePlayerState implements IPlayerState {\r\n  reactive = proxy({\r\n    playerSkin: undefined\r\n  })\r\n  protected movementState: MovementState = 'NOT_MOVING'\r\n  protected velocity = new Vec3(0, 0, 0)\r\n  protected onGround = true\r\n  protected sneaking = false\r\n  protected flying = false\r\n  protected sprinting = false\r\n  readonly events = new EventEmitter() as TypedEmitter<PlayerStateEvents>\r\n\r\n  getEyeHeight (): number {\r\n    return 1.62\r\n  }\r\n\r\n  getMovementState (): MovementState {\r\n    return this.movementState\r\n  }\r\n\r\n  getVelocity (): Vec3 {\r\n    return this.velocity\r\n  }\r\n\r\n  isOnGround (): boolean {\r\n    return this.onGround\r\n  }\r\n\r\n  isSneaking (): boolean {\r\n    return this.sneaking\r\n  }\r\n\r\n  isFlying (): boolean {\r\n    return this.flying\r\n  }\r\n\r\n  isSprinting (): boolean {\r\n    return this.sprinting\r\n  }\r\n\r\n  // For testing purposes\r\n  setState (state: Partial<{\r\n    movementState: MovementState\r\n    velocity: Vec3\r\n    onGround: boolean\r\n    sneaking: boolean\r\n    flying: boolean\r\n    sprinting: boolean\r\n  }>) {\r\n    Object.assign(this, state)\r\n  }\r\n}\r\n","export class CameraBobbing {\r\n  private walkDistance = 0\r\n  private prevWalkDistance = 0\r\n  private bobAmount = 0\r\n  private prevBobAmount = 0\r\n  private readonly gameTimer = new GameTimer()\r\n\r\n  // eslint-disable-next-line max-params\r\n  constructor (\r\n    private readonly BOB_FREQUENCY: number = Math.PI, // How fast the bob cycles\r\n    private readonly BOB_BASE_AMPLITUDE: number = 0.5, // Base amplitude of the bob\r\n    private readonly VERTICAL_MULTIPLIER: number = 1, // Vertical movement multiplier\r\n    private readonly ROTATION_MULTIPLIER_Z: number = 3, // Roll rotation multiplier\r\n    private readonly ROTATION_MULTIPLIER_X: number = 5 // Pitch rotation multiplier\r\n  ) {}\r\n\r\n  // Call this when player is moving\r\n  public updateWalkDistance (distance: number): void {\r\n    this.prevWalkDistance = this.walkDistance\r\n    this.walkDistance = distance\r\n  }\r\n\r\n  // Call this when player is moving to update bob amount\r\n  public updateBobAmount (isMoving: boolean): void {\r\n    const targetBob = isMoving ? 1 : 0\r\n    this.prevBobAmount = this.bobAmount\r\n\r\n    // Update timing\r\n    const ticks = this.gameTimer.update()\r\n    const deltaTime = ticks / 20 // Convert ticks to seconds assuming 20 TPS\r\n\r\n    // Smooth transition for bob amount\r\n    const bobDelta = (targetBob - this.bobAmount) * Math.min(1, deltaTime * 10)\r\n    this.bobAmount += bobDelta\r\n  }\r\n\r\n  // Call this in your render/animation loop\r\n  public getBobbing (): { position: { x: number, y: number }, rotation: { x: number, z: number } } {\r\n    // Interpolate walk distance\r\n    const walkDist = this.prevWalkDistance +\r\n      (this.walkDistance - this.prevWalkDistance) * this.gameTimer.partialTick\r\n\r\n    // Interpolate bob amount\r\n    const bob = this.prevBobAmount +\r\n      (this.bobAmount - this.prevBobAmount) * this.gameTimer.partialTick\r\n\r\n    // Calculate total distance for bob cycle\r\n    const totalDist = -(walkDist * this.BOB_FREQUENCY)\r\n\r\n    // Calculate offsets\r\n    const xOffset = Math.sin(totalDist) * bob * this.BOB_BASE_AMPLITUDE\r\n    const yOffset = -Math.abs(Math.cos(totalDist) * bob) * this.VERTICAL_MULTIPLIER\r\n\r\n    // Calculate rotations (in radians)\r\n    const zRot = (Math.sin(totalDist) * bob * this.ROTATION_MULTIPLIER_Z) * (Math.PI / 180)\r\n    const xRot = (Math.abs(Math.cos(totalDist - 0.2) * bob) * this.ROTATION_MULTIPLIER_X) * (Math.PI / 180)\r\n\r\n    return {\r\n      position: { x: xOffset, y: yOffset },\r\n      rotation: { x: xRot, z: zRot }\r\n    }\r\n  }\r\n}\r\n\r\nclass GameTimer {\r\n  private readonly msPerTick: number\r\n  private lastMs: number\r\n  public partialTick = 0\r\n\r\n  constructor (tickRate = 20) {\r\n    this.msPerTick = 1000 / tickRate\r\n    this.lastMs = performance.now()\r\n  }\r\n\r\n  update (): number {\r\n    const currentMs = performance.now()\r\n    const deltaSinceLastTick = currentMs - this.lastMs\r\n\r\n    // Calculate how much of a tick has passed\r\n    const tickDelta = deltaSinceLastTick / this.msPerTick\r\n    this.lastMs = currentMs\r\n\r\n    // Add to accumulated partial ticks\r\n    this.partialTick += tickDelta\r\n\r\n    // Get whole number of ticks that should occur\r\n    const wholeTicks = Math.floor(this.partialTick)\r\n\r\n    // Keep the remainder as the new partial tick\r\n    this.partialTick -= wholeTicks\r\n\r\n    return wholeTicks\r\n  }\r\n}\r\n","export function buildCleanupDecorator (cleanupMethod: string) {\r\n  return function () {\r\n    return function (_target: { snapshotInitialValues }, propertyKey: string) {\r\n      const target = _target as any\r\n      // Store the initial value of the property\r\n      if (!target._snapshotMethodPatched) {\r\n        target.snapshotInitialValues = function () {\r\n          this._initialValues = {}\r\n          for (const key of target._toCleanup) {\r\n            this._initialValues[key] = this[key]\r\n          }\r\n        }\r\n        target._snapshotMethodPatched = true\r\n      }\r\n      (target._toCleanup ??= []).push(propertyKey)\r\n      if (!target._cleanupPatched) {\r\n        const originalMethod = target[cleanupMethod]\r\n        target[cleanupMethod] = function () {\r\n          for (const key of target._toCleanup) {\r\n            this[key] = this._initialValues[key]\r\n          }\r\n          // eslint-disable-next-line prefer-rest-params\r\n          Reflect.apply(originalMethod, this, arguments)\r\n        }\r\n      }\r\n      target._cleanupPatched = true\r\n    }\r\n  }\r\n}\r\n","//@ts-check\r\nimport EventEmitter from 'events'\r\nimport { UnionToIntersection } from 'type-fest'\r\nimport nbt from 'prismarine-nbt'\r\nimport * as TWEEN from '@tweenjs/tween.js'\r\nimport * as THREE from 'three'\r\nimport { PlayerObject, PlayerAnimation } from 'skinview3d'\r\nimport { loadSkinToCanvas, loadEarsToCanvasFromSkin, inferModelType, loadCapeToCanvas, loadImage } from 'skinview-utils'\r\n// todo replace with url\r\nimport { degreesToRadians } from '@nxg-org/mineflayer-tracker/lib/mathUtils'\r\nimport { NameTagObject } from 'skinview3d/libs/nametag'\r\nimport { flat, fromFormattedString } from '@xmcl/text-component'\r\nimport mojangson from 'mojangson'\r\nimport { snakeCase } from 'change-case'\r\nimport { Item } from 'prismarine-item'\r\nimport { BlockModel } from 'mc-assets'\r\nimport { EntityMetadataVersions } from '../../../src/mcDataTypes'\r\nimport * as Entity from './entity/EntityMesh'\r\nimport { getMesh } from './entity/EntityMesh'\r\nimport { WalkingGeneralSwing } from './entity/animations'\r\nimport { disposeObject } from './threeJsUtils'\r\nimport { armorModel, armorTextures } from './entity/armorModels'\r\nimport { Viewer } from './viewer'\r\nimport { getBlockMeshFromModel } from './holdingBlock'\r\nimport { ItemSpecificContextProperties } from './basePlayerState'\r\nimport { loadSkinImage, getLookupUrl, stevePngUrl, steveTexture } from './utils/skins'\r\nimport { loadTexture } from './utils'\r\n\r\nexport const TWEEN_DURATION = 120\r\n\r\ntype PlayerObjectType = PlayerObject & { animation?: PlayerAnimation }\r\n\r\nfunction convert2sComplementToHex (complement: number) {\r\n  if (complement < 0) {\r\n    complement = (0xFF_FF_FF_FF + complement + 1) >>> 0\r\n  }\r\n  return complement.toString(16)\r\n}\r\n\r\nfunction toRgba (color: string | undefined) {\r\n  if (color === undefined) {\r\n    return undefined\r\n  }\r\n  if (parseInt(color, 10) === 0) {\r\n    return 'rgba(0, 0, 0, 0)'\r\n  }\r\n  const hex = convert2sComplementToHex(parseInt(color, 10))\r\n  if (hex.length === 8) {\r\n    return `#${hex.slice(2, 8)}${hex.slice(0, 2)}`\r\n  } else {\r\n    return `#${hex}`\r\n  }\r\n}\r\n\r\nfunction toQuaternion (quaternion: any, defaultValue?: THREE.Quaternion) {\r\n  if (quaternion === undefined) {\r\n    return defaultValue\r\n  }\r\n  if (quaternion instanceof THREE.Quaternion) {\r\n    return quaternion\r\n  }\r\n  if (Array.isArray(quaternion)) {\r\n    return new THREE.Quaternion(quaternion[0], quaternion[1], quaternion[2], quaternion[3])\r\n  }\r\n  return new THREE.Quaternion(quaternion.x, quaternion.y, quaternion.z, quaternion.w)\r\n}\r\n\r\nfunction poseToEuler (pose: any, defaultValue?: THREE.Euler) {\r\n  if (pose === undefined) {\r\n    return defaultValue ?? new THREE.Euler()\r\n  }\r\n  if (pose instanceof THREE.Euler) {\r\n    return pose\r\n  }\r\n  if (pose['yaw'] !== undefined && pose['pitch'] !== undefined && pose['roll'] !== undefined) {\r\n    // Convert Minecraft pitch, yaw, roll definitions to our angle system\r\n    return new THREE.Euler(-degreesToRadians(pose.pitch), -degreesToRadians(pose.yaw), degreesToRadians(pose.roll), 'ZYX')\r\n  }\r\n  if (pose['x'] !== undefined && pose['y'] !== undefined && pose['z'] !== undefined) {\r\n    return new THREE.Euler(pose.z, pose.y, pose.x, 'ZYX')\r\n  }\r\n  if (Array.isArray(pose)) {\r\n    return new THREE.Euler(pose[0], pose[1], pose[2])\r\n  }\r\n  return defaultValue ?? new THREE.Euler()\r\n}\r\n\r\nfunction getUsernameTexture ({\r\n  username,\r\n  nameTagBackgroundColor = 'rgba(0, 0, 0, 0.3)',\r\n  nameTagTextOpacity = 255\r\n}: any, { fontFamily = 'sans-serif' }: any) {\r\n  const canvas = document.createElement('canvas')\r\n  const ctx = canvas.getContext('2d')\r\n  if (!ctx) throw new Error('Could not get 2d context')\r\n\r\n  const fontSize = 48\r\n  const padding = 5\r\n  ctx.font = `${fontSize}px ${fontFamily}`\r\n\r\n  const lines = String(username).split('\\n')\r\n\r\n  let textWidth = 0\r\n  for (const line of lines) {\r\n    const width = ctx.measureText(line).width + padding * 2\r\n    if (width > textWidth) textWidth = width\r\n  }\r\n\r\n  canvas.width = textWidth\r\n  canvas.height = (fontSize + padding) * lines.length\r\n\r\n  ctx.fillStyle = nameTagBackgroundColor\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height)\r\n\r\n  ctx.font = `${fontSize}px ${fontFamily}`\r\n  ctx.fillStyle = `rgba(255, 255, 255, ${nameTagTextOpacity / 255})`\r\n  let i = 0\r\n  for (const line of lines) {\r\n    i++\r\n    ctx.fillText(line, (textWidth - ctx.measureText(line).width) / 2, -padding + fontSize * i)\r\n  }\r\n\r\n  return canvas\r\n}\r\n\r\nconst addNametag = (entity, options, mesh) => {\r\n  if (entity.username !== undefined) {\r\n    if (mesh.children.some(c => c.name === 'nametag')) return // todo update\r\n    const canvas = getUsernameTexture(entity, options)\r\n    const tex = new THREE.Texture(canvas)\r\n    tex.needsUpdate = true\r\n    let nameTag\r\n    if (entity.nameTagFixed) {\r\n      const geometry = new THREE.PlaneGeometry()\r\n      const material = new THREE.MeshBasicMaterial({ map: tex })\r\n      material.transparent = true\r\n      nameTag = new THREE.Mesh(geometry, material)\r\n      nameTag.rotation.set(entity.pitch, THREE.MathUtils.degToRad(entity.yaw + 180), 0)\r\n      nameTag.position.y += entity.height + 0.3\r\n    } else {\r\n      const spriteMat = new THREE.SpriteMaterial({ map: tex })\r\n      nameTag = new THREE.Sprite(spriteMat)\r\n      nameTag.position.y += entity.height + 0.6\r\n    }\r\n    nameTag.renderOrder = 1000\r\n    nameTag.scale.set(canvas.width * 0.005, canvas.height * 0.005, 1)\r\n    if (entity.nameTagRotationRight) {\r\n      nameTag.applyQuaternion(entity.nameTagRotationRight)\r\n    }\r\n    if (entity.nameTagScale) {\r\n      nameTag.scale.multiply(entity.nameTagScale)\r\n    }\r\n    if (entity.nameTagRotationLeft) {\r\n      nameTag.applyQuaternion(entity.nameTagRotationLeft)\r\n    }\r\n    if (entity.nameTagTranslation) {\r\n      nameTag.position.add(entity.nameTagTranslation)\r\n    }\r\n    nameTag.name = 'nametag'\r\n\r\n    mesh.add(nameTag)\r\n  }\r\n}\r\n\r\n// todo cleanup\r\nconst nametags = {}\r\n\r\nconst isFirstUpperCase = (str) => str.charAt(0) === str.charAt(0).toUpperCase()\r\n\r\nfunction getEntityMesh (entity, world, options, overrides) {\r\n  if (entity.name) {\r\n    try {\r\n      // https://github.com/PrismarineJS/prismarine-viewer/pull/410\r\n      const entityName = (isFirstUpperCase(entity.name) ? snakeCase(entity.name) : entity.name).toLowerCase()\r\n      const e = new Entity.EntityMesh('1.16.4', entityName, world, overrides)\r\n\r\n      if (e.mesh) {\r\n        addNametag(entity, options, e.mesh)\r\n        return e.mesh\r\n      }\r\n    } catch (err) {\r\n      reportError?.(err)\r\n    }\r\n  }\r\n\r\n  const geometry = new THREE.BoxGeometry(entity.width, entity.height, entity.width)\r\n  geometry.translate(0, entity.height / 2, 0)\r\n  const material = new THREE.MeshBasicMaterial({ color: 0xff_00_ff })\r\n  const cube = new THREE.Mesh(geometry, material)\r\n  const nametagCount = (nametags[entity.name] = (nametags[entity.name] || 0) + 1)\r\n  if (nametagCount < 6) {\r\n    addNametag({\r\n      username: entity.name,\r\n      height: entity.height,\r\n    }, options, cube)\r\n  }\r\n  return cube\r\n}\r\n\r\nexport type SceneEntity = THREE.Object3D & {\r\n  playerObject?: PlayerObject & {\r\n    animation?: PlayerAnimation\r\n  }\r\n  username?: string\r\n  uuid?: string\r\n  additionalCleanup?: () => void\r\n}\r\n\r\nexport class Entities extends EventEmitter {\r\n  entities = {} as Record<string, SceneEntity>\r\n  entitiesOptions: {\r\n    fontFamily?: string\r\n  } = {}\r\n  debugMode: string\r\n  onSkinUpdate: () => void\r\n  clock = new THREE.Clock()\r\n  rendering = true\r\n  itemsTexture: THREE.Texture | null = null\r\n  cachedMapsImages = {} as Record<number, string>\r\n  itemFrameMaps = {} as Record<number, Array<THREE.Mesh<THREE.PlaneGeometry, THREE.MeshLambertMaterial>>>\r\n  getItemUv: undefined | ((item: Record<string, any>, specificProps: ItemSpecificContextProperties) => {\r\n    texture: THREE.Texture;\r\n    u: number;\r\n    v: number;\r\n    su?: number;\r\n    sv?: number;\r\n    size?: number;\r\n    modelName?: string;\r\n  } | {\r\n    resolvedModel: BlockModel\r\n    modelName: string\r\n  } | undefined)\r\n\r\n  get entitiesByName (): Record<string, SceneEntity[]> {\r\n    const byName: Record<string, SceneEntity[]> = {}\r\n    for (const entity of Object.values(this.entities)) {\r\n      if (!entity['realName']) continue\r\n      byName[entity['realName']] = byName[entity['realName']] || []\r\n      byName[entity['realName']].push(entity)\r\n    }\r\n    return byName\r\n  }\r\n\r\n  get entitiesRenderingCount (): number {\r\n    return Object.values(this.entities).filter(entity => entity.visible).length\r\n  }\r\n\r\n  constructor (public viewer: Viewer) {\r\n    super()\r\n    this.entitiesOptions = {}\r\n    this.debugMode = 'none'\r\n    this.onSkinUpdate = () => { }\r\n  }\r\n\r\n  clear () {\r\n    for (const mesh of Object.values(this.entities)) {\r\n      this.viewer.scene.remove(mesh)\r\n      disposeObject(mesh)\r\n    }\r\n    this.entities = {}\r\n  }\r\n\r\n  setDebugMode (mode: string, entity: THREE.Object3D | null = null) {\r\n    this.debugMode = mode\r\n    for (const mesh of entity ? [entity] : Object.values(this.entities)) {\r\n      const boxHelper = mesh.children.find(c => c.name === 'debug')!\r\n      boxHelper.visible = false\r\n      if (this.debugMode === 'basic') {\r\n        boxHelper.visible = true\r\n      }\r\n      // todo advanced\r\n    }\r\n  }\r\n\r\n  setRendering (rendering: boolean, entity: THREE.Object3D | null = null) {\r\n    this.rendering = rendering\r\n    for (const ent of entity ? [entity] : Object.values(this.entities)) {\r\n      if (rendering) {\r\n        if (!this.viewer.scene.children.includes(ent)) this.viewer.scene.add(ent)\r\n      } else {\r\n        this.viewer.scene.remove(ent)\r\n      }\r\n    }\r\n  }\r\n\r\n  render () {\r\n    const dt = this.clock.getDelta()\r\n    const botPos = this.viewer.world.viewerPosition\r\n    const VISIBLE_DISTANCE = 8 * 8\r\n\r\n    for (const entityId of Object.keys(this.entities)) {\r\n      const entity = this.entities[entityId]\r\n      const playerObject = entity.playerObject as PlayerObjectType | undefined\r\n\r\n      // Update animations\r\n      if (playerObject?.animation) {\r\n        playerObject.animation.update(playerObject, dt)\r\n      }\r\n\r\n      // Update visibility based on distance and chunk load status\r\n      if (botPos && entity.position) {\r\n        const dx = entity.position.x - botPos.x\r\n        const dy = entity.position.y - botPos.y\r\n        const dz = entity.position.z - botPos.z\r\n        const distanceSquared = dx * dx + dy * dy + dz * dz\r\n\r\n        // Get chunk coordinates\r\n        const chunkX = Math.floor(entity.position.x / 16) * 16\r\n        const chunkZ = Math.floor(entity.position.z / 16) * 16\r\n        const chunkKey = `${chunkX},${chunkZ}`\r\n\r\n        // Entity is visible if within 16 blocks OR in a finished chunk\r\n        entity.visible = !!(distanceSquared < VISIBLE_DISTANCE || this.viewer.world.finishedChunks[chunkKey])\r\n      }\r\n    }\r\n  }\r\n\r\n  getPlayerObject (entityId: string | number) {\r\n    const playerObject = this.entities[entityId]?.playerObject as PlayerObjectType | undefined\r\n    return playerObject\r\n  }\r\n\r\n  uuidPerSkinUrlsCache = {} as Record<string, { skinUrl?: string, capeUrl?: string }>\r\n\r\n  private isCanvasBlank (canvas: HTMLCanvasElement): boolean {\r\n    return !canvas.getContext('2d')\r\n      ?.getImageData(0, 0, canvas.width, canvas.height).data\r\n      .some(channel => channel !== 0)\r\n  }\r\n\r\n  // eslint-disable-next-line max-params\r\n  updatePlayerSkin (entityId: string | number, username: string | undefined, uuid: string | undefined, skinUrl: string | true, capeUrl: string | true | undefined = undefined) {\r\n    if (uuid) {\r\n      if (typeof skinUrl === 'string' || typeof capeUrl === 'string') this.uuidPerSkinUrlsCache[uuid] = {}\r\n      if (typeof skinUrl === 'string') this.uuidPerSkinUrlsCache[uuid].skinUrl = skinUrl\r\n      if (typeof capeUrl === 'string') this.uuidPerSkinUrlsCache[uuid].capeUrl = capeUrl\r\n      if (skinUrl === true) {\r\n        skinUrl = this.uuidPerSkinUrlsCache[uuid]?.skinUrl ?? skinUrl\r\n      }\r\n      capeUrl ??= this.uuidPerSkinUrlsCache[uuid]?.capeUrl\r\n    }\r\n\r\n    const playerObject = this.getPlayerObject(entityId)\r\n    if (!playerObject) return\r\n\r\n    if (skinUrl === true) {\r\n      if (!username) return\r\n      skinUrl = getLookupUrl(username, 'skin')\r\n    }\r\n\r\n    if (typeof skinUrl !== 'string') throw new Error('Invalid skin url')\r\n    const renderEars = this.viewer.world.config.renderEars || username === 'deadmau5'\r\n    void this.loadAndApplySkin(entityId, skinUrl, renderEars).then(() => {\r\n      if (capeUrl) {\r\n        if (capeUrl === true && username) {\r\n          capeUrl = getLookupUrl(username, 'cape')\r\n        }\r\n        if (typeof capeUrl === 'string') {\r\n          void this.loadAndApplyCape(entityId, capeUrl)\r\n        }\r\n      }\r\n    })\r\n\r\n\r\n    playerObject.cape.visible = false\r\n    if (!capeUrl) {\r\n      playerObject.backEquipment = null\r\n      playerObject.elytra.map = null\r\n      if (playerObject.cape.map) {\r\n        playerObject.cape.map.dispose()\r\n      }\r\n      playerObject.cape.map = null\r\n    }\r\n  }\r\n\r\n  private async loadAndApplySkin (entityId: string | number, skinUrl: string, renderEars: boolean) {\r\n    let playerObject = this.getPlayerObject(entityId)\r\n    if (!playerObject) return\r\n\r\n    try {\r\n      let playerCustomSkinImage: HTMLImageElement | undefined\r\n\r\n      playerObject = this.getPlayerObject(entityId)\r\n      if (!playerObject) return\r\n\r\n      let skinTexture: THREE.Texture\r\n      let skinCanvas: HTMLCanvasElement\r\n      if (skinUrl === stevePngUrl) {\r\n        skinTexture = await steveTexture\r\n        const canvas = document.createElement('canvas')\r\n        const ctx = canvas.getContext('2d')\r\n        if (!ctx) throw new Error('Failed to get context')\r\n        ctx.drawImage(skinTexture.image, 0, 0)\r\n        skinCanvas = canvas\r\n      } else {\r\n        const { canvas, image } = await loadSkinImage(skinUrl)\r\n        playerCustomSkinImage = image\r\n        skinTexture = new THREE.CanvasTexture(canvas)\r\n        skinCanvas = canvas\r\n      }\r\n\r\n      skinTexture.magFilter = THREE.NearestFilter\r\n      skinTexture.minFilter = THREE.NearestFilter\r\n      skinTexture.needsUpdate = true\r\n      playerObject.skin.map = skinTexture as any\r\n      playerObject.skin.modelType = inferModelType(skinCanvas)\r\n\r\n      let earsCanvas: HTMLCanvasElement | undefined\r\n      if (!playerCustomSkinImage) {\r\n        renderEars = false\r\n      } else if (renderEars) {\r\n        earsCanvas = document.createElement('canvas')\r\n        loadEarsToCanvasFromSkin(earsCanvas, playerCustomSkinImage)\r\n        renderEars = !this.isCanvasBlank(earsCanvas)\r\n      }\r\n      if (renderEars) {\r\n        const earsTexture = new THREE.CanvasTexture(earsCanvas!)\r\n        earsTexture.magFilter = THREE.NearestFilter\r\n        earsTexture.minFilter = THREE.NearestFilter\r\n        earsTexture.needsUpdate = true\r\n        //@ts-expect-error\r\n        playerObject.ears.map = earsTexture\r\n        playerObject.ears.visible = true\r\n      } else {\r\n        playerObject.ears.map = null\r\n        playerObject.ears.visible = false\r\n      }\r\n      this.onSkinUpdate?.()\r\n    } catch (error) {\r\n      console.error('Error loading skin:', error)\r\n    }\r\n  }\r\n\r\n  private async loadAndApplyCape (entityId: string | number, capeUrl: string) {\r\n    let playerObject = this.getPlayerObject(entityId)\r\n    if (!playerObject) return\r\n\r\n    try {\r\n      const { canvas: capeCanvas, image: capeImage } = await loadSkinImage(capeUrl)\r\n\r\n      playerObject = this.getPlayerObject(entityId)\r\n      if (!playerObject) return\r\n\r\n      loadCapeToCanvas(capeCanvas, capeImage)\r\n      const capeTexture = new THREE.CanvasTexture(capeCanvas)\r\n      capeTexture.magFilter = THREE.NearestFilter\r\n      capeTexture.minFilter = THREE.NearestFilter\r\n      capeTexture.needsUpdate = true\r\n      //@ts-expect-error\r\n      playerObject.cape.map = capeTexture\r\n      playerObject.cape.visible = true\r\n      //@ts-expect-error\r\n      playerObject.elytra.map = capeTexture\r\n      this.onSkinUpdate?.()\r\n\r\n      if (!playerObject.backEquipment) {\r\n        playerObject.backEquipment = 'cape'\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading cape:', error)\r\n    }\r\n  }\r\n\r\n  playAnimation (entityPlayerId, animation: 'walking' | 'running' | 'oneSwing' | 'idle') {\r\n    const playerObject = this.getPlayerObject(entityPlayerId)\r\n    if (!playerObject) return\r\n\r\n    if (animation === 'oneSwing') {\r\n      if (!(playerObject.animation instanceof WalkingGeneralSwing)) throw new Error('Expected WalkingGeneralSwing')\r\n      playerObject.animation.swingArm()\r\n      return\r\n    }\r\n\r\n    if (playerObject.animation instanceof WalkingGeneralSwing) {\r\n      playerObject.animation.switchAnimationCallback = () => {\r\n        if (!(playerObject.animation instanceof WalkingGeneralSwing)) throw new Error('Expected WalkingGeneralSwing')\r\n        playerObject.animation.isMoving = animation !== 'idle'\r\n        playerObject.animation.isRunning = animation === 'running'\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  parseEntityLabel (jsonLike) {\r\n    if (!jsonLike) return\r\n    try {\r\n      if (jsonLike.type === 'string') {\r\n        return jsonLike.value\r\n      }\r\n      const parsed = typeof jsonLike === 'string' ? mojangson.simplify(mojangson.parse(jsonLike)) : nbt.simplify(jsonLike)\r\n      const text = flat(parsed).map(this.textFromComponent)\r\n      return text.join('')\r\n    } catch (err) {\r\n      return jsonLike\r\n    }\r\n  }\r\n\r\n  private textFromComponent (component) {\r\n    return typeof component === 'string' ? component : component.text ?? ''\r\n  }\r\n\r\n  getItemMesh (item, specificProps: ItemSpecificContextProperties, previousModel?: string) {\r\n    const textureUv = this.getItemUv?.(item, specificProps)\r\n    if (previousModel && previousModel === textureUv?.modelName) return undefined\r\n\r\n    if (textureUv && 'resolvedModel' in textureUv) {\r\n      const mesh = getBlockMeshFromModel(this.viewer.world.material, textureUv.resolvedModel, textureUv.modelName)\r\n      let SCALE = 1\r\n      if (specificProps['minecraft:display_context'] === 'ground') {\r\n        SCALE = 0.5\r\n      } else if (specificProps['minecraft:display_context'] === 'thirdperson') {\r\n        SCALE = 6\r\n      }\r\n      mesh.scale.set(SCALE, SCALE, SCALE)\r\n      const outerGroup = new THREE.Group()\r\n      outerGroup.add(mesh)\r\n      return {\r\n        mesh: outerGroup,\r\n        isBlock: true,\r\n        itemsTexture: null,\r\n        itemsTextureFlipped: null,\r\n        modelName: textureUv.modelName,\r\n      }\r\n    }\r\n\r\n    // TODO: Render proper model (especially for blocks) instead of flat texture\r\n    if (textureUv) {\r\n      // todo use geometry buffer uv instead!\r\n      const { u, v, size, su, sv, texture } = textureUv\r\n      const itemsTexture = texture.clone()\r\n      itemsTexture.flipY = true\r\n      const sizeY = (sv ?? size)!\r\n      const sizeX = (su ?? size)!\r\n      itemsTexture.offset.set(u, 1 - v - sizeY)\r\n      itemsTexture.repeat.set(sizeX, sizeY)\r\n      itemsTexture.needsUpdate = true\r\n      itemsTexture.magFilter = THREE.NearestFilter\r\n      itemsTexture.minFilter = THREE.NearestFilter\r\n      const itemsTextureFlipped = itemsTexture.clone()\r\n      itemsTextureFlipped.repeat.x *= -1\r\n      itemsTextureFlipped.needsUpdate = true\r\n      itemsTextureFlipped.offset.set(u + (sizeX), 1 - v - sizeY)\r\n      const material = new THREE.MeshStandardMaterial({\r\n        map: itemsTexture,\r\n        transparent: true,\r\n        alphaTest: 0.1,\r\n      })\r\n      const materialFlipped = new THREE.MeshStandardMaterial({\r\n        map: itemsTextureFlipped,\r\n        transparent: true,\r\n        alphaTest: 0.1,\r\n      })\r\n      const mesh = new THREE.Mesh(new THREE.BoxGeometry(1, 1, 0), [\r\n        // top left and right bottom are black box materials others are transparent\r\n        new THREE.MeshBasicMaterial({ color: 0x00_00_00 }), new THREE.MeshBasicMaterial({ color: 0x00_00_00 }),\r\n        new THREE.MeshBasicMaterial({ color: 0x00_00_00 }), new THREE.MeshBasicMaterial({ color: 0x00_00_00 }),\r\n        material, materialFlipped,\r\n      ])\r\n      let SCALE = 1\r\n      if (specificProps['minecraft:display_context'] === 'ground') {\r\n        SCALE = 0.5\r\n      } else if (specificProps['minecraft:display_context'] === 'thirdperson') {\r\n        SCALE = 6\r\n      }\r\n      mesh.scale.set(SCALE, SCALE, SCALE)\r\n      return {\r\n        mesh,\r\n        isBlock: false,\r\n        itemsTexture,\r\n        itemsTextureFlipped,\r\n        modelName: textureUv.modelName,\r\n      }\r\n    }\r\n  }\r\n\r\n  setVisible (mesh: THREE.Object3D, visible: boolean) {\r\n    //mesh.visible = visible\r\n    //TODO: Fix workaround for visibility setting\r\n    if (visible) {\r\n      mesh.scale.set(1, 1, 1)\r\n    } else {\r\n      mesh.scale.set(0, 0, 0)\r\n    }\r\n  }\r\n\r\n  update (entity: import('prismarine-entity').Entity & { delete?; pos, name }, overrides) {\r\n    const isPlayerModel = entity.name === 'player'\r\n    if (entity.name === 'zombie_villager' || entity.name === 'husk') {\r\n      overrides.texture = `textures/1.16.4/entity/${entity.name === 'zombie_villager' ? 'zombie_villager/zombie_villager.png' : `zombie/${entity.name}.png`}`\r\n    }\r\n    if (entity.name === 'glow_item_frame') {\r\n      if (!overrides.textures) overrides.textures = []\r\n      overrides.textures['background'] = 'block:glow_item_frame'\r\n    }\r\n    // this can be undefined in case where packet entity_destroy was sent twice (so it was already deleted)\r\n    let e = this.entities[entity.id]\r\n\r\n    if (entity.delete) {\r\n      if (!e) return\r\n      if (e.additionalCleanup) e.additionalCleanup()\r\n      e.traverse(c => {\r\n        if (c['additionalCleanup']) c['additionalCleanup']()\r\n      })\r\n      this.emit('remove', entity)\r\n      this.viewer.scene.remove(e)\r\n      disposeObject(e)\r\n      // todo dispose textures as well ?\r\n      delete this.entities[entity.id]\r\n      return\r\n    }\r\n\r\n    let mesh\r\n    if (e === undefined) {\r\n      const group = new THREE.Group()\r\n      if (entity.name === 'item') {\r\n        const item = entity.metadata?.find((m: any) => typeof m === 'object' && m?.itemCount)\r\n        if (item) {\r\n          const object = this.getItemMesh(item, {\r\n            'minecraft:display_context': 'ground',\r\n          })\r\n          if (object) {\r\n            mesh = object.mesh\r\n            mesh.scale.set(0.5, 0.5, 0.5)\r\n            mesh.position.set(0, 0.2, 0)\r\n            // set faces\r\n            // mesh.position.set(targetPos.x + 0.5 + 2, targetPos.y + 0.5, targetPos.z + 0.5)\r\n            // viewer.scene.add(mesh)\r\n            const clock = new THREE.Clock()\r\n            mesh.onBeforeRender = () => {\r\n              const delta = clock.getDelta()\r\n              mesh.rotation.y += delta\r\n            }\r\n            //@ts-expect-error\r\n            group.additionalCleanup = () => {\r\n              // important: avoid texture memory leak and gpu slowdown\r\n              object.itemsTexture?.dispose()\r\n              object.itemsTextureFlipped?.dispose()\r\n            }\r\n          }\r\n        }\r\n      } else if (isPlayerModel) {\r\n        // CREATE NEW PLAYER ENTITY\r\n        const wrapper = new THREE.Group()\r\n        const playerObject = new PlayerObject() as PlayerObjectType\r\n        playerObject.position.set(0, 16, 0)\r\n\r\n        // fix issues with starfield\r\n        playerObject.traverse((obj) => {\r\n          if (obj instanceof THREE.Mesh && obj.material instanceof THREE.MeshStandardMaterial) {\r\n            obj.material.transparent = true\r\n          }\r\n        })\r\n        //@ts-expect-error\r\n        wrapper.add(playerObject)\r\n        const scale = 1 / 16\r\n        wrapper.scale.set(scale, scale, scale)\r\n\r\n        if (entity.username) {\r\n          // todo proper colors\r\n          const nameTag = new NameTagObject(fromFormattedString(entity.username).text, {\r\n            font: `48px ${this.entitiesOptions.fontFamily}`,\r\n          })\r\n          nameTag.position.y = playerObject.position.y + playerObject.scale.y * 16 + 3\r\n          nameTag.renderOrder = 1000\r\n\r\n          //@ts-expect-error\r\n          wrapper.add(nameTag)\r\n        }\r\n\r\n        //@ts-expect-error\r\n        group.playerObject = playerObject\r\n        wrapper.rotation.set(0, Math.PI, 0)\r\n        mesh = wrapper\r\n        playerObject.animation = new WalkingGeneralSwing()\r\n        //@ts-expect-error\r\n        playerObject.animation.isMoving = false\r\n      } else {\r\n        mesh = getEntityMesh(entity, this.viewer.world, this.entitiesOptions, overrides)\r\n      }\r\n      if (!mesh) return\r\n      mesh.name = 'mesh'\r\n      // set initial position so there are no weird jumps update after\r\n      group.position.set(entity.pos.x, entity.pos.y, entity.pos.z)\r\n\r\n      // todo use width and height instead\r\n      const boxHelper = new THREE.BoxHelper(\r\n        mesh,\r\n        entity.type === 'hostile' ? 0xff_00_00 :\r\n          entity.type === 'mob' ? 0x00_ff_00 :\r\n            entity.type === 'player' ? 0x00_00_ff :\r\n              0xff_a5_00,\r\n      )\r\n      boxHelper.name = 'debug'\r\n      group.add(mesh)\r\n      group.add(boxHelper)\r\n      boxHelper.visible = false\r\n      this.viewer.scene.add(group)\r\n\r\n      e = group\r\n      e.name = 'entity'\r\n      e['realName'] = entity.name\r\n      this.entities[entity.id] = e\r\n\r\n      this.emit('add', entity)\r\n\r\n      if (isPlayerModel) {\r\n        this.updatePlayerSkin(entity.id, entity.username, entity.uuid, overrides?.texture || stevePngUrl)\r\n      }\r\n      this.setDebugMode(this.debugMode, group)\r\n      this.setRendering(this.rendering, group)\r\n    } else {\r\n      mesh = e.children.find(c => c.name === 'mesh')\r\n    }\r\n\r\n    // check if entity has armor\r\n    if (entity.equipment) {\r\n      this.addItemModel(e, 'left', entity.equipment[0])\r\n      this.addItemModel(e, 'right', entity.equipment[1])\r\n      addArmorModel(e, 'feet', entity.equipment[2])\r\n      addArmorModel(e, 'legs', entity.equipment[3], 2)\r\n      addArmorModel(e, 'chest', entity.equipment[4])\r\n      addArmorModel(e, 'head', entity.equipment[5])\r\n    }\r\n\r\n    const meta = getGeneralEntitiesMetadata(entity)\r\n\r\n    //@ts-expect-error\r\n    // set visibility\r\n    const isInvisible = entity.metadata?.[0] & 0x20\r\n    for (const child of mesh.children ?? []) {\r\n      if (child.name !== 'nametag') {\r\n        child.visible = !isInvisible\r\n      }\r\n    }\r\n    // ---\r\n    // set baby size\r\n    if (meta.baby) {\r\n      e.scale.set(0.5, 0.5, 0.5)\r\n    } else {\r\n      e.scale.set(1, 1, 1)\r\n    }\r\n    // entity specific meta\r\n    const textDisplayMeta = getSpecificEntityMetadata('text_display', entity)\r\n    const displayTextRaw = textDisplayMeta?.text || meta.custom_name_visible && meta.custom_name\r\n    const displayText = this.parseEntityLabel(displayTextRaw)\r\n    if (entity.name !== 'player' && displayText) {\r\n      const nameTagFixed = textDisplayMeta && (textDisplayMeta.billboard_render_constraints === 'fixed' || !textDisplayMeta.billboard_render_constraints)\r\n      const nameTagBackgroundColor = textDisplayMeta && toRgba(textDisplayMeta.background_color)\r\n      let nameTagTextOpacity: any\r\n      if (textDisplayMeta?.text_opacity) {\r\n        const rawOpacity = parseInt(textDisplayMeta?.text_opacity, 10)\r\n        nameTagTextOpacity = rawOpacity > 0 ? rawOpacity : 256 - rawOpacity\r\n      }\r\n      addNametag(\r\n        { ...entity, username: displayText, nameTagBackgroundColor, nameTagTextOpacity, nameTagFixed,\r\n          nameTagScale: textDisplayMeta?.scale, nameTagTranslation: textDisplayMeta && (textDisplayMeta.translation || new THREE.Vector3(0, 0, 0)),\r\n          nameTagRotationLeft: toQuaternion(textDisplayMeta?.left_rotation), nameTagRotationRight: toQuaternion(textDisplayMeta?.right_rotation) },\r\n        this.entitiesOptions,\r\n        mesh\r\n      )\r\n    }\r\n\r\n    const armorStandMeta = getSpecificEntityMetadata('armor_stand', entity)\r\n    if (armorStandMeta) {\r\n      const isSmall = (parseInt(armorStandMeta.client_flags, 10) & 0x01) !== 0\r\n      const hasArms = (parseInt(armorStandMeta.client_flags, 10) & 0x04) !== 0\r\n      const hasBasePlate = (parseInt(armorStandMeta.client_flags, 10) & 0x08) === 0\r\n      const isMarker = (parseInt(armorStandMeta.client_flags, 10) & 0x10) !== 0\r\n      mesh.castShadow = !isMarker\r\n      mesh.receiveShadow = !isMarker\r\n      if (isSmall) {\r\n        e.scale.set(0.5, 0.5, 0.5)\r\n      } else {\r\n        e.scale.set(1, 1, 1)\r\n      }\r\n      e.traverse(c => {\r\n        switch (c.name) {\r\n          case 'bone_baseplate':\r\n            this.setVisible(c, hasBasePlate)\r\n            c.rotation.y = -e.rotation.y\r\n            break\r\n          case 'bone_head':\r\n            if (armorStandMeta.head_pose) {\r\n              c.setRotationFromEuler(poseToEuler(armorStandMeta.head_pose))\r\n            }\r\n            break\r\n          case 'bone_body':\r\n            if (armorStandMeta.body_pose) {\r\n              c.setRotationFromEuler(poseToEuler(armorStandMeta.body_pose))\r\n            }\r\n            break\r\n          case 'bone_rightarm':\r\n            if (c.parent?.name !== 'bone_armor') {\r\n              this.setVisible(c, hasArms)\r\n            }\r\n            if (armorStandMeta.left_arm_pose) {\r\n              c.setRotationFromEuler(poseToEuler(armorStandMeta.left_arm_pose))\r\n            } else {\r\n              c.setRotationFromEuler(poseToEuler({ 'yaw': -10, 'pitch': -10, 'roll': 0 }))\r\n            }\r\n            break\r\n          case 'bone_leftarm':\r\n            if (c.parent?.name !== 'bone_armor') {\r\n              this.setVisible(c, hasArms)\r\n            }\r\n            if (armorStandMeta.right_arm_pose) {\r\n              c.setRotationFromEuler(poseToEuler(armorStandMeta.right_arm_pose))\r\n            } else {\r\n              c.setRotationFromEuler(poseToEuler({ 'yaw': 10, 'pitch': -10, 'roll': 0 }))\r\n            }\r\n            break\r\n          case 'bone_rightleg':\r\n            if (armorStandMeta.left_leg_pose) {\r\n              c.setRotationFromEuler(poseToEuler(armorStandMeta.left_leg_pose))\r\n            } else {\r\n              c.setRotationFromEuler(poseToEuler({ 'yaw': -1, 'pitch': -1, 'roll': 0 }))\r\n            }\r\n            break\r\n          case 'bone_leftleg':\r\n            if (armorStandMeta.right_leg_pose) {\r\n              c.setRotationFromEuler(poseToEuler(armorStandMeta.right_leg_pose))\r\n            } else {\r\n              c.setRotationFromEuler(poseToEuler({ 'yaw': 1, 'pitch': 1, 'roll': 0 }))\r\n            }\r\n            break\r\n        }\r\n      })\r\n    }\r\n\r\n    // todo handle map, map_chunks events\r\n    let itemFrameMeta = getSpecificEntityMetadata('item_frame', entity)\r\n    if (!itemFrameMeta) {\r\n      itemFrameMeta = getSpecificEntityMetadata('glow_item_frame', entity)\r\n    }\r\n    if (itemFrameMeta) {\r\n      // TODO: fix type\r\n      // todo! fix errors in mc-data (no entities data prior 1.18.2)\r\n      const item = (itemFrameMeta?.item ?? entity.metadata?.[8]) as any as { itemId, blockId, components, nbtData: { value: { map: { value: number } } } }\r\n      mesh.scale.set(1, 1, 1)\r\n      e.rotation.x = -entity.pitch\r\n      e.children.find(c => {\r\n        if (c.name.startsWith('map_')) {\r\n          disposeObject(c)\r\n          const existingMapNumber = parseInt(c.name.split('_')[1], 10)\r\n          this.itemFrameMaps[existingMapNumber] = this.itemFrameMaps[existingMapNumber]?.filter(mesh => mesh !== c)\r\n          if (c instanceof THREE.Mesh) {\r\n            c.material?.map?.dispose()\r\n          }\r\n          return true\r\n        } else if (c.name === 'item') {\r\n          disposeObject(c)\r\n          return true\r\n        }\r\n        return false\r\n      })?.removeFromParent()\r\n      if (item && (item.itemId ?? item.blockId ?? 0) !== 0) {\r\n        const rotation = (itemFrameMeta.rotation as any as number) ?? 0\r\n        const mapNumber = item.nbtData?.value?.map?.value ?? item.components?.find(x => x.type === 'map_id')?.data\r\n        if (mapNumber) {\r\n          // TODO: Use proper larger item frame model when a map exists\r\n          mesh.scale.set(16 / 12, 16 / 12, 1)\r\n          this.addMapModel(e, mapNumber, rotation)\r\n        } else {\r\n          const itemMesh = this.getItemMesh(item, {\r\n            'minecraft:display_context': 'fixed',\r\n          })\r\n          if (itemMesh) {\r\n            itemMesh.mesh.position.set(0, 0, 0.43)\r\n            if (itemMesh.isBlock) {\r\n              itemMesh.mesh.scale.set(0.25, 0.25, 0.25)\r\n            } else {\r\n              itemMesh.mesh.scale.set(0.5, 0.5, 0.5)\r\n            }\r\n            itemMesh.mesh.rotateY(Math.PI)\r\n            itemMesh.mesh.rotateZ(-rotation * Math.PI / 4)\r\n            itemMesh.mesh.name = 'item'\r\n            e.add(itemMesh.mesh)\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    if (entity.username) {\r\n      e.username = entity.username\r\n    }\r\n\r\n    if (e?.playerObject && overrides?.rotation?.head) {\r\n      const playerObject = e.playerObject as PlayerObjectType\r\n      const headRotationDiff = overrides.rotation.head.y ? overrides.rotation.head.y - entity.yaw : 0\r\n      playerObject.skin.head.rotation.y = -headRotationDiff\r\n      playerObject.skin.head.rotation.x = overrides.rotation.head.x ? - overrides.rotation.head.x : 0\r\n    }\r\n\r\n    if (entity.pos) {\r\n      new TWEEN.Tween(e.position).to({ x: entity.pos.x, y: entity.pos.y, z: entity.pos.z }, TWEEN_DURATION).start()\r\n    }\r\n    if (entity.yaw) {\r\n      const da = (entity.yaw - e.rotation.y) % (Math.PI * 2)\r\n      const dy = 2 * da % (Math.PI * 2) - da\r\n      new TWEEN.Tween(e.rotation).to({ y: e.rotation.y + dy }, TWEEN_DURATION).start()\r\n    }\r\n  }\r\n\r\n  updateMap (mapNumber: string | number, data: string) {\r\n    this.cachedMapsImages[mapNumber] = data\r\n    let itemFrameMeshes = this.itemFrameMaps[mapNumber]\r\n    if (!itemFrameMeshes) return\r\n    itemFrameMeshes = itemFrameMeshes.filter(mesh => mesh.parent)\r\n    this.itemFrameMaps[mapNumber] = itemFrameMeshes\r\n    if (itemFrameMeshes) {\r\n      for (const mesh of itemFrameMeshes) {\r\n        mesh.material.map = this.loadMap(data)\r\n        mesh.material.needsUpdate = true\r\n        mesh.visible = true\r\n      }\r\n    }\r\n  }\r\n\r\n  addMapModel (entityMesh: THREE.Object3D, mapNumber: number, rotation: number) {\r\n    const imageData = this.cachedMapsImages?.[mapNumber]\r\n    let texture: THREE.Texture | null = null\r\n    if (imageData) {\r\n      texture = this.loadMap(imageData)\r\n    }\r\n    const parameters = {\r\n      transparent: true,\r\n      alphaTest: 0.1,\r\n    }\r\n    if (texture) {\r\n      parameters['map'] = texture\r\n    }\r\n    const material = new THREE.MeshLambertMaterial(parameters)\r\n\r\n    const mapMesh = new THREE.Mesh(new THREE.PlaneGeometry(1, 1), material)\r\n\r\n    mapMesh.rotation.set(0, Math.PI, 0)\r\n    entityMesh.add(mapMesh)\r\n    let isInvisible = true\r\n    entityMesh.traverseVisible(c => {\r\n      if (c.name === 'geometry_frame') {\r\n        isInvisible = false\r\n      }\r\n    })\r\n    if (isInvisible) {\r\n      mapMesh.position.set(0, 0, 0.499)\r\n    } else {\r\n      mapMesh.position.set(0, 0, 0.437)\r\n    }\r\n    mapMesh.rotateZ(Math.PI * 2 - rotation * Math.PI / 2)\r\n    mapMesh.name = `map_${mapNumber}`\r\n\r\n    if (!texture) {\r\n      mapMesh.visible = false\r\n    }\r\n\r\n    if (!this.itemFrameMaps[mapNumber]) {\r\n      this.itemFrameMaps[mapNumber] = []\r\n    }\r\n    this.itemFrameMaps[mapNumber].push(mapMesh)\r\n  }\r\n\r\n  loadMap (data: any) {\r\n    const texture = new THREE.TextureLoader().load(data)\r\n    if (texture) {\r\n      texture.magFilter = THREE.NearestFilter\r\n      texture.minFilter = THREE.NearestFilter\r\n      texture.needsUpdate = true\r\n    }\r\n    return texture\r\n  }\r\n\r\n  addItemModel (entityMesh: SceneEntity, hand: 'left' | 'right', item: Item) {\r\n    const parentName = `bone_${hand}item`\r\n    // remove existing item\r\n    entityMesh.traverse(c => {\r\n      if (c.parent?.name.toLowerCase() === parentName) {\r\n        c.removeFromParent()\r\n        if (c['additionalCleanup']) c['additionalCleanup']()\r\n      }\r\n    })\r\n    if (!item) return\r\n\r\n    const itemObject = this.getItemMesh(item, {\r\n      'minecraft:display_context': 'thirdperson',\r\n    })\r\n    if (itemObject) {\r\n      entityMesh.traverse(c => {\r\n        if (c.name.toLowerCase() === parentName) {\r\n          const group = new THREE.Object3D()\r\n          group['additionalCleanup'] = () => {\r\n            // important: avoid texture memory leak and gpu slowdown\r\n            itemObject.itemsTexture?.dispose()\r\n            itemObject.itemsTextureFlipped?.dispose()\r\n          }\r\n          const itemMesh = itemObject.mesh\r\n          group.rotation.z = -Math.PI / 16\r\n          if (itemObject.isBlock) {\r\n            group.rotation.y = Math.PI / 4\r\n          } else {\r\n            itemMesh.rotation.z = -Math.PI / 4\r\n            group.rotation.y = Math.PI / 2\r\n            group.scale.multiplyScalar(2)\r\n          }\r\n          group.add(itemMesh)\r\n          c.add(group)\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  handleDamageEvent (entityId, damageAmount) {\r\n    const entityMesh = this.entities[entityId]?.children.find(c => c.name === 'mesh')\r\n    if (entityMesh) {\r\n      entityMesh.traverse((child) => {\r\n        if (child instanceof THREE.Mesh) {\r\n          const clonedMaterial = child.material.clone()\r\n          clonedMaterial.dispose()\r\n          child.material = child.material.clone()\r\n          const originalColor = child.material.color.clone()\r\n          child.material.color.set(0xff_00_00)\r\n          new TWEEN.Tween(child.material.color)\r\n            .to(originalColor, 500)\r\n            .start()\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\nfunction getGeneralEntitiesMetadata (entity: { name; metadata }): Partial<UnionToIntersection<EntityMetadataVersions[keyof EntityMetadataVersions]>> {\r\n  const entityData = loadedData.entitiesByName[entity.name]\r\n  return new Proxy({}, {\r\n    get (target, p, receiver) {\r\n      if (typeof p !== 'string' || !entityData) return\r\n      const index = entityData.metadataKeys?.indexOf(p)\r\n      return entity.metadata?.[index ?? -1]\r\n    },\r\n  })\r\n}\r\n\r\nfunction getSpecificEntityMetadata<T extends keyof EntityMetadataVersions> (name: T, entity): EntityMetadataVersions[T] | undefined {\r\n  if (entity.name !== name) return\r\n  return getGeneralEntitiesMetadata(entity) as any\r\n}\r\n\r\nfunction addArmorModel (entityMesh: THREE.Object3D, slotType: string, item: Item, layer = 1, overlay = false) {\r\n  if (!item) {\r\n    removeArmorModel(entityMesh, slotType)\r\n    return\r\n  }\r\n  const itemParts = item.name.split('_')\r\n  let texturePath\r\n  const isPlayerHead = slotType === 'head' && item.name === 'player_head'\r\n  if (isPlayerHead) {\r\n    removeArmorModel(entityMesh, slotType)\r\n    if (item.nbt) {\r\n      const itemNbt = nbt.simplify(item.nbt)\r\n      try {\r\n        let textureData\r\n        if (itemNbt.SkullOwner) {\r\n          textureData = itemNbt.SkullOwner.Properties.textures[0]?.Value\r\n        } else {\r\n          textureData = itemNbt['minecraft:profile']?.Properties?.find(p => p.name === 'textures')?.value\r\n        }\r\n        if (textureData) {\r\n          const decodedData = JSON.parse(Buffer.from(textureData, 'base64').toString())\r\n          texturePath = decodedData.textures?.SKIN?.url\r\n        }\r\n      } catch (err) {\r\n        console.error('Error decoding player head texture:', err)\r\n      }\r\n    } else {\r\n      texturePath = stevePngUrl\r\n    }\r\n  }\r\n  const armorMaterial = itemParts[0]\r\n  if (!texturePath) {\r\n    // TODO: Support mirroring on certain parts of the model\r\n    const armorTextureName = `${armorMaterial}_layer_${layer}${overlay ? '_overlay' : ''}`\r\n    texturePath = viewer.world.customTextures.armor?.textures[armorTextureName]?.src ?? armorTextures[armorTextureName]\r\n  }\r\n  if (!texturePath || !armorModel[slotType]) {\r\n    removeArmorModel(entityMesh, slotType)\r\n    return\r\n  }\r\n\r\n  const meshName = `geometry_armor_${slotType}${overlay ? '_overlay' : ''}`\r\n  let mesh = entityMesh.children.findLast(c => c.name === meshName) as THREE.Mesh\r\n  let material\r\n  if (mesh) {\r\n    material = mesh.material\r\n    loadTexture(texturePath, texture => {\r\n      texture.magFilter = THREE.NearestFilter\r\n      texture.minFilter = THREE.NearestFilter\r\n      texture.flipY = false\r\n      texture.wrapS = THREE.MirroredRepeatWrapping\r\n      texture.wrapT = THREE.MirroredRepeatWrapping\r\n      material.map = texture\r\n    })\r\n  } else {\r\n    mesh = getMesh(viewer.world, texturePath, armorModel[slotType])\r\n    mesh.name = meshName\r\n    material = mesh.material\r\n    if (!isPlayerHead) {\r\n      material.side = THREE.DoubleSide\r\n    }\r\n  }\r\n  if (armorMaterial === 'leather' && !overlay) {\r\n    const color = (item.nbt?.value as any)?.display?.value?.color?.value\r\n    if (color) {\r\n      const r = color >> 16 & 0xff\r\n      const g = color >> 8 & 0xff\r\n      const b = color & 0xff\r\n      material.color.setRGB(r / 255, g / 255, b / 255)\r\n    } else {\r\n      material.color.setHex(0xB5_6D_51) // default brown color\r\n    }\r\n    addArmorModel(entityMesh, slotType, item, layer, true)\r\n  } else {\r\n    material.color.setHex(0xFF_FF_FF)\r\n  }\r\n  const group = new THREE.Object3D()\r\n  group.name = `armor_${slotType}${overlay ? '_overlay' : ''}`\r\n  group.add(mesh)\r\n\r\n  const skeletonHelper = new THREE.SkeletonHelper(mesh)\r\n  //@ts-expect-error\r\n  skeletonHelper.material.linewidth = 2\r\n  skeletonHelper.visible = false\r\n  group.add(skeletonHelper)\r\n\r\n  entityMesh.add(mesh)\r\n}\r\n\r\nfunction removeArmorModel (entityMesh: THREE.Object3D, slotType: string) {\r\n  for (const c of entityMesh.children) {\r\n    if (c.name === `geometry_armor_${slotType}` || c.name === `geometry_armor_${slotType}_overlay`) {\r\n      c.removeFromParent()\r\n    }\r\n  }\r\n}\r\n","import * as THREE from 'three'\r\nimport { OBJLoader } from 'three-stdlib'\r\nimport huskPng from 'mc-assets/dist/other-textures/latest/entity/zombie/husk.png'\r\nimport { Vec3 } from 'vec3'\r\nimport arrowTexture from '../../../../node_modules/mc-assets/dist/other-textures/1.21.2/entity/projectiles/arrow.png'\r\nimport spectralArrowTexture from '../../../../node_modules/mc-assets/dist/other-textures/1.21.2/entity/projectiles/spectral_arrow.png'\r\nimport tippedArrowTexture from '../../../../node_modules/mc-assets/dist/other-textures/1.21.2/entity/projectiles/tipped_arrow.png'\r\nimport { WorldRendererCommon } from '../worldrendererCommon'\r\nimport { loadTexture } from '../utils'\r\nimport entities from './entities.json'\r\nimport { externalModels } from './objModels'\r\nimport externalTexturesJson from './externalTextures.json'\r\n\r\ninterface ElemFace {\r\n  dir: [number, number, number]\r\n  u0: [number, number, number]\r\n  v0: [number, number, number]\r\n  u1: [number, number, number]\r\n  v1: [number, number, number]\r\n  corners: Array<[number, number, number, number, number]>\r\n}\r\n\r\ninterface GeoData {\r\n  positions: number[]\r\n  normals: number[]\r\n  uvs: number[]\r\n  indices: number[]\r\n  skinIndices: number[]\r\n  skinWeights: number[]\r\n}\r\n\r\ninterface JsonBone {\r\n  name: string\r\n  pivot?: [number, number, number]\r\n  bind_pose_rotation?: [number, number, number]\r\n  rotation?: [number, number, number]\r\n  parent?: string\r\n  cubes?: JsonCube[]\r\n  mirror?: boolean\r\n}\r\n\r\ninterface JsonCube {\r\n  origin: [number, number, number]\r\n  size: [number, number, number]\r\n  uv: [number, number]\r\n  inflate?: number\r\n  rotation?: [number, number, number]\r\n}\r\n\r\ninterface JsonModel {\r\n  texturewidth?: number\r\n  textureheight?: number\r\n  bones: JsonBone[]\r\n}\r\n\r\ninterface EntityOverrides {\r\n  textures?: Record<string, string>\r\n  rotation?: Record<string, { x?: number; y?: number; z?: number }>\r\n}\r\n\r\nconst elemFaces: Record<string, ElemFace> = {\r\n  up: {\r\n    dir: [0, 1, 0],\r\n    u0: [0, 0, 1],\r\n    v0: [0, 0, 0],\r\n    u1: [1, 0, 1],\r\n    v1: [0, 0, 1],\r\n    corners: [\r\n      [0, 1, 1, 0, 0],\r\n      [1, 1, 1, 1, 0],\r\n      [0, 1, 0, 0, 1],\r\n      [1, 1, 0, 1, 1]\r\n    ]\r\n  },\r\n  down: {\r\n    dir: [0, -1, 0],\r\n    u0: [1, 0, 1],\r\n    v0: [0, 0, 0],\r\n    u1: [2, 0, 1],\r\n    v1: [0, 0, 1],\r\n    corners: [\r\n      [1, 0, 1, 0, 0],\r\n      [0, 0, 1, 1, 0],\r\n      [1, 0, 0, 0, 1],\r\n      [0, 0, 0, 1, 1]\r\n    ]\r\n  },\r\n  east: {\r\n    dir: [1, 0, 0],\r\n    u0: [0, 0, 0],\r\n    v0: [0, 0, 1],\r\n    u1: [0, 0, 1],\r\n    v1: [0, 1, 1],\r\n    corners: [\r\n      [1, 1, 1, 0, 0],\r\n      [1, 0, 1, 0, 1],\r\n      [1, 1, 0, 1, 0],\r\n      [1, 0, 0, 1, 1]\r\n    ]\r\n  },\r\n  west: {\r\n    dir: [-1, 0, 0],\r\n    u0: [1, 0, 1],\r\n    v0: [0, 0, 1],\r\n    u1: [1, 0, 2],\r\n    v1: [0, 1, 1],\r\n    corners: [\r\n      [0, 1, 0, 0, 0],\r\n      [0, 0, 0, 0, 1],\r\n      [0, 1, 1, 1, 0],\r\n      [0, 0, 1, 1, 1]\r\n    ]\r\n  },\r\n  north: {\r\n    dir: [0, 0, -1],\r\n    u0: [0, 0, 1],\r\n    v0: [0, 0, 1],\r\n    u1: [1, 0, 1],\r\n    v1: [0, 1, 1],\r\n    corners: [\r\n      [1, 0, 0, 0, 1],\r\n      [0, 0, 0, 1, 1],\r\n      [1, 1, 0, 0, 0],\r\n      [0, 1, 0, 1, 0]\r\n    ]\r\n  },\r\n  south: {\r\n    dir: [0, 0, 1],\r\n    u0: [1, 0, 2],\r\n    v0: [0, 0, 1],\r\n    u1: [2, 0, 2],\r\n    v1: [0, 1, 1],\r\n    corners: [\r\n      [0, 0, 1, 0, 1],\r\n      [1, 0, 1, 1, 1],\r\n      [0, 1, 1, 0, 0],\r\n      [1, 1, 1, 1, 0]\r\n    ]\r\n  }\r\n}\r\n\r\nfunction dot (a: number[], b: number[]): number {\r\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2]\r\n}\r\n\r\nfunction addCube (\r\n  attr: GeoData,\r\n  boneId: number,\r\n  bone: THREE.Bone,\r\n  cube: JsonCube,\r\n  sameTextureForAllFaces = false,\r\n  texWidth = 64,\r\n  texHeight = 64,\r\n  mirror = false,\r\n  errors: string[] = []\r\n): void {\r\n  const cubeRotation = new THREE.Euler(0, 0, 0)\r\n  if (cube.rotation) {\r\n    cubeRotation.x = -cube.rotation[0] * Math.PI / 180\r\n    cubeRotation.y = -cube.rotation[1] * Math.PI / 180\r\n    cubeRotation.z = -cube.rotation[2] * Math.PI / 180\r\n  }\r\n  for (const { dir, corners, u0, v0, u1, v1 } of Object.values(elemFaces)) {\r\n    const ndx = Math.floor(attr.positions.length / 3)\r\n\r\n    const eastOrWest = dir[0] !== 0\r\n    const faceUvs: number[] = []\r\n    for (const pos of corners) {\r\n      let u: number\r\n      let v: number\r\n      if (sameTextureForAllFaces) {\r\n        u = (cube.uv[0] + pos[3] * cube.size[0]) / texWidth\r\n        v = (cube.uv[1] + pos[4] * cube.size[1]) / texHeight\r\n      } else {\r\n        u = (cube.uv[0] + dot(pos[3] ? u1 : u0, cube.size)) / texWidth\r\n        v = (cube.uv[1] + dot(pos[4] ? v1 : v0, cube.size)) / texHeight\r\n      }\r\n      // if (isNaN(u) || isNaN(v)) {\r\n      //   errors.push(`NaN u: ${u}, v: ${v}`)\r\n      //   continue\r\n      // }\r\n      // if (u < 0 || u > 1 || v < 0 || v > 1) {\r\n      //   errors.push(`u: ${u}, v: ${v} out of range`)\r\n      //   continue\r\n      // }\r\n\r\n      const posX = eastOrWest && mirror ? pos[0] ^ 1 : pos[0]\r\n      const posY = pos[1]\r\n      const posZ = eastOrWest && mirror ? pos[2] ^ 1 : pos[2]\r\n      const inflate = cube.inflate ?? 0\r\n      let vecPos = new THREE.Vector3(\r\n        cube.origin[0] + posX * cube.size[0] + (posX ? inflate : -inflate),\r\n        cube.origin[1] + posY * cube.size[1] + (posY ? inflate : -inflate),\r\n        cube.origin[2] + posZ * cube.size[2] + (posZ ? inflate : -inflate)\r\n      )\r\n\r\n      vecPos = vecPos.applyEuler(cubeRotation)\r\n      vecPos = vecPos.sub(bone.position)\r\n      vecPos = vecPos.applyEuler(bone.rotation)\r\n      vecPos = vecPos.add(bone.position)\r\n\r\n      attr.positions.push(vecPos.x, vecPos.y, vecPos.z)\r\n      attr.normals.push(dir[0], dir[1], dir[2])\r\n      faceUvs.push(u, v)\r\n      attr.skinIndices.push(boneId, 0, 0, 0)\r\n      attr.skinWeights.push(1, 0, 0, 0)\r\n    }\r\n\r\n    if (mirror) {\r\n      for (let i = 0; i + 1 < corners.length; i += 2) {\r\n        const faceIndex = i * 2\r\n        const tempFaceUvs = faceUvs.slice(faceIndex, faceIndex + 4)\r\n        faceUvs[faceIndex] = tempFaceUvs[2]\r\n        faceUvs[faceIndex + 1] = tempFaceUvs[eastOrWest ? 1 : 3]\r\n        faceUvs[faceIndex + 2] = tempFaceUvs[0]\r\n        faceUvs[faceIndex + 3] = tempFaceUvs[eastOrWest ? 3 : 1]\r\n      }\r\n    }\r\n    attr.uvs.push(...faceUvs)\r\n\r\n    attr.indices.push(ndx, ndx + 1, ndx + 2, ndx + 2, ndx + 1, ndx + 3)\r\n  }\r\n}\r\n\r\nexport function getMesh (\r\n  worldRenderer: WorldRendererCommon | undefined,\r\n  texture: string,\r\n  jsonModel: JsonModel,\r\n  overrides: EntityOverrides = {},\r\n  debugFlags: EntityDebugFlags = {}\r\n): THREE.SkinnedMesh {\r\n  let textureWidth = jsonModel.texturewidth ?? 64\r\n  let textureHeight = jsonModel.textureheight ?? 64\r\n  let textureOffset: number[] | undefined\r\n  const useBlockTexture = texture.startsWith('block:')\r\n  const blocksTexture = worldRenderer?.material.map\r\n  if (useBlockTexture) {\r\n    if (!worldRenderer) throw new Error('worldRenderer is required for block textures')\r\n    const blockName = texture.slice(6)\r\n    const textureInfo = worldRenderer.blocksAtlasParser!.getTextureInfo(blockName)\r\n    if (textureInfo) {\r\n      textureWidth = blocksTexture!.image.width\r\n      textureHeight = blocksTexture!.image.height\r\n      textureOffset = [textureInfo.u, textureInfo.v]\r\n    } else {\r\n      console.error(`Unknown block ${blockName}`)\r\n    }\r\n  }\r\n\r\n  const bones: Record<string, THREE.Bone> = {}\r\n\r\n  const geoData: GeoData = {\r\n    positions: [],\r\n    normals: [],\r\n    uvs: [],\r\n    indices: [],\r\n    skinIndices: [],\r\n    skinWeights: []\r\n  }\r\n  let i = 0\r\n  for (const jsonBone of jsonModel.bones) {\r\n    const bone = new THREE.Bone()\r\n    if (jsonBone.pivot) {\r\n      bone.position.x = jsonBone.pivot[0]\r\n      bone.position.y = jsonBone.pivot[1]\r\n      bone.position.z = jsonBone.pivot[2]\r\n    }\r\n    if (jsonBone.bind_pose_rotation) {\r\n      bone.rotation.x = -jsonBone.bind_pose_rotation[0] * Math.PI / 180\r\n      bone.rotation.y = -jsonBone.bind_pose_rotation[1] * Math.PI / 180\r\n      bone.rotation.z = -jsonBone.bind_pose_rotation[2] * Math.PI / 180\r\n    } else if (jsonBone.rotation) {\r\n      bone.rotation.x = -jsonBone.rotation[0] * Math.PI / 180\r\n      bone.rotation.y = -jsonBone.rotation[1] * Math.PI / 180\r\n      bone.rotation.z = -jsonBone.rotation[2] * Math.PI / 180\r\n    }\r\n    if (overrides.rotation?.[jsonBone.name]) {\r\n      bone.rotation.x -= (overrides.rotation[jsonBone.name].x ?? 0) * Math.PI / 180\r\n      bone.rotation.y -= (overrides.rotation[jsonBone.name].y ?? 0) * Math.PI / 180\r\n      bone.rotation.z -= (overrides.rotation[jsonBone.name].z ?? 0) * Math.PI / 180\r\n    }\r\n    bone.name = `bone_${jsonBone.name}`\r\n    bones[jsonBone.name] = bone\r\n\r\n    if (jsonBone.cubes) {\r\n      for (const cube of jsonBone.cubes) {\r\n        const errors: string[] = []\r\n        addCube(geoData, i, bone, cube, useBlockTexture, textureWidth, textureHeight, jsonBone.mirror, errors)\r\n        if (errors.length) {\r\n          debugFlags.errors ??= []\r\n          debugFlags.errors.push(...errors.map(error => `Bone ${jsonBone.name}: ${error}`))\r\n        }\r\n      }\r\n    }\r\n    i++\r\n  }\r\n\r\n  const rootBones: THREE.Object3D[] = []\r\n  for (const jsonBone of jsonModel.bones) {\r\n    if (jsonBone.parent && bones[jsonBone.parent]) {\r\n      bones[jsonBone.parent].add(bones[jsonBone.name])\r\n    } else {\r\n      rootBones.push(bones[jsonBone.name])\r\n    }\r\n  }\r\n\r\n  const skeleton = new THREE.Skeleton(Object.values(bones))\r\n\r\n  const geometry = new THREE.BufferGeometry()\r\n  geometry.setAttribute('position', new THREE.Float32BufferAttribute(geoData.positions, 3))\r\n  geometry.setAttribute('normal', new THREE.Float32BufferAttribute(geoData.normals, 3))\r\n  geometry.setAttribute('uv', new THREE.Float32BufferAttribute(geoData.uvs, 2))\r\n  geometry.setAttribute('skinIndex', new THREE.Uint16BufferAttribute(geoData.skinIndices, 4))\r\n  geometry.setAttribute('skinWeight', new THREE.Float32BufferAttribute(geoData.skinWeights, 4))\r\n  geometry.setIndex(geoData.indices)\r\n\r\n  const material = new THREE.MeshLambertMaterial({ transparent: true, alphaTest: 0.1 })\r\n  const mesh = new THREE.SkinnedMesh(geometry, material)\r\n  mesh.add(...rootBones)\r\n  mesh.bind(skeleton)\r\n  mesh.scale.set(1 / 16, 1 / 16, 1 / 16)\r\n\r\n  if (textureOffset) {\r\n    // todo(memory) dont clone\r\n    const loadedTexture = blocksTexture!.clone()\r\n    loadedTexture.offset.set(textureOffset[0], textureOffset[1])\r\n    loadedTexture.needsUpdate = true\r\n    material.map = loadedTexture\r\n  } else {\r\n    void loadTexture(texture, loadedTexture => {\r\n      if (material.map) {\r\n        // texture is already loaded\r\n        return\r\n      }\r\n      loadedTexture.magFilter = THREE.NearestFilter\r\n      loadedTexture.minFilter = THREE.NearestFilter\r\n      loadedTexture.flipY = false\r\n      loadedTexture.wrapS = THREE.RepeatWrapping\r\n      loadedTexture.wrapT = THREE.RepeatWrapping\r\n      material.map = loadedTexture\r\n    }, () => {\r\n      // This callback runs after the texture is fully loaded\r\n      const actualWidth = material.map!.image.width\r\n      if (actualWidth && textureWidth !== actualWidth) {\r\n        material.map!.repeat.x = textureWidth / actualWidth\r\n      }\r\n      const actualHeight = material.map!.image.height\r\n      if (actualHeight && textureHeight !== actualHeight) {\r\n        material.map!.repeat.y = textureHeight / actualHeight\r\n      }\r\n      material.needsUpdate = true\r\n    })\r\n  }\r\n\r\n  return mesh\r\n}\r\n\r\nexport const rendererSpecialHandled = ['item_frame', 'item', 'player']\r\n\r\ntype EntityMapping = {\r\n  pattern: string | RegExp\r\n  target: string\r\n}\r\n\r\nconst temporaryMappings: EntityMapping[] = [\r\n  // Exact matches\r\n  { pattern: 'furnace_minecart', target: 'minecart' },\r\n  { pattern: 'spawner_minecart', target: 'minecart' },\r\n  { pattern: 'chest_minecart', target: 'minecart' },\r\n  { pattern: 'hopper_minecart', target: 'minecart' },\r\n  { pattern: 'command_block_minecart', target: 'minecart' },\r\n  { pattern: 'tnt_minecart', target: 'minecart' },\r\n  { pattern: 'glow_item_frame', target: 'item_frame' },\r\n  { pattern: 'glow_squid', target: 'squid' },\r\n  { pattern: 'trader_llama', target: 'llama' },\r\n  { pattern: 'chest_boat', target: 'boat' },\r\n  { pattern: 'spectral_arrow', target: 'arrow' },\r\n  { pattern: 'husk', target: 'zombie' },\r\n  { pattern: 'zombie_horse', target: 'horse' },\r\n  { pattern: 'donkey', target: 'horse' },\r\n  { pattern: 'skeleton_horse', target: 'horse' },\r\n  { pattern: 'mule', target: 'horse' },\r\n  { pattern: 'ocelot', target: 'cat' },\r\n  // Regex patterns\r\n  { pattern: /_minecraft$/, target: 'minecraft' },\r\n  { pattern: /_boat$/, target: 'boat' },\r\n  { pattern: /_raft$/, target: 'boat' },\r\n  { pattern: /_horse$/, target: 'horse' },\r\n  { pattern: /_zombie$/, target: 'zombie' },\r\n  { pattern: /_arrow$/, target: 'zombie' },\r\n]\r\n\r\nfunction getEntityMapping (type: string): string | undefined {\r\n  for (const mapping of temporaryMappings) {\r\n    if (typeof mapping.pattern === 'string') {\r\n      if (mapping.pattern === type) return mapping.target\r\n    } else if (mapping.pattern.test(type)) { return mapping.target }\r\n  }\r\n  return undefined\r\n}\r\n\r\nconst getEntity = (name: string) => {\r\n  return entities[name]\r\n}\r\n\r\nconst scaleEntity: Record<string, number> = {\r\n  zombie: 1.85,\r\n  husk: 1.85,\r\n  arrow: 0.0025\r\n}\r\n\r\nconst offsetEntity: Record<string, Vec3> = {\r\n  zombie: new Vec3(0, 1, 0),\r\n  husk: new Vec3(0, 1, 0),\r\n  boat: new Vec3(0, -1, 0),\r\n  arrow: new Vec3(0, -0.9, 0)\r\n}\r\n\r\ninterface EntityGeometry {\r\n  geometry: Array<{\r\n    name: string;\r\n    [key: string]: any;\r\n  }>;\r\n}\r\n\r\nexport type EntityDebugFlags = {\r\n  type?: 'obj' | 'bedrock'\r\n  tempMap?: string\r\n  textureMap?: boolean\r\n  errors?: string[]\r\n  isHardcodedTexture?: boolean\r\n}\r\n\r\nexport class EntityMesh {\r\n  mesh: THREE.Object3D\r\n\r\n  constructor (\r\n    version: string,\r\n    type: string,\r\n    worldRenderer?: WorldRendererCommon,\r\n    overrides: EntityOverrides = {},\r\n    debugFlags: EntityDebugFlags = {}\r\n  ) {\r\n    const originalType = type\r\n    const mappedValue = getEntityMapping(type)\r\n    if (mappedValue) {\r\n      type = mappedValue\r\n      debugFlags.tempMap = mappedValue\r\n    }\r\n\r\n    if (externalModels[type]) {\r\n      const objLoader = new OBJLoader()\r\n      const texturePathMap = {\r\n        'zombie_horse': `textures/${version}/entity/horse/horse_zombie.png`,\r\n        'husk': huskPng,\r\n        'skeleton_horse': `textures/${version}/entity/horse/horse_skeleton.png`,\r\n        'donkey': `textures/${version}/entity/horse/donkey.png`,\r\n        'mule': `textures/${version}/entity/horse/mule.png`,\r\n        'ocelot': `textures/${version}/entity/cat/ocelot.png`,\r\n        'arrow': arrowTexture,\r\n        'spectral_arrow': spectralArrowTexture,\r\n        'tipped_arrow': tippedArrowTexture\r\n      }\r\n      const tempTextureMap = texturePathMap[originalType] || texturePathMap[type]\r\n      if (tempTextureMap) {\r\n        debugFlags.textureMap = true\r\n      }\r\n      const texturePath = tempTextureMap || externalTexturesJson[type]\r\n      if (externalTexturesJson[type]) {\r\n        debugFlags.isHardcodedTexture = true\r\n      }\r\n      if (!texturePath) throw new Error(`No texture for ${type}`)\r\n      const texture = new THREE.TextureLoader().load(texturePath)\r\n      texture.minFilter = THREE.NearestFilter\r\n      texture.magFilter = THREE.NearestFilter\r\n      const material = new THREE.MeshBasicMaterial({\r\n        map: texture,\r\n        transparent: true,\r\n        alphaTest: 0.1\r\n      })\r\n      const obj = objLoader.parse(externalModels[type])\r\n      const scale = scaleEntity[originalType] || scaleEntity[type]\r\n      if (scale) obj.scale.set(scale, scale, scale)\r\n      const offset = offsetEntity[originalType]\r\n      if (offset) obj.position.set(offset.x, offset.y, offset.z)\r\n      obj.traverse((child) => {\r\n        if (child instanceof THREE.Mesh) {\r\n          child.material = material\r\n          // todo\r\n          if (child.name === 'Head layer') child.visible = false\r\n          if (child.name === 'Head' && overrides.rotation?.head) { // todo\r\n            child.rotation.x -= (overrides.rotation.head.x ?? 0) * Math.PI / 180\r\n            child.rotation.y -= (overrides.rotation.head.y ?? 0) * Math.PI / 180\r\n            child.rotation.z -= (overrides.rotation.head.z ?? 0) * Math.PI / 180\r\n          }\r\n        }\r\n      })\r\n      this.mesh = obj\r\n      debugFlags.type = 'obj'\r\n      return\r\n    }\r\n\r\n    if (originalType === 'arrow') {\r\n      // overrides.textures = {\r\n      //   'default': testArrow,\r\n      //   ...overrides.textures,\r\n      // }\r\n    }\r\n\r\n    const e = getEntity(type)\r\n    if (!e) {\r\n      // if (knownNotHandled.includes(type)) return\r\n      // throw new Error(`Unknown entity ${type}`)\r\n      return\r\n    }\r\n\r\n    this.mesh = new THREE.Object3D()\r\n    for (const [name, jsonModel] of Object.entries(e.geometry)) {\r\n      const texture = overrides.textures?.[name] ?? e.textures[name]\r\n      if (!texture) continue\r\n      // console.log(JSON.stringify(jsonModel, null, 2))\r\n      const mesh = getMesh(worldRenderer,\r\n        texture.endsWith('.png') || texture.startsWith('data:image/') || texture.startsWith('block:')\r\n          ? texture : texture + '.png',\r\n        jsonModel,\r\n        overrides,\r\n        debugFlags)\r\n      mesh.name = `geometry_${name}`\r\n      this.mesh.add(mesh)\r\n\r\n      const skeletonHelper = new THREE.SkeletonHelper(mesh)\r\n      //@ts-expect-error\r\n      skeletonHelper.material.linewidth = 2\r\n      skeletonHelper.visible = false\r\n      this.mesh.add(skeletonHelper)\r\n    }\r\n    debugFlags.type = 'bedrock'\r\n  }\r\n\r\n  static getStaticData (name: string): { boneNames: string[] } {\r\n    name = getEntityMapping(name) || name\r\n    if (externalModels[name]) {\r\n      return {\r\n        boneNames: [] // todo\r\n      }\r\n    }\r\n    const e = getEntity(name) as EntityGeometry\r\n    if (!e) throw new Error(`Unknown entity ${name}`)\r\n    return {\r\n      boneNames: Object.values(e.geometry).flatMap(x => x.name)\r\n    }\r\n  }\r\n}\r\n","import { PlayerAnimation } from 'skinview3d'\r\n\r\nexport class WalkingGeneralSwing extends PlayerAnimation {\r\n\r\n  switchAnimationCallback\r\n\r\n  isRunning = false\r\n  isMoving = true\r\n\r\n  _startArmSwing\r\n\r\n  swingArm() {\r\n    this._startArmSwing = this.progress\r\n  }\r\n\r\n  animate(player) {\r\n    // Multiply by animation's natural speed\r\n    let t\r\n    const updateT = () => {\r\n      if (!this.isMoving) {\r\n        t = 0\r\n        return\r\n      }\r\n      if (this.isRunning) {\r\n        t = this.progress * 10 + Math.PI * 0.5\r\n      } else {\r\n        t = this.progress * 8\r\n      }\r\n    }\r\n    updateT()\r\n    let reset = false\r\n\r\n    if ((this.isRunning ? Math.cos(t) : Math.sin(t)) < 0.01) {\r\n      if (this.switchAnimationCallback) {\r\n        reset = true\r\n        this.progress = 0\r\n        updateT()\r\n      }\r\n    }\r\n\r\n    if (this.isRunning) {\r\n      // Leg swing with larger amplitude\r\n      player.skin.leftLeg.rotation.x = Math.cos(t + Math.PI) * 1.3\r\n      player.skin.rightLeg.rotation.x = Math.cos(t) * 1.3\r\n    } else {\r\n      // Leg swing\r\n      player.skin.leftLeg.rotation.x = Math.sin(t) * 0.5\r\n      player.skin.rightLeg.rotation.x = Math.sin(t + Math.PI) * 0.5\r\n    }\r\n\r\n    if (this._startArmSwing) {\r\n      const tHand = (this.progress - this._startArmSwing) * 18 + Math.PI * 0.5\r\n      player.skin.rightArm.rotation.x = Math.cos(tHand) * 1.5\r\n      const basicArmRotationZ = Math.PI * 0.1\r\n      player.skin.rightArm.rotation.z = Math.cos(t + Math.PI) * 0.3 - basicArmRotationZ\r\n\r\n      if (tHand > Math.PI + Math.PI * 0.5) {\r\n        this._startArmSwing = null\r\n        player.skin.rightArm.rotation.z = 0\r\n      }\r\n    }\r\n\r\n    if (this.isRunning) {\r\n      player.skin.leftArm.rotation.x = Math.cos(t) * 1.5\r\n      if (!this._startArmSwing) {\r\n        player.skin.rightArm.rotation.x = Math.cos(t + Math.PI) * 1.5\r\n      }\r\n      const basicArmRotationZ = Math.PI * 0.1\r\n      player.skin.leftArm.rotation.z = Math.cos(t) * 0.1 + basicArmRotationZ\r\n      if (!this._startArmSwing) {\r\n        player.skin.rightArm.rotation.z = Math.cos(t + Math.PI) * 0.1 - basicArmRotationZ\r\n      }\r\n    } else {\r\n      // Arm swing\r\n      player.skin.leftArm.rotation.x = Math.sin(t + Math.PI) * 0.5\r\n      if (!this._startArmSwing) {\r\n        player.skin.rightArm.rotation.x = Math.sin(t) * 0.5\r\n      }\r\n      const basicArmRotationZ = Math.PI * 0.02\r\n      player.skin.leftArm.rotation.z = Math.cos(t) * 0.03 + basicArmRotationZ\r\n      if (!this._startArmSwing) {\r\n        player.skin.rightArm.rotation.z = Math.cos(t + Math.PI) * 0.03 - basicArmRotationZ\r\n      }\r\n    }\r\n\r\n    if (this.isRunning) {\r\n      player.rotation.z = Math.cos(t + Math.PI) * 0.01\r\n    }\r\n    if (this.isRunning) {\r\n      const basicCapeRotationX = Math.PI * 0.3\r\n      player.cape.rotation.x = Math.sin(t * 2) * 0.1 + basicCapeRotationX\r\n    } else {\r\n      // Always add an angle for cape around the x axis\r\n      const basicCapeRotationX = Math.PI * 0.06\r\n      player.cape.rotation.x = Math.sin(t / 1.5) * 0.06 + basicCapeRotationX\r\n    }\r\n\r\n    if (reset) {\r\n      this.switchAnimationCallback()\r\n      this.switchAnimationCallback = null\r\n    }\r\n  }\r\n}\r\n","import { default as chainmailLayer1 } from 'mc-assets/dist/other-textures/latest/models/armor/chainmail_layer_1.png'\r\nimport { default as chainmailLayer2 } from 'mc-assets/dist/other-textures/latest/models/armor/chainmail_layer_2.png'\r\nimport { default as diamondLayer1 } from 'mc-assets/dist/other-textures/latest/models/armor/diamond_layer_1.png'\r\nimport { default as diamondLayer2 } from 'mc-assets/dist/other-textures/latest/models/armor/diamond_layer_2.png'\r\nimport { default as goldenLayer1 } from 'mc-assets/dist/other-textures/latest/models/armor/gold_layer_1.png'\r\nimport { default as goldenLayer2 } from 'mc-assets/dist/other-textures/latest/models/armor/gold_layer_2.png'\r\nimport { default as ironLayer1 } from 'mc-assets/dist/other-textures/latest/models/armor/iron_layer_1.png'\r\nimport { default as ironLayer2 } from 'mc-assets/dist/other-textures/latest/models/armor/iron_layer_2.png'\r\nimport { default as leatherLayer1 } from 'mc-assets/dist/other-textures/latest/models/armor/leather_layer_1.png'\r\nimport { default as leatherLayer1Overlay } from 'mc-assets/dist/other-textures/latest/models/armor/leather_layer_1_overlay.png'\r\nimport { default as leatherLayer2 } from 'mc-assets/dist/other-textures/latest/models/armor/leather_layer_2.png'\r\nimport { default as leatherLayer2Overlay } from 'mc-assets/dist/other-textures/latest/models/armor/leather_layer_2_overlay.png'\r\nimport { default as netheriteLayer1 } from 'mc-assets/dist/other-textures/latest/models/armor/netherite_layer_1.png'\r\nimport { default as netheriteLayer2 } from 'mc-assets/dist/other-textures/latest/models/armor/netherite_layer_2.png'\r\nimport { default as turtleLayer1 } from 'mc-assets/dist/other-textures/latest/models/armor/turtle_layer_1.png'\r\n\r\nexport { default as armorModel } from './armorModels.json'\r\n\r\nexport const armorTextures = {\r\n  'leather_layer_1': leatherLayer1,\r\n  'leather_layer_1_overlay': leatherLayer1Overlay,\r\n  'leather_layer_2': leatherLayer2,\r\n  'leather_layer_2_overlay': leatherLayer2Overlay,\r\n  'chainmail_layer_1': chainmailLayer1,\r\n  'chainmail_layer_2': chainmailLayer2,\r\n  'iron_layer_1': ironLayer1,\r\n  'iron_layer_2': ironLayer2,\r\n  'diamond_layer_1': diamondLayer1,\r\n  'diamond_layer_2': diamondLayer2,\r\n  'golden_layer_1': goldenLayer1,\r\n  'golden_layer_2': goldenLayer2,\r\n  'netherite_layer_1': netheriteLayer1,\r\n  'netherite_layer_2': netheriteLayer2,\r\n  'turtle_layer_1': turtleLayer1\r\n}\r\n","export { default as allay } from './models/allay.obj'\r\nexport { default as axolotl } from './models/axolotl.obj'\r\nexport { default as blaze } from './models/blaze.obj'\r\nexport { default as camel } from './models/camel.obj'\r\nexport { default as cat } from './models/cat.obj'\r\nexport { default as chicken } from './models/chicken.obj'\r\nexport { default as cod } from './models/cod.obj'\r\nexport { default as creeper } from './models/creeper.obj'\r\nexport { default as dolphin } from './models/dolphin.obj'\r\nexport { default as ender_dragon } from './models/ender_dragon.obj'\r\nexport { default as enderman } from './models/enderman.obj'\r\nexport { default as endermite } from './models/endermite.obj'\r\nexport { default as fox } from './models/fox.obj'\r\nexport { default as frog } from './models/frog.obj'\r\nexport { default as ghast } from './models/ghast.obj'\r\nexport { default as goat } from './models/goat.obj'\r\nexport { default as guardian } from './models/guardian.obj'\r\nexport { default as horse } from './models/horse.obj'\r\nexport { default as llama } from './models/llama.obj'\r\nexport { default as minecart } from './models/minecart.obj'\r\nexport { default as parrot } from './models/parrot.obj'\r\nexport { default as piglin } from './models/piglin.obj'\r\nexport { default as pillager } from './models/pillager.obj'\r\nexport { default as rabbit } from './models/rabbit.obj'\r\nexport { default as sheep } from './models/sheep.obj'\r\nexport { default as arrow } from './models/arrow.obj'\r\nexport { default as shulker } from './models/shulker.obj'\r\nexport { default as sniffer } from './models/sniffer.obj'\r\nexport { default as spider } from './models/spider.obj'\r\nexport { default as tadpole } from './models/tadpole.obj'\r\nexport { default as turtle } from './models/turtle.obj'\r\nexport { default as vex } from './models/vex.obj'\r\nexport { default as villager } from './models/villager.obj'\r\nexport { default as warden } from './models/warden.obj'\r\nexport { default as witch } from './models/witch.obj'\r\nexport { default as wolf } from './models/wolf.obj'\r\nexport { default as zombie_villager } from './models/zombie_villager.obj'\r\nexport { default as boat } from './models/boat.obj'\r\n","export * as externalModels from './exportedModels'\r\n","// Import placeholders - replace with actual imports for your environment\r\nimport { ItemRenderer, Identifier, ItemStack, NbtString, Structure, StructureRenderer, ItemRendererResources, BlockDefinition, BlockModel, TextureAtlas, Resources, ItemModel } from 'deepslate'\r\nimport { mat4, vec3 } from 'gl-matrix'\r\nimport { AssetsParser } from 'mc-assets/dist/assetsParser'\r\nimport { getLoadedImage } from 'mc-assets/dist/utils'\r\nimport { BlockModel as BlockModelMcAssets, AtlasParser } from 'mc-assets'\r\nimport { getLoadedBlockstatesStore, getLoadedModelsStore } from 'mc-assets/dist/stores'\r\nimport { makeTextureAtlas } from 'mc-assets/dist/atlasCreator'\r\nimport { proxy, ref } from 'valtio'\r\nimport { getItemDefinition } from 'mc-assets/dist/itemDefinitions'\r\nimport { versionToNumber } from '../prepare/utils'\r\n\r\nexport const activeGuiAtlas = proxy({\r\n  atlas: null as null | { json, image },\r\n})\r\n\r\nexport const getNonFullBlocksModels = () => {\r\n  let version = viewer.world.texturesVersion ?? 'latest'\r\n  if (versionToNumber(version) < versionToNumber('1.13')) version = '1.13'\r\n  const itemsDefinitions = viewer.world.itemsDefinitionsStore.data.latest\r\n  const blockModelsResolved = {} as Record<string, any>\r\n  const itemsModelsResolved = {} as Record<string, any>\r\n  const fullBlocksWithNonStandardDisplay = [] as string[]\r\n  const handledItemsWithDefinitions = new Set()\r\n  const assetsParser = new AssetsParser(version, getLoadedBlockstatesStore(viewer.world.blockstatesModels), getLoadedModelsStore(viewer.world.blockstatesModels))\r\n\r\n  const standardGuiDisplay = {\r\n    'rotation': [\r\n      30,\r\n      225,\r\n      0\r\n    ],\r\n    'translation': [\r\n      0,\r\n      0,\r\n      0\r\n    ],\r\n    'scale': [\r\n      0.625,\r\n      0.625,\r\n      0.625\r\n    ]\r\n  }\r\n\r\n  const arrEqual = (a: number[], b: number[]) => a.length === b.length && a.every((x, i) => x === b[i])\r\n  const addModelIfNotFullblock = (name: string, model: BlockModelMcAssets) => {\r\n    if (blockModelsResolved[name]) return\r\n    if (!model?.elements?.length) return\r\n    const isFullBlock = model.elements.length === 1 && arrEqual(model.elements[0].from, [0, 0, 0]) && arrEqual(model.elements[0].to, [16, 16, 16])\r\n    if (isFullBlock) return\r\n    model['display'] ??= {}\r\n    model['display']['gui'] ??= standardGuiDisplay\r\n    blockModelsResolved[name] = model\r\n  }\r\n\r\n  for (const [name, definition] of Object.entries(itemsDefinitions)) {\r\n    const item = getItemDefinition(viewer.world.itemsDefinitionsStore, {\r\n      version,\r\n      name,\r\n      properties: {\r\n        'minecraft:display_context': 'gui',\r\n      },\r\n    })\r\n    if (item) {\r\n      const { resolvedModel } = assetsParser.getResolvedModelsByModel((item.special ? name : item.model).replace('minecraft:', '')) ?? {}\r\n      if (resolvedModel) {\r\n        handledItemsWithDefinitions.add(name)\r\n      }\r\n      if (resolvedModel?.elements) {\r\n\r\n        let hasStandardDisplay = true\r\n        if (resolvedModel['display']?.gui) {\r\n          hasStandardDisplay =\r\n            arrEqual(resolvedModel['display'].gui.rotation, standardGuiDisplay.rotation)\r\n            && arrEqual(resolvedModel['display'].gui.translation, standardGuiDisplay.translation)\r\n            && arrEqual(resolvedModel['display'].gui.scale, standardGuiDisplay.scale)\r\n        }\r\n\r\n        addModelIfNotFullblock(name, resolvedModel)\r\n\r\n        if (!blockModelsResolved[name] && !hasStandardDisplay) {\r\n          fullBlocksWithNonStandardDisplay.push(name)\r\n        }\r\n        const notSideLight = resolvedModel['gui_light'] && resolvedModel['gui_light'] !== 'side'\r\n        if (!hasStandardDisplay || notSideLight) {\r\n          blockModelsResolved[name] = resolvedModel\r\n        }\r\n      }\r\n      if (!blockModelsResolved[name] && item.tints && resolvedModel) {\r\n        resolvedModel['tints'] = item.tints\r\n        if (resolvedModel.elements) {\r\n          blockModelsResolved[name] = resolvedModel\r\n        } else {\r\n          itemsModelsResolved[name] = resolvedModel\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  for (const [name, blockstate] of Object.entries(viewer.world.blockstatesModels.blockstates.latest)) {\r\n    if (handledItemsWithDefinitions.has(name)) {\r\n      continue\r\n    }\r\n    const resolvedModel = assetsParser.getResolvedModelFirst({ name: name.replace('minecraft:', ''), properties: {} }, true)\r\n    if (resolvedModel) {\r\n      addModelIfNotFullblock(name, resolvedModel[0])\r\n    }\r\n  }\r\n\r\n  return {\r\n    blockModelsResolved,\r\n    itemsModelsResolved\r\n  }\r\n}\r\n\r\n// customEvents.on('gameLoaded', () => {\r\n//   const res = getNonFullBlocksModels()\r\n// })\r\n\r\nconst RENDER_SIZE = 64\r\n\r\nconst generateItemsGui = async (models: Record<string, BlockModelMcAssets>, isItems = false) => {\r\n  const img = await getLoadedImage(isItems ? viewer.world.itemsAtlasParser!.latestImage : viewer.world.blocksAtlasParser!.latestImage)\r\n  const canvasTemp = document.createElement('canvas')\r\n  canvasTemp.width = img.width\r\n  canvasTemp.height = img.height\r\n  canvasTemp.style.imageRendering = 'pixelated'\r\n  const ctx = canvasTemp.getContext('2d')!\r\n  ctx.imageSmoothingEnabled = false\r\n  ctx.drawImage(img, 0, 0)\r\n\r\n  const atlasParser = isItems ? viewer.world.itemsAtlasParser! : viewer.world.blocksAtlasParser!\r\n  const textureAtlas = new TextureAtlas(\r\n    ctx.getImageData(0, 0, img.width, img.height),\r\n    Object.fromEntries(Object.entries(atlasParser.atlas.latest.textures).map(([key, value]) => {\r\n      return [key, [\r\n        value.u,\r\n        value.v,\r\n        (value.u + (value.su ?? atlasParser.atlas.latest.suSv)),\r\n        (value.v + (value.sv ?? atlasParser.atlas.latest.suSv)),\r\n      ]] as [string, [number, number, number, number]]\r\n    }))\r\n  )\r\n\r\n  const PREVIEW_ID = Identifier.parse('preview:preview')\r\n  const PREVIEW_DEFINITION = new BlockDefinition({ '': { model: PREVIEW_ID.toString() } }, undefined)\r\n\r\n  let modelData: any\r\n  let currentModelName: string | undefined\r\n  const resources: ItemRendererResources = {\r\n    getBlockModel (id) {\r\n      if (id.equals(PREVIEW_ID)) {\r\n        return BlockModel.fromJson(modelData ?? {})\r\n      }\r\n      return null\r\n    },\r\n    getTextureUV (texture) {\r\n      return textureAtlas.getTextureUV(texture.toString().replace('minecraft:', '').replace('block/', '').replace('item/', '').replace('blocks/', '').replace('items/', '') as any)\r\n    },\r\n    getTextureAtlas () {\r\n      return textureAtlas.getTextureAtlas()\r\n    },\r\n    getItemComponents (id) {\r\n      return new Map()\r\n    },\r\n    getItemModel (id) {\r\n      // const isSpecial = currentModelName === 'shield' || currentModelName === 'conduit' || currentModelName === 'trident'\r\n      const isSpecial = false\r\n      if (id.equals(PREVIEW_ID)) {\r\n        return ItemModel.fromJson({\r\n          type: isSpecial ? 'minecraft:special' : 'minecraft:model',\r\n          model: isSpecial ? {\r\n            type: currentModelName,\r\n          } : PREVIEW_ID.toString(),\r\n          base: PREVIEW_ID.toString(),\r\n          tints: modelData?.tints,\r\n        })\r\n      }\r\n      return null\r\n    },\r\n  }\r\n\r\n  const canvas = document.createElement('canvas')\r\n  canvas.width = RENDER_SIZE\r\n  canvas.height = RENDER_SIZE\r\n  const gl = canvas.getContext('webgl2', { preserveDrawingBuffer: true })\r\n  if (!gl) {\r\n    throw new Error('Cannot get WebGL2 context')\r\n  }\r\n\r\n  function resetGLContext (gl) {\r\n    gl.clearColor(0, 0, 0, 0)\r\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT | gl.STENCIL_BUFFER_BIT)\r\n  }\r\n\r\n  // const includeOnly = ['powered_repeater', 'wooden_door']\r\n  const includeOnly = [] as string[]\r\n\r\n  const images: Record<string, HTMLImageElement> = {}\r\n  const item = new ItemStack(PREVIEW_ID, 1, new Map(Object.entries({\r\n    'minecraft:item_model': new NbtString(PREVIEW_ID.toString()),\r\n  })))\r\n  const renderer = new ItemRenderer(gl, item, resources, { display_context: 'gui' })\r\n  const missingTextures = new Set()\r\n  for (const [modelName, model] of Object.entries(models)) {\r\n    if (includeOnly.length && !includeOnly.includes(modelName)) continue\r\n\r\n    const patchMissingTextures = () => {\r\n      for (const element of model.elements ?? []) {\r\n        for (const [faceName, face] of Object.entries(element.faces)) {\r\n          if (face.texture.startsWith('#')) {\r\n            missingTextures.add(`${modelName} ${faceName}: ${face.texture}`)\r\n            face.texture = 'block/unknown'\r\n          }\r\n        }\r\n      }\r\n    }\r\n    patchMissingTextures()\r\n    // TODO eggs\r\n\r\n    modelData = model\r\n    currentModelName = modelName\r\n    resetGLContext(gl)\r\n    if (!modelData) continue\r\n    renderer.setItem(item, { display_context: 'gui' })\r\n    renderer.drawItem()\r\n    const url = canvas.toDataURL()\r\n    // eslint-disable-next-line no-await-in-loop\r\n    const img = await getLoadedImage(url)\r\n    images[modelName] = img\r\n  }\r\n\r\n  if (missingTextures.size) {\r\n    console.warn(`[guiRenderer] Missing textures in ${[...missingTextures].join(', ')}`)\r\n  }\r\n\r\n  return images\r\n}\r\n\r\nconst generateAtlas = async (images: Record<string, HTMLImageElement>) => {\r\n  const atlas = makeTextureAtlas({\r\n    input: Object.keys(images),\r\n    tileSize: RENDER_SIZE,\r\n    getLoadedImage (name) {\r\n      return {\r\n        image: images[name],\r\n      }\r\n    },\r\n  })\r\n\r\n  // const atlasParser = new AtlasParser({ latest: atlas.json }, atlas.canvas.toDataURL())\r\n  // const a = document.createElement('a')\r\n  // a.href = await atlasParser.createDebugImage(true)\r\n  // a.download = 'blocks_atlas.png'\r\n  // a.click()\r\n\r\n  activeGuiAtlas.atlas = {\r\n    json: atlas.json,\r\n    image: ref(await getLoadedImage(atlas.canvas.toDataURL())),\r\n  }\r\n\r\n  return atlas\r\n}\r\n\r\nexport const generateGuiAtlas = async () => {\r\n  const { blockModelsResolved, itemsModelsResolved } = getNonFullBlocksModels()\r\n\r\n  // Generate blocks atlas\r\n  console.time('generate blocks gui atlas')\r\n  const blockImages = await generateItemsGui(blockModelsResolved, false)\r\n  console.timeEnd('generate blocks gui atlas')\r\n  console.time('generate items gui atlas')\r\n  const itemImages = await generateItemsGui(itemsModelsResolved, true)\r\n  console.timeEnd('generate items gui atlas')\r\n  await generateAtlas({ ...blockImages, ...itemImages })\r\n  // await generateAtlas(blockImages)\r\n}\r\n","import * as THREE from 'three'\r\nimport { loadSkinToCanvas } from 'skinview-utils'\r\nimport { getLookupUrl, loadSkinImage, steveTexture } from './utils/skins'\r\n\r\nexport const getMyHand = async (image?: string, userName?: string) => {\r\n  let newMap: THREE.Texture\r\n  if (!image && !userName) {\r\n    newMap = await steveTexture\r\n  } else {\r\n    if (!image) {\r\n      image = getLookupUrl(userName!, 'skin')\r\n    }\r\n    const { canvas } = await loadSkinImage(image)\r\n    newMap = new THREE.CanvasTexture(canvas)\r\n  }\r\n\r\n  newMap.magFilter = THREE.NearestFilter\r\n  newMap.minFilter = THREE.NearestFilter\r\n  // right arm\r\n  const box = new THREE.BoxGeometry()\r\n  const material = new THREE.MeshStandardMaterial()\r\n  const slim = false\r\n  const mesh = new THREE.Mesh(box, material)\r\n  mesh.scale.x = slim ? 3 : 4\r\n  mesh.scale.y = 12\r\n  mesh.scale.z = 4\r\n  setSkinUVs(box, 40, 16, slim ? 3 : 4, 12, 4)\r\n  material.map = newMap\r\n  material.needsUpdate = true\r\n  const group = new THREE.Group()\r\n  group.add(mesh)\r\n  group.scale.set(0.1, 0.1, 0.1)\r\n  mesh.rotation.z = Math.PI\r\n  return group\r\n}\r\n\r\nfunction setUVs (\r\n  box: THREE.BoxGeometry,\r\n  u: number,\r\n  v: number,\r\n  width: number,\r\n  height: number,\r\n  depth: number,\r\n  textureWidth: number,\r\n  textureHeight: number\r\n): void {\r\n  const toFaceVertices = (x1: number, y1: number, x2: number, y2: number) => [\r\n    new THREE.Vector2(x1 / textureWidth, 1 - y2 / textureHeight),\r\n    new THREE.Vector2(x2 / textureWidth, 1 - y2 / textureHeight),\r\n    new THREE.Vector2(x2 / textureWidth, 1 - y1 / textureHeight),\r\n    new THREE.Vector2(x1 / textureWidth, 1 - y1 / textureHeight),\r\n  ]\r\n\r\n  const top = toFaceVertices(u + depth, v, u + width + depth, v + depth)\r\n  const bottom = toFaceVertices(u + width + depth, v, u + width * 2 + depth, v + depth)\r\n  const left = toFaceVertices(u, v + depth, u + depth, v + depth + height)\r\n  const front = toFaceVertices(u + depth, v + depth, u + width + depth, v + depth + height)\r\n  const right = toFaceVertices(u + width + depth, v + depth, u + width + depth * 2, v + height + depth)\r\n  const back = toFaceVertices(u + width + depth * 2, v + depth, u + width * 2 + depth * 2, v + height + depth)\r\n\r\n  const uvAttr = box.attributes.uv as THREE.BufferAttribute\r\n  const uvRight = [right[3], right[2], right[0], right[1]]\r\n  const uvLeft = [left[3], left[2], left[0], left[1]]\r\n  const uvTop = [top[3], top[2], top[0], top[1]]\r\n  const uvBottom = [bottom[0], bottom[1], bottom[3], bottom[2]]\r\n  const uvFront = [front[3], front[2], front[0], front[1]]\r\n  const uvBack = [back[3], back[2], back[0], back[1]]\r\n\r\n  // Create a new array to hold the modified UV data\r\n  const newUVData = [] as number[]\r\n\r\n  // Iterate over the arrays and copy the data to uvData\r\n  for (const uvArray of [uvRight, uvLeft, uvTop, uvBottom, uvFront, uvBack]) {\r\n    for (const uv of uvArray) {\r\n      newUVData.push(uv.x, uv.y)\r\n    }\r\n  }\r\n\r\n  uvAttr.set(new Float32Array(newUVData))\r\n  uvAttr.needsUpdate = true\r\n}\r\n\r\nfunction setSkinUVs (box: THREE.BoxGeometry, u: number, v: number, width: number, height: number, depth: number): void {\r\n  setUVs(box, u, v, width, height, depth, 64, 64)\r\n}\r\n","import * as THREE from 'three'\r\nimport * as tweenJs from '@tweenjs/tween.js'\r\nimport worldBlockProvider from 'mc-assets/dist/worldBlockProvider'\r\nimport { BlockModel } from 'mc-assets'\r\nimport { getThreeBlockModelGroup, renderBlockThree, setBlockPosition } from './mesher/standaloneRenderer'\r\nimport { getMyHand } from './hand'\r\nimport { IPlayerState, MovementState } from './basePlayerState'\r\nimport { DebugGui } from './DebugGui'\r\nimport { SmoothSwitcher } from './smoothSwitcher'\r\nimport { watchProperty } from './utils/proxy'\r\nimport { disposeObject } from './threeJsUtils'\r\nimport { WorldRendererConfig } from './worldrendererCommon'\r\n\r\nexport type HandItemBlock = {\r\n  name?\r\n  properties?\r\n  fullItem?\r\n  type: 'block' | 'item' | 'hand'\r\n  id?: number\r\n}\r\n\r\nconst rotationPositionData = {\r\n  itemRight: {\r\n    'rotation': [\r\n      0,\r\n      -90,\r\n      25\r\n    ],\r\n    'translation': [\r\n      1.13,\r\n      3.2,\r\n      1.13\r\n    ],\r\n    'scale': [\r\n      0.68,\r\n      0.68,\r\n      0.68\r\n    ]\r\n  },\r\n  itemLeft: {\r\n    'rotation': [\r\n      0,\r\n      90,\r\n      -25\r\n    ],\r\n    'translation': [\r\n      1.13,\r\n      3.2,\r\n      1.13\r\n    ],\r\n    'scale': [\r\n      0.68,\r\n      0.68,\r\n      0.68\r\n    ]\r\n  },\r\n  blockRight: {\r\n    'rotation': [\r\n      0,\r\n      45,\r\n      0\r\n    ],\r\n    'translation': [\r\n      0,\r\n      0,\r\n      0\r\n    ],\r\n    'scale': [\r\n      0.4,\r\n      0.4,\r\n      0.4\r\n    ]\r\n  },\r\n  blockLeft: {\r\n    'rotation': [\r\n      0,\r\n      225,\r\n      0\r\n    ],\r\n    'translation': [\r\n      0,\r\n      0,\r\n      0\r\n    ],\r\n    'scale': [\r\n      0.4,\r\n      0.4,\r\n      0.4\r\n    ]\r\n  }\r\n}\r\n\r\nexport default class HoldingBlock {\r\n  // TODO refactor with the tree builder for better visual understanding\r\n  holdingBlock: THREE.Object3D | undefined = undefined\r\n  blockSwapAnimation: {\r\n    switcher: SmoothSwitcher\r\n    // hidden: boolean\r\n  } | undefined = undefined\r\n  cameraGroup = new THREE.Mesh()\r\n  objectOuterGroup = new THREE.Group() // 3\r\n  objectInnerGroup = new THREE.Group() // 4\r\n  holdingBlockInnerGroup = new THREE.Group() // 5\r\n  camera = new THREE.PerspectiveCamera(75, 1, 0.1, 100)\r\n  stopUpdate = false\r\n  lastHeldItem: HandItemBlock | undefined\r\n  isSwinging = false\r\n  nextIterStopCallbacks: Array<() => void> | undefined\r\n  idleAnimator: HandIdleAnimator | undefined\r\n  ready = false\r\n  lastUpdate = 0\r\n  playerHand: THREE.Object3D | undefined\r\n  offHandDisplay = false\r\n  offHandModeLegacy = false\r\n\r\n  swingAnimator: HandSwingAnimator | undefined\r\n\r\n  constructor (public playerState: IPlayerState, public config: WorldRendererConfig, public offHand = false) {\r\n    this.initCameraGroup()\r\n\r\n    this.playerState.events.on('heldItemChanged', (_, isOffHand) => {\r\n      if (this.offHand !== isOffHand) return\r\n      this.updateItem()\r\n    })\r\n\r\n    this.offHandDisplay = this.offHand\r\n    // this.offHandDisplay = true\r\n    if (!this.offHand) {\r\n      // watch over my hand\r\n      watchProperty(\r\n        async () => {\r\n          return getMyHand(this.playerState.reactive.playerSkin, this.playerState.onlineMode ? this.playerState.username : undefined)\r\n        },\r\n        this.playerState.reactive,\r\n        'playerSkin',\r\n        (newHand) => {\r\n          this.playerHand = newHand\r\n        },\r\n        (oldHand) => {\r\n          disposeObject(oldHand, true)\r\n        }\r\n      )\r\n    }\r\n  }\r\n\r\n  updateItem () {\r\n    if (!this.ready || !this.playerState.getHeldItem) return\r\n    const item = this.playerState.getHeldItem(this.offHand)\r\n    if (item) {\r\n      void this.setNewItem(item)\r\n    } else if (!this.offHand) {\r\n      void this.setNewItem({\r\n        type: 'hand',\r\n      })\r\n    }\r\n  }\r\n\r\n  initCameraGroup () {\r\n    this.cameraGroup = new THREE.Mesh()\r\n  }\r\n\r\n  startSwing () {\r\n    this.swingAnimator?.startSwing()\r\n  }\r\n\r\n  stopSwing () {\r\n    this.swingAnimator?.stopSwing()\r\n  }\r\n\r\n  render (originalCamera: THREE.PerspectiveCamera, renderer: THREE.WebGLRenderer, ambientLight: THREE.AmbientLight, directionalLight: THREE.DirectionalLight) {\r\n    if (!this.lastHeldItem) return\r\n    const now = performance.now()\r\n    if (this.lastUpdate && now - this.lastUpdate > 50) { // one tick\r\n      void this.replaceItemModel(this.lastHeldItem)\r\n    }\r\n\r\n    // Only update idle animation if not swinging\r\n    if (this.swingAnimator?.isCurrentlySwinging() || this.swingAnimator?.debugParams.animationStage) {\r\n      this.swingAnimator?.update()\r\n    } else {\r\n      this.idleAnimator?.update()\r\n    }\r\n\r\n    this.blockSwapAnimation?.switcher.update()\r\n\r\n    const scene = new THREE.Scene()\r\n    scene.add(this.cameraGroup)\r\n    // if (this.camera.aspect !== originalCamera.aspect) {\r\n    //   this.camera.aspect = originalCamera.aspect\r\n    //   this.camera.updateProjectionMatrix()\r\n    // }\r\n    this.updateCameraGroup()\r\n    scene.add(ambientLight.clone())\r\n    scene.add(directionalLight.clone())\r\n\r\n    const viewerSize = renderer.getSize(new THREE.Vector2())\r\n    const minSize = Math.min(viewerSize.width, viewerSize.height)\r\n    const x = viewerSize.width - minSize\r\n\r\n    // Mirror the scene for offhand by scaling\r\n    const { offHandDisplay } = this\r\n    if (offHandDisplay) {\r\n      this.cameraGroup.scale.x = -1\r\n    }\r\n\r\n    renderer.autoClear = false\r\n    renderer.clearDepth()\r\n    if (this.offHandDisplay) {\r\n      renderer.setViewport(0, 0, minSize, minSize)\r\n    } else {\r\n      const x = viewerSize.width - minSize\r\n      // if (x) x -= x / 4\r\n      renderer.setViewport(x, 0, minSize, minSize)\r\n    }\r\n    renderer.render(scene, this.camera)\r\n    renderer.setViewport(0, 0, viewerSize.width, viewerSize.height)\r\n\r\n    // Reset the mirroring after rendering\r\n    if (offHandDisplay) {\r\n      this.cameraGroup.scale.x = 1\r\n    }\r\n  }\r\n\r\n  // worldTest () {\r\n  //   const mesh = new THREE.Mesh(new THREE.BoxGeometry(1, 1, 1), new THREE.MeshPhongMaterial({ color: 0x00_00_ff, transparent: true, opacity: 0.5 }))\r\n  //   mesh.position.set(0.5, 0.5, 0.5)\r\n  //   const group = new THREE.Group()\r\n  //   group.add(mesh)\r\n  //   group.position.set(-0.5, -0.5, -0.5)\r\n  //   const outerGroup = new THREE.Group()\r\n  //   outerGroup.add(group)\r\n  //   outerGroup.position.set(this.camera.position.x, this.camera.position.y, this.camera.position.z)\r\n  //   this.scene.add(outerGroup)\r\n\r\n  //   new tweenJs.Tween(group.rotation).to({ z: THREE.MathUtils.degToRad(90) }, 1000).yoyo(true).repeat(Infinity).start()\r\n  // }\r\n\r\n  async playBlockSwapAnimation (forceState: 'appeared' | 'disappeared') {\r\n    this.blockSwapAnimation ??= {\r\n      switcher: new SmoothSwitcher(\r\n        () => ({\r\n          y: this.objectInnerGroup.position.y\r\n        }),\r\n        (property, value) => {\r\n          if (property === 'y') this.objectInnerGroup.position.y = value\r\n        },\r\n        {\r\n          y: 16 // units per second\r\n        }\r\n      )\r\n    }\r\n\r\n    const newState = forceState\r\n    // if (forceState && newState !== forceState) {\r\n    //   throw new Error(`forceState does not match current state ${forceState} !== ${newState}`)\r\n    // }\r\n\r\n    const targetY = this.objectInnerGroup.position.y + (this.objectInnerGroup.scale.y * 1.5 * (newState === 'appeared' ? 1 : -1))\r\n\r\n    // if (newState === this.blockSwapAnimation.switcher.transitioningToStateName) {\r\n    //   return false\r\n    // }\r\n\r\n    let cancelled = false\r\n    return new Promise<boolean>((resolve) => {\r\n      this.blockSwapAnimation!.switcher.transitionTo(\r\n        { y: targetY },\r\n        newState,\r\n        () => {\r\n          if (!cancelled) {\r\n            resolve(true)\r\n          }\r\n        },\r\n        () => {\r\n          cancelled = true\r\n          resolve(false)\r\n        }\r\n      )\r\n    })\r\n  }\r\n\r\n  isDifferentItem (block: HandItemBlock | undefined) {\r\n    if (!this.lastHeldItem) {\r\n      return true\r\n    }\r\n    if (this.lastHeldItem.name !== block?.name) {\r\n      return true\r\n    }\r\n    // eslint-disable-next-line sonarjs/prefer-single-boolean-return\r\n    if (JSON.stringify(this.lastHeldItem.fullItem) !== JSON.stringify(block?.fullItem ?? '{}')) {\r\n      return true\r\n    }\r\n\r\n    return false\r\n  }\r\n\r\n  updateCameraGroup () {\r\n    if (this.stopUpdate) return\r\n    const { camera } = this\r\n    this.cameraGroup.position.copy(camera.position)\r\n    this.cameraGroup.rotation.copy(camera.rotation)\r\n\r\n    // const viewerSize = viewer.renderer.getSize(new THREE.Vector2())\r\n    // const aspect = viewerSize.width / viewerSize.height\r\n    const aspect = 1\r\n\r\n\r\n    // Adjust the position based on the aspect ratio\r\n    const { position, scale: scaleData } = this.getHandHeld3d()\r\n    const distance = -position.z\r\n    const side = this.offHandModeLegacy ? -1 : 1\r\n    this.objectOuterGroup.position.set(\r\n      distance * position.x * aspect * side,\r\n      distance * position.y,\r\n      -distance\r\n    )\r\n\r\n    // const scale = Math.min(0.8, Math.max(1, 1 * aspect))\r\n    const scale = scaleData * 2.22 * 0.2\r\n    this.objectOuterGroup.scale.set(scale, scale, scale)\r\n  }\r\n\r\n  lastItemModelName: string | undefined\r\n  private async createItemModel (handItem: HandItemBlock): Promise<{ model: THREE.Object3D; type: 'hand' | 'block' | 'item' } | undefined> {\r\n    this.lastUpdate = performance.now()\r\n    if (!handItem || (handItem.type === 'hand' && !this.playerHand)) return undefined\r\n\r\n    let blockInner: THREE.Object3D | undefined\r\n    if (handItem.type === 'item' || handItem.type === 'block') {\r\n      const result = viewer.entities.getItemMesh({\r\n        ...handItem.fullItem,\r\n        itemId: handItem.id,\r\n      }, {\r\n        'minecraft:display_context': 'firstperson',\r\n        'minecraft:use_duration': this.playerState.getItemUsageTicks?.(),\r\n        'minecraft:using_item': !!this.playerState.getItemUsageTicks?.(),\r\n      }, this.lastItemModelName)\r\n      if (result) {\r\n        const { mesh: itemMesh, isBlock, modelName } = result\r\n        if (isBlock) {\r\n          blockInner = itemMesh\r\n          handItem.type = 'block'\r\n        } else {\r\n          itemMesh.position.set(0.5, 0.5, 0.5)\r\n          blockInner = itemMesh\r\n          handItem.type = 'item'\r\n        }\r\n        this.lastItemModelName = modelName\r\n      }\r\n    } else {\r\n      blockInner = this.playerHand!\r\n    }\r\n    if (!blockInner) return\r\n    blockInner.name = 'holdingBlock'\r\n\r\n    const rotationDeg = this.getHandHeld3d().rotation\r\n    blockInner.rotation.x = THREE.MathUtils.degToRad(rotationDeg.x)\r\n    blockInner.rotation.y = THREE.MathUtils.degToRad(rotationDeg.y)\r\n    blockInner.rotation.z = THREE.MathUtils.degToRad(rotationDeg.z)\r\n\r\n    return { model: blockInner, type: handItem.type }\r\n  }\r\n\r\n  async replaceItemModel (handItem?: HandItemBlock): Promise<void> {\r\n    // if switch animation is in progress, do not replace the item\r\n    if (this.blockSwapAnimation?.switcher.isTransitioning) return\r\n\r\n    if (!handItem) {\r\n      this.holdingBlock?.removeFromParent()\r\n      this.holdingBlock = undefined\r\n      this.swingAnimator?.stopSwing()\r\n      this.swingAnimator = undefined\r\n      this.idleAnimator = undefined\r\n      return\r\n    }\r\n\r\n    const result = await this.createItemModel(handItem)\r\n    if (!result) return\r\n\r\n    // Update the model without changing the group structure\r\n    this.holdingBlock?.removeFromParent()\r\n    this.holdingBlock = result.model\r\n    this.holdingBlockInnerGroup.add(result.model)\r\n\r\n\r\n  }\r\n\r\n  testUnknownBlockSwitch () {\r\n    void this.setNewItem({\r\n      type: 'item',\r\n      name: 'minecraft:some-unknown-block',\r\n      id: 0,\r\n      fullItem: {}\r\n    })\r\n  }\r\n\r\n  switchRequest = 0\r\n  async setNewItem (handItem?: HandItemBlock) {\r\n    if (!this.isDifferentItem(handItem)) return\r\n    this.lastItemModelName = undefined\r\n    const switchRequest = ++this.switchRequest\r\n    this.lastHeldItem = handItem\r\n    let playAppearAnimation = false\r\n    if (this.holdingBlock) {\r\n      // play disappear animation\r\n      playAppearAnimation = true\r\n      const result = await this.playBlockSwapAnimation('disappeared')\r\n      if (!result) return\r\n      this.holdingBlock?.removeFromParent()\r\n      this.holdingBlock = undefined\r\n    }\r\n\r\n    if (!handItem) {\r\n      this.swingAnimator?.stopSwing()\r\n      this.swingAnimator = undefined\r\n      this.idleAnimator = undefined\r\n      this.blockSwapAnimation = undefined\r\n      return\r\n    }\r\n\r\n    if (switchRequest !== this.switchRequest) return\r\n    const result = await this.createItemModel(handItem)\r\n    if (!result || switchRequest !== this.switchRequest) return\r\n\r\n    const blockOuterGroup = new THREE.Group()\r\n    this.holdingBlockInnerGroup.removeFromParent()\r\n    this.holdingBlockInnerGroup = new THREE.Group()\r\n    this.holdingBlockInnerGroup.add(result.model)\r\n    blockOuterGroup.add(this.holdingBlockInnerGroup)\r\n    this.holdingBlock = result.model\r\n    this.objectInnerGroup = new THREE.Group()\r\n    this.objectInnerGroup.add(blockOuterGroup)\r\n    this.objectInnerGroup.position.set(-0.5, -0.5, -0.5)\r\n    if (playAppearAnimation) {\r\n      this.objectInnerGroup.position.y -= this.objectInnerGroup.scale.y * 1.5\r\n    }\r\n    Object.assign(blockOuterGroup.position, { x: 0.5, y: 0.5, z: 0.5 })\r\n\r\n    this.objectOuterGroup = new THREE.Group()\r\n    this.objectOuterGroup.add(this.objectInnerGroup)\r\n\r\n    this.cameraGroup.add(this.objectOuterGroup)\r\n    const rotationDeg = this.getHandHeld3d().rotation\r\n    this.objectOuterGroup.rotation.y = THREE.MathUtils.degToRad(rotationDeg.yOuter)\r\n\r\n    if (playAppearAnimation) {\r\n      await this.playBlockSwapAnimation('appeared')\r\n    }\r\n\r\n    this.swingAnimator = new HandSwingAnimator(this.holdingBlockInnerGroup)\r\n    this.swingAnimator.type = result.type\r\n    if (this.config.viewBobbing) {\r\n      this.idleAnimator = new HandIdleAnimator(this.holdingBlockInnerGroup, this.playerState)\r\n    }\r\n  }\r\n\r\n  getHandHeld3d () {\r\n    const type = this.lastHeldItem?.type ?? 'hand'\r\n    const side = this.offHandModeLegacy ? 'Left' : 'Right'\r\n\r\n    let scale = 0.8 * 1.15 // default scale for hand\r\n    let position = {\r\n      x: 0.4,\r\n      y: -0.7,\r\n      z: -0.45\r\n    }\r\n    let rotation = {\r\n      x: -32.4,\r\n      y: 42.8,\r\n      z: -41.3,\r\n      yOuter: 0\r\n    }\r\n\r\n    if (type === 'item') {\r\n      const itemData = rotationPositionData[`item${side}`]\r\n      position = {\r\n        x: -0.05,\r\n        y: -0.7,\r\n        z: -0.45\r\n      }\r\n      rotation = {\r\n        x: itemData.rotation[0],\r\n        y: itemData.rotation[1],\r\n        z: itemData.rotation[2],\r\n        yOuter: 0\r\n      }\r\n      scale = itemData.scale[0] * 1.15\r\n    } else if (type === 'block') {\r\n      const blockData = rotationPositionData[`block${side}`]\r\n      position = {\r\n        x: 0.4,\r\n        y: -0.7,\r\n        z: -0.45\r\n      }\r\n      rotation = {\r\n        x: blockData.rotation[0],\r\n        y: blockData.rotation[1],\r\n        z: blockData.rotation[2],\r\n        yOuter: 0\r\n      }\r\n      scale = blockData.scale[0] * 1.15\r\n    }\r\n\r\n    return {\r\n      rotation,\r\n      position,\r\n      scale\r\n    }\r\n  }\r\n}\r\n\r\nclass HandIdleAnimator {\r\n  globalTime = 0\r\n  lastTime = 0\r\n  currentState: MovementState\r\n  targetState: MovementState\r\n  defaultPosition: { x: number; y: number; z: number; rotationX: number; rotationY: number; rotationZ: number }\r\n  private readonly idleOffset = { y: 0, rotationZ: 0 }\r\n  private readonly tween = new tweenJs.Group()\r\n  private idleTween: tweenJs.Tween<{ y: number; rotationZ: number }> | null = null\r\n  private readonly stateSwitcher: SmoothSwitcher\r\n\r\n  // Debug parameters\r\n  private readonly debugParams = {\r\n    // Transition durations for different state changes\r\n    walkingSpeed: 8,\r\n    sprintingSpeed: 16,\r\n    walkingAmplitude: { x: 1 / 30, y: 1 / 10, rotationZ: 0.25 },\r\n    sprintingAmplitude: { x: 1 / 30, y: 1 / 10, rotationZ: 0.4 }\r\n  }\r\n\r\n  private readonly debugGui: DebugGui\r\n\r\n  constructor (public handMesh: THREE.Object3D, public playerState: IPlayerState) {\r\n    this.handMesh = handMesh\r\n    this.globalTime = 0\r\n    this.currentState = 'NOT_MOVING'\r\n    this.targetState = 'NOT_MOVING'\r\n\r\n    this.defaultPosition = {\r\n      x: handMesh.position.x,\r\n      y: handMesh.position.y,\r\n      z: handMesh.position.z,\r\n      rotationX: handMesh.rotation.x,\r\n      rotationY: handMesh.rotation.y,\r\n      rotationZ: handMesh.rotation.z\r\n    }\r\n\r\n    // Initialize state switcher with appropriate speeds\r\n    this.stateSwitcher = new SmoothSwitcher(\r\n      () => {\r\n        return {\r\n          x: this.handMesh.position.x,\r\n          y: this.handMesh.position.y,\r\n          z: this.handMesh.position.z,\r\n          rotationX: this.handMesh.rotation.x,\r\n          rotationY: this.handMesh.rotation.y,\r\n          rotationZ: this.handMesh.rotation.z\r\n        }\r\n      },\r\n      (property, value) => {\r\n        switch (property) {\r\n          case 'x': this.handMesh.position.x = value; break\r\n          case 'y': this.handMesh.position.y = value; break\r\n          case 'z': this.handMesh.position.z = value; break\r\n          case 'rotationX': this.handMesh.rotation.x = value; break\r\n          case 'rotationY': this.handMesh.rotation.y = value; break\r\n          case 'rotationZ': this.handMesh.rotation.z = value; break\r\n        }\r\n      },\r\n      {\r\n        x: 2, // units per second\r\n        y: 2,\r\n        z: 2,\r\n        rotation: Math.PI // radians per second\r\n      }\r\n    )\r\n\r\n    // Initialize debug GUI\r\n    this.debugGui = new DebugGui('idle_animator', this.debugParams)\r\n    // this.debugGui.activate()\r\n  }\r\n\r\n  private startIdleAnimation () {\r\n    if (this.idleTween) {\r\n      this.idleTween.stop()\r\n    }\r\n\r\n    // Start from current position for smooth transition\r\n    this.idleOffset.y = this.handMesh.position.y - this.defaultPosition.y\r\n    this.idleOffset.rotationZ = this.handMesh.rotation.z - this.defaultPosition.rotationZ\r\n\r\n    this.idleTween = new tweenJs.Tween(this.idleOffset, this.tween)\r\n      .to({\r\n        y: 0.05,\r\n        rotationZ: 0.05\r\n      }, 3000)\r\n      .easing(tweenJs.Easing.Sinusoidal.InOut)\r\n      .yoyo(true)\r\n      .repeat(Infinity)\r\n      .start()\r\n  }\r\n\r\n  private stopIdleAnimation () {\r\n    if (this.idleTween) {\r\n      this.idleTween.stop()\r\n      this.idleOffset.y = 0\r\n      this.idleOffset.rotationZ = 0\r\n    }\r\n  }\r\n\r\n  private getStateTransform (state: MovementState, time: number) {\r\n    switch (state) {\r\n      case 'NOT_MOVING':\r\n      case 'SNEAKING':\r\n        return {\r\n          x: this.defaultPosition.x,\r\n          y: this.defaultPosition.y,\r\n          z: this.defaultPosition.z,\r\n          rotationX: this.defaultPosition.rotationX,\r\n          rotationY: this.defaultPosition.rotationY,\r\n          rotationZ: this.defaultPosition.rotationZ\r\n        }\r\n      case 'WALKING':\r\n      case 'SPRINTING': {\r\n        const speed = state === 'SPRINTING' ? this.debugParams.sprintingSpeed : this.debugParams.walkingSpeed\r\n        const amplitude = state === 'SPRINTING' ? this.debugParams.sprintingAmplitude : this.debugParams.walkingAmplitude\r\n\r\n        return {\r\n          x: this.defaultPosition.x + Math.sin(time * speed) * amplitude.x,\r\n          y: this.defaultPosition.y - Math.abs(Math.cos(time * speed)) * amplitude.y,\r\n          z: this.defaultPosition.z,\r\n          rotationX: this.defaultPosition.rotationX,\r\n          rotationY: this.defaultPosition.rotationY,\r\n          // rotationZ: this.defaultPosition.rotationZ + Math.sin(time * speed) * amplitude.rotationZ\r\n          rotationZ: this.defaultPosition.rotationZ\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  setState (newState: MovementState) {\r\n    if (newState === this.targetState) return\r\n\r\n    this.targetState = newState\r\n    const noTransition = false\r\n    if (this.currentState !== newState) {\r\n      // Stop idle animation during state transitions\r\n      this.stopIdleAnimation()\r\n\r\n      // Calculate new state transform\r\n      if (!noTransition) {\r\n        // this.globalTime = 0\r\n        const stateTransform = this.getStateTransform(newState, this.globalTime)\r\n\r\n        // Start transition to new state\r\n        this.stateSwitcher.transitionTo(stateTransform, newState)\r\n        // this.updated = false\r\n      }\r\n      this.currentState = newState\r\n    }\r\n  }\r\n\r\n  updated = false\r\n  update () {\r\n    this.stateSwitcher.update()\r\n\r\n    const now = performance.now()\r\n    const deltaTime = (now - this.lastTime) / 1000\r\n    this.lastTime = now\r\n\r\n    // Update global time based on current state\r\n    if (!this.stateSwitcher.isTransitioning) {\r\n      switch (this.currentState) {\r\n        case 'NOT_MOVING':\r\n        case 'SNEAKING':\r\n          this.globalTime = Math.PI / 4\r\n          break\r\n        case 'SPRINTING':\r\n        case 'WALKING':\r\n          this.globalTime += deltaTime\r\n          break\r\n      }\r\n    }\r\n\r\n    // Check for state changes from player state\r\n    if (this.playerState) {\r\n      const newState = this.playerState.getMovementState()\r\n      if (newState !== this.targetState) {\r\n        this.setState(newState)\r\n      }\r\n    }\r\n\r\n    // If we're not transitioning between states and in a stable state that should have idle animation\r\n    if (!this.stateSwitcher.isTransitioning &&\r\n      (this.currentState === 'NOT_MOVING' || this.currentState === 'SNEAKING')) {\r\n      // Start idle animation if not already running\r\n      if (!this.idleTween?.isPlaying()) {\r\n        this.startIdleAnimation()\r\n      }\r\n      // Update idle animation\r\n      this.tween.update()\r\n\r\n      // Apply idle offsets\r\n      this.handMesh.position.y = this.defaultPosition.y + this.idleOffset.y\r\n      this.handMesh.rotation.z = this.defaultPosition.rotationZ + this.idleOffset.rotationZ\r\n    }\r\n\r\n    // If we're in a movement state and not transitioning, update the movement animation\r\n    if (!this.stateSwitcher.isTransitioning &&\r\n      (this.currentState === 'WALKING' || this.currentState === 'SPRINTING')) {\r\n      const stateTransform = this.getStateTransform(this.currentState, this.globalTime)\r\n      Object.assign(this.handMesh.position, stateTransform)\r\n      Object.assign(this.handMesh.rotation, {\r\n        x: stateTransform.rotationX,\r\n        y: stateTransform.rotationY,\r\n        z: stateTransform.rotationZ\r\n      })\r\n      // this.stateSwitcher.transitionTo(stateTransform, this.currentState)\r\n    }\r\n  }\r\n\r\n  getCurrentState () {\r\n    return this.currentState\r\n  }\r\n\r\n  destroy () {\r\n    this.stopIdleAnimation()\r\n    this.stateSwitcher.forceFinish()\r\n  }\r\n}\r\n\r\nclass HandSwingAnimator {\r\n  private readonly PI = Math.PI\r\n  private animationTimer = 0\r\n  private lastTime = 0\r\n  private isAnimating = false\r\n  private stopRequested = false\r\n  private readonly originalRotation: THREE.Euler\r\n  private readonly originalPosition: THREE.Vector3\r\n  private readonly originalScale: THREE.Vector3\r\n\r\n  readonly debugParams = {\r\n    // Animation timing\r\n    animationTime: 250,\r\n    animationStage: 0,\r\n    useClassicSwing: true,\r\n\r\n    // Item/Block animation parameters\r\n    itemSwingXPosScale: -0.8,\r\n    itemSwingYPosScale: 0.2,\r\n    itemSwingZPosScale: -0.2,\r\n    itemHeightScale: -0.6,\r\n    itemPreswingRotY: 45,\r\n    itemSwingXRotAmount: -30,\r\n    itemSwingYRotAmount: -35,\r\n    itemSwingZRotAmount: -5,\r\n\r\n    // Hand/Arm animation parameters\r\n    armSwingXPosScale: -0.3,\r\n    armSwingYPosScale: 0.4,\r\n    armSwingZPosScale: -0.4,\r\n    armSwingYRotAmount: 70,\r\n    armSwingZRotAmount: -20,\r\n    armHeightScale: -0.6\r\n  }\r\n\r\n  private readonly debugGui: DebugGui\r\n\r\n  public type: 'hand' | 'block' | 'item' = 'hand'\r\n\r\n  constructor (public handMesh: THREE.Object3D) {\r\n    this.handMesh = handMesh\r\n    // Store initial transforms\r\n    this.originalRotation = handMesh.rotation.clone()\r\n    this.originalPosition = handMesh.position.clone()\r\n    this.originalScale = handMesh.scale.clone()\r\n\r\n    // Initialize debug GUI\r\n    this.debugGui = new DebugGui('hand_animator', this.debugParams, undefined, {\r\n      animationStage: {\r\n        min: 0,\r\n        max: 1,\r\n        step: 0.01\r\n      },\r\n      // Add ranges for all animation parameters\r\n      itemSwingXPosScale: { min: -2, max: 2, step: 0.1 },\r\n      itemSwingYPosScale: { min: -2, max: 2, step: 0.1 },\r\n      itemSwingZPosScale: { min: -2, max: 2, step: 0.1 },\r\n      itemHeightScale: { min: -2, max: 2, step: 0.1 },\r\n      itemPreswingRotY: { min: -180, max: 180, step: 5 },\r\n      itemSwingXRotAmount: { min: -180, max: 180, step: 5 },\r\n      itemSwingYRotAmount: { min: -180, max: 180, step: 5 },\r\n      itemSwingZRotAmount: { min: -180, max: 180, step: 5 },\r\n      armSwingXPosScale: { min: -2, max: 2, step: 0.1 },\r\n      armSwingYPosScale: { min: -2, max: 2, step: 0.1 },\r\n      armSwingZPosScale: { min: -2, max: 2, step: 0.1 },\r\n      armSwingYRotAmount: { min: -180, max: 180, step: 5 },\r\n      armSwingZRotAmount: { min: -180, max: 180, step: 5 },\r\n      armHeightScale: { min: -2, max: 2, step: 0.1 }\r\n    })\r\n    // this.debugGui.activate()\r\n  }\r\n\r\n  update () {\r\n    if (!this.isAnimating && !this.debugParams.animationStage) {\r\n      // If not animating, ensure we're at original position\r\n      this.handMesh.rotation.copy(this.originalRotation)\r\n      this.handMesh.position.copy(this.originalPosition)\r\n      this.handMesh.scale.copy(this.originalScale)\r\n      return\r\n    }\r\n\r\n    const now = performance.now()\r\n    const deltaTime = (now - this.lastTime) / 1000\r\n    this.lastTime = now\r\n\r\n    // Update animation progress\r\n    this.animationTimer += deltaTime * 1000 // Convert to ms\r\n\r\n    // Calculate animation stage (0 to 1)\r\n    const stage = this.debugParams.animationStage || Math.min(this.animationTimer / this.debugParams.animationTime, 1)\r\n\r\n    if (stage >= 1) {\r\n      // Animation complete\r\n      if (this.stopRequested) {\r\n        // If stop was requested, actually stop now that we've completed a swing\r\n        this.isAnimating = false\r\n        this.stopRequested = false\r\n        this.animationTimer = 0\r\n        this.handMesh.rotation.copy(this.originalRotation)\r\n        this.handMesh.position.copy(this.originalPosition)\r\n        this.handMesh.scale.copy(this.originalScale)\r\n        return\r\n      }\r\n      // Otherwise reset timer and continue\r\n      this.animationTimer = 0\r\n      return\r\n    }\r\n\r\n    // Start from original transforms\r\n    this.handMesh.rotation.copy(this.originalRotation)\r\n    this.handMesh.position.copy(this.originalPosition)\r\n    this.handMesh.scale.copy(this.originalScale)\r\n\r\n    // Calculate swing progress\r\n    const swingProgress = stage\r\n    const sqrtProgress = Math.sqrt(swingProgress)\r\n    const sinProgress = Math.sin(swingProgress * this.PI)\r\n    const sinSqrtProgress = Math.sin(sqrtProgress * this.PI)\r\n\r\n    if (this.type === 'hand') {\r\n      // Hand animation\r\n      const xOffset = this.debugParams.armSwingXPosScale * sinSqrtProgress\r\n      const yOffset = this.debugParams.armSwingYPosScale * Math.sin(sqrtProgress * this.PI * 2)\r\n      const zOffset = this.debugParams.armSwingZPosScale * sinProgress\r\n\r\n      this.handMesh.position.x += xOffset\r\n      this.handMesh.position.y += yOffset + this.debugParams.armHeightScale * swingProgress\r\n      this.handMesh.position.z += zOffset\r\n\r\n      // Rotations\r\n      this.handMesh.rotation.y += THREE.MathUtils.degToRad(this.debugParams.armSwingYRotAmount * sinSqrtProgress)\r\n      this.handMesh.rotation.z += THREE.MathUtils.degToRad(this.debugParams.armSwingZRotAmount * sinProgress)\r\n    } else {\r\n      // Item/Block animation\r\n      const xOffset = this.debugParams.itemSwingXPosScale * sinSqrtProgress\r\n      const yOffset = this.debugParams.itemSwingYPosScale * Math.sin(sqrtProgress * this.PI * 2)\r\n      const zOffset = this.debugParams.itemSwingZPosScale * sinProgress\r\n\r\n      this.handMesh.position.x += xOffset\r\n      this.handMesh.position.y += yOffset + this.debugParams.itemHeightScale * swingProgress\r\n      this.handMesh.position.z += zOffset\r\n\r\n      // Pre-swing rotation\r\n      this.handMesh.rotation.y += THREE.MathUtils.degToRad(this.debugParams.itemPreswingRotY)\r\n\r\n      // Swing rotations\r\n      this.handMesh.rotation.x += THREE.MathUtils.degToRad(this.debugParams.itemSwingXRotAmount * sinProgress)\r\n      this.handMesh.rotation.y += THREE.MathUtils.degToRad(this.debugParams.itemSwingYRotAmount * sinSqrtProgress)\r\n      this.handMesh.rotation.z += THREE.MathUtils.degToRad(this.debugParams.itemSwingZRotAmount * sinProgress)\r\n    }\r\n  }\r\n\r\n  startSwing () {\r\n    this.stopRequested = false\r\n    if (this.isAnimating) return\r\n\r\n    this.isAnimating = true\r\n    this.animationTimer = 0\r\n    this.lastTime = performance.now()\r\n  }\r\n\r\n  stopSwing () {\r\n    if (!this.isAnimating) return\r\n    this.stopRequested = true\r\n  }\r\n\r\n  isCurrentlySwinging () {\r\n    return this.isAnimating\r\n  }\r\n}\r\n\r\nexport const getBlockMeshFromModel = (material: THREE.Material, model: BlockModel, name: string) => {\r\n  const blockProvider = worldBlockProvider(viewer.world.blockstatesModels, viewer.world.blocksAtlasParser!.atlas, 'latest')\r\n  const worldRenderModel = blockProvider.transformModel(model, {\r\n    name,\r\n    properties: {}\r\n  })\r\n  return getThreeBlockModelGroup(material, [[worldRenderModel]], undefined, 'plains', loadedData)\r\n}\r\n","import { BlockModelPartsResolved } from './world'\r\n\r\nexport type BlockElement = NonNullable<BlockModelPartsResolved[0][0]['elements']>[0]\r\n\r\n\r\nexport function buildRotationMatrix (axis, degree) {\r\n  const radians = degree / 180 * Math.PI\r\n  const cos = Math.cos(radians)\r\n  const sin = Math.sin(radians)\r\n\r\n  const axis0 = { x: 0, y: 1, z: 2 }[axis]\r\n  const axis1 = (axis0 + 1) % 3\r\n  const axis2 = (axis0 + 2) % 3\r\n\r\n  const matrix = [\r\n    [0, 0, 0],\r\n    [0, 0, 0],\r\n    [0, 0, 0]\r\n  ]\r\n\r\n  matrix[axis0][axis0] = 1\r\n  matrix[axis1][axis1] = cos\r\n  matrix[axis1][axis2] = -sin\r\n  matrix[axis2][axis1] = +sin\r\n  matrix[axis2][axis2] = cos\r\n\r\n  return matrix\r\n}\r\n\r\nexport function vecadd3 (a, b) {\r\n  if (!b) return a\r\n  return [a[0] + b[0], a[1] + b[1], a[2] + b[2]]\r\n}\r\n\r\nexport function vecsub3 (a, b) {\r\n  if (!b) return a\r\n  return [a[0] - b[0], a[1] - b[1], a[2] - b[2]]\r\n}\r\n\r\nexport function matmul3 (matrix, vector): [number, number, number] {\r\n  if (!matrix) return vector\r\n  return [\r\n    matrix[0][0] * vector[0] + matrix[0][1] * vector[1] + matrix[0][2] * vector[2],\r\n    matrix[1][0] * vector[0] + matrix[1][1] * vector[1] + matrix[1][2] * vector[2],\r\n    matrix[2][0] * vector[0] + matrix[2][1] * vector[1] + matrix[2][2] * vector[2]\r\n  ]\r\n}\r\n\r\nexport function matmulmat3 (a, b) {\r\n  const te = [[0, 0, 0], [0, 0, 0], [0, 0, 0]]\r\n\r\n  const a11 = a[0][0]; const a12 = a[1][0]; const a13 = a[2][0]\r\n  const a21 = a[0][1]; const a22 = a[1][1]; const a23 = a[2][1]\r\n  const a31 = a[0][2]; const a32 = a[1][2]; const a33 = a[2][2]\r\n\r\n  const b11 = b[0][0]; const b12 = b[1][0]; const b13 = b[2][0]\r\n  const b21 = b[0][1]; const b22 = b[1][1]; const b23 = b[2][1]\r\n  const b31 = b[0][2]; const b32 = b[1][2]; const b33 = b[2][2]\r\n\r\n  te[0][0] = a11 * b11 + a12 * b21 + a13 * b31\r\n  te[1][0] = a11 * b12 + a12 * b22 + a13 * b32\r\n  te[2][0] = a11 * b13 + a12 * b23 + a13 * b33\r\n\r\n  te[0][1] = a21 * b11 + a22 * b21 + a23 * b31\r\n  te[1][1] = a21 * b12 + a22 * b22 + a23 * b32\r\n  te[2][1] = a21 * b13 + a22 * b23 + a23 * b33\r\n\r\n  te[0][2] = a31 * b11 + a32 * b21 + a33 * b31\r\n  te[1][2] = a31 * b12 + a32 * b22 + a33 * b32\r\n  te[2][2] = a31 * b13 + a32 * b23 + a33 * b33\r\n\r\n  return te\r\n}\r\n\r\nexport const elemFaces = {\r\n  up: {\r\n    dir: [0, 1, 0],\r\n    mask1: [1, 1, 0],\r\n    mask2: [0, 1, 1],\r\n    corners: [\r\n      [0, 1, 1, 0, 1],\r\n      [1, 1, 1, 1, 1],\r\n      [0, 1, 0, 0, 0],\r\n      [1, 1, 0, 1, 0]\r\n    ]\r\n  },\r\n  down: {\r\n    dir: [0, -1, 0],\r\n    mask1: [1, 1, 0],\r\n    mask2: [0, 1, 1],\r\n    corners: [\r\n      [1, 0, 1, 0, 1],\r\n      [0, 0, 1, 1, 1],\r\n      [1, 0, 0, 0, 0],\r\n      [0, 0, 0, 1, 0]\r\n    ]\r\n  },\r\n  east: {\r\n    dir: [1, 0, 0],\r\n    mask1: [1, 1, 0],\r\n    mask2: [1, 0, 1],\r\n    corners: [\r\n      [1, 1, 1, 0, 0],\r\n      [1, 0, 1, 0, 1],\r\n      [1, 1, 0, 1, 0],\r\n      [1, 0, 0, 1, 1]\r\n    ]\r\n  },\r\n  west: {\r\n    dir: [-1, 0, 0],\r\n    mask1: [1, 1, 0],\r\n    mask2: [1, 0, 1],\r\n    corners: [\r\n      [0, 1, 0, 0, 0],\r\n      [0, 0, 0, 0, 1],\r\n      [0, 1, 1, 1, 0],\r\n      [0, 0, 1, 1, 1]\r\n    ]\r\n  },\r\n  north: {\r\n    dir: [0, 0, -1],\r\n    mask1: [1, 0, 1],\r\n    mask2: [0, 1, 1],\r\n    corners: [\r\n      [1, 0, 0, 0, 1],\r\n      [0, 0, 0, 1, 1],\r\n      [1, 1, 0, 0, 0],\r\n      [0, 1, 0, 1, 0]\r\n    ]\r\n  },\r\n  south: {\r\n    dir: [0, 0, 1],\r\n    mask1: [1, 0, 1],\r\n    mask2: [0, 1, 1],\r\n    corners: [\r\n      [0, 0, 1, 0, 1],\r\n      [1, 0, 1, 1, 1],\r\n      [0, 1, 1, 0, 0],\r\n      [1, 1, 1, 1, 0]\r\n    ]\r\n  }\r\n}\r\n","import { BlockType } from '../../../playground/shared'\r\n\r\nexport const defaultMesherConfig = {\r\n  version: '',\r\n  enableLighting: true,\r\n  skyLight: 15,\r\n  smoothLighting: true,\r\n  outputFormat: 'threeJs' as 'threeJs' | 'webgpu',\r\n  textureSize: 1024, // for testing\r\n  debugModelVariant: undefined as undefined | number[],\r\n  clipWorldBelowY: undefined as undefined | number,\r\n  disableSignsMapsSupport: false\r\n}\r\n\r\nexport type CustomBlockModels = {\r\n  [blockPosKey: string]: string // blockPosKey is \"x,y,z\" -> model name\r\n}\r\n\r\nexport type MesherConfig = typeof defaultMesherConfig\r\n\r\nexport type MesherGeometryOutput = {\r\n  sx: number,\r\n  sy: number,\r\n  sz: number,\r\n  // resulting: float32array\r\n  positions: any,\r\n  normals: any,\r\n  colors: any,\r\n  uvs: any,\r\n  t_positions?: number[],\r\n  t_normals?: number[],\r\n  t_colors?: number[],\r\n  t_uvs?: number[],\r\n\r\n  indices: number[],\r\n  tiles: Record<string, BlockType>,\r\n  heads: Record<string, any>,\r\n  signs: Record<string, any>,\r\n  // isFull: boolean\r\n  highestBlocks: Map<string, HighestBlockInfo>\r\n  hadErrors: boolean\r\n  blocksCount: number\r\n  customBlockModels?: CustomBlockModels\r\n}\r\n\r\nexport type HighestBlockInfo = { y: number, stateId: number | undefined, biomeId: number | undefined }\r\n\r\nexport type BlockStateModelInfo = {\r\n  cacheKey: string\r\n  issues: string[]\r\n  modelNames: string[]\r\n  conditions: string[]\r\n}\r\n\r\nexport const getBlockAssetsCacheKey = (stateId: number, modelNameOverride?: string) => {\r\n  return modelNameOverride ? `${stateId}:${modelNameOverride}` : String(stateId)\r\n}\r\n","/* eslint-disable @stylistic/function-call-argument-newline */\r\nimport { Vec3 } from 'vec3'\r\nimport { Block } from 'prismarine-block'\r\nimport { IndexedData } from 'minecraft-data'\r\nimport * as THREE from 'three'\r\nimport { BlockModelPartsResolved } from './world'\r\nimport { BlockElement, buildRotationMatrix, elemFaces, matmul3, matmulmat3, vecadd3, vecsub3 } from './modelsGeometryCommon'\r\n\r\ntype NeighborSide = 'up' | 'down' | 'east' | 'west' | 'north' | 'south'\r\n\r\nfunction tintToGl (tint) {\r\n  const r = (tint >> 16) & 0xff\r\n  const g = (tint >> 8) & 0xff\r\n  const b = tint & 0xff\r\n  return [r / 255, g / 255, b / 255]\r\n}\r\n\r\ntype Neighbors = Partial<Record<NeighborSide, boolean>>\r\nfunction renderElement (element: BlockElement, doAO: boolean, attr, globalMatrix, globalShift, block: Block | undefined, biome: string, neighbors: Neighbors) {\r\n  const cursor = new Vec3(0, 0, 0)\r\n\r\n  // const key = `${position.x},${position.y},${position.z}`\r\n  // if (!globalThis.allowedBlocks.includes(key)) return\r\n  // const cullIfIdentical = block.name.indexOf('glass') >= 0\r\n\r\n  // eslint-disable-next-line guard-for-in\r\n  for (const face in element.faces) {\r\n    const eFace = element.faces[face]\r\n    const { corners, mask1, mask2 } = elemFaces[face]\r\n    const dir = matmul3(globalMatrix, elemFaces[face].dir)\r\n\r\n    if (eFace.cullface) {\r\n      if (neighbors[face]) continue\r\n    }\r\n\r\n    const minx = element.from[0]\r\n    const miny = element.from[1]\r\n    const minz = element.from[2]\r\n    const maxx = element.to[0]\r\n    const maxy = element.to[1]\r\n    const maxz = element.to[2]\r\n\r\n    const texture = eFace.texture as any\r\n    const { u } = texture\r\n    const { v } = texture\r\n    const { su } = texture\r\n    const { sv } = texture\r\n\r\n    const ndx = Math.floor(attr.positions.length / 3)\r\n\r\n    let tint = [1, 1, 1]\r\n    if (eFace.tintindex !== undefined) {\r\n      if (eFace.tintindex === 0) {\r\n        // TODO\r\n        // if (block.name === 'redstone_wire') {\r\n        //   tint = tints.redstone[`${block.getProperties().power}`]\r\n        // } else if (block.name === 'birch_leaves' ||\r\n        //   block.name === 'spruce_leaves' ||\r\n        //   block.name === 'lily_pad') {\r\n        //   tint = tints.constant[block.name]\r\n        // } else if (block.name.includes('leaves') || block.name === 'vine') {\r\n        //   tint = tints.foliage[biome]\r\n        // } else {\r\n        //   tint = tints.grass[biome]\r\n        // }\r\n        const grassTint = [145 / 255, 189 / 255, 89 / 255]\r\n        tint = grassTint\r\n      }\r\n    }\r\n\r\n    // UV rotation\r\n    const r = eFace.rotation || 0\r\n    const uvcs = Math.cos(r * Math.PI / 180)\r\n    const uvsn = -Math.sin(r * Math.PI / 180)\r\n\r\n    let localMatrix = null as any\r\n    let localShift = null as any\r\n\r\n    if (element.rotation) {\r\n      // todo do we support rescale?\r\n      localMatrix = buildRotationMatrix(\r\n        element.rotation.axis,\r\n        element.rotation.angle\r\n      )\r\n\r\n      localShift = vecsub3(\r\n        element.rotation.origin,\r\n        matmul3(\r\n          localMatrix,\r\n          element.rotation.origin\r\n        )\r\n      )\r\n    }\r\n\r\n    const aos: number[] = []\r\n    // const neighborPos = position.plus(new Vec3(...dir))\r\n    // const baseLight = world.getLight(neighborPos, undefined, undefined, block.name) / 15\r\n    const baseLight = 1\r\n    for (const pos of corners) {\r\n      let vertex = [\r\n        (pos[0] ? maxx : minx),\r\n        (pos[1] ? maxy : miny),\r\n        (pos[2] ? maxz : minz)\r\n      ]\r\n\r\n      vertex = vecadd3(matmul3(localMatrix, vertex), localShift)\r\n      vertex = vecadd3(matmul3(globalMatrix, vertex), globalShift)\r\n      vertex = vertex.map(v => v / 16)\r\n\r\n      attr.positions.push(\r\n        vertex[0]/*  + (cursor.x & 15) - 8 */,\r\n        vertex[1]/*  + (cursor.y & 15) x */,\r\n        vertex[2]/*  + (cursor.z & 15) - 8 */\r\n      )\r\n\r\n      attr.normals.push(...dir)\r\n\r\n      const baseu = (pos[3] - 0.5) * uvcs - (pos[4] - 0.5) * uvsn + 0.5\r\n      const basev = (pos[3] - 0.5) * uvsn + (pos[4] - 0.5) * uvcs + 0.5\r\n      attr.uvs.push(baseu * su + u, basev * sv + v)\r\n\r\n      let light = 1\r\n      if (doAO) {\r\n        const cornerLightResult = 15\r\n\r\n        const side1Block = 0\r\n        const side2Block = 0\r\n        const cornerBlock = 0\r\n\r\n        const ao = (side1Block && side2Block) ? 0 : (3 - (side1Block + side2Block + cornerBlock))\r\n        // todo light should go upper on lower blocks\r\n        light = (ao + 1) / 4 * (cornerLightResult / 15)\r\n        aos.push(ao)\r\n      }\r\n\r\n      attr.colors.push(baseLight * tint[0] * light, baseLight * tint[1] * light, baseLight * tint[2] * light)\r\n    }\r\n\r\n    // if (needTiles) {\r\n    //   attr.tiles[`${cursor.x},${cursor.y},${cursor.z}`] ??= {\r\n    //     block: block.name,\r\n    //     faces: [],\r\n    //   }\r\n    //   attr.tiles[`${cursor.x},${cursor.y},${cursor.z}`].faces.push({\r\n    //     face,\r\n    //     neighbor: `${neighborPos.x},${neighborPos.y},${neighborPos.z}`,\r\n    //     light: baseLight\r\n    //     // texture: eFace.texture.name,\r\n    //   })\r\n    // }\r\n\r\n    if (doAO && aos[0] + aos[3] >= aos[1] + aos[2]) {\r\n      attr.indices.push(\r\n\r\n        ndx, ndx + 3, ndx + 2,\r\n        ndx, ndx + 1, ndx + 3\r\n      )\r\n    } else {\r\n      attr.indices.push(\r\n\r\n        ndx, ndx + 1, ndx + 2,\r\n        ndx + 2, ndx + 1, ndx + 3\r\n      )\r\n    }\r\n  }\r\n}\r\n\r\nexport const renderBlockThreeAttr = (models: BlockModelPartsResolved, block: Block | undefined, biome: string, mcData: IndexedData, variants = [], neighbors: Neighbors = {}) => {\r\n  const sx = 0\r\n  const sy = 0\r\n  const sz = 0\r\n\r\n  const attr = {\r\n    sx: sx + 0.5,\r\n    sy: sy + 0.5,\r\n    sz: sz + 0.5,\r\n    positions: [],\r\n    normals: [],\r\n    colors: [],\r\n    uvs: [],\r\n    t_positions: [],\r\n    t_normals: [],\r\n    t_colors: [],\r\n    t_uvs: [],\r\n    indices: [],\r\n    tiles: {},\r\n  } as Record<string, any>\r\n\r\n  for (const [i, modelVars] of models.entries()) {\r\n    const model = modelVars[variants[i]] ?? modelVars[0]\r\n    if (!model) continue\r\n    let globalMatrix = null as any\r\n    let globalShift = null as any\r\n    for (const axis of ['x', 'y', 'z'] as const) {\r\n      if (axis in model) {\r\n        if (globalMatrix) { globalMatrix = matmulmat3(globalMatrix, buildRotationMatrix(axis, -(model[axis] ?? 0))) } else { globalMatrix = buildRotationMatrix(axis, -(model[axis] ?? 0)) }\r\n      }\r\n    }\r\n    if (globalMatrix) {\r\n      globalShift = [8, 8, 8]\r\n      globalShift = vecsub3(globalShift, matmul3(globalMatrix, globalShift))\r\n    }\r\n\r\n    const ao = model.ao ?? true\r\n\r\n    for (const element of model.elements ?? []) {\r\n      renderElement(element, ao, attr, globalMatrix, globalShift, block, biome, neighbors)\r\n    }\r\n  }\r\n\r\n  let ndx = attr.positions.length / 3\r\n  for (let i = 0; i < attr.t_positions.length / 12; i++) {\r\n    attr.indices.push(\r\n      ndx, ndx + 1, ndx + 2, ndx + 2, ndx + 1, ndx + 3,\r\n      // back face\r\n      ndx, ndx + 2, ndx + 1, ndx + 2, ndx + 3, ndx + 1\r\n    )\r\n    ndx += 4\r\n  }\r\n\r\n  attr.positions.push(...attr.t_positions)\r\n  attr.normals.push(...attr.t_normals)\r\n  attr.colors.push(...attr.t_colors)\r\n  attr.uvs.push(...attr.t_uvs)\r\n\r\n  delete attr.t_positions\r\n  delete attr.t_normals\r\n  delete attr.t_colors\r\n  delete attr.t_uvs\r\n\r\n  attr.positions = new Float32Array(attr.positions) as any\r\n  attr.normals = new Float32Array(attr.normals) as any\r\n  attr.colors = new Float32Array(attr.colors) as any\r\n  attr.uvs = new Float32Array(attr.uvs) as any\r\n\r\n  return attr\r\n}\r\n\r\nexport const renderBlockThree = (...args: Parameters<typeof renderBlockThreeAttr>) => {\r\n  const attr = renderBlockThreeAttr(...args)\r\n  const data = {\r\n    geometry: attr\r\n  }\r\n\r\n  const geometry = new THREE.BufferGeometry()\r\n  geometry.setAttribute('position', new THREE.BufferAttribute(data.geometry.positions, 3))\r\n  geometry.setAttribute('normal', new THREE.BufferAttribute(data.geometry.normals, 3))\r\n  geometry.setAttribute('color', new THREE.BufferAttribute(data.geometry.colors, 3))\r\n  geometry.setAttribute('uv', new THREE.BufferAttribute(data.geometry.uvs, 2))\r\n  geometry.setIndex(data.geometry.indices)\r\n  geometry.name = 'block-geometry'\r\n\r\n  return geometry\r\n}\r\n\r\nexport const getThreeBlockModelGroup = (material: THREE.Material, ...args: Parameters<typeof renderBlockThree>) => {\r\n  const geometry = renderBlockThree(...args)\r\n  const mesh = new THREE.Mesh(geometry, material)\r\n  mesh.position.set(-0.5, -0.5, -0.5)\r\n  const group = new THREE.Group()\r\n  group.add(mesh)\r\n  group.rotation.set(0, -THREE.MathUtils.degToRad(90), 0, 'ZYX')\r\n  globalThis.mesh = group\r\n  return group\r\n  // return new THREE.Mesh(new THREE.BoxGeometry(1, 1, 1), new THREE.MeshPhongMaterial({ color: 0x00_00_ff, transparent: true, opacity: 0.5 }))\r\n}\r\n\r\nexport const setBlockPosition = (object: THREE.Object3D, position: { x: number, y: number, z: number }) => {\r\n  object.position.set(position.x + 0.5, position.y + 0.5, position.z + 0.5)\r\n}\r\n","export const INVISIBLE_BLOCKS = new Set(['air', 'void_air', 'cave_air', 'barrier', 'light', 'moving_piston'])\r\n","export async function getBufferFromStream (stream) {\r\n  return new Promise((resolve, reject) => {\r\n    let buffer = Buffer.from([])\r\n    stream.on('data', buf => {\r\n      buffer = Buffer.concat([buffer, buf])\r\n    })\r\n    stream.on('end', () => resolve(buffer))\r\n    stream.on('error', reject)\r\n  })\r\n}\r\n\r\nexport function openURL (url, newTab = true) {\r\n  if (newTab) {\r\n    window.open(url, '_blank', 'noopener,noreferrer')\r\n  } else {\r\n    window.open(url, '_self')\r\n  }\r\n}\r\n\r\nexport const isMobile = () => {\r\n  return window.matchMedia('(pointer: coarse)').matches || navigator.userAgent.includes('Mobile')\r\n}\r\n\r\nexport function chunkPos (pos: { x: number, z: number }) {\r\n  const x = Math.floor(pos.x / 16)\r\n  const z = Math.floor(pos.z / 16)\r\n  return [x, z]\r\n}\r\n\r\nexport function sectionPos (pos: { x: number, y: number, z: number }) {\r\n  const x = Math.floor(pos.x / 16)\r\n  const y = Math.floor(pos.y / 16)\r\n  const z = Math.floor(pos.z / 16)\r\n  return [x, y, z]\r\n}\r\n","import * as tweenJs from '@tweenjs/tween.js'\r\nimport { AnimationController } from './animationController'\r\n\r\nexport type StateProperties = Record<string, number>\r\nexport type StateGetterFn = () => StateProperties\r\nexport type StateSetterFn = (property: string, value: number) => void\r\n\r\n// Speed in units per second for each property type\r\nconst DEFAULT_SPEEDS = {\r\n  x: 3000, // pixels/units per second\r\n  y: 3000,\r\n  z: 3000,\r\n  rotation: Math.PI, // radians per second\r\n  scale: 1, // scale units per second\r\n  default: 3000 // default speed for unknown properties\r\n}\r\n\r\nexport class SmoothSwitcher {\r\n  private readonly animationController = new AnimationController()\r\n  // private readonly currentState: StateProperties = {}\r\n  private readonly defaultState: StateProperties\r\n  private readonly speeds: Record<string, number>\r\n  public currentStateName = ''\r\n  public transitioningToStateName = ''\r\n\r\n  constructor (\r\n    public getState: StateGetterFn,\r\n    public setState: StateSetterFn,\r\n    speeds?: Partial<Record<string, number>>\r\n  ) {\r\n\r\n    // Initialize speeds with defaults and overrides\r\n    this.speeds = { ...DEFAULT_SPEEDS }\r\n    if (speeds) {\r\n      Object.assign(this.speeds, speeds)\r\n    }\r\n\r\n    // Store initial values\r\n    this.defaultState = this.getState()\r\n  }\r\n\r\n  /**\r\n   * Calculate transition duration based on the largest property change\r\n   */\r\n  private calculateDuration (newState: Partial<StateProperties>): number {\r\n    let maxDuration = 0\r\n    const currentState = this.getState()\r\n\r\n    for (const [key, targetValue] of Object.entries(newState)) {\r\n      const currentValue = currentState[key]\r\n      const diff = Math.abs(targetValue! - currentValue)\r\n      const speed = this.getPropertySpeed(key)\r\n      const duration = (diff / speed) * 1000 // Convert to milliseconds\r\n\r\n      maxDuration = Math.max(maxDuration, duration)\r\n    }\r\n\r\n    // Ensure minimum duration of 50ms and maximum of 2000ms\r\n    return Math.min(Math.max(maxDuration, 200), 2000)\r\n  }\r\n\r\n  private getPropertySpeed (property: string): number {\r\n    // Check for specific property speed\r\n    if (property in this.speeds) {\r\n      return this.speeds[property]\r\n    }\r\n\r\n    // Check for property type (rotation, scale, etc.)\r\n    if (property.toLowerCase().includes('rotation')) return this.speeds.rotation\r\n    if (property.toLowerCase().includes('scale')) return this.speeds.scale\r\n    if (property.toLowerCase() === 'x' || property.toLowerCase() === 'y' || property.toLowerCase() === 'z') {\r\n      return this.speeds[property]\r\n    }\r\n\r\n    return this.speeds.default\r\n  }\r\n\r\n  /**\r\n   * Start a transition to a new state\r\n   * @param newState Partial state - only need to specify properties that change\r\n   * @param easing Easing function to use\r\n   */\r\n  startTransition (\r\n    newState: Partial<StateProperties>,\r\n    stateName?: string,\r\n    onEnd?: () => void,\r\n    easing: (amount: number) => number = tweenJs.Easing.Linear.None,\r\n    onCancelled?: () => void\r\n  ): void {\r\n    if (this.isTransitioning) {\r\n      this.animationController.forceFinish(false)\r\n    }\r\n\r\n    this.transitioningToStateName = stateName ?? ''\r\n    const state = this.getState()\r\n\r\n    const duration = this.calculateDuration(newState)\r\n    // console.log('duration', duration, JSON.stringify(state), JSON.stringify(newState))\r\n\r\n    void this.animationController.startAnimation(() => {\r\n      const group = new tweenJs.Group()\r\n      new tweenJs.Tween(state, group)\r\n        .to(newState, duration)\r\n        .easing(easing)\r\n        .onUpdate((obj) => {\r\n          for (const key of Object.keys(obj)) {\r\n            this.setState(key, obj[key])\r\n          }\r\n        })\r\n        .onComplete(() => {\r\n          this.animationController.forceFinish()\r\n          this.currentStateName = this.transitioningToStateName\r\n          this.transitioningToStateName = ''\r\n          onEnd?.()\r\n        })\r\n        .start()\r\n      return group\r\n    }, onCancelled)\r\n  }\r\n\r\n  /**\r\n   * Reset to default state\r\n   */\r\n  reset (): void {\r\n    this.startTransition(this.defaultState)\r\n  }\r\n\r\n\r\n  /**\r\n   * Update the animation (should be called in your render/update loop)\r\n   */\r\n  update (): void {\r\n    this.animationController.update()\r\n  }\r\n\r\n  /**\r\n   * Force finish the current transition\r\n   */\r\n  forceFinish (): void {\r\n    this.animationController.forceFinish()\r\n  }\r\n\r\n  /**\r\n   * Start a new transition to the specified state\r\n   */\r\n  transitionTo (\r\n    newState: Partial<StateProperties>,\r\n    stateName?: string,\r\n    onEnd?: () => void,\r\n    onCancelled?: () => void\r\n  ): void {\r\n    this.startTransition(newState, stateName, onEnd, tweenJs.Easing.Linear.None, onCancelled)\r\n  }\r\n\r\n  /**\r\n   * Get the current value of a property\r\n   */\r\n  getCurrentValue (property: string): number {\r\n    return this.getState()[property]\r\n  }\r\n\r\n  /**\r\n   * Check if currently transitioning\r\n   */\r\n  get isTransitioning (): boolean {\r\n    return this.animationController.isActive\r\n  }\r\n}\r\n","import * as THREE from 'three'\r\n\r\nexport const disposeObject = (obj: THREE.Object3D, cleanTextures = false) => {\r\n  // not cleaning texture there as it might be used by other objects, but would be good to also do that\r\n  if (obj instanceof THREE.Mesh) {\r\n    obj.geometry?.dispose?.()\r\n    obj.material?.dispose?.()\r\n  }\r\n  if (obj.children) {\r\n    // eslint-disable-next-line unicorn/no-array-for-each\r\n    obj.children.forEach(child => disposeObject(child, cleanTextures))\r\n  }\r\n  if (cleanTextures) {\r\n    if (obj instanceof THREE.Mesh) {\r\n      obj.material?.map?.dispose?.()\r\n    }\r\n  }\r\n}\r\n","/* eslint-disable unicorn/prefer-dom-node-text-content */\r\nconst rightOffset = 0\r\n\r\nconst stats = {}\r\n\r\nlet lastY = 40\r\nexport const addNewStat = (id: string, width = 80, x = rightOffset, y = lastY) => {\r\n  const pane = document.createElement('div')\r\n  pane.style.position = 'fixed'\r\n  pane.style.top = `${y}px`\r\n  pane.style.right = `${x}px`\r\n  // gray bg\r\n  pane.style.backgroundColor = 'rgba(0, 0, 0, 0.7)'\r\n  pane.style.color = 'white'\r\n  pane.style.padding = '2px'\r\n  pane.style.fontFamily = 'monospace'\r\n  pane.style.fontSize = '12px'\r\n  pane.style.zIndex = '100'\r\n  pane.style.pointerEvents = 'none'\r\n  document.body.appendChild(pane)\r\n  stats[id] = pane\r\n  if (y === 0) { // otherwise it's a custom position\r\n    // rightOffset += width\r\n    lastY += 20\r\n  }\r\n\r\n  return {\r\n    updateText (text: string) {\r\n      if (pane.innerText === text) return\r\n      pane.innerText = text\r\n    },\r\n    setVisibility (visible: boolean) {\r\n      pane.style.display = visible ? 'block' : 'none'\r\n    }\r\n  }\r\n}\r\n\r\nexport const updateStatText = (id, text) => {\r\n  if (!stats[id]) return\r\n  stats[id].innerText = text\r\n}\r\n\r\nif (typeof customEvents !== 'undefined') {\r\n  customEvents.on('gameLoaded', () => {\r\n    const chunksLoaded = addNewStat('chunks-loaded', 80, 0, 0)\r\n    const chunksTotal = addNewStat('chunks-read', 80, 0, 0)\r\n  })\r\n}\r\n","import * as THREE from 'three'\r\n\r\nlet textureCache: Record<string, THREE.Texture> = {}\r\nlet imagesPromises: Record<string, Promise<THREE.Texture>> = {}\r\n\r\nexport async function loadTexture (texture: string, cb: (texture: THREE.Texture) => void, onLoad?: () => void): Promise<void> {\r\n  const cached = textureCache[texture]\r\n  if (!cached) {\r\n    const { promise, resolve } = Promise.withResolvers<THREE.Texture>()\r\n    textureCache[texture] = new THREE.TextureLoader().load(texture, resolve)\r\n    imagesPromises[texture] = promise\r\n  }\r\n\r\n  cb(textureCache[texture])\r\n  void imagesPromises[texture].then(() => {\r\n    onLoad?.()\r\n  })\r\n}\r\n\r\nexport const clearTextureCache = () => {\r\n  textureCache = {}\r\n  imagesPromises = {}\r\n}\r\n\r\nexport const loadScript = async function (scriptSrc: string): Promise<HTMLScriptElement> {\r\n  const existingScript = document.querySelector<HTMLScriptElement>(`script[src=\"${scriptSrc}\"]`)\r\n  if (existingScript) {\r\n    return existingScript\r\n  }\r\n\r\n  return new Promise((resolve, reject) => {\r\n    const scriptElement = document.createElement('script')\r\n    scriptElement.src = scriptSrc\r\n    scriptElement.async = true\r\n\r\n    scriptElement.addEventListener('load', () => {\r\n      resolve(scriptElement)\r\n    })\r\n\r\n    scriptElement.onerror = (error) => {\r\n      reject(new Error(typeof error === 'string' ? error : (error as any).message))\r\n      scriptElement.remove()\r\n    }\r\n\r\n    document.head.appendChild(scriptElement)\r\n  })\r\n}\r\n","import { subscribeKey } from 'valtio/utils'\r\n\r\n// eslint-disable-next-line max-params\r\nexport function watchProperty<T extends Record<string, any>, K> (asyncGetter: (value: T[keyof T]) => Promise<K>, valtioProxy: T, key: keyof T, readySetter: (res: K) => void, cleanup?: (res: K) => void) {\r\n  let i = 0\r\n  let lastRes: K | undefined\r\n  const request = async () => {\r\n    const req = ++i\r\n    const res = await asyncGetter(valtioProxy[key])\r\n    if (req === i) {\r\n      if (lastRes) {\r\n        cleanup?.(lastRes)\r\n      }\r\n      readySetter(res)\r\n      lastRes = res\r\n    } else {\r\n      // rejected\r\n      cleanup?.(res)\r\n    }\r\n  }\r\n  void request()\r\n  return subscribeKey(valtioProxy, key, request)\r\n}\r\n","import { loadSkinToCanvas } from 'skinview-utils'\r\nimport * as THREE from 'three'\r\nimport stevePng from 'mc-assets/dist/other-textures/latest/entity/player/wide/steve.png'\r\n\r\n// eslint-disable-next-line unicorn/prefer-export-from\r\nexport const stevePngUrl = stevePng\r\nexport const steveTexture = new THREE.TextureLoader().loadAsync(stevePng)\r\n\r\nexport async function loadImageFromUrl (imageUrl: string): Promise<HTMLImageElement> {\r\n  const img = new Image()\r\n  img.src = imageUrl\r\n  await new Promise<void>(resolve => {\r\n    img.onload = () => resolve()\r\n  })\r\n  return img\r\n}\r\n\r\nexport function getLookupUrl (username: string, type: 'skin' | 'cape'): string {\r\n  return `https://mulv.tycrek.dev/api/lookup?username=${username}&type=${type}`\r\n}\r\n\r\nexport async function loadSkinImage (skinUrl: string): Promise<{ canvas: HTMLCanvasElement, image: HTMLImageElement }> {\r\n  const image = await loadImageFromUrl(skinUrl)\r\n  const skinCanvas = document.createElement('canvas')\r\n  loadSkinToCanvas(skinCanvas, image)\r\n  return { canvas: skinCanvas, image }\r\n}\r\n","import EventEmitter from 'events'\r\nimport * as THREE from 'three'\r\nimport { Vec3 } from 'vec3'\r\nimport { generateSpiralMatrix } from 'flying-squid/dist/utils'\r\nimport worldBlockProvider from 'mc-assets/dist/worldBlockProvider'\r\nimport { Entities } from './entities'\r\nimport { Primitives } from './primitives'\r\nimport { WorldRendererThree } from './worldrendererThree'\r\nimport { WorldRendererCommon, WorldRendererConfig, defaultWorldRendererConfig } from './worldrendererCommon'\r\nimport { getThreeBlockModelGroup, renderBlockThree, setBlockPosition } from './mesher/standaloneRenderer'\r\nimport { addNewStat } from './ui/newStats'\r\nimport { getMyHand } from './hand'\r\nimport { IPlayerState, BasePlayerState } from './basePlayerState'\r\nimport { CameraBobbing } from './cameraBobbing'\r\n\r\nexport class Viewer {\r\n  scene: THREE.Scene\r\n  ambientLight: THREE.AmbientLight\r\n  directionalLight: THREE.DirectionalLight\r\n  world: WorldRendererCommon\r\n  entities: Entities\r\n  // primitives: Primitives\r\n  domElement: HTMLCanvasElement\r\n  playerHeight = 1.62\r\n  threeJsWorld: WorldRendererThree\r\n  cameraObjectOverride?: THREE.Object3D // for xr\r\n  audioListener: THREE.AudioListener\r\n  renderingUntilNoUpdates = false\r\n  processEntityOverrides = (e, overrides) => overrides\r\n  private readonly cameraBobbing: CameraBobbing\r\n\r\n  get camera () {\r\n    return this.world.camera\r\n  }\r\n\r\n  set camera (camera) {\r\n    this.world.camera = camera\r\n  }\r\n\r\n  constructor (public renderer: THREE.WebGLRenderer, worldConfig = defaultWorldRendererConfig, public playerState: IPlayerState = new BasePlayerState()) {\r\n    // https://discourse.threejs.org/t/updates-to-color-management-in-three-js-r152/50791\r\n    THREE.ColorManagement.enabled = false\r\n    renderer.outputColorSpace = THREE.LinearSRGBColorSpace\r\n\r\n    this.scene = new THREE.Scene()\r\n    this.scene.matrixAutoUpdate = false // for perf\r\n    this.threeJsWorld = new WorldRendererThree(this.scene, this.renderer, worldConfig, this.playerState)\r\n    this.setWorld()\r\n    this.resetScene()\r\n    this.entities = new Entities(this)\r\n    // this.primitives = new Primitives(this.scene, this.camera)\r\n    this.cameraBobbing = new CameraBobbing()\r\n\r\n    this.domElement = renderer.domElement\r\n  }\r\n\r\n  setWorld () {\r\n    this.world = this.threeJsWorld\r\n  }\r\n\r\n  resetScene () {\r\n    this.scene.background = new THREE.Color('lightblue')\r\n\r\n    if (this.ambientLight) this.scene.remove(this.ambientLight)\r\n    this.ambientLight = new THREE.AmbientLight(0xcc_cc_cc)\r\n    this.scene.add(this.ambientLight)\r\n\r\n    if (this.directionalLight) this.scene.remove(this.directionalLight)\r\n    this.directionalLight = new THREE.DirectionalLight(0xff_ff_ff, 0.5)\r\n    this.directionalLight.position.set(1, 1, 0.5).normalize()\r\n    this.directionalLight.castShadow = true\r\n    this.scene.add(this.directionalLight)\r\n\r\n    const size = this.renderer.getSize(new THREE.Vector2())\r\n    this.camera = new THREE.PerspectiveCamera(75, size.x / size.y, 0.1, 1000)\r\n  }\r\n\r\n  resetAll () {\r\n    this.resetScene()\r\n    this.world.resetWorld()\r\n    this.entities.clear()\r\n    // this.primitives.clear()\r\n  }\r\n\r\n  setVersion (userVersion: string, texturesVersion = userVersion): void | Promise<void> {\r\n    console.log('[viewer] Using version:', userVersion, 'textures:', texturesVersion)\r\n    this.entities.clear()\r\n    // this.primitives.clear()\r\n    return this.world.setVersion(userVersion, texturesVersion)\r\n  }\r\n\r\n  addColumn (x, z, chunk, isLightUpdate = false) {\r\n    this.world.addColumn(x, z, chunk, isLightUpdate)\r\n  }\r\n\r\n  removeColumn (x: string, z: string) {\r\n    this.world.removeColumn(x, z)\r\n  }\r\n\r\n  setBlockStateId (pos: Vec3, stateId: number) {\r\n    const set = async () => {\r\n      const sectionX = Math.floor(pos.x / 16) * 16\r\n      const sectionZ = Math.floor(pos.z / 16) * 16\r\n      if (this.world.queuedChunks.has(`${sectionX},${sectionZ}`)) {\r\n        await new Promise<void>(resolve => {\r\n          this.world.queuedFunctions.push(() => {\r\n            resolve()\r\n          })\r\n        })\r\n      }\r\n      if (!this.world.loadedChunks[`${sectionX},${sectionZ}`]) {\r\n        // console.debug('[should be unreachable] setBlockStateId called for unloaded chunk', pos)\r\n      }\r\n      this.world.setBlockStateId(pos, stateId)\r\n    }\r\n    void set()\r\n  }\r\n\r\n  async demoModel () {\r\n    //@ts-expect-error\r\n    const pos = cursorBlockRel(0, 1, 0).position\r\n\r\n    const mesh = await getMyHand()\r\n    // mesh.rotation.y = THREE.MathUtils.degToRad(90)\r\n    setBlockPosition(mesh, pos)\r\n    const helper = new THREE.BoxHelper(mesh, 0xff_ff_00)\r\n    mesh.add(helper)\r\n    this.scene.add(mesh)\r\n  }\r\n\r\n  demoItem () {\r\n    //@ts-expect-error\r\n    const pos = cursorBlockRel(0, 1, 0).position\r\n    const { mesh } = this.entities.getItemMesh({\r\n      itemId: 541,\r\n    }, {})!\r\n    mesh.position.set(pos.x + 0.5, pos.y + 0.5, pos.z + 0.5)\r\n    // mesh.scale.set(0.5, 0.5, 0.5)\r\n    const helper = new THREE.BoxHelper(mesh, 0xff_ff_00)\r\n    mesh.add(helper)\r\n    this.scene.add(mesh)\r\n  }\r\n\r\n  updateEntity (e) {\r\n    this.entities.update(e, this.processEntityOverrides(e, {\r\n      rotation: {\r\n        head: {\r\n          x: e.headPitch ?? e.pitch,\r\n          y: e.headYaw,\r\n          z: 0\r\n        }\r\n      }\r\n    }))\r\n  }\r\n\r\n  setFirstPersonCamera (pos: Vec3 | null, yaw: number, pitch: number) {\r\n    const cam = this.cameraObjectOverride || this.camera\r\n    const yOffset = this.playerState.getEyeHeight()\r\n    // if (this.playerState.isSneaking()) yOffset -= 0.3\r\n\r\n    this.world.camera = cam as THREE.PerspectiveCamera\r\n    this.world.updateCamera(pos?.offset(0, yOffset, 0) ?? null, yaw, pitch)\r\n\r\n    // // Update camera bobbing based on movement state\r\n    // const velocity = this.playerState.getVelocity()\r\n    // const movementState = this.playerState.getMovementState()\r\n    // const isMoving = movementState === 'SPRINTING' || movementState === 'WALKING'\r\n    // const speed = Math.hypot(velocity.x, velocity.z)\r\n\r\n    // // Update bobbing state\r\n    // this.cameraBobbing.updateWalkDistance(speed)\r\n    // this.cameraBobbing.updateBobAmount(isMoving)\r\n\r\n    // // Get bobbing offsets\r\n    // const bobbing = isMoving ? this.cameraBobbing.getBobbing() : { position: { x: 0, y: 0 }, rotation: { x: 0, z: 0 } }\r\n\r\n    // // Apply camera position with bobbing\r\n    // const finalPos = pos ? pos.offset(bobbing.position.x, yOffset + bobbing.position.y, 0) : null\r\n    // this.world.updateCamera(finalPos, yaw + bobbing.rotation.x, pitch)\r\n\r\n    // // Apply roll rotation separately since updateCamera doesn't handle it\r\n    // this.camera.rotation.z = bobbing.rotation.z\r\n  }\r\n\r\n  playSound (position: Vec3, path: string, volume = 1, pitch = 1) {\r\n    if (!this.audioListener) {\r\n      this.audioListener = new THREE.AudioListener()\r\n      this.camera.add(this.audioListener)\r\n    }\r\n\r\n    const sound = new THREE.PositionalAudio(this.audioListener)\r\n\r\n    const audioLoader = new THREE.AudioLoader()\r\n    const start = Date.now()\r\n    void audioLoader.loadAsync(path).then((buffer) => {\r\n      if (Date.now() - start > 500) return\r\n      // play\r\n      sound.setBuffer(buffer)\r\n      sound.setRefDistance(20)\r\n      sound.setVolume(volume)\r\n      sound.setPlaybackRate(pitch) // set the pitch\r\n      this.scene.add(sound)\r\n      // set sound position\r\n      sound.position.set(position.x, position.y, position.z)\r\n      sound.onEnded = () => {\r\n        this.scene.remove(sound)\r\n        sound.disconnect()\r\n        audioLoader.manager.itemEnd(path)\r\n      }\r\n      sound.play()\r\n    })\r\n  }\r\n\r\n  addChunksBatchWaitTime = 200\r\n\r\n  connect (worldEmitter: EventEmitter) {\r\n    worldEmitter.on('entity', (e) => {\r\n      this.updateEntity(e)\r\n    })\r\n\r\n    worldEmitter.on('primitive', (p) => {\r\n      // this.updatePrimitive(p)\r\n    })\r\n\r\n    let currentLoadChunkBatch = null as {\r\n      timeout\r\n      data\r\n    } | null\r\n    worldEmitter.on('loadChunk', ({ x, z, chunk, worldConfig, isLightUpdate }) => {\r\n      this.world.worldConfig = worldConfig\r\n      this.world.queuedChunks.add(`${x},${z}`)\r\n      const args = [x, z, chunk, isLightUpdate]\r\n      if (!currentLoadChunkBatch) {\r\n        // add a setting to use debounce instead\r\n        currentLoadChunkBatch = {\r\n          data: [],\r\n          timeout: setTimeout(() => {\r\n            for (const args of currentLoadChunkBatch!.data) {\r\n              this.world.queuedChunks.delete(`${args[0]},${args[1]}`)\r\n              this.addColumn(...args as Parameters<typeof this.addColumn>)\r\n            }\r\n            for (const fn of this.world.queuedFunctions) {\r\n              fn()\r\n            }\r\n            this.world.queuedFunctions = []\r\n            currentLoadChunkBatch = null\r\n          }, this.addChunksBatchWaitTime)\r\n        }\r\n      }\r\n      currentLoadChunkBatch.data.push(args)\r\n    })\r\n    // todo remove and use other architecture instead so data flow is clear\r\n    worldEmitter.on('blockEntities', (blockEntities) => {\r\n      if (this.world instanceof WorldRendererThree) (this.world).blockEntities = blockEntities\r\n    })\r\n\r\n    worldEmitter.on('unloadChunk', ({ x, z }) => {\r\n      this.removeColumn(x, z)\r\n    })\r\n\r\n    worldEmitter.on('blockUpdate', ({ pos, stateId }) => {\r\n      this.setBlockStateId(new Vec3(pos.x, pos.y, pos.z), stateId)\r\n    })\r\n\r\n    worldEmitter.on('chunkPosUpdate', ({ pos }) => {\r\n      this.world.updateViewerPosition(pos)\r\n    })\r\n\r\n\r\n    worldEmitter.on('renderDistance', (d) => {\r\n      this.world.viewDistance = d\r\n      this.world.chunksLength = d === 0 ? 1 : generateSpiralMatrix(d).length\r\n    })\r\n\r\n    worldEmitter.on('renderDistance', (d) => {\r\n      this.world.viewDistance = d\r\n      this.world.chunksLength = d === 0 ? 1 : generateSpiralMatrix(d).length\r\n      this.world.allChunksFinished = Object.keys(this.world.finishedChunks).length === this.world.chunksLength\r\n    })\r\n\r\n    worldEmitter.on('markAsLoaded', ({ x, z }) => {\r\n      this.world.markAsLoaded(x, z)\r\n    })\r\n\r\n    worldEmitter.on('updateLight', ({ pos }) => {\r\n      if (this.world instanceof WorldRendererThree) (this.world).updateLight(pos.x, pos.z)\r\n    })\r\n\r\n    worldEmitter.on('time', (timeOfDay) => {\r\n      this.world.timeUpdated?.(timeOfDay)\r\n\r\n      let skyLight = 15\r\n      if (timeOfDay < 0 || timeOfDay > 24_000) {\r\n        throw new Error('Invalid time of day. It should be between 0 and 24000.')\r\n      } else if (timeOfDay <= 6000 || timeOfDay >= 18_000) {\r\n        skyLight = 15\r\n      } else if (timeOfDay > 6000 && timeOfDay < 12_000) {\r\n        skyLight = 15 - ((timeOfDay - 6000) / 6000) * 15\r\n      } else if (timeOfDay >= 12_000 && timeOfDay < 18_000) {\r\n        skyLight = ((timeOfDay - 12_000) / 6000) * 15\r\n      }\r\n\r\n      skyLight = Math.floor(skyLight) // todo: remove this after optimization\r\n\r\n      if (this.world.mesherConfig.skyLight === skyLight) return\r\n      this.world.mesherConfig.skyLight = skyLight\r\n      if (this.world instanceof WorldRendererThree) {\r\n        (this.world).rerenderAllChunks?.()\r\n      }\r\n    })\r\n\r\n    worldEmitter.emit('listening')\r\n  }\r\n\r\n  render () {\r\n    if (this.world instanceof WorldRendererThree) {\r\n      (this.world).render()\r\n      this.entities.render()\r\n    }\r\n  }\r\n\r\n  async waitForChunksToRender () {\r\n    await this.world.waitForChunksToRender()\r\n  }\r\n}\r\n","import * as THREE from 'three'\r\nimport { statsEnd, statsStart } from '../../../src/topRightStats'\r\nimport { activeModalStack } from '../../../src/globalState'\r\n\r\n// wrapper for now\r\nexport class ViewerWrapper {\r\n  previousWindowWidth: number\r\n  previousWindowHeight: number\r\n  globalObject = globalThis as any\r\n  stopRenderOnBlur = false\r\n  addedToPage = false\r\n  renderInterval = 0\r\n  renderIntervalUnfocused: number | undefined\r\n  fpsInterval\r\n\r\n  constructor (public canvas: HTMLCanvasElement, public renderer?: THREE.WebGLRenderer) {\r\n    if (this.renderer) this.globalObject.renderer = this.renderer\r\n  }\r\n\r\n  addToPage (startRendering = true) {\r\n    if (this.addedToPage) throw new Error('Already added to page')\r\n    let pixelRatio = window.devicePixelRatio || 1 // todo this value is too high on ios, need to check, probably we should use avg, also need to make it configurable\r\n    if (this.renderer) {\r\n      if (!this.renderer.capabilities.isWebGL2) pixelRatio = 1 // webgl1 has issues with high pixel ratio (sometimes screen is clipped)\r\n      this.renderer.setPixelRatio(pixelRatio)\r\n      this.renderer.setSize(window.innerWidth, window.innerHeight)\r\n    } else {\r\n      this.canvas.width = window.innerWidth * pixelRatio\r\n      this.canvas.height = window.innerHeight * pixelRatio\r\n    }\r\n    this.previousWindowWidth = window.innerWidth\r\n    this.previousWindowHeight = window.innerHeight\r\n\r\n    this.canvas.id = 'viewer-canvas'\r\n    document.body.appendChild(this.canvas)\r\n\r\n    this.addedToPage = true\r\n\r\n    let max = 0\r\n    this.fpsInterval = setInterval(() => {\r\n      if (max > 0) {\r\n        viewer.world.droppedFpsPercentage = this.renderedFps / max\r\n      }\r\n      max = Math.max(this.renderedFps, max)\r\n      this.renderedFps = 0\r\n    }, 1000)\r\n    if (startRendering) {\r\n      this.globalObject.requestAnimationFrame(this.render.bind(this))\r\n    }\r\n    if (typeof window !== 'undefined') {\r\n      this.trackWindowFocus()\r\n    }\r\n  }\r\n\r\n  windowFocused = true\r\n  trackWindowFocus () {\r\n    window.addEventListener('focus', () => {\r\n      this.windowFocused = true\r\n    })\r\n    window.addEventListener('blur', () => {\r\n      this.windowFocused = false\r\n    })\r\n  }\r\n\r\n  dispose () {\r\n    if (!this.addedToPage) throw new Error('Not added to page')\r\n    this.canvas.remove()\r\n    this.renderer?.dispose()\r\n    // this.addedToPage = false\r\n    clearInterval(this.fpsInterval)\r\n  }\r\n\r\n\r\n  renderedFps = 0\r\n  lastTime = performance.now()\r\n  delta = 0\r\n  preRender = () => { }\r\n  postRender = () => { }\r\n  render (time: DOMHighResTimeStamp) {\r\n    if (this.globalObject.stopLoop) return\r\n    this.globalObject.requestAnimationFrame(this.render.bind(this))\r\n    if (activeModalStack.some(m => m.reactType === 'app-status')) return\r\n    if (!viewer || this.globalObject.stopRender || this.renderer?.xr.isPresenting || (this.stopRenderOnBlur && !this.windowFocused)) return\r\n    const renderInterval = (this.windowFocused ? this.renderInterval : this.renderIntervalUnfocused) ?? this.renderInterval\r\n    if (renderInterval) {\r\n      this.delta += time - this.lastTime\r\n      this.lastTime = time\r\n      if (this.delta > renderInterval) {\r\n        this.delta %= renderInterval\r\n        // continue rendering\r\n      } else {\r\n        return\r\n      }\r\n    }\r\n    for (const fn of beforeRenderFrame) fn()\r\n    this.preRender()\r\n    statsStart()\r\n    // ios bug: viewport dimensions are updated after the resize event\r\n    if (this.previousWindowWidth !== window.innerWidth || this.previousWindowHeight !== window.innerHeight) {\r\n      this.resizeHandler()\r\n      this.previousWindowWidth = window.innerWidth\r\n      this.previousWindowHeight = window.innerHeight\r\n    }\r\n    viewer.render()\r\n    this.renderedFps++\r\n    statsEnd()\r\n    this.postRender()\r\n  }\r\n\r\n  resizeHandler () {\r\n    const width = window.innerWidth\r\n    const height = window.innerHeight\r\n\r\n    viewer.camera.aspect = width / height\r\n    viewer.camera.updateProjectionMatrix()\r\n\r\n    if (this.renderer) {\r\n      this.renderer.setSize(width, height)\r\n    }\r\n    viewer.world.handleResize()\r\n  }\r\n}\r\n","/* eslint-disable guard-for-in */\r\n\r\n// todo refactor into its own commons module\r\nimport { EventEmitter } from 'events'\r\nimport { generateSpiralMatrix, ViewRect } from 'flying-squid/dist/utils'\r\nimport { Vec3 } from 'vec3'\r\nimport { BotEvents } from 'mineflayer'\r\nimport { getItemFromBlock } from '../../../src/chatUtils'\r\nimport { delayedIterator } from '../../playground/shared'\r\nimport { playerState } from '../../../src/mineflayer/playerState'\r\nimport { chunkPos } from './simpleUtils'\r\n\r\nexport type ChunkPosKey = string\r\ntype ChunkPos = { x: number, z: number }\r\n\r\n/**\r\n * Usually connects to mineflayer bot and emits world data (chunks, entities)\r\n * It's up to the consumer to serialize the data if needed\r\n */\r\nexport class WorldDataEmitter extends EventEmitter {\r\n  private loadedChunks: Record<ChunkPosKey, boolean>\r\n  private readonly lastPos: Vec3\r\n  private eventListeners: Record<string, any> = {}\r\n  private readonly emitter: WorldDataEmitter\r\n  keepChunksDistance = 0\r\n  addWaitTime = 1\r\n  isPlayground = false\r\n\r\n  constructor (public world: typeof __type_bot['world'], public viewDistance: number, position: Vec3 = new Vec3(0, 0, 0)) {\r\n    super()\r\n    this.loadedChunks = {}\r\n    this.lastPos = new Vec3(0, 0, 0).update(position)\r\n    // todo\r\n    this.emitter = this\r\n\r\n    this.emitter.on('mouseClick', async (click) => {\r\n      const ori = new Vec3(click.origin.x, click.origin.y, click.origin.z)\r\n      const dir = new Vec3(click.direction.x, click.direction.y, click.direction.z)\r\n      const block = this.world.raycast(ori, dir, 256)\r\n      if (!block) return\r\n      this.emit('blockClicked', block, block.face, click.button)\r\n    })\r\n  }\r\n\r\n  setBlockStateId (position: Vec3, stateId: number) {\r\n    const val = this.world.setBlockStateId(position, stateId) as Promise<void> | void\r\n    if (val) throw new Error('setBlockStateId returned promise (not supported)')\r\n    const chunkX = Math.floor(position.x / 16)\r\n    const chunkZ = Math.floor(position.z / 16)\r\n    if (!this.loadedChunks[`${chunkX},${chunkZ}`]) {\r\n      void this.loadChunk({ x: chunkX, z: chunkZ })\r\n      return\r\n    }\r\n\r\n    this.emit('blockUpdate', { pos: position, stateId })\r\n  }\r\n\r\n  updateViewDistance (viewDistance: number) {\r\n    this.viewDistance = viewDistance\r\n    this.emitter.emit('renderDistance', viewDistance)\r\n  }\r\n\r\n  listenToBot (bot: typeof __type_bot) {\r\n    const emitEntity = (e) => {\r\n      if (!e || e === bot.entity) return\r\n      this.emitter.emit('entity', {\r\n        ...e,\r\n        pos: e.position,\r\n        username: e.username,\r\n        // set debugTree (obj) {\r\n        //   e.debugTree = obj\r\n        // }\r\n      })\r\n    }\r\n\r\n    this.eventListeners = {\r\n      // 'move': botPosition,\r\n      entitySpawn (e: any) {\r\n        if (e.name === 'item_frame' || e.name === 'glow_item_frame') {\r\n          // Item frames use block positions in the protocol, not their center. Fix that.\r\n          e.position.translate(0.5, 0.5, 0.5)\r\n        }\r\n        emitEntity(e)\r\n      },\r\n      entityUpdate (e: any) {\r\n        emitEntity(e)\r\n      },\r\n      entityMoved (e: any) {\r\n        emitEntity(e)\r\n      },\r\n      entityGone: (e: any) => {\r\n        this.emitter.emit('entity', { id: e.id, delete: true })\r\n      },\r\n      chunkColumnLoad: (pos: Vec3) => {\r\n        void this.loadChunk(pos)\r\n      },\r\n      chunkColumnUnload: (pos: Vec3) => {\r\n        this.unloadChunk(pos)\r\n      },\r\n      blockUpdate: (oldBlock: any, newBlock: any) => {\r\n        const stateId = newBlock.stateId ?? ((newBlock.type << 4) | newBlock.metadata)\r\n        this.emitter.emit('blockUpdate', { pos: oldBlock.position, stateId })\r\n      },\r\n      time: () => {\r\n        this.emitter.emit('time', bot.time.timeOfDay)\r\n      }\r\n    } satisfies Partial<BotEvents>\r\n\r\n\r\n    bot._client.on('update_light', ({ chunkX, chunkZ }) => {\r\n      const chunkPos = new Vec3(chunkX * 16, 0, chunkZ * 16)\r\n      void this.loadChunk(chunkPos, true)\r\n    })\r\n\r\n    this.emitter.on('listening', () => {\r\n      this.emitter.emit('blockEntities', new Proxy({}, {\r\n        get (_target, posKey, receiver) {\r\n          if (typeof posKey !== 'string') return\r\n          const [x, y, z] = posKey.split(',').map(Number)\r\n          return bot.world.getBlock(new Vec3(x, y, z))?.entity\r\n        },\r\n      }))\r\n      this.emitter.emit('renderDistance', this.viewDistance)\r\n      this.emitter.emit('time', bot.time.timeOfDay)\r\n    })\r\n    // node.js stream data event pattern\r\n    if (this.emitter.listenerCount('blockEntities')) {\r\n      this.emitter.emit('listening')\r\n    }\r\n\r\n    for (const [evt, listener] of Object.entries(this.eventListeners)) {\r\n      bot.on(evt as any, listener)\r\n    }\r\n\r\n    for (const id in bot.entities) {\r\n      const e = bot.entities[id]\r\n      emitEntity(e)\r\n    }\r\n  }\r\n\r\n  removeListenersFromBot (bot: import('mineflayer').Bot) {\r\n    for (const [evt, listener] of Object.entries(this.eventListeners)) {\r\n      bot.removeListener(evt as any, listener)\r\n    }\r\n  }\r\n\r\n  async init (pos: Vec3) {\r\n    this.updateViewDistance(this.viewDistance)\r\n    this.emitter.emit('chunkPosUpdate', { pos })\r\n    const [botX, botZ] = chunkPos(pos)\r\n\r\n    const positions = generateSpiralMatrix(this.viewDistance).map(([x, z]) => new Vec3((botX + x) * 16, 0, (botZ + z) * 16))\r\n\r\n    this.lastPos.update(pos)\r\n    await this._loadChunks(positions)\r\n  }\r\n\r\n  async _loadChunks (positions: Vec3[], sliceSize = 5) {\r\n    const promises = [] as Array<Promise<void>>\r\n    await delayedIterator(positions, this.addWaitTime, (pos) => {\r\n      promises.push(this.loadChunk(pos))\r\n    })\r\n    await Promise.all(promises)\r\n  }\r\n\r\n  readdDebug () {\r\n    const clonedLoadedChunks = { ...this.loadedChunks }\r\n    this.unloadAllChunks()\r\n    for (const loadedChunk in clonedLoadedChunks) {\r\n      const [x, z] = loadedChunk.split(',').map(Number)\r\n      void this.loadChunk(new Vec3(x, 0, z))\r\n    }\r\n  }\r\n\r\n  // debugGotChunkLatency = [] as number[]\r\n  // lastTime = 0\r\n\r\n  async loadChunk (pos: ChunkPos, isLightUpdate = false) {\r\n    const [botX, botZ] = chunkPos(this.lastPos)\r\n    const dx = Math.abs(botX - Math.floor(pos.x / 16))\r\n    const dz = Math.abs(botZ - Math.floor(pos.z / 16))\r\n    if (dx <= this.viewDistance && dz <= this.viewDistance) {\r\n      // eslint-disable-next-line @typescript-eslint/await-thenable -- todo allow to use async world provider but not sure if needed\r\n      const column = await this.world.getColumnAt(pos['y'] ? pos as Vec3 : new Vec3(pos.x, 0, pos.z))\r\n      if (column) {\r\n        // const latency = Math.floor(performance.now() - this.lastTime)\r\n        // this.debugGotChunkLatency.push(latency)\r\n        // this.lastTime = performance.now()\r\n        // todo optimize toJson data, make it clear why it is used\r\n        const chunk = column.toJson()\r\n        // TODO: blockEntities\r\n        const worldConfig = {\r\n          minY: column['minY'] ?? 0,\r\n          worldHeight: column['worldHeight'] ?? 256,\r\n        }\r\n        //@ts-expect-error\r\n        this.emitter.emit('loadChunk', { x: pos.x, z: pos.z, chunk, blockEntities: column.blockEntities, worldConfig, isLightUpdate })\r\n        this.loadedChunks[`${pos.x},${pos.z}`] = true\r\n      } else if (this.isPlayground) { // don't allow in real worlds pre-flag chunks as loaded to avoid race condition when the chunk might still be loading. In playground it's assumed we always pre-load all chunks first\r\n        this.emitter.emit('markAsLoaded', { x: pos.x, z: pos.z })\r\n      }\r\n    } else {\r\n      // console.debug('skipped loading chunk', dx, dz, '>', this.viewDistance)\r\n    }\r\n  }\r\n\r\n  unloadAllChunks () {\r\n    for (const coords of Object.keys(this.loadedChunks)) {\r\n      const [x, z] = coords.split(',').map(Number)\r\n      this.unloadChunk({ x, z })\r\n    }\r\n  }\r\n\r\n  unloadChunk (pos: ChunkPos) {\r\n    this.emitter.emit('unloadChunk', { x: pos.x, z: pos.z })\r\n    delete this.loadedChunks[`${pos.x},${pos.z}`]\r\n  }\r\n\r\n  async updatePosition (pos: Vec3, force = false) {\r\n    const [lastX, lastZ] = chunkPos(this.lastPos)\r\n    const [botX, botZ] = chunkPos(pos)\r\n    if (lastX !== botX || lastZ !== botZ || force) {\r\n      this.emitter.emit('chunkPosUpdate', { pos })\r\n      const newViewToUnload = new ViewRect(botX, botZ, this.viewDistance + this.keepChunksDistance)\r\n      const chunksToUnload: Vec3[] = []\r\n      for (const coords of Object.keys(this.loadedChunks)) {\r\n        const x = parseInt(coords.split(',')[0], 10)\r\n        const z = parseInt(coords.split(',')[1], 10)\r\n        const p = new Vec3(x, 0, z)\r\n        const [chunkX, chunkZ] = chunkPos(p)\r\n        if (!newViewToUnload.contains(chunkX, chunkZ)) {\r\n          chunksToUnload.push(p)\r\n        }\r\n      }\r\n      console.log('unloading', chunksToUnload.length, 'total now', Object.keys(this.loadedChunks).length)\r\n      for (const p of chunksToUnload) {\r\n        this.unloadChunk(p)\r\n      }\r\n      const positions = generateSpiralMatrix(this.viewDistance).map(([x, z]) => {\r\n        const pos = new Vec3((botX + x) * 16, 0, (botZ + z) * 16)\r\n        if (!this.loadedChunks[`${pos.x},${pos.z}`]) return pos\r\n        return undefined!\r\n      }).filter(a => !!a)\r\n      this.lastPos.update(pos)\r\n      void this._loadChunks(positions)\r\n    } else {\r\n      this.emitter.emit('chunkPosUpdate', { pos }) // todo-low\r\n      this.lastPos.update(pos)\r\n    }\r\n  }\r\n}\r\n","/* eslint-disable guard-for-in */\r\nimport { EventEmitter } from 'events'\r\nimport { Vec3 } from 'vec3'\r\nimport * as THREE from 'three'\r\nimport mcDataRaw from 'minecraft-data/data.js' // note: using alias\r\nimport blocksAtlases from 'mc-assets/dist/blocksAtlases.json'\r\nimport blocksAtlasLatest from 'mc-assets/dist/blocksAtlasLatest.png'\r\nimport blocksAtlasLegacy from 'mc-assets/dist/blocksAtlasLegacy.png'\r\nimport itemsAtlases from 'mc-assets/dist/itemsAtlases.json'\r\nimport itemsAtlasLatest from 'mc-assets/dist/itemsAtlasLatest.png'\r\nimport itemsAtlasLegacy from 'mc-assets/dist/itemsAtlasLegacy.png'\r\nimport { AtlasParser, getLoadedItemDefinitionsStore } from 'mc-assets'\r\nimport TypedEmitter from 'typed-emitter'\r\nimport { LineMaterial } from 'three-stdlib'\r\nimport christmasPack from 'mc-assets/dist/textureReplacements/christmas'\r\nimport { ItemsRenderer } from 'mc-assets/dist/itemsRenderer'\r\nimport itemDefinitionsJson from 'mc-assets/dist/itemDefinitions.json'\r\nimport worldBlockProvider, { WorldBlockProvider } from 'mc-assets/dist/worldBlockProvider'\r\nimport { dynamicMcDataFiles } from '../../buildMesherConfig.mjs'\r\nimport { toMajorVersion } from '../../../src/utils'\r\nimport { buildCleanupDecorator } from './cleanupDecorator'\r\nimport { defaultMesherConfig, HighestBlockInfo, MesherGeometryOutput, CustomBlockModels, BlockStateModelInfo } from './mesher/shared'\r\nimport { chunkPos } from './simpleUtils'\r\nimport { HandItemBlock } from './holdingBlock'\r\nimport { updateStatText } from './ui/newStats'\r\nimport { WorldRendererThree } from './worldrendererThree'\r\nimport { generateGuiAtlas } from './guiRenderer'\r\n\r\nfunction mod (x, n) {\r\n  return ((x % n) + n) % n\r\n}\r\n\r\nexport const worldCleanup = buildCleanupDecorator('resetWorld')\r\n\r\nexport const defaultWorldRendererConfig = {\r\n  showChunkBorders: false,\r\n  numWorkers: 4,\r\n  isPlayground: false,\r\n  renderEars: true,\r\n  // game renderer setting actually\r\n  showHand: false,\r\n  viewBobbing: false\r\n}\r\n\r\nexport type WorldRendererConfig = typeof defaultWorldRendererConfig\r\n\r\ntype CustomTexturesData = {\r\n  tileSize: number | undefined\r\n  textures: Record<string, HTMLImageElement>\r\n}\r\n\r\nexport abstract class WorldRendererCommon<WorkerSend = any, WorkerReceive = any> {\r\n  // todo\r\n  @worldCleanup()\r\n  threejsCursorLineMaterial: LineMaterial\r\n  @worldCleanup()\r\n  cursorBlock = null as Vec3 | null\r\n  displayStats = true\r\n  @worldCleanup()\r\n  worldConfig = { minY: 0, worldHeight: 256 }\r\n  // todo need to cleanup\r\n  material = new THREE.MeshLambertMaterial({ vertexColors: true, transparent: true, alphaTest: 0.1 })\r\n  cameraRoll = 0\r\n\r\n  @worldCleanup()\r\n  active = false\r\n\r\n  version = undefined as string | undefined\r\n  // #region CHUNK & SECTIONS TRACKING\r\n  @worldCleanup()\r\n  loadedChunks = {} as Record<string, boolean> // data is added for these chunks and they might be still processing\r\n\r\n  @worldCleanup()\r\n  finishedChunks = {} as Record<string, boolean> // these chunks are fully loaded into the world (scene)\r\n\r\n  @worldCleanup()\r\n  finishedSections = {} as Record<string, boolean> // these sections are fully loaded into the world (scene)\r\n\r\n  @worldCleanup()\r\n  // loading sections (chunks)\r\n  sectionsWaiting = new Map<string, number>()\r\n\r\n  @worldCleanup()\r\n  queuedChunks = new Set<string>()\r\n  queuedFunctions = [] as Array<() => void>\r\n  // #endregion\r\n\r\n  @worldCleanup()\r\n  renderUpdateEmitter = new EventEmitter() as unknown as TypedEmitter<{\r\n    dirty (pos: Vec3, value: boolean): void\r\n    update (/* pos: Vec3, value: boolean */): void\r\n    textureDownloaded (): void\r\n    itemsTextureDownloaded (): void\r\n    chunkFinished (key: string): void\r\n  }>\r\n  customTexturesDataUrl = undefined as string | undefined\r\n  @worldCleanup()\r\n  currentTextureImage = undefined as any\r\n  workers: any[] = []\r\n  @worldCleanup()\r\n  viewerPosition?: Vec3\r\n  lastCamUpdate = 0\r\n  droppedFpsPercentage = 0\r\n  @worldCleanup()\r\n  initialChunkLoadWasStartedIn: number | undefined\r\n  @worldCleanup()\r\n  initialChunksLoad = true\r\n  enableChunksLoadDelay = false\r\n  texturesVersion?: string\r\n  viewDistance = -1\r\n  chunksLength = 0\r\n  @worldCleanup()\r\n  allChunksFinished = false\r\n\r\n  handleResize = () => { }\r\n  mesherConfig = defaultMesherConfig\r\n  camera: THREE.PerspectiveCamera\r\n  highestBlocks = new Map<string, HighestBlockInfo>()\r\n  blockstatesModels: any\r\n  customBlockStates: Record<string, any> | undefined\r\n  customModels: Record<string, any> | undefined\r\n  itemsAtlasParser: AtlasParser | undefined\r\n  blocksAtlasParser: AtlasParser | undefined\r\n\r\n  sourceData = {\r\n    blocksAtlases,\r\n    itemsAtlases,\r\n    itemDefinitionsJson\r\n  }\r\n  customTextures: {\r\n    items?: CustomTexturesData\r\n    blocks?: CustomTexturesData\r\n    armor?: CustomTexturesData\r\n  } = {}\r\n  itemsDefinitionsStore = getLoadedItemDefinitionsStore(this.sourceData.itemDefinitionsJson)\r\n  workersProcessAverageTime = 0\r\n  workersProcessAverageTimeCount = 0\r\n  maxWorkersProcessTime = 0\r\n  geometryReceiveCount = {}\r\n  allLoadedIn: undefined | number\r\n  rendererDevice = '...'\r\n\r\n  edgeChunks = {} as Record<string, boolean>\r\n  lastAddChunk = null as null | {\r\n    timeout: any\r\n    x: number\r\n    z: number\r\n  }\r\n  neighborChunkUpdates = true\r\n  lastChunkDistance = 0\r\n  debugStopGeometryUpdate = false\r\n\r\n  @worldCleanup()\r\n  freeFlyMode = false\r\n  @worldCleanup()\r\n  freeFlyState = {\r\n    yaw: 0,\r\n    pitch: 0,\r\n    position: new Vec3(0, 0, 0)\r\n  }\r\n  @worldCleanup()\r\n  itemsRenderer: ItemsRenderer | undefined\r\n\r\n  protocolCustomBlocks = new Map<string, CustomBlockModels>()\r\n\r\n  @worldCleanup()\r\n  blockStateModelInfo = new Map<string, BlockStateModelInfo>()\r\n\r\n  abstract outputFormat: 'threeJs' | 'webgpu'\r\n  worldBlockProvider: WorldBlockProvider\r\n\r\n  abstract changeBackgroundColor (color: [number, number, number]): void\r\n\r\n  constructor (public config: WorldRendererConfig) {\r\n    // this.initWorkers(1) // preload script on page load\r\n    this.snapshotInitialValues()\r\n\r\n    this.renderUpdateEmitter.on('update', () => {\r\n      const loadedChunks = Object.keys(this.finishedChunks).length\r\n      updateStatText('loaded-chunks', `${loadedChunks}/${this.chunksLength} chunks (${this.lastChunkDistance}/${this.viewDistance})`)\r\n    })\r\n  }\r\n\r\n  snapshotInitialValues () { }\r\n\r\n  initWorkers (numWorkers = this.config.numWorkers) {\r\n    // init workers\r\n    for (let i = 0; i < numWorkers + 1; i++) {\r\n      // Node environment needs an absolute path, but browser needs the url of the file\r\n      const workerName = 'mesher.js'\r\n      // eslint-disable-next-line node/no-path-concat\r\n      const src = typeof window === 'undefined' ? `${__dirname}/${workerName}` : workerName\r\n\r\n      let worker: any\r\n      if (process.env.SINGLE_FILE_BUILD) {\r\n        const workerCode = document.getElementById('mesher-worker-code')!.textContent!\r\n        const blob = new Blob([workerCode], { type: 'text/javascript' })\r\n        worker = new Worker(window.URL.createObjectURL(blob))\r\n      } else {\r\n        worker = new Worker(src)\r\n      }\r\n      const handleMessage = (data) => {\r\n        if (!this.active) return\r\n        if (data.type !== 'geometry' || !this.debugStopGeometryUpdate) {\r\n          this.handleWorkerMessage(data)\r\n        }\r\n        if (data.type === 'geometry') {\r\n          this.geometryReceiveCount[data.workerIndex] ??= 0\r\n          this.geometryReceiveCount[data.workerIndex]++\r\n          const geometry = data.geometry as MesherGeometryOutput\r\n          for (const [key, highest] of geometry.highestBlocks.entries()) {\r\n            const currHighest = this.highestBlocks.get(key)\r\n            if (!currHighest || currHighest.y < highest.y) {\r\n              this.highestBlocks.set(key, highest)\r\n            }\r\n          }\r\n          // for (const key in geometry.highestBlocks) {\r\n          //   const highest = geometry.highestBlocks[key]\r\n          //   if (!this.highestBlocks[key] || this.highestBlocks[key].y < highest.y) {\r\n          //     this.highestBlocks[key] = highest\r\n          //   }\r\n          // }\r\n          const chunkCoords = data.key.split(',').map(Number)\r\n          this.lastChunkDistance = Math.max(...this.getDistance(new Vec3(chunkCoords[0], 0, chunkCoords[2])))\r\n        }\r\n        if (data.type === 'sectionFinished') { // on after load & unload section\r\n          if (!this.sectionsWaiting.get(data.key)) throw new Error(`sectionFinished event for non-outstanding section ${data.key}`)\r\n          this.sectionsWaiting.set(data.key, this.sectionsWaiting.get(data.key)! - 1)\r\n          if (this.sectionsWaiting.get(data.key) === 0) {\r\n            this.sectionsWaiting.delete(data.key)\r\n            this.finishedSections[data.key] = true\r\n          }\r\n\r\n          const chunkCoords = data.key.split(',').map(Number)\r\n          if (this.loadedChunks[`${chunkCoords[0]},${chunkCoords[2]}`]) { // ensure chunk data was added, not a neighbor chunk update\r\n            const loadingKeys = [...this.sectionsWaiting.keys()]\r\n            if (!loadingKeys.some(key => {\r\n              const [x, y, z] = key.split(',').map(Number)\r\n              return x === chunkCoords[0] && z === chunkCoords[2]\r\n            })) {\r\n              this.finishedChunks[`${chunkCoords[0]},${chunkCoords[2]}`] = true\r\n              this.renderUpdateEmitter.emit(`chunkFinished`, `${chunkCoords[0] / 16},${chunkCoords[2] / 16}`)\r\n            }\r\n          }\r\n          this.checkAllFinished()\r\n\r\n          this.renderUpdateEmitter.emit('update')\r\n          if (data.processTime) {\r\n            this.workersProcessAverageTimeCount++\r\n            this.workersProcessAverageTime = ((this.workersProcessAverageTime * (this.workersProcessAverageTimeCount - 1)) + data.processTime) / this.workersProcessAverageTimeCount\r\n            this.maxWorkersProcessTime = Math.max(this.maxWorkersProcessTime, data.processTime)\r\n          }\r\n        }\r\n\r\n        if (data.type === 'blockStateModelInfo') {\r\n          for (const [cacheKey, info] of Object.entries(data.info)) {\r\n            this.blockStateModelInfo.set(cacheKey, info)\r\n          }\r\n        }\r\n      }\r\n      worker.onmessage = ({ data }) => {\r\n        if (Array.isArray(data)) {\r\n          // eslint-disable-next-line unicorn/no-array-for-each\r\n          data.forEach(handleMessage)\r\n          return\r\n        }\r\n        handleMessage(data)\r\n      }\r\n      if (worker.on) worker.on('message', (data) => { worker.onmessage({ data }) })\r\n      this.workers.push(worker)\r\n    }\r\n  }\r\n\r\n  checkAllFinished () {\r\n    if (this.sectionsWaiting.size === 0) {\r\n      const allFinished = Object.keys(this.finishedChunks).length === this.chunksLength\r\n      if (allFinished) {\r\n        this.allChunksLoaded?.()\r\n        this.allChunksFinished = true\r\n        this.allLoadedIn ??= Date.now() - this.initialChunkLoadWasStartedIn!\r\n      }\r\n    }\r\n  }\r\n\r\n  changeHandSwingingState (isAnimationPlaying: boolean, isLeftHand: boolean): void { }\r\n\r\n  abstract handleWorkerMessage (data: WorkerReceive): void\r\n\r\n  abstract updateCamera (pos: Vec3 | null, yaw: number, pitch: number): void\r\n\r\n  abstract render (): void\r\n\r\n  /**\r\n   * Optionally update data that are depedendent on the viewer position\r\n   */\r\n  updatePosDataChunk? (key: string): void\r\n\r\n  allChunksLoaded? (): void\r\n\r\n  timeUpdated? (newTime: number): void\r\n\r\n  updateViewerPosition (pos: Vec3) {\r\n    this.viewerPosition = pos\r\n    for (const [key, value] of Object.entries(this.loadedChunks)) {\r\n      if (!value) continue\r\n      this.updatePosDataChunk?.(key)\r\n    }\r\n  }\r\n\r\n  sendWorkers (message: WorkerSend) {\r\n    for (const worker of this.workers) {\r\n      worker.postMessage(message)\r\n    }\r\n  }\r\n\r\n  getDistance (posAbsolute: Vec3) {\r\n    const [botX, botZ] = chunkPos(this.viewerPosition!)\r\n    const dx = Math.abs(botX - Math.floor(posAbsolute.x / 16))\r\n    const dz = Math.abs(botZ - Math.floor(posAbsolute.z / 16))\r\n    return [dx, dz] as [number, number]\r\n  }\r\n\r\n  abstract updateShowChunksBorder (value: boolean): void\r\n\r\n  resetWorld () {\r\n    // destroy workers\r\n    for (const worker of this.workers) {\r\n      worker.terminate()\r\n    }\r\n    this.workers = []\r\n    this.currentTextureImage = undefined\r\n    this.blocksAtlasParser = undefined\r\n    this.itemsAtlasParser = undefined\r\n  }\r\n\r\n  // new game load happens here\r\n  async setVersion (version, texturesVersion = version) {\r\n    if (!this.blockstatesModels) throw new Error('Blockstates models is not loaded yet')\r\n    this.version = version\r\n    this.texturesVersion = texturesVersion\r\n    this.resetWorld()\r\n\r\n    // for workers in single file build\r\n    if (document.readyState === 'loading') {\r\n      await new Promise(resolve => {\r\n        document.addEventListener('DOMContentLoaded', resolve)\r\n      })\r\n    }\r\n\r\n    this.initWorkers()\r\n    this.active = true\r\n    this.mesherConfig.outputFormat = this.outputFormat\r\n    this.mesherConfig.version = this.version!\r\n\r\n    this.sendMesherMcData()\r\n    await this.updateAssetsData()\r\n  }\r\n\r\n  sendMesherMcData () {\r\n    const allMcData = mcDataRaw.pc[this.version] ?? mcDataRaw.pc[toMajorVersion(this.version)]\r\n    const mcData = {\r\n      version: JSON.parse(JSON.stringify(allMcData.version))\r\n    }\r\n    for (const key of dynamicMcDataFiles) {\r\n      mcData[key] = allMcData[key]\r\n    }\r\n\r\n    for (const worker of this.workers) {\r\n      worker.postMessage({ type: 'mcData', mcData, config: this.mesherConfig })\r\n    }\r\n  }\r\n\r\n  async generateGuiTextures () {\r\n    await generateGuiAtlas()\r\n  }\r\n\r\n  async updateAssetsData (resourcePackUpdate = false, prioritizeBlockTextures?: string[]) {\r\n    const blocksAssetsParser = new AtlasParser(this.sourceData.blocksAtlases, blocksAtlasLatest, blocksAtlasLegacy)\r\n    const itemsAssetsParser = new AtlasParser(this.sourceData.itemsAtlases, itemsAtlasLatest, itemsAtlasLegacy)\r\n\r\n    const blockTexturesChanges = {} as Record<string, string>\r\n    const date = new Date()\r\n    if ((date.getMonth() === 11 && date.getDate() >= 24) || (date.getMonth() === 0 && date.getDate() <= 6)) {\r\n      Object.assign(blockTexturesChanges, christmasPack)\r\n    }\r\n\r\n    const customBlockTextures = Object.keys(this.customTextures.blocks?.textures ?? {})\r\n    const customItemTextures = Object.keys(this.customTextures.items?.textures ?? {})\r\n    console.time('createBlocksAtlas')\r\n    const { atlas: blocksAtlas, canvas: blocksCanvas } = await blocksAssetsParser.makeNewAtlas(this.texturesVersion ?? this.version ?? 'latest', (textureName) => {\r\n      const texture = this.customTextures?.blocks?.textures[textureName]\r\n      return blockTexturesChanges[textureName] ?? texture\r\n    }, /* this.customTextures?.blocks?.tileSize */undefined, prioritizeBlockTextures, customBlockTextures)\r\n    console.timeEnd('createBlocksAtlas')\r\n    console.time('createItemsAtlas')\r\n    const { atlas: itemsAtlas, canvas: itemsCanvas } = await itemsAssetsParser.makeNewAtlas(this.texturesVersion ?? this.version ?? 'latest', (textureName) => {\r\n      const texture = this.customTextures?.items?.textures[textureName]\r\n      if (!texture) return\r\n      return texture\r\n    }, this.customTextures?.items?.tileSize, undefined, customItemTextures)\r\n    console.timeEnd('createItemsAtlas')\r\n\r\n    this.blocksAtlasParser = new AtlasParser({ latest: blocksAtlas }, blocksCanvas.toDataURL())\r\n    this.itemsAtlasParser = new AtlasParser({ latest: itemsAtlas }, itemsCanvas.toDataURL())\r\n\r\n    this.itemsRenderer = new ItemsRenderer(this.version!, this.blockstatesModels, this.itemsAtlasParser, this.blocksAtlasParser)\r\n    this.worldBlockProvider = worldBlockProvider(this.blockstatesModels, this.blocksAtlasParser.atlas, 'latest')\r\n\r\n    const texture = await new THREE.TextureLoader().loadAsync(this.blocksAtlasParser.latestImage)\r\n    texture.magFilter = THREE.NearestFilter\r\n    texture.minFilter = THREE.NearestFilter\r\n    texture.flipY = false\r\n    this.material.map = texture\r\n    this.currentTextureImage = this.material.map.image\r\n    this.mesherConfig.textureSize = this.material.map.image.width\r\n\r\n    for (const [i, worker] of this.workers.entries()) {\r\n      const { blockstatesModels } = this\r\n      if (this.customBlockStates) {\r\n        // TODO! remove from other versions as well\r\n        blockstatesModels.blockstates.latest = {\r\n          ...blockstatesModels.blockstates.latest,\r\n          ...this.customBlockStates\r\n        }\r\n      }\r\n      if (this.customModels) {\r\n        blockstatesModels.models.latest = {\r\n          ...blockstatesModels.models.latest,\r\n          ...this.customModels\r\n        }\r\n      }\r\n      worker.postMessage({\r\n        type: 'mesherData',\r\n        workerIndex: i,\r\n        blocksAtlas: {\r\n          latest: blocksAtlas\r\n        },\r\n        blockstatesModels,\r\n        config: this.mesherConfig,\r\n      })\r\n    }\r\n    if (!this.itemsAtlasParser) return\r\n    const itemsTexture = await new THREE.TextureLoader().loadAsync(this.itemsAtlasParser.latestImage)\r\n    itemsTexture.magFilter = THREE.NearestFilter\r\n    itemsTexture.minFilter = THREE.NearestFilter\r\n    itemsTexture.flipY = false\r\n    viewer.entities.itemsTexture = itemsTexture\r\n    if (!this.itemsAtlasParser) return\r\n\r\n    this.renderUpdateEmitter.emit('textureDownloaded')\r\n\r\n    console.time('generateGuiTextures')\r\n    await this.generateGuiTextures()\r\n    console.timeEnd('generateGuiTextures')\r\n    if (!this.itemsAtlasParser) return\r\n    this.renderUpdateEmitter.emit('itemsTextureDownloaded')\r\n    console.log('textures loaded')\r\n  }\r\n\r\n  async downloadDebugAtlas (isItems = false) {\r\n    const atlasParser = (isItems ? this.itemsAtlasParser : this.blocksAtlasParser)!\r\n    const dataUrl = await atlasParser.createDebugImage(true)\r\n    const a = document.createElement('a')\r\n    a.href = dataUrl\r\n    a.download = `atlas-debug-${isItems ? 'items' : 'blocks'}.png`\r\n    a.click()\r\n  }\r\n\r\n  get worldMinYRender () {\r\n    return Math.floor(Math.max(this.worldConfig.minY, this.mesherConfig.clipWorldBelowY ?? -Infinity) / 16) * 16\r\n  }\r\n\r\n  updateChunksStatsText () {\r\n    updateStatText('downloaded-chunks', `${Object.keys(this.loadedChunks).length}/${this.chunksLength} chunks D (${this.workers.length}:${this.workersProcessAverageTime.toFixed(0)}ms/${this.allLoadedIn?.toFixed(1) ?? '-'}s)`)\r\n  }\r\n\r\n  addColumn (x: number, z: number, chunk: any, isLightUpdate: boolean) {\r\n    if (!this.active) return\r\n    if (this.workers.length === 0) throw new Error('workers not initialized yet')\r\n    this.initialChunksLoad = false\r\n    this.initialChunkLoadWasStartedIn ??= Date.now()\r\n    this.loadedChunks[`${x},${z}`] = true\r\n    this.updateChunksStatsText()\r\n\r\n    const chunkKey = `${x},${z}`\r\n    const customBlockModels = this.protocolCustomBlocks.get(chunkKey)\r\n\r\n    for (const worker of this.workers) {\r\n      worker.postMessage({\r\n        type: 'chunk',\r\n        x,\r\n        z,\r\n        chunk,\r\n        customBlockModels: customBlockModels || undefined\r\n      })\r\n    }\r\n    for (let y = this.worldMinYRender; y < this.worldConfig.worldHeight; y += 16) {\r\n      const loc = new Vec3(x, y, z)\r\n      this.setSectionDirty(loc)\r\n      if (this.neighborChunkUpdates && (!isLightUpdate || this.mesherConfig.smoothLighting)) {\r\n        this.setSectionDirty(loc.offset(-16, 0, 0))\r\n        this.setSectionDirty(loc.offset(16, 0, 0))\r\n        this.setSectionDirty(loc.offset(0, 0, -16))\r\n        this.setSectionDirty(loc.offset(0, 0, 16))\r\n      }\r\n    }\r\n  }\r\n\r\n  markAsLoaded (x, z) {\r\n    this.loadedChunks[`${x},${z}`] = true\r\n    this.finishedChunks[`${x},${z}`] = true\r\n    this.checkAllFinished()\r\n  }\r\n\r\n  removeColumn (x, z) {\r\n    delete this.loadedChunks[`${x},${z}`]\r\n    for (const worker of this.workers) {\r\n      worker.postMessage({ type: 'unloadChunk', x, z })\r\n    }\r\n    delete this.finishedChunks[`${x},${z}`]\r\n    this.allChunksFinished = Object.keys(this.finishedChunks).length === this.chunksLength\r\n    if (!this.allChunksFinished) {\r\n      this.allLoadedIn = undefined\r\n      this.initialChunkLoadWasStartedIn = undefined\r\n    }\r\n    for (let y = this.worldConfig.minY; y < this.worldConfig.worldHeight; y += 16) {\r\n      this.setSectionDirty(new Vec3(x, y, z), false)\r\n      delete this.finishedSections[`${x},${y},${z}`]\r\n    }\r\n\r\n    // remove from highestBlocks\r\n    const startX = Math.floor(x / 16) * 16\r\n    const startZ = Math.floor(z / 16) * 16\r\n    const endX = Math.ceil((x + 1) / 16) * 16\r\n    const endZ = Math.ceil((z + 1) / 16) * 16\r\n    for (let x = startX; x < endX; x += 16) {\r\n      for (let z = startZ; z < endZ; z += 16) {\r\n        delete this.highestBlocks[`${x},${z}`]\r\n      }\r\n    }\r\n  }\r\n\r\n  setBlockStateId (pos: Vec3, stateId: number) {\r\n    const needAoRecalculation = true\r\n    const chunkKey = `${Math.floor(pos.x / 16) * 16},${Math.floor(pos.z / 16) * 16}`\r\n    const blockPosKey = `${pos.x},${pos.y},${pos.z}`\r\n    const customBlockModels = this.protocolCustomBlocks.get(chunkKey) || {}\r\n\r\n    for (const worker of this.workers) {\r\n      worker.postMessage({\r\n        type: 'blockUpdate',\r\n        pos,\r\n        stateId,\r\n        customBlockModels\r\n      })\r\n    }\r\n    this.setSectionDirty(pos, true, true)\r\n    if (this.neighborChunkUpdates) {\r\n      if ((pos.x & 15) === 0) this.setSectionDirty(pos.offset(-16, 0, 0), true, true)\r\n      if ((pos.x & 15) === 15) this.setSectionDirty(pos.offset(16, 0, 0), true, true)\r\n      if ((pos.y & 15) === 0) this.setSectionDirty(pos.offset(0, -16, 0), true, true)\r\n      if ((pos.y & 15) === 15) this.setSectionDirty(pos.offset(0, 16, 0), true, true)\r\n      if ((pos.z & 15) === 0) this.setSectionDirty(pos.offset(0, 0, -16), true, true)\r\n      if ((pos.z & 15) === 15) this.setSectionDirty(pos.offset(0, 0, 16), true, true)\r\n\r\n      if (needAoRecalculation) {\r\n        // top view neighbors\r\n        if ((pos.x & 15) === 0 && (pos.z & 15) === 0) this.setSectionDirty(pos.offset(-16, 0, -16), true, true)\r\n        if ((pos.x & 15) === 15 && (pos.z & 15) === 0) this.setSectionDirty(pos.offset(16, 0, -16), true, true)\r\n        if ((pos.x & 15) === 0 && (pos.z & 15) === 15) this.setSectionDirty(pos.offset(-16, 0, 16), true, true)\r\n        if ((pos.x & 15) === 15 && (pos.z & 15) === 15) this.setSectionDirty(pos.offset(16, 0, 16), true, true)\r\n\r\n        // side view neighbors (but ignore updates above)\r\n        // z view neighbors\r\n        if ((pos.x & 15) === 0 && (pos.y & 15) === 0) this.setSectionDirty(pos.offset(-16, -16, 0), true, true)\r\n        if ((pos.x & 15) === 15 && (pos.y & 15) === 0) this.setSectionDirty(pos.offset(16, -16, 0), true, true)\r\n\r\n        // x view neighbors\r\n        if ((pos.z & 15) === 0 && (pos.y & 15) === 0) this.setSectionDirty(pos.offset(0, -16, -16), true, true)\r\n        if ((pos.z & 15) === 15 && (pos.y & 15) === 0) this.setSectionDirty(pos.offset(0, -16, 16), true, true)\r\n\r\n        // x & z neighbors\r\n        if ((pos.y & 15) === 0 && (pos.x & 15) === 0 && (pos.z & 15) === 0) this.setSectionDirty(pos.offset(-16, -16, -16), true, true)\r\n        if ((pos.y & 15) === 0 && (pos.x & 15) === 15 && (pos.z & 15) === 0) this.setSectionDirty(pos.offset(16, -16, -16), true, true)\r\n        if ((pos.y & 15) === 0 && (pos.x & 15) === 0 && (pos.z & 15) === 15) this.setSectionDirty(pos.offset(-16, -16, 16), true, true)\r\n        if ((pos.y & 15) === 0 && (pos.x & 15) === 15 && (pos.z & 15) === 15) this.setSectionDirty(pos.offset(16, -16, 16), true, true)\r\n      }\r\n    }\r\n  }\r\n\r\n  queueAwaited = false\r\n  messagesQueue = {} as { [workerIndex: string]: any[] }\r\n\r\n  getWorkerNumber (pos: Vec3, updateAction = false) {\r\n    if (updateAction) {\r\n      const key = `${Math.floor(pos.x / 16) * 16},${Math.floor(pos.y / 16) * 16},${Math.floor(pos.z / 16) * 16}`\r\n      const cantUseChangeWorker = this.sectionsWaiting.get(key) && !this.finishedSections[key]\r\n      if (!cantUseChangeWorker) return 0\r\n    }\r\n\r\n    const hash = mod(Math.floor(pos.x / 16) + Math.floor(pos.y / 16) + Math.floor(pos.z / 16), this.workers.length - 1)\r\n    return hash + 1\r\n  }\r\n\r\n  setSectionDirty (pos: Vec3, value = true, useChangeWorker = false) { // value false is used for unloading chunks\r\n    if (this.viewDistance === -1) throw new Error('viewDistance not set')\r\n    this.allChunksFinished = false\r\n    const distance = this.getDistance(pos)\r\n    if (!this.workers.length || distance[0] > this.viewDistance || distance[1] > this.viewDistance) return\r\n    const key = `${Math.floor(pos.x / 16) * 16},${Math.floor(pos.y / 16) * 16},${Math.floor(pos.z / 16) * 16}`\r\n    // if (this.sectionsOutstanding.has(key)) return\r\n    this.renderUpdateEmitter.emit('dirty', pos, value)\r\n    // Dispatch sections to workers based on position\r\n    // This guarantees uniformity accross workers and that a given section\r\n    // is always dispatched to the same worker\r\n    const hash = this.getWorkerNumber(pos, useChangeWorker)\r\n    this.sectionsWaiting.set(key, (this.sectionsWaiting.get(key) ?? 0) + 1)\r\n    this.messagesQueue[hash] ??= []\r\n    this.messagesQueue[hash].push({\r\n      // this.workers[hash].postMessage({\r\n      type: 'dirty',\r\n      x: pos.x,\r\n      y: pos.y,\r\n      z: pos.z,\r\n      value,\r\n      config: this.mesherConfig,\r\n    })\r\n    this.dispatchMessages()\r\n  }\r\n\r\n  dispatchMessages () {\r\n    if (this.queueAwaited) return\r\n    this.queueAwaited = true\r\n    setTimeout(() => {\r\n      // group messages and send as one\r\n      for (const workerIndex in this.messagesQueue) {\r\n        const worker = this.workers[Number(workerIndex)]\r\n        worker.postMessage(this.messagesQueue[workerIndex])\r\n      }\r\n      this.messagesQueue = {}\r\n      this.queueAwaited = false\r\n    })\r\n  }\r\n\r\n  // Listen for chunk rendering updates emitted if a worker finished a render and resolve if the number\r\n  // of sections not rendered are 0\r\n  async waitForChunksToRender () {\r\n    return new Promise<void>((resolve, reject) => {\r\n      if ([...this.sectionsWaiting].length === 0) {\r\n        resolve()\r\n        return\r\n      }\r\n\r\n      const updateHandler = () => {\r\n        if (this.sectionsWaiting.size === 0) {\r\n          this.renderUpdateEmitter.removeListener('update', updateHandler)\r\n          resolve()\r\n        }\r\n      }\r\n      this.renderUpdateEmitter.on('update', updateHandler)\r\n    })\r\n  }\r\n\r\n  async waitForChunkToLoad (pos: Vec3) {\r\n    return new Promise<void>((resolve, reject) => {\r\n      const key = `${Math.floor(pos.x / 16) * 16},${Math.floor(pos.z / 16) * 16}`\r\n      if (this.loadedChunks[key]) {\r\n        resolve()\r\n        return\r\n      }\r\n      const updateHandler = () => {\r\n        if (this.loadedChunks[key]) {\r\n          this.renderUpdateEmitter.removeListener('update', updateHandler)\r\n          resolve()\r\n        }\r\n      }\r\n      this.renderUpdateEmitter.on('update', updateHandler)\r\n    })\r\n  }\r\n\r\n  destroy () {\r\n    console.warn('world destroy is not implemented')\r\n  }\r\n\r\n  abstract setHighlightCursorBlock (block: typeof this.cursorBlock, shapePositions?: Array<{ position; width; height; depth }>): void\r\n}\r\n","import * as THREE from 'three'\r\nimport { Vec3 } from 'vec3'\r\nimport nbt from 'prismarine-nbt'\r\nimport PrismarineChatLoader from 'prismarine-chat'\r\nimport * as tweenJs from '@tweenjs/tween.js'\r\nimport { BloomPass, RenderPass, UnrealBloomPass, EffectComposer, WaterPass, GlitchPass, LineSegmentsGeometry, Wireframe, LineMaterial } from 'three-stdlib'\r\nimport worldBlockProvider from 'mc-assets/dist/worldBlockProvider'\r\nimport { renderSign } from '../sign-renderer'\r\nimport { chunkPos, sectionPos } from './simpleUtils'\r\nimport { WorldRendererCommon, WorldRendererConfig } from './worldrendererCommon'\r\nimport { disposeObject } from './threeJsUtils'\r\nimport HoldingBlock, { HandItemBlock } from './holdingBlock'\r\nimport { addNewStat } from './ui/newStats'\r\nimport { MesherGeometryOutput } from './mesher/shared'\r\nimport { IPlayerState } from './basePlayerState'\r\nimport { getMesh } from './entity/EntityMesh'\r\nimport { armorModel } from './entity/armorModels'\r\n\r\nexport class WorldRendererThree extends WorldRendererCommon {\r\n  interactionLines: null | { blockPos; mesh } = null\r\n  outputFormat = 'threeJs' as const\r\n  blockEntities = {}\r\n  sectionObjects: Record<string, THREE.Object3D> = {}\r\n  chunkTextures = new Map<string, { [pos: string]: THREE.Texture }>()\r\n  signsCache = new Map<string, any>()\r\n  starField: StarField\r\n  cameraSectionPos: Vec3 = new Vec3(0, 0, 0)\r\n  holdingBlock: HoldingBlock\r\n  holdingBlockLeft: HoldingBlock\r\n  rendererDevice = '...'\r\n\r\n  get tilesRendered () {\r\n    return Object.values(this.sectionObjects).reduce((acc, obj) => acc + (obj as any).tilesCount, 0)\r\n  }\r\n\r\n  get blocksRendered () {\r\n    return Object.values(this.sectionObjects).reduce((acc, obj) => acc + (obj as any).blocksCount, 0)\r\n  }\r\n\r\n  constructor (public scene: THREE.Scene, public renderer: THREE.WebGLRenderer, public config: WorldRendererConfig, public playerState: IPlayerState) {\r\n    super(config)\r\n    this.rendererDevice = `${WorldRendererThree.getRendererInfo(this.renderer)} powered by three.js r${THREE.REVISION}`\r\n    this.starField = new StarField(scene)\r\n    this.holdingBlock = new HoldingBlock(playerState, this.config)\r\n    this.holdingBlockLeft = new HoldingBlock(playerState, this.config, true)\r\n\r\n    this.renderUpdateEmitter.on('itemsTextureDownloaded', () => {\r\n      this.holdingBlock.ready = true\r\n      this.holdingBlock.updateItem()\r\n      this.holdingBlockLeft.ready = true\r\n      this.holdingBlockLeft.updateItem()\r\n    })\r\n\r\n    this.addDebugOverlay()\r\n  }\r\n\r\n  changeHandSwingingState (isAnimationPlaying: boolean, isLeft = false) {\r\n    const holdingBlock = isLeft ? this.holdingBlockLeft : this.holdingBlock\r\n    if (isAnimationPlaying) {\r\n      holdingBlock.startSwing()\r\n    } else {\r\n      holdingBlock.stopSwing()\r\n    }\r\n  }\r\n\r\n  changeBackgroundColor (color: [number, number, number]): void {\r\n    this.scene.background = new THREE.Color(color[0], color[1], color[2])\r\n  }\r\n\r\n  timeUpdated (newTime: number): void {\r\n    const nightTime = 13_500\r\n    const morningStart = 23_000\r\n    const displayStars = newTime > nightTime && newTime < morningStart\r\n    if (displayStars) {\r\n      this.starField.addToScene()\r\n    } else {\r\n      this.starField.remove()\r\n    }\r\n  }\r\n\r\n  debugOverlayAdded = false\r\n  addDebugOverlay () {\r\n    if (this.debugOverlayAdded) return\r\n    this.debugOverlayAdded = true\r\n    const pane = addNewStat('debug-overlay')\r\n    setInterval(() => {\r\n      pane.setVisibility(this.displayStats)\r\n      if (this.displayStats) {\r\n        pane.updateText(`C: ${this.renderer.info.render.calls} TR: ${this.renderer.info.render.triangles} TE: ${this.renderer.info.memory.textures} F: ${this.tilesRendered} B: ${this.blocksRendered}`)\r\n      }\r\n    }, 100)\r\n  }\r\n\r\n  /**\r\n   * Optionally update data that are depedendent on the viewer position\r\n   */\r\n  updatePosDataChunk (key: string) {\r\n    const [x, y, z] = key.split(',').map(x => Math.floor(+x / 16))\r\n    // sum of distances: x + y + z\r\n    const chunkDistance = Math.abs(x - this.cameraSectionPos.x) + Math.abs(y - this.cameraSectionPos.y) + Math.abs(z - this.cameraSectionPos.z)\r\n    const section = this.sectionObjects[key].children.find(child => child.name === 'mesh')!\r\n    section.renderOrder = 500 - chunkDistance\r\n  }\r\n\r\n  updateViewerPosition (pos: Vec3): void {\r\n    this.viewerPosition = pos\r\n    const cameraPos = this.camera.position.toArray().map(x => Math.floor(x / 16)) as [number, number, number]\r\n    this.cameraSectionPos = new Vec3(...cameraPos)\r\n    // eslint-disable-next-line guard-for-in\r\n    for (const key in this.sectionObjects) {\r\n      const value = this.sectionObjects[key]\r\n      if (!value) continue\r\n      this.updatePosDataChunk(key)\r\n    }\r\n  }\r\n\r\n  // debugRecomputedDeletedObjects = 0\r\n  handleWorkerMessage (data: { geometry: MesherGeometryOutput, key, type }): void {\r\n    if (data.type !== 'geometry') return\r\n    let object: THREE.Object3D = this.sectionObjects[data.key]\r\n    if (object) {\r\n      this.scene.remove(object)\r\n      disposeObject(object)\r\n      delete this.sectionObjects[data.key]\r\n    }\r\n\r\n    const chunkCoords = data.key.split(',')\r\n    if (!this.loadedChunks[chunkCoords[0] + ',' + chunkCoords[2]] || !data.geometry.positions.length || !this.active) return\r\n\r\n    // if (object) {\r\n    //   this.debugRecomputedDeletedObjects++\r\n    // }\r\n\r\n    // if (!this.initialChunksLoad && this.enableChunksLoadDelay) {\r\n    //   const newPromise = new Promise(resolve => {\r\n    //     if (this.droppedFpsPercentage > 0.5) {\r\n    //       setTimeout(resolve, 1000 / 50 * this.droppedFpsPercentage)\r\n    //     } else {\r\n    //       setTimeout(resolve)\r\n    //     }\r\n    //   })\r\n    //   this.promisesQueue.push(newPromise)\r\n    //   for (const promise of this.promisesQueue) {\r\n    //     await promise\r\n    //   }\r\n    // }\r\n\r\n    const geometry = new THREE.BufferGeometry()\r\n    geometry.setAttribute('position', new THREE.BufferAttribute(data.geometry.positions, 3))\r\n    geometry.setAttribute('normal', new THREE.BufferAttribute(data.geometry.normals, 3))\r\n    geometry.setAttribute('color', new THREE.BufferAttribute(data.geometry.colors, 3))\r\n    geometry.setAttribute('uv', new THREE.BufferAttribute(data.geometry.uvs, 2))\r\n    geometry.setIndex(data.geometry.indices)\r\n\r\n    const mesh = new THREE.Mesh(geometry, this.material)\r\n    mesh.position.set(data.geometry.sx, data.geometry.sy, data.geometry.sz)\r\n    mesh.name = 'mesh'\r\n    object = new THREE.Group()\r\n    object.add(mesh)\r\n    // mesh with static dimensions: 16x16x16\r\n    const staticChunkMesh = new THREE.Mesh(new THREE.BoxGeometry(16, 16, 16), new THREE.MeshBasicMaterial({ color: 0x00_00_00, transparent: true, opacity: 0 }))\r\n    staticChunkMesh.position.set(data.geometry.sx, data.geometry.sy, data.geometry.sz)\r\n    const boxHelper = new THREE.BoxHelper(staticChunkMesh, 0xff_ff_00)\r\n    boxHelper.name = 'helper'\r\n    object.add(boxHelper)\r\n    object.name = 'chunk';\r\n    (object as any).tilesCount = data.geometry.positions.length / 3 / 4;\r\n    (object as any).blocksCount = data.geometry.blocksCount\r\n    if (!this.config.showChunkBorders) {\r\n      boxHelper.visible = false\r\n    }\r\n    // should not compute it once\r\n    if (Object.keys(data.geometry.signs).length) {\r\n      for (const [posKey, { isWall, isHanging, rotation }] of Object.entries(data.geometry.signs)) {\r\n        const signBlockEntity = this.blockEntities[posKey]\r\n        if (!signBlockEntity) continue\r\n        const [x, y, z] = posKey.split(',')\r\n        const sign = this.renderSign(new Vec3(+x, +y, +z), rotation, isWall, isHanging, nbt.simplify(signBlockEntity))\r\n        if (!sign) continue\r\n        object.add(sign)\r\n      }\r\n    }\r\n    if (Object.keys(data.geometry.heads).length) {\r\n      for (const [posKey, { isWall, rotation }] of Object.entries(data.geometry.heads)) {\r\n        const headBlockEntity = this.blockEntities[posKey]\r\n        if (!headBlockEntity) continue\r\n        const [x, y, z] = posKey.split(',')\r\n        const head = this.renderHead(new Vec3(+x, +y, +z), rotation, isWall, nbt.simplify(headBlockEntity))\r\n        if (!head) continue\r\n        object.add(head)\r\n      }\r\n    }\r\n    this.sectionObjects[data.key] = object\r\n    this.updatePosDataChunk(data.key)\r\n    object.matrixAutoUpdate = false\r\n    mesh.onAfterRender = (renderer, scene, camera, geometry, material, group) => {\r\n      // mesh.matrixAutoUpdate = false\r\n    }\r\n\r\n    this.scene.add(object)\r\n  }\r\n\r\n  getSignTexture (position: Vec3, blockEntity, backSide = false) {\r\n    const chunk = chunkPos(position)\r\n    let textures = this.chunkTextures.get(`${chunk[0]},${chunk[1]}`)\r\n    if (!textures) {\r\n      textures = {}\r\n      this.chunkTextures.set(`${chunk[0]},${chunk[1]}`, textures)\r\n    }\r\n    const texturekey = `${position.x},${position.y},${position.z}`\r\n    // todo investigate bug and remove this so don't need to clean in section dirty\r\n    if (textures[texturekey]) return textures[texturekey]\r\n\r\n    const PrismarineChat = PrismarineChatLoader(this.version!)\r\n    const canvas = renderSign(blockEntity, PrismarineChat)\r\n    if (!canvas) return\r\n    const tex = new THREE.Texture(canvas)\r\n    tex.magFilter = THREE.NearestFilter\r\n    tex.minFilter = THREE.NearestFilter\r\n    tex.needsUpdate = true\r\n    textures[texturekey] = tex\r\n    return tex\r\n  }\r\n\r\n  updateCamera (pos: Vec3 | null, yaw: number, pitch: number): void {\r\n    if (this.freeFlyMode) {\r\n      pos = this.freeFlyState.position\r\n      pitch = this.freeFlyState.pitch\r\n      yaw = this.freeFlyState.yaw\r\n    }\r\n\r\n    if (pos) {\r\n      new tweenJs.Tween(this.camera.position).to({ x: pos.x, y: pos.y, z: pos.z }, 50).start()\r\n      this.freeFlyState.position = pos\r\n    }\r\n    this.camera.rotation.set(pitch, yaw, this.cameraRoll, 'ZYX')\r\n  }\r\n\r\n  render () {\r\n    tweenJs.update()\r\n    // eslint-disable-next-line @typescript-eslint/non-nullable-type-assertion-style\r\n    const cam = this.camera instanceof THREE.Group ? this.camera.children.find(child => child instanceof THREE.PerspectiveCamera) as THREE.PerspectiveCamera : this.camera\r\n    this.renderer.render(this.scene, cam)\r\n    if (this.config.showHand && !this.freeFlyMode) {\r\n      this.holdingBlock.render(this.camera, this.renderer, viewer.ambientLight, viewer.directionalLight)\r\n      this.holdingBlockLeft.render(this.camera, this.renderer, viewer.ambientLight, viewer.directionalLight)\r\n    }\r\n  }\r\n\r\n  renderHead (position: Vec3, rotation: number, isWall: boolean, blockEntity) {\r\n    const textures = blockEntity.SkullOwner?.Properties?.textures[0]\r\n    if (!textures) return\r\n\r\n    try {\r\n      const textureData = JSON.parse(Buffer.from(textures.Value, 'base64').toString())\r\n      const skinUrl = textureData.textures?.SKIN?.url\r\n\r\n      const mesh = getMesh(this, skinUrl, armorModel.head)\r\n      const group = new THREE.Group()\r\n      if (isWall) {\r\n        mesh.position.set(0, 0.3125, 0.3125)\r\n      }\r\n      // move head model down as armor have a different offset than blocks\r\n      mesh.position.y -= 23 / 16\r\n      group.add(mesh)\r\n      group.position.set(position.x + 0.5, position.y + 0.045, position.z + 0.5)\r\n      group.rotation.set(\r\n        0,\r\n        -THREE.MathUtils.degToRad(rotation * (isWall ? 90 : 45 / 2)),\r\n        0\r\n      )\r\n      group.scale.set(0.8, 0.8, 0.8)\r\n      return group\r\n    } catch (err) {\r\n      console.error('Error decoding player texture:', err)\r\n    }\r\n  }\r\n\r\n  renderSign (position: Vec3, rotation: number, isWall: boolean, isHanging: boolean, blockEntity) {\r\n    const tex = this.getSignTexture(position, blockEntity)\r\n\r\n    if (!tex) return\r\n\r\n    // todo implement\r\n    // const key = JSON.stringify({ position, rotation, isWall })\r\n    // if (this.signsCache.has(key)) {\r\n    //   console.log('cached', key)\r\n    // } else {\r\n    //   this.signsCache.set(key, tex)\r\n    // }\r\n\r\n    const mesh = new THREE.Mesh(new THREE.PlaneGeometry(1, 1), new THREE.MeshBasicMaterial({ map: tex, transparent: true }))\r\n    mesh.renderOrder = 999\r\n\r\n    const lineHeight = 7 / 16\r\n    const scaleFactor = isHanging ? 1.3 : 1\r\n    mesh.scale.set(1 * scaleFactor, lineHeight * scaleFactor, 1 * scaleFactor)\r\n\r\n    const thickness = (isHanging ? 2 : 1.5) / 16\r\n    const wallSpacing = 0.25 / 16\r\n    if (isWall && !isHanging) {\r\n      mesh.position.set(0, 0, -0.5 + thickness + wallSpacing + 0.0001)\r\n    } else {\r\n      mesh.position.set(0, 0, thickness / 2 + 0.0001)\r\n    }\r\n\r\n    const group = new THREE.Group()\r\n    group.rotation.set(\r\n      0,\r\n      -THREE.MathUtils.degToRad(rotation * (isWall ? 90 : 45 / 2)),\r\n      0\r\n    )\r\n    group.add(mesh)\r\n    const height = (isHanging ? 10 : 8) / 16\r\n    const heightOffset = (isHanging ? 0 : isWall ? 4.333 : 9.333) / 16\r\n    const textPosition = height / 2 + heightOffset\r\n    group.position.set(position.x + 0.5, position.y + textPosition, position.z + 0.5)\r\n    return group\r\n  }\r\n\r\n  updateLight (chunkX: number, chunkZ: number) {\r\n    // set all sections in the chunk dirty\r\n    for (let y = this.worldConfig.minY; y < this.worldConfig.worldHeight; y += 16) {\r\n      this.setSectionDirty(new Vec3(chunkX, y, chunkZ))\r\n    }\r\n  }\r\n\r\n  async doHmr () {\r\n    const oldSections = { ...this.sectionObjects }\r\n    this.sectionObjects = {} // skip clearing\r\n    worldView!.unloadAllChunks()\r\n    void this.setVersion(this.version, this.texturesVersion)\r\n    this.sectionObjects = oldSections\r\n    // this.rerenderAllChunks()\r\n\r\n    // supply new data\r\n    await worldView!.updatePosition(bot.entity.position, true)\r\n  }\r\n\r\n  rerenderAllChunks () { // todo not clear what to do with loading chunks\r\n    for (const key of Object.keys(this.sectionObjects)) {\r\n      const [x, y, z] = key.split(',').map(Number)\r\n      this.setSectionDirty(new Vec3(x, y, z))\r\n    }\r\n  }\r\n\r\n  updateShowChunksBorder (value: boolean) {\r\n    this.config.showChunkBorders = value\r\n    for (const object of Object.values(this.sectionObjects)) {\r\n      for (const child of object.children) {\r\n        if (child.name === 'helper') {\r\n          child.visible = value\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  resetWorld () {\r\n    super.resetWorld()\r\n\r\n    for (const mesh of Object.values(this.sectionObjects)) {\r\n      this.scene.remove(mesh)\r\n    }\r\n  }\r\n\r\n  getLoadedChunksRelative (pos: Vec3, includeY = false) {\r\n    const [currentX, currentY, currentZ] = sectionPos(pos)\r\n    return Object.fromEntries(Object.entries(this.sectionObjects).map(([key, o]) => {\r\n      const [xRaw, yRaw, zRaw] = key.split(',').map(Number)\r\n      const [x, y, z] = sectionPos({ x: xRaw, y: yRaw, z: zRaw })\r\n      const setKey = includeY ? `${x - currentX},${y - currentY},${z - currentZ}` : `${x - currentX},${z - currentZ}`\r\n      return [setKey, o]\r\n    }))\r\n  }\r\n\r\n  cleanChunkTextures (x, z) {\r\n    const textures = this.chunkTextures.get(`${Math.floor(x / 16)},${Math.floor(z / 16)}`) ?? {}\r\n    for (const key of Object.keys(textures)) {\r\n      textures[key].dispose()\r\n      delete textures[key]\r\n    }\r\n  }\r\n\r\n  readdChunks () {\r\n    for (const key of Object.keys(this.sectionObjects)) {\r\n      this.scene.remove(this.sectionObjects[key])\r\n    }\r\n    setTimeout(() => {\r\n      for (const key of Object.keys(this.sectionObjects)) {\r\n        this.scene.add(this.sectionObjects[key])\r\n      }\r\n    }, 500)\r\n  }\r\n\r\n  disableUpdates (children = this.scene.children) {\r\n    for (const child of children) {\r\n      child.matrixWorldNeedsUpdate = false\r\n      this.disableUpdates(child.children ?? [])\r\n    }\r\n  }\r\n\r\n  removeColumn (x, z) {\r\n    super.removeColumn(x, z)\r\n\r\n    this.cleanChunkTextures(x, z)\r\n    for (let y = this.worldConfig.minY; y < this.worldConfig.worldHeight; y += 16) {\r\n      this.setSectionDirty(new Vec3(x, y, z), false)\r\n      const key = `${x},${y},${z}`\r\n      const mesh = this.sectionObjects[key]\r\n      if (mesh) {\r\n        this.scene.remove(mesh)\r\n        disposeObject(mesh)\r\n      }\r\n      delete this.sectionObjects[key]\r\n    }\r\n  }\r\n\r\n  setSectionDirty (...args: Parameters<WorldRendererCommon['setSectionDirty']>) {\r\n    const [pos] = args\r\n    this.cleanChunkTextures(pos.x, pos.z) // todo don't do this!\r\n    super.setSectionDirty(...args)\r\n  }\r\n\r\n  setHighlightCursorBlock (blockPos: typeof this.cursorBlock, shapePositions?: Array<{ position: any; width: any; height: any; depth: any; }>): void {\r\n    this.cursorBlock = blockPos\r\n    if (blockPos && this.interactionLines && blockPos.equals(this.interactionLines.blockPos)) {\r\n      return\r\n    }\r\n    if (this.interactionLines !== null) {\r\n      this.scene.remove(this.interactionLines.mesh)\r\n      this.interactionLines = null\r\n    }\r\n    if (blockPos === null) {\r\n      return\r\n    }\r\n\r\n    const group = new THREE.Group()\r\n    for (const { position, width, height, depth } of shapePositions ?? []) {\r\n      const scale = [1.0001 * width, 1.0001 * height, 1.0001 * depth] as const\r\n      const geometry = new THREE.BoxGeometry(...scale)\r\n      const lines = new LineSegmentsGeometry().fromEdgesGeometry(new THREE.EdgesGeometry(geometry))\r\n      const wireframe = new Wireframe(lines, this.threejsCursorLineMaterial)\r\n      const pos = blockPos.plus(position)\r\n      wireframe.position.set(pos.x, pos.y, pos.z)\r\n      wireframe.computeLineDistances()\r\n      group.add(wireframe)\r\n    }\r\n    this.scene.add(group)\r\n    this.interactionLines = { blockPos, mesh: group }\r\n  }\r\n\r\n  static getRendererInfo (renderer: THREE.WebGLRenderer) {\r\n    try {\r\n      const gl = renderer.getContext()\r\n      return `${gl.getParameter(gl.getExtension('WEBGL_debug_renderer_info')!.UNMASKED_RENDERER_WEBGL)}`\r\n    } catch (err) {\r\n      console.warn('Failed to get renderer info', err)\r\n    }\r\n  }\r\n}\r\n\r\nclass StarField {\r\n  points?: THREE.Points\r\n  private _enabled = true\r\n  get enabled () {\r\n    return this._enabled\r\n  }\r\n\r\n  set enabled (value) {\r\n    this._enabled = value\r\n    if (this.points) {\r\n      this.points.visible = value\r\n    }\r\n  }\r\n\r\n  constructor (private readonly scene: THREE.Scene) {\r\n  }\r\n\r\n  addToScene () {\r\n    if (this.points || !this.enabled) return\r\n\r\n    const radius = 80\r\n    const depth = 50\r\n    const count = 7000\r\n    const factor = 7\r\n    const saturation = 10\r\n    const speed = 0.2\r\n\r\n    const geometry = new THREE.BufferGeometry()\r\n\r\n    const genStar = r => new THREE.Vector3().setFromSpherical(new THREE.Spherical(r, Math.acos(1 - Math.random() * 2), Math.random() * 2 * Math.PI))\r\n\r\n    const positions = [] as number[]\r\n    const colors = [] as number[]\r\n    const sizes = Array.from({ length: count }, () => (0.5 + 0.5 * Math.random()) * factor)\r\n    const color = new THREE.Color()\r\n    let r = radius + depth\r\n    const increment = depth / count\r\n    for (let i = 0; i < count; i++) {\r\n      r -= increment * Math.random()\r\n      positions.push(...genStar(r).toArray())\r\n      color.setHSL(i / count, saturation, 0.9)\r\n      colors.push(color.r, color.g, color.b)\r\n    }\r\n\r\n    geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3))\r\n    geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3))\r\n    geometry.setAttribute('size', new THREE.Float32BufferAttribute(sizes, 1))\r\n\r\n    // Create a material\r\n    const material = new StarfieldMaterial()\r\n    material.blending = THREE.AdditiveBlending\r\n    material.depthTest = false\r\n    material.transparent = true\r\n\r\n    // Create points and add them to the scene\r\n    this.points = new THREE.Points(geometry, material)\r\n    this.scene.add(this.points)\r\n\r\n    const clock = new THREE.Clock()\r\n    this.points.onBeforeRender = (renderer, scene, camera) => {\r\n      this.points?.position.copy?.(camera.position)\r\n      material.uniforms.time.value = clock.getElapsedTime() * speed\r\n    }\r\n    this.points.renderOrder = -1\r\n  }\r\n\r\n  remove () {\r\n    if (this.points) {\r\n      this.points.geometry.dispose();\r\n      (this.points.material as THREE.Material).dispose()\r\n      this.scene.remove(this.points)\r\n\r\n      this.points = undefined\r\n    }\r\n  }\r\n}\r\n\r\nconst version = parseInt(THREE.REVISION.replaceAll(/\\D+/g, ''), 10)\r\nclass StarfieldMaterial extends THREE.ShaderMaterial {\r\n  constructor () {\r\n    super({\r\n      uniforms: { time: { value: 0 }, fade: { value: 1 } },\r\n      vertexShader: /* glsl */ `\r\n                uniform float time;\r\n                attribute float size;\r\n                varying vec3 vColor;\r\n                attribute vec3 color;\r\n                void main() {\r\n                vColor = color;\r\n                vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);\r\n                gl_PointSize = 0.7 * size * (30.0 / -mvPosition.z) * (3.0 + sin(time + 100.0));\r\n                gl_Position = projectionMatrix * mvPosition;\r\n            }`,\r\n      fragmentShader: /* glsl */ `\r\n                uniform sampler2D pointTexture;\r\n                uniform float fade;\r\n                varying vec3 vColor;\r\n                void main() {\r\n                float opacity = 1.0;\r\n                gl_FragColor = vec4(vColor, 1.0);\r\n\r\n                #include <tonemapping_fragment>\r\n                #include <${version >= 154 ? 'colorspace_fragment' : 'encodings_fragment'}>\r\n            }`,\r\n    })\r\n  }\r\n}\r\n","export const versionToNumber = (ver: string) => {\r\n  const [x, y = '0', z = '0'] = ver.split('.')\r\n  return +`${x.padStart(2, '0')}${y.padStart(2, '0')}${z.padStart(2, '0')}`\r\n}\r\n\r\nexport const versionToMajor = (version: string) => {\r\n  const [x, y = '0'] = version.split('.')\r\n  return `${x.padStart(2, '0')}.${y.padStart(2, '0')}`\r\n}\r\n\r\nexport const versionsMapToMajor = <T> (versionsMap: Record<string, T>) => {\r\n  const majorVersions = {} as Record<string, T>\r\n  for (const [ver, data] of Object.entries(versionsMap)) {\r\n    const major = versionToMajor(ver)\r\n    majorVersions[major] = data\r\n  }\r\n  return majorVersions\r\n}\r\n","import { fromFormattedString, render, RenderNode, TextComponent } from '@xmcl/text-component'\r\nimport type { ChatMessage } from 'prismarine-chat'\r\n\r\ntype SignBlockEntity = {\r\n  Color?: string\r\n  GlowingText?: 0 | 1\r\n  Text1?: string\r\n  Text2?: string\r\n  Text3?: string\r\n  Text4?: string\r\n} | {\r\n  // todo\r\n  is_waxed?: 0 | 1\r\n  front_text: {\r\n    color: string\r\n    messages: string[]\r\n    // todo\r\n    has_glowing_text?: 0 | 1\r\n  }\r\n  // todo\r\n  // back_text: {}\r\n}\r\n\r\ntype JsonEncodedType = string | null | Record<string, any>\r\n\r\nconst parseSafe = (text: string, task: string) => {\r\n  try {\r\n    return JSON.parse(text)\r\n  } catch (e) {\r\n    console.warn(`Failed to parse ${task}`, e)\r\n    return null\r\n  }\r\n}\r\n\r\nexport const renderSign = (blockEntity: SignBlockEntity, PrismarineChat: typeof ChatMessage, ctxHook = (ctx) => { }) => {\r\n  // todo don't use texture rendering, investigate the font rendering when possible\r\n  // or increase factor when needed\r\n  const factor = 40\r\n  const signboardY = [16, 9]\r\n  const heightOffset = signboardY[0] - signboardY[1]\r\n  const heightScalar = heightOffset / 16\r\n\r\n  let canvas: HTMLCanvasElement | undefined\r\n  let _ctx: CanvasRenderingContext2D | null = null\r\n  const getCtx = () => {\r\n    if (_ctx) return _ctx\r\n    canvas = document.createElement('canvas')\r\n\r\n    canvas.width = 16 * factor\r\n    canvas.height = heightOffset * factor\r\n\r\n    _ctx = canvas.getContext('2d')!\r\n    _ctx.imageSmoothingEnabled = false\r\n\r\n    ctxHook(_ctx)\r\n    return _ctx\r\n  }\r\n\r\n  const texts = 'front_text' in blockEntity ? /* > 1.20 */ blockEntity.front_text.messages : [\r\n    blockEntity.Text1,\r\n    blockEntity.Text2,\r\n    blockEntity.Text3,\r\n    blockEntity.Text4\r\n  ]\r\n  const defaultColor = ('front_text' in blockEntity ? blockEntity.front_text.color : blockEntity.Color) || 'black'\r\n  for (const [lineNum, text] of texts.slice(0, 4).entries()) {\r\n    // todo: in pre flatenning it seems the format was not json\r\n    if (text === 'null') continue\r\n    const parsed = text?.startsWith('{') || text?.startsWith('\"') ? parseSafe(text ?? '\"\"', 'sign text') : text\r\n    if (!parsed || (typeof parsed !== 'object' && typeof parsed !== 'string')) continue\r\n    // todo fix type\r\n    const message = typeof parsed === 'string' ? fromFormattedString(parsed) : new PrismarineChat(parsed) as never\r\n    const patchExtra = ({ extra }: TextComponent) => {\r\n      if (!extra) return\r\n      for (const child of extra) {\r\n        if (child.color) {\r\n          child.color = child.color === 'dark_green' ? child.color.toUpperCase() : child.color.toLowerCase()\r\n        }\r\n        patchExtra(child)\r\n      }\r\n    }\r\n    patchExtra(message)\r\n    const rendered = render(message)\r\n\r\n    const toRenderCanvas: Array<{\r\n      fontStyle: string\r\n      fillStyle: string\r\n      underlineStyle: boolean\r\n      strikeStyle: boolean\r\n      text: string\r\n    }> = []\r\n    let plainText = ''\r\n    // todo the text should be clipped based on it's render width (needs investigate)\r\n    const MAX_LENGTH = 50 // avoid abusing the signboard\r\n    const renderText = (node: RenderNode) => {\r\n      const { component } = node\r\n      let { text } = component\r\n      if (plainText.length + text.length > MAX_LENGTH) {\r\n        text = text.slice(0, MAX_LENGTH - plainText.length)\r\n        if (!text) return false\r\n      }\r\n      plainText += text\r\n      toRenderCanvas.push({\r\n        fontStyle: `${component.bold ? 'bold' : ''} ${component.italic ? 'italic' : ''}`,\r\n        fillStyle: node.style['color'] || defaultColor,\r\n        underlineStyle: component.underlined ?? false,\r\n        strikeStyle: component.strikethrough ?? false,\r\n        text\r\n      })\r\n      for (const child of node.children) {\r\n        const stop = renderText(child) === false\r\n        if (stop) return false\r\n      }\r\n    }\r\n\r\n    renderText(rendered)\r\n\r\n    // skip rendering empty lines (and possible signs)\r\n    if (!plainText.trim()) continue\r\n\r\n    const ctx = getCtx()\r\n    const fontSize = 1.6 * factor\r\n    ctx.font = `${fontSize}px mojangles`\r\n    const textWidth = ctx.measureText(plainText).width\r\n\r\n    let renderedWidth = 0\r\n    for (const { fillStyle, fontStyle, strikeStyle, text, underlineStyle } of toRenderCanvas) {\r\n      // todo strikeStyle, underlineStyle\r\n      ctx.fillStyle = fillStyle\r\n      ctx.font = `${fontStyle} ${fontSize}px mojangles`\r\n      ctx.fillText(text, (canvas!.width - textWidth) / 2 + renderedWidth, fontSize * (lineNum + 1))\r\n      renderedWidth += ctx.measureText(text).width // todo isn't the font is monospace?\r\n    }\r\n  }\r\n  // ctx.fillStyle = 'red'\r\n  // ctx.fillRect(0, 0, canvas.width, canvas.height)\r\n\r\n  return canvas\r\n}\r\n","globalThis.resolveDnsFallback = async (hostname: string) => {\r\n  const response = await fetchServerStatus(hostname)\r\n  return response?.raw.srv_record ?? undefined\r\n}\r\n\r\nexport const isServerValid = (ip: string) => {\r\n  const isInLocalNetwork = ip.startsWith('192.168.') ||\r\n    ip.startsWith('10.') ||\r\n    ip.startsWith('172.') ||\r\n    ip.startsWith('127.') ||\r\n    ip.startsWith('localhost') ||\r\n    ip.startsWith(':')\r\n  const VALID_IP_OR_DOMAIN = ip.includes('.')\r\n\r\n  return !isInLocalNetwork && VALID_IP_OR_DOMAIN\r\n}\r\n\r\nexport async function fetchServerStatus (ip: string, signal?: AbortSignal, versionOverride?: string) {\r\n  if (!isServerValid(ip)) return\r\n\r\n  const response = await fetch(`https://api.mcstatus.io/v2/status/java/${ip}`, { signal })\r\n  const data: ServerResponse = await response.json()\r\n  const versionClean = data.version?.name_raw.replace(/^[^\\d.]+/, '')\r\n\r\n  return {\r\n    formattedText: data.motd?.raw ?? '',\r\n    textNameRight: data.online ?\r\n      `${versionOverride ?? versionClean} ${data.players?.online ?? '??'}/${data.players?.max ?? '??'}` :\r\n      '',\r\n    icon: data.icon,\r\n    offline: !data.online,\r\n    raw: data\r\n  }\r\n}\r\n\r\nexport type ServerResponse = {\r\n  online: boolean\r\n  version?: {\r\n    name_raw: string\r\n  }\r\n  // display tooltip\r\n  players?: {\r\n    online: number\r\n    max: number\r\n    list: Array<{\r\n      name_raw: string\r\n      name_clean: string\r\n    }>\r\n  }\r\n  icon?: string\r\n  motd?: {\r\n    raw: string\r\n  }\r\n  // todo circle error icon\r\n  mods?: Array<{ name: string, version: string }>\r\n  // todo display via hammer icon\r\n  software?: string\r\n  plugins?: Array<{ name, version }>\r\n  // port?: number\r\n  srv_record?: {\r\n    host: string\r\n    port: number\r\n  }\r\n}\r\n","import { disabledSettings, options, qsOptions } from './optionsStorage'\r\nimport { miscUiState } from './globalState'\r\nimport { setLoadingScreenStatus } from './appStatus'\r\nimport { setStorageDataOnAppConfigLoad } from './react/appStorageProvider'\r\n\r\nexport type AppConfig = {\r\n  // defaultHost?: string\r\n  // defaultHostSave?: string\r\n  defaultProxy?: string\r\n  // defaultProxySave?: string\r\n  // defaultVersion?: string\r\n  peerJsServer?: string\r\n  peerJsServerFallback?: string\r\n  promoteServers?: Array<{ ip, description, version? }>\r\n  mapsProvider?: string\r\n\r\n  appParams?: Record<string, any> // query string params\r\n\r\n  defaultSettings?: Record<string, any>\r\n  forceSettings?: Record<string, boolean>\r\n  // hideSettings?: Record<string, boolean>\r\n  allowAutoConnect?: boolean\r\n  pauseLinks?: Array<Array<Record<string, any>>>\r\n}\r\n\r\nexport const loadAppConfig = (appConfig: AppConfig) => {\r\n  if (miscUiState.appConfig) {\r\n    Object.assign(miscUiState.appConfig, appConfig)\r\n  } else {\r\n    miscUiState.appConfig = appConfig\r\n  }\r\n\r\n  if (appConfig.forceSettings) {\r\n    for (const [key, value] of Object.entries(appConfig.forceSettings)) {\r\n      if (value) {\r\n        disabledSettings.value.add(key)\r\n        // since the setting is forced, we need to set it to that value\r\n        if (appConfig.defaultSettings?.[key] && !qsOptions[key]) {\r\n          options[key] = appConfig.defaultSettings[key]\r\n        }\r\n      } else {\r\n        disabledSettings.value.delete(key)\r\n      }\r\n    }\r\n  }\r\n\r\n  setStorageDataOnAppConfigLoad()\r\n}\r\n\r\nexport const isBundledConfigUsed = !!process.env.INLINED_APP_CONFIG\r\n\r\nif (isBundledConfigUsed) {\r\n  loadAppConfig(process.env.INLINED_APP_CONFIG as AppConfig ?? {})\r\n} else {\r\n  void window.fetch('config.json').then(async res => res.json()).then(c => c, (error) => {\r\n  // console.warn('Failed to load optional app config.json', error)\r\n  // return {}\r\n    setLoadingScreenStatus('Failed to load app config.json', true)\r\n  }).then((config: AppConfig) => {\r\n    loadAppConfig(config)\r\n  })\r\n}\r\n","import type { AppConfig } from './appConfig'\r\nimport { miscUiState } from './globalState'\r\n\r\nconst qsParams = new URLSearchParams(window.location?.search ?? '')\r\n\r\nexport type AppQsParams = {\r\n  // AddServerOrConnect.tsx params\r\n  ip?: string\r\n  name?: string\r\n  version?: string\r\n  proxy?: string\r\n  username?: string\r\n  lockConnect?: string\r\n  autoConnect?: string\r\n  // googledrive.ts params\r\n  state?: string\r\n  // ServersListProvider.tsx params\r\n  serversList?: string\r\n  // Map and texture params\r\n  texturepack?: string\r\n  map?: string\r\n  mapDirBaseUrl?: string\r\n  mapDirGuess?: string\r\n  // Singleplayer params\r\n  singleplayer?: string\r\n  sp?: string\r\n  loadSave?: string\r\n  // Server params\r\n  reconnect?: string\r\n  server?: string\r\n  // Peer connection params\r\n  connectPeer?: string\r\n  peerVersion?: string\r\n  // UI params\r\n  modal?: string\r\n  viewerConnect?: string\r\n  // Map version param\r\n  mapVersion?: string\r\n  // Command params\r\n  command?: string\r\n  // Misc params\r\n  suggest_save?: string\r\n  noPacketsValidation?: string\r\n  testCrashApp?: string\r\n\r\n  // Replay params\r\n  replayFilter?: string\r\n  replaySpeed?: string\r\n  replayFileUrl?: string\r\n  replayValidateClient?: string\r\n  replayStopOnError?: string\r\n  replaySkipMissingOnTimeout?: string\r\n  replayPacketsSenderDelay?: string\r\n}\r\n\r\nexport type AppQsParamsArray = {\r\n  mapDir?: string[]\r\n  setting?: string[]\r\n  serverSetting?: string[]\r\n  command?: string[]\r\n}\r\n\r\ntype AppQsParamsArrayTransformed = {\r\n  [k in keyof AppQsParamsArray]: string[]\r\n}\r\n\r\nglobalThis.process ??= {} as any\r\nconst initialAppConfig = process?.env?.INLINED_APP_CONFIG as AppConfig ?? {}\r\n\r\nexport const appQueryParams = new Proxy<AppQsParams>({} as AppQsParams, {\r\n  get (target, property) {\r\n    if (typeof property !== 'string') {\r\n      return undefined\r\n    }\r\n    const qsParam = qsParams.get(property)\r\n    if (qsParam) return qsParam\r\n    return miscUiState.appConfig?.appParams?.[property]\r\n  },\r\n})\r\n\r\nexport const appQueryParamsArray = new Proxy({} as AppQsParamsArrayTransformed, {\r\n  get (target, property) {\r\n    if (typeof property !== 'string') {\r\n      return null\r\n    }\r\n    const qsParam = qsParams.getAll(property)\r\n    if (qsParam.length) return qsParam\r\n    return miscUiState.appConfig?.appParams?.[property] ?? []\r\n  },\r\n})\r\n\r\nexport function updateQsParam (name: keyof AppQsParams, value: string | undefined) {\r\n  const url = new URL(window.location.href)\r\n  if (value) {\r\n    url.searchParams.set(name, value)\r\n  } else {\r\n    url.searchParams.delete(name)\r\n  }\r\n  window.history.replaceState({}, '', url.toString())\r\n}\r\n\r\n// Helper function to check if a specific query parameter exists\r\nexport const hasQueryParam = (param: keyof AppQsParams) => qsParams.has(param)\r\n\r\n// Helper function to get all query parameters as a URLSearchParams object\r\nexport const getRawQueryParams = () => qsParams;\r\n\r\n(globalThis as any).debugQueryParams = Object.fromEntries(qsParams.entries())\r\n","import { hideModal, activeModalStack, showModal, miscUiState } from './globalState'\r\nimport { appStatusState, resetAppStatusState } from './react/AppStatusProvider'\r\n\r\nlet ourLastStatus: string | undefined = ''\r\nexport const setLoadingScreenStatus = function (status: string | undefined | null, isError = false, hideDots = false, fromFlyingSquid = false, minecraftJsonMessage?: Record<string, any>) {\r\n  // null can come from flying squid, should restore our last status\r\n  if (status === null) {\r\n    status = ourLastStatus\r\n  } else if (!fromFlyingSquid) {\r\n    ourLastStatus = status\r\n  }\r\n  fromFlyingSquid = false\r\n\r\n  if (status === undefined) {\r\n    appStatusState.status = ''\r\n\r\n    hideModal({ reactType: 'app-status' }, {}, { force: true })\r\n    return\r\n  }\r\n\r\n  if (!activeModalStack.some(x => x.reactType === 'app-status')) {\r\n    // just showing app status\r\n    resetAppStatusState()\r\n  }\r\n  showModal({ reactType: 'app-status' })\r\n  if (appStatusState.isError) {\r\n    miscUiState.gameLoaded = false\r\n    return\r\n  }\r\n  appStatusState.hideDots = hideDots\r\n  appStatusState.isError = isError\r\n  appStatusState.lastStatus = isError ? appStatusState.status : ''\r\n  appStatusState.status = status\r\n  appStatusState.minecraftJsonMessage = minecraftJsonMessage ?? null\r\n}\r\nglobalThis.setLoadingScreenStatus = setLoadingScreenStatus\r\n","import { subscribeKey } from 'valtio/utils'\r\nimport { options } from './optionsStorage'\r\nimport { isCypress } from './standaloneUtils'\r\nimport { reportWarningOnce } from './utils'\r\n\r\nlet audioContext: AudioContext\r\nconst sounds: Record<string, any> = {}\r\n\r\n// Track currently playing sounds and their gain nodes\r\nconst activeSounds: Array<{ source: AudioBufferSourceNode; gainNode: GainNode; volumeMultiplier: number }> = []\r\nwindow.activeSounds = activeSounds\r\n\r\n// load as many resources on page load as possible instead on demand as user can disable internet connection after he thinks the page is loaded\r\nconst loadingSounds = [] as string[]\r\nconst convertedSounds = [] as string[]\r\n\r\nexport async function loadSound (path: string, contents = path) {\r\n  if (loadingSounds.includes(path)) return true\r\n  loadingSounds.push(path)\r\n\r\n  try {\r\n    audioContext ??= new window.AudioContext()\r\n\r\n    const res = await window.fetch(contents)\r\n    if (!res.ok) {\r\n      const error = `Failed to load sound ${path}`\r\n      if (isCypress()) throw new Error(error)\r\n      else console.warn(error)\r\n      return\r\n    }\r\n    const arrayBuffer = await res.arrayBuffer()\r\n\r\n    // Decode the audio data immediately\r\n    const audioBuffer = await audioContext.decodeAudioData(arrayBuffer)\r\n    sounds[path] = audioBuffer\r\n    convertedSounds.push(path) // Mark as converted immediately\r\n\r\n    loadingSounds.splice(loadingSounds.indexOf(path), 1)\r\n  } catch (err) {\r\n    console.warn(`Failed to load sound ${path}:`, err)\r\n    loadingSounds.splice(loadingSounds.indexOf(path), 1)\r\n    if (isCypress()) throw err\r\n  }\r\n}\r\n\r\nexport const loadOrPlaySound = async (url, soundVolume = 1, loadTimeout = 500) => {\r\n  const soundBuffer = sounds[url]\r\n  if (!soundBuffer) {\r\n    const start = Date.now()\r\n    const cancelled = await loadSound(url)\r\n    if (cancelled || Date.now() - start > loadTimeout) return\r\n  }\r\n\r\n  return playSound(url, soundVolume)\r\n}\r\n\r\nexport async function playSound (url, soundVolume = 1) {\r\n  const volume = soundVolume * (options.volume / 100)\r\n\r\n  if (!volume) return\r\n\r\n  try {\r\n    audioContext ??= new window.AudioContext()\r\n  } catch (err) {\r\n    reportWarningOnce('audioContext', 'Failed to create audio context. Some sounds will not play')\r\n    return\r\n  }\r\n\r\n  const soundBuffer = sounds[url]\r\n  if (!soundBuffer) {\r\n    console.warn(`Sound ${url} not loaded yet`)\r\n    return\r\n  }\r\n\r\n  const gainNode = audioContext.createGain()\r\n  const source = audioContext.createBufferSource()\r\n  source.buffer = soundBuffer\r\n  source.connect(gainNode)\r\n  gainNode.connect(audioContext.destination)\r\n  gainNode.gain.value = volume\r\n  source.start(0)\r\n\r\n  // Add to active sounds\r\n  activeSounds.push({ source, gainNode, volumeMultiplier: soundVolume })\r\n\r\n  const callbacks = [] as Array<() => void>\r\n  source.onended = () => {\r\n    // Remove from active sounds when finished\r\n    const index = activeSounds.findIndex(s => s.source === source)\r\n    if (index !== -1) activeSounds.splice(index, 1)\r\n\r\n    for (const callback of callbacks) {\r\n      callback()\r\n    }\r\n    callbacks.length = 0\r\n  }\r\n\r\n  return {\r\n    onEnded (callback: () => void) {\r\n      callbacks.push(callback)\r\n    },\r\n  }\r\n}\r\n\r\nexport function stopAllSounds () {\r\n  for (const { source } of activeSounds) {\r\n    try {\r\n      source.stop()\r\n    } catch (err) {\r\n      console.warn('Failed to stop sound:', err)\r\n    }\r\n  }\r\n  activeSounds.length = 0\r\n}\r\n\r\nexport function changeVolumeOfCurrentlyPlayingSounds (newVolume: number) {\r\n  const normalizedVolume = newVolume / 100\r\n  for (const { gainNode, volumeMultiplier } of activeSounds) {\r\n    try {\r\n      gainNode.gain.value = normalizedVolume * volumeMultiplier\r\n    } catch (err) {\r\n      console.warn('Failed to change sound volume:', err)\r\n    }\r\n  }\r\n}\r\n\r\nsubscribeKey(options, 'volume', () => {\r\n  changeVolumeOfCurrentlyPlayingSounds(options.volume)\r\n})\r\n","import { versionToNumber } from 'renderer/viewer/prepare/utils'\r\nimport * as nbt from 'prismarine-nbt'\r\n\r\nexport const displayClientChat = (text: string) => {\r\n  const message = {\r\n    text\r\n  }\r\n  if (versionToNumber(bot.version) >= versionToNumber('1.19')) {\r\n    bot._client.emit('systemChat', {\r\n      formattedMessage: JSON.stringify(message),\r\n      position: 0,\r\n      sender: 'minecraft:chat'\r\n    })\r\n    return\r\n  }\r\n  bot._client.emit('chat', {\r\n    message: JSON.stringify(message),\r\n    position: 0,\r\n    sender: 'minecraft:chat'\r\n  })\r\n}\r\n\r\nexport const parseFormattedMessagePacket = (arg) => {\r\n  // if (typeof arg === 'string') {\r\n  //   try {\r\n  //     arg = JSON.parse(arg)\r\n  //     return {\r\n  //       formatted: arg,\r\n  //       plain: ''\r\n  //     }\r\n  //   } catch {}\r\n  // }\r\n  if (typeof arg === 'object') {\r\n    try {\r\n      return {\r\n        formatted: nbt.simplify(arg),\r\n        plain: ''\r\n      }\r\n    } catch (err) {\r\n      console.warn('Failed to parse formatted message', arg, err)\r\n      return {\r\n        plain: JSON.stringify(arg)\r\n      }\r\n    }\r\n  }\r\n  return {\r\n    plain: String(arg)\r\n  }\r\n}\r\n","import { join } from 'path'\r\nimport { promisify } from 'util'\r\nimport fs from 'fs'\r\nimport sanitizeFilename from 'sanitize-filename'\r\nimport { oneOf } from '@zardoy/utils'\r\nimport * as browserfs from 'browserfs'\r\nimport { options, resetOptions } from './optionsStorage'\r\n\r\nimport { fsState, loadSave } from './loadSave'\r\nimport { installResourcepackPack, installTexturePackFromHandle, updateTexturePackInstalledState } from './resourcePack'\r\nimport { miscUiState } from './globalState'\r\nimport { setLoadingScreenStatus } from './appStatus'\r\nimport { VALID_REPLAY_EXTENSIONS, openFile } from './packetsReplay/replayPackets'\r\nimport { getFixedFilesize } from './downloadAndOpenFile'\r\nimport { packetsReplayState } from './react/state/packetsReplayState'\r\nimport { createFullScreenProgressReporter } from './core/progressReporter'\r\nimport { showNotification } from './react/NotificationProvider'\r\nimport { resetAppStorage } from './react/appStorageProvider'\r\nconst { GoogleDriveFileSystem } = require('google-drive-browserfs/src/backends/GoogleDrive')\r\n\r\nbrowserfs.install(window)\r\nconst defaultMountablePoints = {\r\n  '/data': { fs: 'IndexedDB' },\r\n  '/resourcepack': { fs: 'InMemory' }, // temporary storage for currently loaded resource pack\r\n  '/temp': { fs: 'InMemory' }\r\n}\r\nconst fallbackMountablePoints = {\r\n  '/resourcepack': { fs: 'InMemory' }, // temporary storage for downloaded server resource pack\r\n  '/temp': { fs: 'InMemory' }\r\n}\r\nbrowserfs.configure({\r\n  fs: 'MountableFileSystem',\r\n  options: defaultMountablePoints,\r\n}, async (e) => {\r\n  if (e) {\r\n    browserfs.configure({\r\n      fs: 'MountableFileSystem',\r\n      options: fallbackMountablePoints,\r\n    }, async (e2) => {\r\n      if (e2) {\r\n        showNotification('Unknown FS error, cannot continue', e2.message, true)\r\n        throw e2\r\n      }\r\n      showNotification('Failed to access device storage', `Check you have free space. ${e.message}`, true)\r\n      miscUiState.fsReady = true\r\n      miscUiState.singleplayerAvailable = false\r\n    })\r\n    return\r\n  }\r\n  await updateTexturePackInstalledState()\r\n  miscUiState.fsReady = true\r\n  miscUiState.singleplayerAvailable = true\r\n})\r\n\r\nexport const forceCachedDataPaths = {}\r\nexport const forceRedirectPaths = {}\r\n\r\nwindow.fs = fs\r\n//@ts-expect-error\r\nfs.promises = new Proxy(Object.fromEntries(['readFile', 'writeFile', 'stat', 'mkdir', 'rmdir', 'unlink', 'rename', /* 'copyFile',  */'readdir'].map(key => [key, promisify(fs[key])])), {\r\n  get (target, p: string, receiver) {\r\n    if (!target[p]) throw new Error(`Not implemented fs.promises.${p}`)\r\n    return (...args) => {\r\n      // browser fs bug: if path doesn't start with / dirname will return . which would cause infinite loop, so we need to normalize paths\r\n      if (typeof args[0] === 'string' && !args[0].startsWith('/')) args[0] = '/' + args[0]\r\n      const toRemap = Object.entries(forceRedirectPaths).find(([from]) => args[0].startsWith(from))\r\n      if (toRemap) {\r\n        args[0] = args[0].replace(toRemap[0], toRemap[1])\r\n      }\r\n      // Write methods\r\n      // todo issue one-time warning (in chat I guess)\r\n      const readonly = fsState.isReadonly && !(args[0].startsWith('/data') && !fsState.inMemorySave) // allow copying worlds from external providers such as zip\r\n      if (readonly) {\r\n        if (oneOf(p, 'readFile', 'writeFile') && forceCachedDataPaths[args[0]]) {\r\n          if (p === 'readFile') {\r\n            return Promise.resolve(forceCachedDataPaths[args[0]])\r\n          } else if (p === 'writeFile') {\r\n            forceCachedDataPaths[args[0]] = args[1]\r\n            console.debug('Skipped writing to readonly fs', args[0])\r\n            return Promise.resolve()\r\n          }\r\n        }\r\n        if (oneOf(p, 'writeFile', 'mkdir', 'rename')) return\r\n      }\r\n      if (p === 'open' && fsState.isReadonly) {\r\n        args[1] = 'r' // read-only, zipfs throw otherwise\r\n      }\r\n      if (p === 'readFile') {\r\n        fsState.openReadOperations++\r\n      } else if (p === 'writeFile') {\r\n        fsState.openWriteOperations++\r\n      }\r\n      return target[p](...args).finally(() => {\r\n        if (p === 'readFile') {\r\n          fsState.openReadOperations--\r\n        } else if (p === 'writeFile') {\r\n          fsState.openWriteOperations--\r\n        }\r\n      })\r\n    }\r\n  }\r\n})\r\n//@ts-expect-error\r\nfs.promises.open = async (...args) => {\r\n  //@ts-expect-error\r\n  const fd = await promisify(fs.open)(...args)\r\n  return {\r\n    ...Object.fromEntries(['read', 'write', 'close'].map(x => [x, async (...args) => {\r\n      return new Promise(resolve => {\r\n        // todo it results in world corruption on interactions eg block placements\r\n        if (x === 'write' && fsState.isReadonly) {\r\n          resolve({ buffer: Buffer.from([]), bytesRead: 0 })\r\n          return\r\n        }\r\n\r\n        if (x === 'read') {\r\n          fsState.openReadOperations++\r\n        } else if (x === 'write' || x === 'close') {\r\n          fsState.openWriteOperations++\r\n        }\r\n        fs[x](fd, ...args, (err, bytesRead, buffer) => {\r\n          if (x === 'read') {\r\n            fsState.openReadOperations--\r\n          } else if (x === 'write' || x === 'close') {\r\n            // todo that's not correct\r\n            fsState.openWriteOperations--\r\n          }\r\n          if (err) throw err\r\n          // todo if readonly probably there is no need to open at all (return some mocked version - check reload)?\r\n          if (x === 'write' && !fsState.isReadonly) {\r\n            // flush data, though alternatively we can rely on close in unload\r\n            fs.fsync(fd, () => { })\r\n          }\r\n          resolve({ buffer, bytesRead })\r\n        })\r\n      })\r\n    }])),\r\n    // for debugging\r\n    fd,\r\n    filename: args[0],\r\n    async close () {\r\n      return new Promise<void>(resolve => {\r\n        fs.close(fd, (err) => {\r\n          if (err) {\r\n            throw err\r\n          } else {\r\n            resolve()\r\n          }\r\n        })\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\n// for testing purposes, todo move it to core patch\r\nconst removeFileRecursiveSync = (path) => {\r\n  for (const file of fs.readdirSync(path)) {\r\n    const curPath = join(path, file)\r\n    if (fs.lstatSync(curPath).isDirectory()) {\r\n      // recurse\r\n      removeFileRecursiveSync(curPath)\r\n      fs.rmdirSync(curPath)\r\n    } else {\r\n      // delete file\r\n      fs.unlinkSync(curPath)\r\n    }\r\n  }\r\n}\r\n\r\nwindow.removeFileRecursiveSync = removeFileRecursiveSync\r\n\r\nexport const mkdirRecursive = async (path: string) => {\r\n  const parts = path.split('/')\r\n  let current = ''\r\n  for (const part of parts) {\r\n    current += part + '/'\r\n    try {\r\n      // eslint-disable-next-line no-await-in-loop\r\n      await fs.promises.mkdir(current)\r\n    } catch (err) {\r\n    }\r\n  }\r\n}\r\n\r\nexport const uniqueFileNameFromWorldName = async (title: string, savePath: string) => {\r\n  const name = sanitizeFilename(title)\r\n  let resultPath!: string\r\n  // getUniqueFolderName\r\n  let i = 0\r\n  let free = false\r\n  while (!free) {\r\n    try {\r\n      resultPath = `${savePath.replace(/\\$/, '')}/${name}${i === 0 ? '' : `-${i}`}`\r\n      // eslint-disable-next-line no-await-in-loop\r\n      await fs.promises.stat(resultPath)\r\n      i++\r\n    } catch (err) {\r\n      free = true\r\n    }\r\n  }\r\n  return resultPath\r\n}\r\n\r\nexport const mountExportFolder = async () => {\r\n  let handle: FileSystemDirectoryHandle\r\n  try {\r\n    handle = await showDirectoryPicker({\r\n      id: 'world-export',\r\n    })\r\n  } catch (err) {\r\n    if (err instanceof DOMException && err.name === 'AbortError') return\r\n    throw err\r\n  }\r\n  if (!handle) return false\r\n  await new Promise<void>(resolve => {\r\n    browserfs.configure({\r\n      fs: 'MountableFileSystem',\r\n      options: {\r\n        ...defaultMountablePoints,\r\n        '/export': {\r\n          fs: 'FileSystemAccess',\r\n          options: {\r\n            handle\r\n          }\r\n        }\r\n      },\r\n    }, (e) => {\r\n      if (e) throw e\r\n      resolve()\r\n    })\r\n  })\r\n  return true\r\n}\r\n\r\nlet googleDriveFileSystem\r\n\r\n/** Only cached! */\r\nexport const googleDriveGetFileIdFromPath = (path: string) => {\r\n  return googleDriveFileSystem._getExistingFileId(path)\r\n}\r\n\r\nexport const mountGoogleDriveFolder = async (readonly: boolean, rootId: string) => {\r\n  googleDriveFileSystem = new GoogleDriveFileSystem()\r\n  googleDriveFileSystem.rootDirId = rootId\r\n  googleDriveFileSystem.isReadonly = readonly\r\n  await new Promise<void>(resolve => {\r\n    browserfs.configure({\r\n      fs: 'MountableFileSystem',\r\n      options: {\r\n        ...defaultMountablePoints,\r\n        '/google': googleDriveFileSystem\r\n      },\r\n    }, (e) => {\r\n      if (e) throw e\r\n      resolve()\r\n    })\r\n  })\r\n  fsState.isReadonly = readonly\r\n  fsState.syncFs = false\r\n  fsState.inMemorySave = false\r\n  fsState.remoteBackend = true\r\n  return true\r\n}\r\n\r\nexport async function removeFileRecursiveAsync (path) {\r\n  const errors = [] as Array<[string, Error]>\r\n  try {\r\n    const files = await fs.promises.readdir(path)\r\n\r\n    // Use Promise.all to parallelize file/directory removal\r\n    await Promise.all(files.map(async (file) => {\r\n      const curPath = join(path, file)\r\n      const stats = await fs.promises.stat(curPath)\r\n      if (stats.isDirectory()) {\r\n        // Recurse\r\n        await removeFileRecursiveAsync(curPath)\r\n      } else {\r\n        // Delete file\r\n        await fs.promises.unlink(curPath)\r\n      }\r\n    }))\r\n\r\n    // After removing all files/directories, remove the current directory\r\n    await fs.promises.rmdir(path)\r\n  } catch (error) {\r\n    errors.push([path, error])\r\n  }\r\n\r\n  if (errors.length) {\r\n    setTimeout(() => {\r\n      console.error(errors)\r\n      throw new Error(`Error removing directories/files: ${errors.map(([path, err]) => `${path}: ${err.message}`).join(', ')}`)\r\n    })\r\n  }\r\n}\r\n\r\n\r\nconst SUPPORT_WRITE = true\r\n\r\nexport const openWorldDirectory = async (dragndropHandle?: FileSystemDirectoryHandle) => {\r\n  let _directoryHandle: FileSystemDirectoryHandle\r\n  if (dragndropHandle) {\r\n    _directoryHandle = dragndropHandle\r\n  } else {\r\n    try {\r\n      _directoryHandle = await window.showDirectoryPicker({\r\n        id: 'select-world', // important: this is used to remember user choice (start directory)\r\n      })\r\n    } catch (err) {\r\n      if (err instanceof DOMException && err.name === 'AbortError') return\r\n      throw err\r\n    }\r\n  }\r\n  const directoryHandle = _directoryHandle\r\n\r\n  const requestResult = SUPPORT_WRITE && !options.preferLoadReadonly ? await directoryHandle.requestPermission?.({ mode: 'readwrite' }) : undefined\r\n  const writeAccess = requestResult === 'granted'\r\n\r\n  const doContinue = writeAccess || !SUPPORT_WRITE || options.disableLoadPrompts || confirm('Continue in readonly mode?')\r\n  if (!doContinue) return\r\n  await new Promise<void>(resolve => {\r\n    browserfs.configure({\r\n      fs: 'MountableFileSystem',\r\n      options: {\r\n        ...defaultMountablePoints,\r\n        '/world': {\r\n          fs: 'FileSystemAccess',\r\n          options: {\r\n            handle: directoryHandle\r\n          }\r\n        }\r\n      },\r\n    }, (e) => {\r\n      if (e) throw e\r\n      resolve()\r\n    })\r\n  })\r\n\r\n  fsState.isReadonly = !writeAccess\r\n  fsState.syncFs = false\r\n  fsState.inMemorySave = false\r\n  fsState.remoteBackend = false\r\n  await loadSave()\r\n}\r\n\r\nconst tryToDetectResourcePack = async () => {\r\n  const askInstall = async () => {\r\n    // todo investigate browserfs read errors\r\n    return alert('ATM You can install texturepacks only via options menu.')\r\n    // if (confirm('Resource pack detected, do you want to install it?')) {\r\n    //   await installTexturePackFromHandle()\r\n    // }\r\n  }\r\n\r\n  if (fs.existsSync('/world/pack.mcmeta')) {\r\n    await askInstall()\r\n    return true\r\n  }\r\n  // const jszip = new JSZip()\r\n  // let loaded = await jszip.loadAsync(file)\r\n  // if (loaded.file('pack.mcmeta')) {\r\n  //   loaded = null\r\n  //   askInstall()\r\n  //   return true\r\n  // }\r\n  // loaded = null\r\n}\r\n\r\nexport const possiblyCleanHandle = (callback = () => { }) => {\r\n  if (!fsState.saveLoaded) {\r\n    // todo clean handle\r\n    browserfs.configure({\r\n      fs: 'MountableFileSystem',\r\n      options: defaultMountablePoints,\r\n    }, (e) => {\r\n      callback()\r\n      if (e) throw e\r\n    })\r\n  }\r\n}\r\n\r\nconst readdirSafe = async (path: string) => {\r\n  try {\r\n    return await fs.promises.readdir(path)\r\n  } catch (err) {\r\n    return null\r\n  }\r\n}\r\n\r\nexport const collectFilesToCopy = async (basePath: string, safe = false): Promise<string[]> => {\r\n  const result: string[] = []\r\n  const countFiles = async (relPath: string) => {\r\n    const resolvedPath = join(basePath, relPath)\r\n    const files = relPath === '.' && !safe ? await fs.promises.readdir(resolvedPath) : await readdirSafe(resolvedPath)\r\n    if (!files) return null\r\n    await Promise.all(files.map(async file => {\r\n      const res = await countFiles(join(relPath, file))\r\n      if (res === null) {\r\n        // is file\r\n        result.push(join(relPath, file))\r\n      }\r\n    }))\r\n  }\r\n  await countFiles('.')\r\n  return result\r\n}\r\n\r\nexport const copyFilesAsyncWithProgress = async (pathSrc: string, pathDest: string, throwRootNotExist = true, addMsg = '') => {\r\n  const stat = await existsViaStats(pathSrc)\r\n  if (!stat) {\r\n    if (throwRootNotExist) throw new Error(`Cannot copy. Source directory ${pathSrc} does not exist`)\r\n    console.debug('source directory does not exist', pathSrc)\r\n    return\r\n  }\r\n  if (!stat.isDirectory()) {\r\n    await fs.promises.writeFile(pathDest, await fs.promises.readFile(pathSrc) as any)\r\n    console.debug('copied single file', pathSrc, pathDest)\r\n    return\r\n  }\r\n\r\n  try {\r\n    setLoadingScreenStatus('Copying files')\r\n    let filesCount = 0\r\n    const countFiles = async (path: string) => {\r\n      const files = await fs.promises.readdir(path)\r\n      await Promise.all(files.map(async (file) => {\r\n        const curPath = join(path, file)\r\n        const stats = await fs.promises.stat(curPath)\r\n        if (stats.isDirectory()) {\r\n          // Recurse\r\n          await countFiles(curPath)\r\n        } else {\r\n          filesCount++\r\n        }\r\n      }))\r\n    }\r\n    console.debug('Counting files', pathSrc)\r\n    await countFiles(pathSrc)\r\n    console.debug('counted', filesCount)\r\n    let copied = 0\r\n    await copyFilesAsync(pathSrc, pathDest, (name) => {\r\n      copied++\r\n      setLoadingScreenStatus(`Copying files${addMsg} (${copied}/${filesCount}): ${name}`)\r\n    })\r\n  } finally {\r\n    setLoadingScreenStatus(undefined)\r\n  }\r\n}\r\n\r\nexport const existsViaStats = async (path: string) => {\r\n  try {\r\n    return await fs.promises.stat(path)\r\n  } catch (e) {\r\n    return false\r\n  }\r\n}\r\n\r\nexport const fileExistsAsyncOptimized = async (path: string) => {\r\n  try {\r\n    await fs.promises.readdir(path)\r\n  } catch (err) {\r\n    if (err.code === 'ENOTDIR') return true\r\n    // eslint-disable-next-line sonarjs/prefer-single-boolean-return\r\n    if (err.code === 'ENOENT') return false\r\n    // throw err\r\n    return false\r\n  }\r\n  return true\r\n}\r\n\r\nexport const copyFilesAsync = async (pathSrc: string, pathDest: string, fileCopied?: (name) => void) => {\r\n  // query: can't use fs.copy! use fs.promises.writeFile and readFile\r\n  const files = await fs.promises.readdir(pathSrc)\r\n\r\n  if (!await existsViaStats(pathDest)) {\r\n    await fs.promises.mkdir(pathDest, { recursive: true })\r\n  }\r\n\r\n  // Use Promise.all to parallelize file/directory copying\r\n  await Promise.all(files.map(async (file) => {\r\n    const curPathSrc = join(pathSrc, file)\r\n    const curPathDest = join(pathDest, file)\r\n    const stats = await fs.promises.stat(curPathSrc)\r\n    if (stats.isDirectory()) {\r\n      // Recurse\r\n      await fs.promises.mkdir(curPathDest)\r\n      await copyFilesAsync(curPathSrc, curPathDest, fileCopied)\r\n    } else {\r\n      // Copy file\r\n      try {\r\n        await fs.promises.writeFile(curPathDest, await fs.promises.readFile(curPathSrc) as any)\r\n        console.debug('copied file', curPathSrc, curPathDest)\r\n      } catch (err) {\r\n        console.error('Error copying file', curPathSrc, curPathDest, err)\r\n        throw err\r\n      }\r\n      fileCopied?.(curPathDest)\r\n    }\r\n  }))\r\n}\r\n\r\nexport const openWorldFromHttpDir = async (fileDescriptorUrls: string[]/*  | undefined */, baseUrlParam) => {\r\n  // todo try go guess mode\r\n  let index\r\n  let baseUrl\r\n  for (const url of fileDescriptorUrls) {\r\n    let file\r\n    try {\r\n      setLoadingScreenStatus(`Trying to get world descriptor from ${new URL(url).host}`)\r\n      const controller = new AbortController()\r\n      setTimeout(() => {\r\n        controller.abort()\r\n      }, 3000)\r\n      // eslint-disable-next-line no-await-in-loop\r\n      const response = await fetch(url, { signal: controller.signal })\r\n      // eslint-disable-next-line no-await-in-loop\r\n      file = await response.json()\r\n    } catch (err) {\r\n      console.error('Error fetching file descriptor', url, err)\r\n    }\r\n    if (!file) continue\r\n    if (file.baseUrl) {\r\n      baseUrl = new URL(file.baseUrl, baseUrl).toString()\r\n      index = file.index\r\n    } else {\r\n      index = file\r\n      baseUrl = baseUrlParam ?? url.split('/').slice(0, -1).join('/')\r\n    }\r\n    break\r\n  }\r\n  if (!index) throw new Error(`The provided mapDir file is not valid descriptor file! ${fileDescriptorUrls.join(', ')}`)\r\n  await new Promise<void>(async resolve => {\r\n    browserfs.configure({\r\n      fs: 'MountableFileSystem',\r\n      options: {\r\n        ...defaultMountablePoints,\r\n        '/world': {\r\n          fs: 'HTTPRequest',\r\n          options: {\r\n            index,\r\n            baseUrl\r\n          }\r\n        }\r\n      },\r\n    }, (e) => {\r\n      if (e) throw e\r\n      resolve()\r\n    })\r\n  })\r\n\r\n  fsState.saveLoaded = false\r\n  fsState.isReadonly = true\r\n  fsState.syncFs = false\r\n  fsState.inMemorySave = false\r\n  fsState.remoteBackend = true\r\n\r\n  await loadSave()\r\n}\r\n\r\n// todo rename method\r\nconst openWorldZipInner = async (file: File | ArrayBuffer, name = file['name']) => {\r\n  await new Promise<void>(async resolve => {\r\n    browserfs.configure({\r\n      // todo\r\n      fs: 'MountableFileSystem',\r\n      options: {\r\n        ...defaultMountablePoints,\r\n        '/world': {\r\n          fs: 'ZipFS',\r\n          options: {\r\n            zipData: Buffer.from(file instanceof File ? (await file.arrayBuffer()) : file),\r\n            name\r\n          }\r\n        }\r\n      },\r\n    }, (e) => {\r\n      if (e) throw e\r\n      resolve()\r\n    })\r\n  })\r\n\r\n  fsState.saveLoaded = false\r\n  fsState.isReadonly = true\r\n  fsState.syncFs = true\r\n  fsState.inMemorySave = false\r\n  fsState.remoteBackend = false\r\n\r\n  if (fs.existsSync('/world/level.dat')) {\r\n    await loadSave()\r\n  } else {\r\n    const dirs = fs.readdirSync('/world')\r\n    const availableWorlds: string[] = []\r\n    for (const dir of dirs) {\r\n      if (fs.existsSync(`/world/${dir}/level.dat`)) {\r\n        availableWorlds.push(dir)\r\n      }\r\n    }\r\n\r\n    if (availableWorlds.length === 0) {\r\n      if (await tryToDetectResourcePack()) return\r\n      alert('No worlds found in the zip')\r\n      return\r\n    }\r\n\r\n    if (availableWorlds.length === 1) {\r\n      await loadSave(`/world/${availableWorlds[0]}`)\r\n      return\r\n    }\r\n\r\n    alert(`Many (${availableWorlds.length}) worlds found in the zip!`)\r\n    // todo prompt picker\r\n    // const selectWorld\r\n  }\r\n}\r\n\r\nexport const openWorldZip = async (...args: Parameters<typeof openWorldZipInner>) => {\r\n  try {\r\n    return await openWorldZipInner(...args)\r\n  } finally {\r\n    possiblyCleanHandle()\r\n  }\r\n}\r\n\r\nexport const resetLocalStorage = () => {\r\n  resetOptions()\r\n  resetAppStorage()\r\n}\r\n\r\nwindow.resetLocalStorage = resetLocalStorage\r\n\r\nexport const openFilePicker = (specificCase?: 'resourcepack') => {\r\n  // create and show input picker\r\n  let picker: HTMLInputElement = document.body.querySelector('input#file-zip-picker')!\r\n  if (!picker) {\r\n    picker = document.createElement('input')\r\n    picker.type = 'file'\r\n    picker.accept = specificCase ? '.zip' : [...VALID_REPLAY_EXTENSIONS, '.zip'].join(',')\r\n\r\n    picker.addEventListener('change', () => {\r\n      const file = picker.files?.[0]\r\n      picker.value = ''\r\n      if (!file) return\r\n      if (specificCase === 'resourcepack') {\r\n        if (!file.name.endsWith('.zip')) {\r\n          const doContinue = confirm(`Are you sure ${file.name.slice(-20)} is .zip file? ONLY .zip files are supported. Continue?`)\r\n          if (!doContinue) return\r\n        }\r\n        void installResourcepackPack(file, createFullScreenProgressReporter()).catch((err) => {\r\n          setLoadingScreenStatus(err.message, true)\r\n        })\r\n      } else {\r\n        // eslint-disable-next-line no-lonely-if\r\n        if (VALID_REPLAY_EXTENSIONS.some(ext => file.name.endsWith(ext)) || file.name.startsWith('packets-replay')) {\r\n          void file.text().then(contents => {\r\n            openFile({\r\n              contents,\r\n              filename: file.name,\r\n              filesize: file.size\r\n            })\r\n          })\r\n        } else {\r\n          void openWorldZip(file)\r\n        }\r\n      }\r\n    })\r\n    picker.hidden = true\r\n    document.body.appendChild(picker)\r\n  }\r\n\r\n  picker.click()\r\n}\r\n\r\nexport const resetStateAfterDisconnect = () => {\r\n  miscUiState.gameLoaded = false\r\n  miscUiState.loadedDataVersion = null\r\n  miscUiState.singleplayer = false\r\n  miscUiState.flyingSquid = false\r\n  miscUiState.wanOpened = false\r\n  miscUiState.currentDisplayQr = null\r\n\r\n  fsState.saveLoaded = false\r\n}\r\n","import fs from 'fs'\r\nimport { join } from 'path'\r\nimport JSZip from 'jszip'\r\nimport { readLevelDat } from './loadSave'\r\nimport { closeWan, openToWanAndCopyJoinLink } from './localServerMultiplayer'\r\nimport { copyFilesAsync, uniqueFileNameFromWorldName } from './browserfs'\r\nimport { saveServer } from './flyingSquidUtils'\r\nimport { setLoadingScreenStatus } from './appStatus'\r\nimport { displayClientChat } from './botUtils'\r\n\r\nconst notImplemented = () => {\r\n  return 'Not implemented yet'\r\n}\r\n\r\nasync function addFolderToZip (folderPath, zip, relativePath) {\r\n  const entries = await fs.promises.readdir(folderPath)\r\n\r\n  for (const entry of entries) {\r\n    const entryPath = join(folderPath, entry)\r\n    const stats = await fs.promises.stat(entryPath)\r\n\r\n    const zipEntryPath = join(relativePath, entry)\r\n\r\n    if (stats.isDirectory()) {\r\n      const subZip = zip.folder(zipEntryPath)\r\n      await addFolderToZip(entryPath, subZip, zipEntryPath)\r\n    } else {\r\n      const fileData = await fs.promises.readFile(entryPath)\r\n      zip.file(entry, fileData)\r\n    }\r\n  }\r\n}\r\n\r\nexport const exportWorld = async (path: string, type: 'zip' | 'folder', zipName = 'world-prismarine-exported') => {\r\n  try {\r\n    if (type === 'zip') {\r\n      setLoadingScreenStatus('Generating zip, this may take a few minutes')\r\n      const zip = new JSZip()\r\n      await addFolderToZip(path, zip, '')\r\n\r\n      // Generate the ZIP archive content\r\n      const zipContent = await zip.generateAsync({ type: 'blob' })\r\n\r\n      // Create a download link and trigger the download\r\n      const downloadLink = document.createElement('a')\r\n      downloadLink.href = URL.createObjectURL(zipContent)\r\n      // todo use loaded zip/folder name\r\n      downloadLink.download = `${zipName}.zip`\r\n      downloadLink.click()\r\n\r\n      // Clean up the URL object after download\r\n      URL.revokeObjectURL(downloadLink.href)\r\n    } else {\r\n      setLoadingScreenStatus('Preparing export folder')\r\n      let dest = '/'\r\n      if ((await fs.promises.readdir('/export')).length) {\r\n        const { levelDat } = (await readLevelDat(path))!\r\n        dest = await uniqueFileNameFromWorldName(levelDat.LevelName, path)\r\n      }\r\n      setLoadingScreenStatus(`Copying files to ${dest} of selected folder`)\r\n      await copyFilesAsync(path, '/export' + dest)\r\n    }\r\n  } finally {\r\n    setLoadingScreenStatus(undefined)\r\n  }\r\n}\r\n\r\n// todo include in help\r\nconst exportLoadedWorld = async () => {\r\n  await saveServer()\r\n  let { worldFolder } = localServer!.options\r\n  if (!worldFolder.startsWith('/')) worldFolder = `/${worldFolder}`\r\n  await exportWorld(worldFolder, 'zip')\r\n}\r\n\r\nwindow.exportWorld = exportLoadedWorld\r\n\r\nconst writeText = (text) => {\r\n  displayClientChat(text)\r\n}\r\n\r\nexport const commands: Array<{\r\n  command: string[],\r\n  alwaysAvailable?: boolean,\r\n  invoke (args: string[]): Promise<void> | void\r\n  //@ts-format-ignore-region\r\n}> = [\r\n  {\r\n    command: ['/download', '/export'],\r\n    invoke: exportLoadedWorld\r\n  },\r\n  {\r\n    command: ['/publish', '/share'],\r\n    async invoke () {\r\n      const text = await openToWanAndCopyJoinLink(writeText)\r\n      if (text) writeText(text)\r\n    }\r\n  },\r\n  {\r\n    command: ['/close'],\r\n    invoke () {\r\n      const text = closeWan()\r\n      if (text) writeText(text)\r\n    }\r\n  },\r\n  {\r\n    command: ['/save'],\r\n    async invoke () {\r\n      await saveServer(false)\r\n      writeText('Saved to browser memory')\r\n    }\r\n  },\r\n  {\r\n    command: ['/pos'],\r\n    alwaysAvailable: true,\r\n    async invoke ([type]) {\r\n      let pos: { x: number, y: number, z: number } | undefined\r\n      if (type === 'block') {\r\n        const blockPos = window.cursorBlockRel()?.position\r\n        if (blockPos) {\r\n          pos = { x: blockPos.x, y: blockPos.y, z: blockPos.z }\r\n        }\r\n      } else {\r\n        const playerPos = bot.entity.position\r\n        pos = { x: playerPos.x, y: playerPos.y, z: playerPos.z }\r\n      }\r\n      if (!pos) return\r\n      const formatted = `${pos.x.toFixed(2)} ${pos.y.toFixed(2)} ${pos.z.toFixed(2)}`\r\n      await navigator.clipboard.writeText(formatted)\r\n      writeText(`Copied position to clipboard: ${formatted}`)\r\n    }\r\n  }\r\n]\r\n//@ts-format-ignore-endregion\r\n\r\nexport const getBuiltinCommandsList = () => commands.filter(command => command.alwaysAvailable || localServer).flatMap(command => command.command)\r\n\r\nexport const tryHandleBuiltinCommand = (message: string) => {\r\n  const [userCommand, ...args] = message.split(' ')\r\n\r\n  for (const command of commands.filter(command => command.alwaysAvailable || localServer)) {\r\n    if (command.command.includes(userCommand)) {\r\n      void command.invoke(args) // ignoring for now\r\n      return true\r\n    }\r\n  }\r\n}\r\n","import { contro } from './controls'\r\nimport { activeModalStack, isGameActive, miscUiState, showModal } from './globalState'\r\nimport { options } from './optionsStorage'\r\nimport { hideNotification, notificationProxy } from './react/NotificationProvider'\r\nimport { pointerLock } from './utils'\r\nimport { updateMotion, initMotionTracking } from './react/uiMotion'\r\n\r\nlet lastMouseMove: number\r\n\r\nexport type CameraMoveEvent = {\r\n  movementX: number\r\n  movementY: number\r\n  type: string\r\n  stopPropagation?: () => void\r\n}\r\n\r\nexport function onCameraMove (e: MouseEvent | CameraMoveEvent) {\r\n  if (!isGameActive(true)) return\r\n  if (e.type === 'mousemove' && !document.pointerLockElement) return\r\n  e.stopPropagation?.()\r\n  const now = performance.now()\r\n  // todo: limit camera movement for now to avoid unexpected jumps\r\n  if (now - lastMouseMove < 4 && !options.preciseMouseInput) return\r\n  lastMouseMove = now\r\n  let { mouseSensX, mouseSensY } = options\r\n  if (mouseSensY === -1) mouseSensY = mouseSensX\r\n  moveCameraRawHandler({\r\n    x: e.movementX * mouseSensX * 0.0001,\r\n    y: e.movementY * mouseSensY * 0.0001\r\n  })\r\n  bot.mouse.update()\r\n  updateMotion()\r\n}\r\n\r\n\r\nexport const moveCameraRawHandler = ({ x, y }: { x: number; y: number }) => {\r\n  const maxPitch = 0.5 * Math.PI\r\n  const minPitch = -0.5 * Math.PI\r\n\r\n  viewer.world.lastCamUpdate = Date.now()\r\n\r\n  if (viewer.world.freeFlyMode) {\r\n    // Update freeFlyState directly\r\n    viewer.world.freeFlyState.yaw = (viewer.world.freeFlyState.yaw - x) % (2 * Math.PI)\r\n    viewer.world.freeFlyState.pitch = Math.max(minPitch, Math.min(maxPitch, viewer.world.freeFlyState.pitch - y))\r\n    return\r\n  }\r\n\r\n  if (!bot?.entity) return\r\n  const pitch = bot.entity.pitch - y\r\n  void bot.look(bot.entity.yaw - x, Math.max(minPitch, Math.min(maxPitch, pitch)), true)\r\n}\r\n\r\nwindow.addEventListener('mousemove', (e: MouseEvent) => {\r\n  onCameraMove(e)\r\n}, { capture: true })\r\n\r\nexport const onControInit = () => {\r\n  contro.on('stickMovement', ({ stick, vector }) => {\r\n    if (!isGameActive(true)) return\r\n    if (stick !== 'right') return\r\n    let { x, z } = vector\r\n    if (Math.abs(x) < 0.18) x = 0\r\n    if (Math.abs(z) < 0.18) z = 0\r\n    onCameraMove({\r\n      movementX: x * 10,\r\n      movementY: z * 10,\r\n      type: 'stickMovement',\r\n      stopPropagation () {}\r\n    } as CameraMoveEvent)\r\n    miscUiState.usingGamepadInput = true\r\n  })\r\n}\r\n\r\nfunction pointerLockChangeCallback () {\r\n  if (notificationProxy.id === 'pointerlockchange') {\r\n    hideNotification()\r\n  }\r\n  if (viewer.renderer.xr.isPresenting) return // todo\r\n  if (!pointerLock.hasPointerLock && activeModalStack.length === 0 && miscUiState.gameLoaded) {\r\n    showModal({ reactType: 'pause-screen' })\r\n  }\r\n}\r\n\r\ndocument.addEventListener('pointerlockchange', pointerLockChangeCallback, false)\r\n","// this should actually be moved to mineflayer / renderer\r\n\r\nimport { fromFormattedString, TextComponent } from '@xmcl/text-component'\r\nimport type { IndexedData } from 'minecraft-data'\r\nimport { versionToNumber } from 'renderer/viewer/prepare/utils'\r\n\r\nexport type MessageFormatPart = Pick<TextComponent, 'hoverEvent' | 'clickEvent'> & {\r\n  text: string\r\n  color?: string\r\n  bold?: boolean\r\n  italic?: boolean\r\n  underlined?: boolean\r\n  strikethrough?: boolean\r\n  obfuscated?: boolean\r\n}\r\n\r\ntype MessageInput = {\r\n  text?: string\r\n  translate?: string\r\n  with?: Array<MessageInput | string>\r\n  color?: string\r\n  bold?: boolean\r\n  italic?: boolean\r\n  underlined?: boolean\r\n  strikethrough?: boolean\r\n  obfuscated?: boolean\r\n  extra?: MessageInput[]\r\n  json?: any\r\n}\r\n\r\nconst global = globalThis as any\r\n\r\n// todo move to sign-renderer, replace with prismarine-chat, fix mcData issue!\r\nexport const formatMessage = (message: MessageInput, mcData: IndexedData = global.loadedData) => {\r\n  let msglist: MessageFormatPart[] = []\r\n\r\n  const readMsg = (msg: MessageInput) => {\r\n    const styles = {\r\n      color: msg.color,\r\n      bold: !!msg.bold,\r\n      italic: !!msg.italic,\r\n      underlined: !!msg.underlined,\r\n      strikethrough: !!msg.strikethrough,\r\n      obfuscated: !!msg.obfuscated\r\n    }\r\n\r\n    if (!msg.text && typeof msg.json?.[''] === 'string') msg.text = msg.json['']\r\n    if (msg.text) {\r\n      msglist.push({\r\n        ...msg,\r\n        text: msg.text,\r\n        ...styles\r\n      })\r\n    } else if (msg.translate) {\r\n      const tText = mcData?.language[msg.translate] ?? msg.translate\r\n\r\n      if (msg.with) {\r\n        const splitted = tText.split(/%s|%\\d+\\$s/g)\r\n\r\n        let i = 0\r\n        for (const [j, part] of splitted.entries()) {\r\n          msglist.push({ text: part, ...styles })\r\n\r\n          if (j + 1 < splitted.length) {\r\n            if (msg.with[i]) {\r\n              const msgWith = msg.with[i]\r\n              if (typeof msgWith === 'string') {\r\n                readMsg({\r\n                  ...styles,\r\n                  text: msgWith\r\n                })\r\n              } else {\r\n                readMsg({\r\n                  ...styles,\r\n                  ...msgWith\r\n                })\r\n              }\r\n            }\r\n            i++\r\n          }\r\n        }\r\n      } else {\r\n        msglist.push({\r\n          ...msg,\r\n          text: tText,\r\n          ...styles\r\n        })\r\n      }\r\n    }\r\n\r\n    if (msg.extra) {\r\n      for (const ex of msg.extra) {\r\n        readMsg({ ...styles, ...ex })\r\n      }\r\n    }\r\n  }\r\n\r\n  readMsg(message)\r\n\r\n  const flat = (msg) => {\r\n    return [msg, msg.extra?.flatMap(flat) ?? []]\r\n  }\r\n\r\n  msglist = msglist.map(msg => {\r\n    // normalize \r\n    if (!msg.text.includes?.('')) return msg\r\n    const newMsg = fromFormattedString(msg.text)\r\n    return flat(newMsg)\r\n  }).flat(Infinity)\r\n\r\n  return msglist\r\n}\r\n\r\nconst blockToItemRemaps = {\r\n  water: 'water_bucket',\r\n  lava: 'lava_bucket',\r\n  redstone_wire: 'redstone',\r\n  tripwire: 'tripwire_hook'\r\n}\r\n\r\nexport const getItemFromBlock = (block: import('prismarine-block').Block) => {\r\n  const item = global.loadedData.itemsByName[blockToItemRemaps[block.name] ?? block.name]\r\n  return item\r\n}\r\n","// import { versionsByMinecraftVersion } from 'minecraft-data'\r\n// import minecraftInitialDataJson from '../generated/minecraft-initial-data.json'\r\nimport MinecraftData from 'minecraft-data'\r\nimport PrismarineBlock from 'prismarine-block'\r\nimport PrismarineItem from 'prismarine-item'\r\nimport pathfinder from 'mineflayer-pathfinder'\r\nimport { importLargeData } from '../generated/large-data-aliases'\r\nimport { miscUiState } from './globalState'\r\nimport supportedVersions from './supportedVersions.mjs'\r\nimport { options } from './optionsStorage'\r\nimport { downloadSoundsIfNeeded } from './sounds/botSoundSystem'\r\nimport { AuthenticatedAccount } from './react/serversStorage'\r\n\r\nexport type ConnectOptions = {\r\n  server?: string\r\n  singleplayer?: any\r\n  username: string\r\n  proxy?: string\r\n  botVersion?: any\r\n  serverOverrides?\r\n  serverOverridesFlat?\r\n  peerId?: string\r\n  ignoreQs?: boolean\r\n  onSuccessfulPlay?: () => void\r\n  autoLoginPassword?: string\r\n  serverIndex?: string\r\n  /** If true, will show a UI to authenticate with a new account */\r\n  authenticatedAccount?: AuthenticatedAccount | true\r\n  peerOptions?: any\r\n  viewerWsConnect?: string\r\n  saveServerToHistory?: boolean\r\n\r\n  /** Will enable local replay server */\r\n  worldStateFileContents?: string\r\n}\r\n\r\nexport const getVersionAutoSelect = (autoVersionSelect = options.serversAutoVersionSelect) => {\r\n  if (autoVersionSelect === 'auto') {\r\n    return '1.19.4'\r\n  }\r\n  if (autoVersionSelect === 'latest') {\r\n    return supportedVersions.at(-1)!\r\n  }\r\n  return autoVersionSelect\r\n}\r\n\r\nexport const loadMinecraftData = async (version: string, importBlockstatesModels = false) => {\r\n  await window._LOAD_MC_DATA()\r\n  // setLoadingScreenStatus(`Loading data for ${version}`)\r\n  // // todo expose cache\r\n  // // const initialDataVersion = Object.keys(minecraftInitialDataJson)[0]!\r\n  // // if (version === initialDataVersion) {\r\n  // //   // ignore cache hit\r\n  // //   versionsByMinecraftVersion.pc[initialDataVersion]!.dataVersion!++\r\n  // // }\r\n\r\n  const mcData = MinecraftData(version)\r\n  window.PrismarineBlock = PrismarineBlock(mcData.version.minecraftVersion!)\r\n  window.PrismarineItem = PrismarineItem(mcData.version.minecraftVersion!)\r\n  window.loadedData = mcData\r\n  window.pathfinder = pathfinder\r\n  miscUiState.loadedDataVersion = version\r\n\r\n  if (importBlockstatesModels) {\r\n    viewer.world.blockstatesModels = await importLargeData('blockStatesModels')\r\n  }\r\n}\r\n\r\nexport const downloadAllMinecraftData = async () => {\r\n  await window._LOAD_MC_DATA()\r\n}\r\n\r\nconst loadFonts = async () => {\r\n  const FONT_FAMILY = 'mojangles'\r\n  if (!document.fonts.check(`1em ${FONT_FAMILY}`)) {\r\n    // todo instead re-render signs on load\r\n    await document.fonts.load(`1em ${FONT_FAMILY}`).catch(() => {\r\n      console.error('Failed to load font, signs wont be rendered correctly')\r\n    })\r\n  }\r\n}\r\n\r\nexport const downloadOtherGameData = async () => {\r\n  await Promise.all([loadFonts(), downloadSoundsIfNeeded()])\r\n}\r\n","//@ts-check\r\n\r\nimport { Vec3 } from 'vec3'\r\nimport { proxy, subscribe } from 'valtio'\r\nimport * as THREE from 'three'\r\n\r\nimport { ControMax } from 'contro-max/build/controMax'\r\nimport { CommandEventArgument, SchemaCommandInput } from 'contro-max/build/types'\r\nimport { stringStartsWith } from 'contro-max/build/stringUtils'\r\nimport { UserOverrideCommand, UserOverridesConfig } from 'contro-max/build/types/store'\r\nimport { GameMode } from 'mineflayer'\r\nimport { isGameActive, showModal, gameAdditionalState, activeModalStack, hideCurrentModal, miscUiState, hideModal, hideAllModals } from './globalState'\r\nimport { goFullscreen, isInRealGameSession, pointerLock, reloadChunks } from './utils'\r\nimport { options } from './optionsStorage'\r\nimport { openPlayerInventory } from './inventoryWindows'\r\nimport { chatInputValueGlobal } from './react/Chat'\r\nimport { fsState } from './loadSave'\r\nimport { customCommandsConfig } from './customCommands'\r\nimport type { CustomCommand } from './react/KeybindingsCustom'\r\nimport { showOptionsModal } from './react/SelectOption'\r\nimport widgets from './react/widgets'\r\nimport { getItemFromBlock } from './chatUtils'\r\nimport { gamepadUiCursorState, moveGamepadCursorByPx } from './react/GamepadUiCursor'\r\nimport { completeResourcepackPackInstall, copyServerResourcePackToRegular, resourcePackState } from './resourcePack'\r\nimport { showNotification } from './react/NotificationProvider'\r\nimport { lastConnectOptions } from './react/AppStatusProvider'\r\nimport { onCameraMove, onControInit } from './cameraRotationControls'\r\nimport { createNotificationProgressReporter } from './core/progressReporter'\r\nimport { appStorage } from './react/appStorageProvider'\r\nimport { switchGameMode } from './packetsReplay/replayPackets'\r\n\r\n\r\nexport const customKeymaps = proxy(appStorage.keybindings)\r\nsubscribe(customKeymaps, () => {\r\n  appStorage.keybindings = customKeymaps\r\n})\r\n\r\nconst controlOptions = {\r\n  preventDefault: true\r\n}\r\n\r\nexport const contro = new ControMax({\r\n  commands: {\r\n    general: {\r\n      jump: ['Space', 'A'],\r\n      inventory: ['KeyE', 'X'],\r\n      drop: ['KeyQ', 'B'],\r\n      sneak: ['ShiftLeft'],\r\n      toggleSneakOrDown: [null, 'Right Stick'],\r\n      sprint: ['ControlLeft', 'Left Stick'],\r\n      nextHotbarSlot: [null, 'Right Bumper'],\r\n      prevHotbarSlot: [null, 'Left Bumper'],\r\n      attackDestroy: [null, 'Right Trigger'],\r\n      interactPlace: [null, 'Left Trigger'],\r\n      chat: [['KeyT', 'Enter']],\r\n      command: ['Slash'],\r\n      swapHands: ['KeyF'],\r\n      zoom: ['KeyC'],\r\n      selectItem: ['KeyH'], // default will be removed\r\n      rotateCameraLeft: [null],\r\n      rotateCameraRight: [null],\r\n      rotateCameraUp: [null],\r\n      rotateCameraDown: [null],\r\n      viewerConsole: ['Backquote']\r\n    },\r\n    ui: {\r\n      toggleFullscreen: ['F11'],\r\n      back: [null/* 'Escape' */, 'B'],\r\n      toggleMap: ['KeyM'],\r\n      leftClick: [null, 'A'],\r\n      rightClick: [null, 'Y'],\r\n      speedupCursor: [null, 'Left Stick'],\r\n      pauseMenu: [null, 'Start']\r\n    },\r\n    advanced: {\r\n      lockUrl: ['KeyY'],\r\n    },\r\n    custom: {} as Record<string, SchemaCommandInput & { type: string, input: any[] }>,\r\n    // waila: {\r\n    //   showLookingBlockRecipe: ['Numpad3'],\r\n    //   showLookingBlockUsages: ['Numpad4']\r\n    // }\r\n  } satisfies Record<string, Record<string, SchemaCommandInput>>,\r\n  movementKeymap: 'WASD',\r\n  movementVector: '2d',\r\n  groupedCommands: {\r\n    general: {\r\n      switchSlot: ['Digits', []]\r\n    }\r\n  },\r\n}, {\r\n  defaultControlOptions: controlOptions,\r\n  target: document,\r\n  captureEvents () {\r\n    return true\r\n  },\r\n  storeProvider: {\r\n    load: () => customKeymaps,\r\n    save () { },\r\n  },\r\n  gamepadPollingInterval: 10\r\n})\r\nwindow.controMax = contro\r\nexport type Command = CommandEventArgument<typeof contro['_commandsRaw']>['command']\r\n\r\nonControInit()\r\n\r\nupdateBinds(customKeymaps)\r\n\r\nconst updateDoPreventDefault = () => {\r\n  controlOptions.preventDefault = miscUiState.gameLoaded && !activeModalStack.length\r\n}\r\n\r\nsubscribe(miscUiState, updateDoPreventDefault)\r\nsubscribe(activeModalStack, updateDoPreventDefault)\r\nupdateDoPreventDefault()\r\n\r\nconst setSprinting = (state: boolean) => {\r\n  bot.setControlState('sprint', state)\r\n  gameAdditionalState.isSprinting = state\r\n}\r\n\r\ncontro.on('movementUpdate', ({ vector, soleVector, gamepadIndex }) => {\r\n  if (gamepadIndex !== undefined && gamepadUiCursorState.display) {\r\n    const deadzone = 0.1 // TODO make deadzone configurable\r\n    if (Math.abs(soleVector.x) < deadzone && Math.abs(soleVector.z) < deadzone) {\r\n      return\r\n    }\r\n    moveGamepadCursorByPx(soleVector.x, true)\r\n    moveGamepadCursorByPx(soleVector.z, false)\r\n    emitMousemove()\r\n  }\r\n  miscUiState.usingGamepadInput = gamepadIndex !== undefined\r\n  if (!bot || !isGameActive(false)) return\r\n\r\n  if (viewer.world.freeFlyMode) {\r\n    // Create movement vector from input\r\n    const direction = new THREE.Vector3(0, 0, 0)\r\n    if (vector.z !== undefined) direction.z = vector.z\r\n    if (vector.x !== undefined) direction.x = vector.x\r\n\r\n    // Apply camera rotation to movement direction\r\n    direction.applyQuaternion(viewer.camera.quaternion)\r\n\r\n    // Update freeFlyState position with normalized direction\r\n    const moveSpeed = 1\r\n    direction.multiplyScalar(moveSpeed)\r\n    viewer.world.freeFlyState.position.add(new Vec3(direction.x, direction.y, direction.z))\r\n    return\r\n  }\r\n\r\n  // gamepadIndex will be used for splitscreen in future\r\n  const coordToAction = [\r\n    ['z', -1, 'forward'],\r\n    ['z', 1, 'back'],\r\n    ['x', -1, 'left'],\r\n    ['x', 1, 'right'],\r\n  ] as const\r\n\r\n  const newState: Partial<typeof bot.controlState> = {}\r\n  for (const [coord, v] of Object.entries(vector)) {\r\n    if (v === undefined || Math.abs(v) < 0.3) continue\r\n    // todo use raw values eg for slow movement\r\n    const mappedValue = v < 0 ? -1 : 1\r\n    // eslint-disable-next-line @typescript-eslint/no-non-null-asserted-optional-chain\r\n    const foundAction = coordToAction.find(([c, mapV]) => c === coord && mapV === mappedValue)?.[2]!\r\n    newState[foundAction] = true\r\n  }\r\n\r\n  for (const key of ['forward', 'back', 'left', 'right'] as const) {\r\n    if (newState[key] === bot.controlState[key]) continue\r\n    const action = !!newState[key]\r\n    if (action && !isGameActive(true)) continue\r\n    bot.setControlState(key, action)\r\n\r\n    if (key === 'forward') {\r\n      // todo workaround: need to refactor\r\n      if (action) {\r\n        void contro.emit('trigger', { command: 'general.forward' } as any)\r\n      } else {\r\n        setSprinting(false)\r\n      }\r\n    }\r\n  }\r\n})\r\n\r\nlet lastCommandTrigger = null as { command: string, time: number } | null\r\n\r\nconst secondActionActivationTimeout = 300\r\nconst secondActionCommands = {\r\n  'general.jump' () {\r\n    // if (bot.game.gameMode === 'spectator') return\r\n    toggleFly()\r\n  },\r\n  'general.forward' () {\r\n    setSprinting(true)\r\n  }\r\n}\r\n\r\n// detect pause open, as ANY keyup event is not fired when you exit pointer lock (esc)\r\nsubscribe(activeModalStack, () => {\r\n  if (activeModalStack.length) {\r\n    // iterate over pressedKeys\r\n    for (const key of contro.pressedKeys) {\r\n      contro.pressedKeyOrButtonChanged({ code: key }, false)\r\n    }\r\n  }\r\n})\r\n\r\nconst emitMousemove = () => {\r\n  const { x, y } = gamepadUiCursorState\r\n  const xAbs = x / 100 * window.innerWidth\r\n  const yAbs = y / 100 * window.innerHeight\r\n  const element = document.elementFromPoint(xAbs, yAbs) as HTMLElement | null\r\n  if (!element) return\r\n  element.dispatchEvent(new MouseEvent('mousemove', {\r\n    clientX: xAbs,\r\n    clientY: yAbs\r\n  }))\r\n}\r\n\r\nlet lastClickedEl = null as HTMLElement | null\r\nlet lastClickedElTimeout: ReturnType<typeof setTimeout> | undefined\r\nconst inModalCommand = (command: Command, pressed: boolean) => {\r\n  if (pressed && !gamepadUiCursorState.display) return\r\n\r\n  if (pressed) {\r\n    if (command === 'ui.back') {\r\n      hideCurrentModal()\r\n    }\r\n    if (command === 'ui.leftClick' || command === 'ui.rightClick') {\r\n      // in percent\r\n      const { x, y } = gamepadUiCursorState\r\n      const xAbs = x / 100 * window.innerWidth\r\n      const yAbs = y / 100 * window.innerHeight\r\n      const el = document.elementFromPoint(xAbs, yAbs) as HTMLElement\r\n      if (el) {\r\n        if (el === lastClickedEl && command === 'ui.leftClick') {\r\n          el.dispatchEvent(new MouseEvent('dblclick', {\r\n            bubbles: true,\r\n            clientX: xAbs,\r\n            clientY: yAbs\r\n          }))\r\n          return\r\n        }\r\n        el.dispatchEvent(new MouseEvent('mousedown', {\r\n          button: command === 'ui.leftClick' ? 0 : 2,\r\n          bubbles: true,\r\n          clientX: xAbs,\r\n          clientY: yAbs\r\n        }))\r\n        el.dispatchEvent(new MouseEvent(command === 'ui.leftClick' ? 'click' : 'contextmenu', {\r\n          bubbles: true,\r\n          clientX: xAbs,\r\n          clientY: yAbs\r\n        }))\r\n        el.dispatchEvent(new MouseEvent('mouseup', {\r\n          button: command === 'ui.leftClick' ? 0 : 2,\r\n          bubbles: true,\r\n          clientX: xAbs,\r\n          clientY: yAbs\r\n        }))\r\n        el.focus()\r\n        lastClickedEl = el\r\n        if (lastClickedElTimeout) clearTimeout(lastClickedElTimeout)\r\n        lastClickedElTimeout = setTimeout(() => {\r\n          lastClickedEl = null\r\n        }, 500)\r\n      }\r\n    }\r\n  }\r\n\r\n  if (command === 'ui.speedupCursor') {\r\n    gamepadUiCursorState.multiply = pressed ? 2 : 1\r\n  }\r\n}\r\n\r\n// Camera rotation controls\r\nconst cameraRotationControls = {\r\n  activeDirections: new Set<'left' | 'right' | 'up' | 'down'>(),\r\n  interval: null as ReturnType<typeof setInterval> | null,\r\n  config: {\r\n    speed: 1, // movement per interval\r\n    interval: 5 // ms between movements\r\n  },\r\n  movements: {\r\n    left: { movementX: -0.5, movementY: 0 },\r\n    right: { movementX: 0.5, movementY: 0 },\r\n    up: { movementX: 0, movementY: -0.5 },\r\n    down: { movementX: 0, movementY: 0.5 }\r\n  },\r\n  updateMovement () {\r\n    if (cameraRotationControls.activeDirections.size === 0) {\r\n      if (cameraRotationControls.interval) {\r\n        clearInterval(cameraRotationControls.interval)\r\n        cameraRotationControls.interval = null\r\n      }\r\n      return\r\n    }\r\n\r\n    if (!cameraRotationControls.interval) {\r\n      cameraRotationControls.interval = setInterval(() => {\r\n        // Combine all active movements\r\n        const movement = { movementX: 0, movementY: 0 }\r\n        for (const direction of cameraRotationControls.activeDirections) {\r\n          movement.movementX += cameraRotationControls.movements[direction].movementX\r\n          movement.movementY += cameraRotationControls.movements[direction].movementY\r\n        }\r\n\r\n        onCameraMove({\r\n          ...movement,\r\n          type: 'keyboardRotation',\r\n          stopPropagation () {}\r\n        })\r\n      }, cameraRotationControls.config.interval)\r\n    }\r\n  },\r\n  start (direction: 'left' | 'right' | 'up' | 'down') {\r\n    cameraRotationControls.activeDirections.add(direction)\r\n    cameraRotationControls.updateMovement()\r\n  },\r\n  stop (direction: 'left' | 'right' | 'up' | 'down') {\r\n    cameraRotationControls.activeDirections.delete(direction)\r\n    cameraRotationControls.updateMovement()\r\n  },\r\n  handleCommand (command: string, pressed: boolean) {\r\n    const directionMap = {\r\n      'general.rotateCameraLeft': 'left',\r\n      'general.rotateCameraRight': 'right',\r\n      'general.rotateCameraUp': 'up',\r\n      'general.rotateCameraDown': 'down'\r\n    } as const\r\n\r\n    const direction = directionMap[command]\r\n    if (direction) {\r\n      if (pressed) cameraRotationControls.start(direction)\r\n      else cameraRotationControls.stop(direction)\r\n      return true\r\n    }\r\n    return false\r\n  }\r\n}\r\nwindow.cameraRotationControls = cameraRotationControls\r\n\r\nconst setSneaking = (state: boolean) => {\r\n  gameAdditionalState.isSneaking = state\r\n  bot.setControlState('sneak', state)\r\n}\r\n\r\nconst onTriggerOrReleased = (command: Command, pressed: boolean) => {\r\n  // always allow release!\r\n  if (!bot || !isGameActive(false)) return\r\n  if (stringStartsWith(command, 'general')) {\r\n    // handle general commands\r\n    // eslint-disable-next-line @typescript-eslint/switch-exhaustiveness-check\r\n    switch (command) {\r\n      case 'general.jump':\r\n        if (viewer.world.freeFlyMode) {\r\n          const moveSpeed = 0.5\r\n          viewer.world.freeFlyState.position.add(new Vec3(0, pressed ? moveSpeed : 0, 0))\r\n        } else {\r\n          bot.setControlState('jump', pressed)\r\n        }\r\n        break\r\n      case 'general.sneak':\r\n        if (viewer.world.freeFlyMode) {\r\n          const moveSpeed = 0.5\r\n          viewer.world.freeFlyState.position.add(new Vec3(0, pressed ? -moveSpeed : 0, 0))\r\n        } else {\r\n          setSneaking(pressed)\r\n        }\r\n        break\r\n      case 'general.sprint':\r\n        // todo add setting to change behavior\r\n        if (pressed) {\r\n          setSprinting(pressed)\r\n        }\r\n        break\r\n      case 'general.toggleSneakOrDown':\r\n        if (gameAdditionalState.isFlying) {\r\n          setSneaking(pressed)\r\n        } else if (pressed) {\r\n          setSneaking(!gameAdditionalState.isSneaking)\r\n        }\r\n        break\r\n      case 'general.attackDestroy':\r\n        document.dispatchEvent(new MouseEvent(pressed ? 'mousedown' : 'mouseup', { button: 0 }))\r\n        break\r\n      case 'general.interactPlace':\r\n        document.dispatchEvent(new MouseEvent(pressed ? 'mousedown' : 'mouseup', { button: 2 }))\r\n        break\r\n      case 'general.zoom':\r\n        gameAdditionalState.isZooming = pressed\r\n        break\r\n      case 'general.rotateCameraLeft':\r\n      case 'general.rotateCameraRight':\r\n      case 'general.rotateCameraUp':\r\n      case 'general.rotateCameraDown':\r\n        cameraRotationControls.handleCommand(command, pressed)\r\n        break\r\n    }\r\n  }\r\n}\r\n\r\n// im still not sure, maybe need to refactor to handle in inventory instead\r\nconst alwaysPressedHandledCommand = (command: Command) => {\r\n  inModalCommand(command, true)\r\n  // triggered even outside of the game\r\n  if (command === 'general.inventory') {\r\n    if (activeModalStack.at(-1)?.reactType?.startsWith?.('player_win:')) { // todo?\r\n      hideCurrentModal()\r\n    }\r\n  }\r\n  if (command === 'advanced.lockUrl') {\r\n    lockUrl()\r\n  }\r\n}\r\n\r\nexport function lockUrl () {\r\n  let newQs = ''\r\n  if (fsState.saveLoaded) {\r\n    const save = localServer!.options.worldFolder.split('/').at(-1)\r\n    newQs = `loadSave=${save}`\r\n  } else if (process.env.NODE_ENV === 'development') {\r\n    newQs = `reconnect=1`\r\n  } else if (lastConnectOptions.value?.server) {\r\n    const qs = new URLSearchParams()\r\n    const { server, botVersion, proxy, username } = lastConnectOptions.value\r\n    qs.set('ip', server)\r\n    if (botVersion) qs.set('version', botVersion)\r\n    if (proxy) qs.set('proxy', proxy)\r\n    if (username) qs.set('username', username)\r\n    newQs = String(qs.toString())\r\n  }\r\n\r\n  if (newQs) {\r\n    window.history.replaceState({}, '', `${window.location.pathname}?${newQs}`)\r\n  }\r\n}\r\n\r\nfunction cycleHotbarSlot (dir: 1 | -1) {\r\n  const newHotbarSlot = (bot.quickBarSlot + dir + 9) % 9\r\n  bot.setQuickBarSlot(newHotbarSlot)\r\n}\r\n\r\n// custom commands handler\r\nconst customCommandsHandler = ({ command }) => {\r\n  const [section, name] = command.split('.')\r\n  if (!isGameActive(true) || section !== 'custom') return\r\n\r\n  if (contro.userConfig?.custom) {\r\n    customCommandsConfig[(contro.userConfig.custom[name] as CustomCommand).type].handler((contro.userConfig.custom[name] as CustomCommand).inputs)\r\n  }\r\n}\r\ncontro.on('trigger', customCommandsHandler)\r\n\r\ncontro.on('trigger', ({ command }) => {\r\n  const willContinue = !isGameActive(true)\r\n  alwaysPressedHandledCommand(command)\r\n  if (willContinue) return\r\n\r\n  const secondActionCommand = secondActionCommands[command]\r\n  if (secondActionCommand) {\r\n    if (command === lastCommandTrigger?.command && Date.now() - lastCommandTrigger.time < secondActionActivationTimeout) {\r\n      const commandToTrigger = secondActionCommands[lastCommandTrigger.command]\r\n      commandToTrigger()\r\n      lastCommandTrigger = null\r\n    } else {\r\n      lastCommandTrigger = {\r\n        command,\r\n        time: Date.now(),\r\n      }\r\n    }\r\n  }\r\n\r\n  onTriggerOrReleased(command, true)\r\n\r\n  if (stringStartsWith(command, 'general')) {\r\n    switch (command) {\r\n      case 'general.jump':\r\n      case 'general.sneak':\r\n      case 'general.toggleSneakOrDown':\r\n      case 'general.sprint':\r\n      case 'general.attackDestroy':\r\n      case 'general.rotateCameraLeft':\r\n      case 'general.rotateCameraRight':\r\n      case 'general.rotateCameraUp':\r\n      case 'general.rotateCameraDown':\r\n        // no-op\r\n        break\r\n      case 'general.swapHands': {\r\n        bot._client.write('entity_action', {\r\n          entityId: bot.entity.id,\r\n          actionId: 6,\r\n          jumpBoost: 0\r\n        })\r\n        break\r\n      }\r\n      case 'general.interactPlace':\r\n        // handled in onTriggerOrReleased\r\n        break\r\n      case 'general.inventory':\r\n        document.exitPointerLock?.()\r\n        openPlayerInventory()\r\n        break\r\n      case 'general.drop': {\r\n        // if (bot.heldItem/* && ctrl */) bot.tossStack(bot.heldItem)\r\n        bot._client.write('block_dig', {\r\n          'status': 4,\r\n          'location': {\r\n            'x': 0,\r\n            'z': 0,\r\n            'y': 0\r\n          },\r\n          'face': 0,\r\n          sequence: 0\r\n        })\r\n        const slot = bot.inventory.hotbarStart + bot.quickBarSlot\r\n        const item = bot.inventory.slots[slot]\r\n        if (item) {\r\n          item.count--\r\n          bot.inventory.updateSlot(slot, item.count > 0 ? item : null!)\r\n        }\r\n        break\r\n      }\r\n      case 'general.chat':\r\n        showModal({ reactType: 'chat' })\r\n        break\r\n      case 'general.command':\r\n        chatInputValueGlobal.value = '/'\r\n        showModal({ reactType: 'chat' })\r\n        break\r\n      case 'general.selectItem':\r\n        void selectItem()\r\n        break\r\n      case 'general.nextHotbarSlot':\r\n        cycleHotbarSlot(1)\r\n        break\r\n      case 'general.prevHotbarSlot':\r\n        cycleHotbarSlot(-1)\r\n        break\r\n      case 'general.zoom':\r\n        break\r\n      case 'general.viewerConsole':\r\n        if (lastConnectOptions.value?.viewerWsConnect) {\r\n          showModal({ reactType: 'console' })\r\n        }\r\n        break\r\n    }\r\n  }\r\n\r\n  if (command === 'ui.pauseMenu') {\r\n    showModal({ reactType: 'pause-screen' })\r\n  }\r\n\r\n  if (command === 'ui.toggleFullscreen') {\r\n    void goFullscreen(true)\r\n  }\r\n})\r\n\r\n// show-hide Fullmap\r\ncontro.on('trigger', ({ command }) => {\r\n  if (command !== 'ui.toggleMap') return\r\n  const isActive = isGameActive(true)\r\n  if (activeModalStack.at(-1)?.reactType === 'full-map') {\r\n    miscUiState.displayFullmap = false\r\n    hideModal({ reactType: 'full-map' })\r\n  } else if (isActive && !activeModalStack.length) {\r\n    miscUiState.displayFullmap = true\r\n    showModal({ reactType: 'full-map' })\r\n  }\r\n})\r\n\r\ncontro.on('release', ({ command }) => {\r\n  inModalCommand(command, false)\r\n  onTriggerOrReleased(command, false)\r\n})\r\n\r\n// hard-coded keybindings\r\n\r\nexport const f3Keybinds: Array<{\r\n  key?: string,\r\n  action: () => void,\r\n  mobileTitle: string\r\n  enabled?: () => boolean\r\n}> = [\r\n  {\r\n    key: 'KeyA',\r\n    action () {\r\n      //@ts-expect-error\r\n      const loadedChunks = Object.entries(worldView.loadedChunks).filter(([, v]) => v).map(([key]) => key.split(',').map(Number))\r\n      for (const [x, z] of loadedChunks) {\r\n        worldView!.unloadChunk({ x, z })\r\n      }\r\n      for (const child of viewer.scene.children) {\r\n        if (child.name === 'chunk') { // should not happen\r\n          viewer.scene.remove(child)\r\n          console.warn('forcefully removed chunk from scene')\r\n        }\r\n      }\r\n      if (localServer) {\r\n        //@ts-expect-error not sure why it is private... maybe revisit api?\r\n        localServer.players[0].world.columns = {}\r\n      }\r\n      void reloadChunks()\r\n    },\r\n    mobileTitle: 'Reload chunks',\r\n  },\r\n  {\r\n    key: 'KeyG',\r\n    action () {\r\n      options.showChunkBorders = !options.showChunkBorders\r\n      viewer.world.updateShowChunksBorder(options.showChunkBorders)\r\n    },\r\n    mobileTitle: 'Toggle chunk borders',\r\n  },\r\n  {\r\n    key: 'KeyY',\r\n    async action () {\r\n      // waypoints\r\n      const widgetNames = widgets.map(widget => widget.name)\r\n      const widget = await showOptionsModal('Open Widget', widgetNames)\r\n      if (!widget) return\r\n      showModal({ reactType: `widget-${widget}` })\r\n    },\r\n    mobileTitle: 'Open Widget'\r\n  },\r\n  {\r\n    key: 'KeyT',\r\n    async action () {\r\n      // TODO!\r\n      if (resourcePackState.resourcePackInstalled || gameAdditionalState.usingServerResourcePack) {\r\n        showNotification('Reloading textures...')\r\n        await completeResourcepackPackInstall('default', 'default', gameAdditionalState.usingServerResourcePack, createNotificationProgressReporter())\r\n      }\r\n    },\r\n    mobileTitle: 'Reload Textures'\r\n  },\r\n  {\r\n    key: 'F4',\r\n    async action () {\r\n      let nextGameMode: GameMode\r\n      switch (bot.game.gameMode) {\r\n        case 'creative': {\r\n          nextGameMode = 'survival'\r\n\r\n          break\r\n        }\r\n        case 'survival': {\r\n          nextGameMode = 'adventure'\r\n\r\n          break\r\n        }\r\n        case 'adventure': {\r\n          nextGameMode = 'spectator'\r\n\r\n          break\r\n        }\r\n        case 'spectator': {\r\n          nextGameMode = 'creative'\r\n\r\n          break\r\n        }\r\n      // No default\r\n      }\r\n      if (lastConnectOptions.value?.worldStateFileContents) {\r\n        switchGameMode(nextGameMode)\r\n      } else {\r\n        bot.chat(`/gamemode ${nextGameMode}`)\r\n      }\r\n    },\r\n    mobileTitle: 'Cycle Game Mode'\r\n  },\r\n  {\r\n    key: 'KeyP',\r\n    async action () {\r\n      const { uuid, ping: playerPing, username } = bot.player\r\n      const proxyPing = await bot['pingProxy']()\r\n      void showOptionsModal(`${username}: last known total latency (ping): ${playerPing}. Connected to ${lastConnectOptions.value?.proxy} with current ping ${proxyPing}. Player UUID: ${uuid}`, [])\r\n    },\r\n    mobileTitle: 'Show Player & Ping Details',\r\n    enabled: () => !lastConnectOptions.value?.singleplayer && !!bot.player\r\n  },\r\n  {\r\n    action () {\r\n      void copyServerResourcePackToRegular()\r\n    },\r\n    mobileTitle: 'Copy Server Resource Pack',\r\n    enabled: () => !!gameAdditionalState.usingServerResourcePack\r\n  }\r\n]\r\n\r\nconst hardcodedPressedKeys = new Set<string>()\r\ndocument.addEventListener('keydown', (e) => {\r\n  if (!isGameActive(false)) return\r\n  if (hardcodedPressedKeys.has('F3')) {\r\n    const keybind = f3Keybinds.find((v) => v.key === e.code)\r\n    if (keybind && (keybind.enabled?.() ?? true)) {\r\n      keybind.action()\r\n      e.stopPropagation()\r\n    }\r\n    return\r\n  }\r\n\r\n  hardcodedPressedKeys.add(e.code)\r\n}, {\r\n  capture: true,\r\n})\r\ndocument.addEventListener('keyup', (e) => {\r\n  hardcodedPressedKeys.delete(e.code)\r\n})\r\ndocument.addEventListener('visibilitychange', (e) => {\r\n  if (document.visibilityState === 'hidden') {\r\n    hardcodedPressedKeys.clear()\r\n  }\r\n})\r\n\r\n// #region creative fly\r\n// these controls are more like for gamemode 3\r\n\r\nconst makeInterval = (fn, interval) => {\r\n  const intervalId = setInterval(fn, interval)\r\n\r\n  const cleanup = () => {\r\n    clearInterval(intervalId)\r\n    cleanup.active = false\r\n  }\r\n  cleanup.active = true\r\n  return cleanup\r\n}\r\n\r\nconst isFlying = () => bot.physics.gravity === 0\r\nlet endFlyLoop: ReturnType<typeof makeInterval> | undefined\r\n\r\nconst currentFlyVector = new Vec3(0, 0, 0)\r\nwindow.currentFlyVector = currentFlyVector\r\n\r\n// todo cleanup\r\nconst flyingPressedKeys = {\r\n  down: false,\r\n  up: false\r\n}\r\n\r\nconst startFlyLoop = () => {\r\n  if (!isFlying()) return\r\n  endFlyLoop?.()\r\n\r\n  endFlyLoop = makeInterval(() => {\r\n    if (!bot) {\r\n      endFlyLoop?.()\r\n      return\r\n    }\r\n\r\n    bot.entity.position.add(currentFlyVector.clone().multiply(new Vec3(0, 0.5, 0)))\r\n  }, 50)\r\n}\r\n\r\n// todo we will get rid of patching it when refactor controls\r\nlet originalSetControlState\r\nconst patchedSetControlState = (action, state) => {\r\n  if (!isFlying()) {\r\n    return originalSetControlState(action, state)\r\n  }\r\n\r\n  const actionPerFlyVector = {\r\n    jump: new Vec3(0, 1, 0),\r\n    sneak: new Vec3(0, -1, 0),\r\n  }\r\n\r\n  const changeVec = actionPerFlyVector[action]\r\n  if (!changeVec) {\r\n    return originalSetControlState(action, state)\r\n  }\r\n  if (flyingPressedKeys[state === 'jump' ? 'up' : 'down'] === state) return\r\n  const toAddVec = changeVec.scaled(state ? 1 : -1)\r\n  for (const coord of ['x', 'y', 'z']) {\r\n    if (toAddVec[coord] === 0) continue\r\n    if (currentFlyVector[coord] === toAddVec[coord]) return\r\n  }\r\n  currentFlyVector.add(toAddVec)\r\n  flyingPressedKeys[state === 'jump' ? 'up' : 'down'] = state\r\n}\r\n\r\nconst startFlying = (sendAbilities = true) => {\r\n  bot.entity['creativeFly'] = true\r\n  if (sendAbilities) {\r\n    bot._client.write('abilities', {\r\n      flags: 2,\r\n    })\r\n  }\r\n  // window.flyingSpeed will be removed\r\n  bot.physics['airborneAcceleration'] = window.flyingSpeed ?? 0.1 // todo use abilities\r\n  bot.entity.velocity = new Vec3(0, 0, 0)\r\n  bot.creative.startFlying()\r\n  startFlyLoop()\r\n}\r\n\r\nconst endFlying = (sendAbilities = true) => {\r\n  bot.entity['creativeFly'] = false\r\n  if (bot.physics.gravity !== 0) return\r\n  if (sendAbilities) {\r\n    bot._client.write('abilities', {\r\n      flags: 0,\r\n    })\r\n  }\r\n  Object.assign(flyingPressedKeys, {\r\n    up: false,\r\n    down: false\r\n  })\r\n  currentFlyVector.set(0, 0, 0)\r\n  bot.physics['airborneAcceleration'] = standardAirborneAcceleration\r\n  bot.creative.stopFlying()\r\n  endFlyLoop?.()\r\n}\r\n\r\nlet allowFlying = false\r\n\r\nexport const onBotCreate = () => {\r\n  let wasSpectatorFlying = false\r\n  bot._client.on('abilities', ({ flags }) => {\r\n    allowFlying = !!(flags & 4)\r\n    if (flags & 2) { // flying\r\n      toggleFly(true, false)\r\n    } else {\r\n      toggleFly(false, false)\r\n    }\r\n  })\r\n  const gamemodeCheck = () => {\r\n    if (bot.game.gameMode === 'spectator') {\r\n      allowFlying = true\r\n      toggleFly(true, false)\r\n      wasSpectatorFlying = true\r\n    } else if (wasSpectatorFlying) {\r\n      toggleFly(false, false)\r\n      wasSpectatorFlying = false\r\n    }\r\n  }\r\n  bot.on('game', () => {\r\n    gamemodeCheck()\r\n  })\r\n  bot.on('login', () => {\r\n    gamemodeCheck()\r\n  })\r\n}\r\n\r\nconst standardAirborneAcceleration = 0.02\r\nconst toggleFly = (newState = !isFlying(), sendAbilities?: boolean) => {\r\n  // if (bot.game.gameMode !== 'creative' && bot.game.gameMode !== 'spectator') return\r\n  if (!allowFlying) return\r\n  if (bot.setControlState !== patchedSetControlState) {\r\n    originalSetControlState = bot.setControlState\r\n    bot.setControlState = patchedSetControlState\r\n  }\r\n\r\n  if (newState) {\r\n    startFlying(sendAbilities)\r\n  } else {\r\n    endFlying(sendAbilities)\r\n  }\r\n  gameAdditionalState.isFlying = isFlying()\r\n}\r\n// #endregion\r\n\r\nconst selectItem = async () => {\r\n  const block = bot.blockAtCursor(5)\r\n  if (!block) return\r\n  const itemId = getItemFromBlock(block)?.id\r\n  if (!itemId) return\r\n  const Item = require('prismarine-item')(bot.version)\r\n  const item = new Item(itemId, 1, 0)\r\n  await bot.creative.setInventorySlot(bot.inventory.hotbarStart + bot.quickBarSlot, item)\r\n  bot.updateHeldItem()\r\n}\r\n\r\naddEventListener('mousedown', async (e) => {\r\n  if ((e.target as HTMLElement).matches?.('#VRButton')) return\r\n  if (!isInRealGameSession() && !(e.target as HTMLElement).id.includes('ui-root')) return\r\n  void pointerLock.requestPointerLock()\r\n  if (!bot) return\r\n  // wheel click\r\n  // todo support ctrl+wheel (+nbt)\r\n  if (e.button === 1) {\r\n    await selectItem()\r\n  }\r\n})\r\n\r\nwindow.addEventListener('keydown', (e) => {\r\n  if (e.code !== 'Escape') return\r\n  if (activeModalStack.length) {\r\n    const hideAll = e.ctrlKey || e.metaKey\r\n    if (hideAll) {\r\n      hideAllModals()\r\n    } else {\r\n      hideCurrentModal()\r\n    }\r\n    if (activeModalStack.length === 0) {\r\n      pointerLock.justHitEscape = true\r\n    }\r\n  } else if (pointerLock.hasPointerLock) {\r\n    document.exitPointerLock?.()\r\n    if (options.autoExitFullscreen) {\r\n      void document.exitFullscreen()\r\n    }\r\n  } else {\r\n    document.dispatchEvent(new Event('pointerlockchange'))\r\n  }\r\n})\r\n\r\nwindow.addEventListener('keydown', (e) => {\r\n  if (e.code !== 'F2' || e.repeat || !isGameActive(true)) return\r\n  e.preventDefault()\r\n  const canvas = document.getElementById('viewer-canvas') as HTMLCanvasElement\r\n  if (!canvas) return\r\n  const link = document.createElement('a')\r\n  link.href = canvas.toDataURL('image/png')\r\n  const date = new Date()\r\n  link.download = `screenshot ${date.toLocaleString().replaceAll('.', '-').replace(',', '')}.png`\r\n  link.click()\r\n})\r\n\r\nwindow.addEventListener('keydown', (e) => {\r\n  if (e.code !== 'F1' || e.repeat || !isGameActive(true)) return\r\n  e.preventDefault()\r\n  miscUiState.showUI = !miscUiState.showUI\r\n})\r\n\r\n// #region experimental debug things\r\nwindow.addEventListener('keydown', (e) => {\r\n  if (e.code === 'KeyL' && e.altKey) {\r\n    console.clear()\r\n  }\r\n})\r\n// #endregion\r\n\r\nexport function updateBinds (commands: any) {\r\n  contro.inputSchema.commands.custom = Object.fromEntries(Object.entries(commands?.custom ?? {}).map(([key, value]) => {\r\n    return [key, {\r\n      keys: [],\r\n      gamepad: [],\r\n      type: '',\r\n      inputs: []\r\n    }]\r\n  }))\r\n\r\n  for (const [group, actions] of Object.entries(commands)) {\r\n    contro.userConfig![group] = Object.fromEntries(Object.entries(actions).map(([key, value]) => {\r\n      const newValue = {\r\n        keys: value?.keys ?? undefined,\r\n        gamepad: value?.gamepad ?? undefined,\r\n      }\r\n\r\n      if (group === 'custom') {\r\n        newValue['type'] = (value).type\r\n        newValue['inputs'] = (value).inputs\r\n      }\r\n\r\n      return [key, newValue]\r\n    }))\r\n  }\r\n}\r\n","import { setLoadingScreenStatus } from '../appStatus'\r\nimport { appStatusState } from '../react/AppStatusProvider'\r\nimport { hideNotification, showNotification } from '../react/NotificationProvider'\r\n\r\nexport interface ProgressReporter {\r\n  currentMessage: string | undefined\r\n  beginStage (stage: string, title: string): void\r\n  endStage (stage: string): void\r\n  setSubStage (stage: string, subStageTitle: string): void\r\n  reportProgress (stage: string, progress: number): void\r\n  executeWithMessage<T>(message: string, fn: () => Promise<T>): Promise<T>\r\n  executeWithMessage<T>(message: string, stage: string, fn: () => Promise<T>): Promise<T>\r\n\r\n  setMessage (message: string): void\r\n\r\n  end(): void\r\n  error(message: string): void\r\n}\r\n\r\ninterface ReporterDisplayImplementation {\r\n  setMessage (message: string): void\r\n  end (): void\r\n  error(message: string): void\r\n}\r\n\r\ninterface StageInfo {\r\n  title: string\r\n  subStage?: string\r\n  progress?: number\r\n}\r\n\r\nconst NO_STAGES_ACTION_END = false\r\n\r\nconst createProgressReporter = (implementation: ReporterDisplayImplementation): ProgressReporter => {\r\n  const stages = new Map<string, StageInfo>()\r\n  let currentMessage: string | undefined\r\n  let ended = false\r\n\r\n  const end = () => {\r\n    if (ended) return\r\n    ended = true\r\n    stages.clear()\r\n    implementation.end()\r\n  }\r\n\r\n  const updateStatus = () => {\r\n    if (ended) return\r\n    const activeStages = [...stages.entries()]\r\n    if (activeStages.length === 0) {\r\n      if (NO_STAGES_ACTION_END) {\r\n        end()\r\n      } else {\r\n        implementation.setMessage('Waiting for tasks')\r\n      }\r\n      return\r\n    }\r\n\r\n    const [currentStage, info] = activeStages.at(-1)!\r\n    let message = info.title\r\n    if (info.subStage) {\r\n      message += ` - ${info.subStage}`\r\n    }\r\n    if (info.progress !== undefined) {\r\n      const num = Math.round(info.progress * 100)\r\n      if (isFinite(num)) {\r\n        message += `: ${num}%`\r\n      }\r\n    }\r\n\r\n    currentMessage = message\r\n    implementation.setMessage(message)\r\n  }\r\n\r\n  const reporter = {\r\n    beginStage (stage: string, title: string) {\r\n      if (stages.has(stage)) {\r\n        throw new Error(`Stage ${stage} already is running`)\r\n      }\r\n      stages.set(stage, { title })\r\n      updateStatus()\r\n    },\r\n\r\n    endStage (stage: string) {\r\n      stages.delete(stage)\r\n      updateStatus()\r\n    },\r\n\r\n    setSubStage (stage: string, subStageTitle: string) {\r\n      const info = stages.get(stage)\r\n      if (info) {\r\n        info.subStage = subStageTitle\r\n        updateStatus()\r\n      }\r\n    },\r\n\r\n    reportProgress (stage: string, progress: number) {\r\n      const info = stages.get(stage)\r\n      if (info) {\r\n        info.progress = progress\r\n        updateStatus()\r\n      }\r\n    },\r\n\r\n    async executeWithMessage<T>(...args: any[]): Promise<T> {\r\n      const message = args[0]\r\n      const stage = typeof args[1] === 'string' ? args[1] : undefined\r\n      const fn = typeof args[1] === 'string' ? args[2] : args[1]\r\n\r\n      const tempStage = stage ?? 'temp-' + Math.random().toString(36).slice(2)\r\n      reporter.beginStage(tempStage, message)\r\n      try {\r\n        const result = await fn()\r\n        return result\r\n      } finally {\r\n        reporter.endStage(tempStage)\r\n      }\r\n    },\r\n\r\n    end (): void {\r\n      end()\r\n    },\r\n\r\n    setMessage (message: string): void {\r\n      implementation.setMessage(message)\r\n    },\r\n\r\n    get currentMessage () {\r\n      return currentMessage\r\n    },\r\n\r\n    error (message: string): void {\r\n      implementation.error(message)\r\n    }\r\n  }\r\n\r\n  return reporter\r\n}\r\n\r\nconst fullScreenReporters = [] as ProgressReporter[]\r\nexport const createFullScreenProgressReporter = (): ProgressReporter => {\r\n  const reporter = createProgressReporter({\r\n    setMessage (message: string) {\r\n      if (appStatusState.isError) return\r\n      setLoadingScreenStatus(message)\r\n    },\r\n    end () {\r\n      if (appStatusState.isError) return\r\n      fullScreenReporters.splice(fullScreenReporters.indexOf(reporter), 1)\r\n      if (fullScreenReporters.length === 0) {\r\n        setLoadingScreenStatus(undefined)\r\n      } else {\r\n        setLoadingScreenStatus(fullScreenReporters.at(-1)!.currentMessage)\r\n      }\r\n    },\r\n\r\n    error (message: string): void {\r\n      if (appStatusState.isError) return\r\n      setLoadingScreenStatus(message, true)\r\n    }\r\n  })\r\n  fullScreenReporters.push(reporter)\r\n  return reporter\r\n}\r\n\r\nexport const createNotificationProgressReporter = (endMessage?: string): ProgressReporter => {\r\n  return createProgressReporter({\r\n    setMessage (message: string) {\r\n      showNotification(`${message}...`, '', false, '', undefined, true)\r\n    },\r\n    end () {\r\n      if (endMessage) {\r\n        showNotification(endMessage, '', false, '', undefined, true)\r\n      } else {\r\n        hideNotification()\r\n      }\r\n    },\r\n\r\n    error (message: string): void {\r\n      showNotification(message, '', true, '', undefined, true)\r\n    }\r\n  })\r\n}\r\n\r\nexport const createConsoleLogProgressReporter = (): ProgressReporter => {\r\n  return createProgressReporter({\r\n    setMessage (message: string) {\r\n      console.log(message)\r\n    },\r\n    end () {\r\n      console.log('done')\r\n    },\r\n\r\n    error (message: string): void {\r\n      console.error(message)\r\n    }\r\n  })\r\n}\r\n\r\nexport const createWrappedProgressReporter = (reporter: ProgressReporter, message?: string) => {\r\n  const stage = `wrapped-${message}`\r\n  if (message) {\r\n    reporter.beginStage(stage, message)\r\n  }\r\n\r\n  return createProgressReporter({\r\n    setMessage (message: string) {\r\n      reporter.setMessage(message)\r\n    },\r\n    end () {\r\n      if (message) {\r\n        reporter.endStage(stage)\r\n      }\r\n    },\r\n\r\n    error (message: string): void {\r\n      reporter.error(message)\r\n    }\r\n  })\r\n}\r\n","import { LocalServer } from './customServer'\r\n\r\nconst { createMCServer } = require('flying-squid/dist')\r\n\r\nexport const startLocalServer = (serverOptions) => {\r\n  const passOptions = { ...serverOptions, Server: LocalServer }\r\n  const server: NonNullable<typeof localServer> = createMCServer(passOptions)\r\n  server.formatMessage = (message) => `[server] ${message}`\r\n  server.options = passOptions\r\n  //@ts-expect-error todo remove\r\n  server.looseProtocolMode = true\r\n  return server\r\n}\r\n\r\n// features that flying-squid doesn't support at all\r\n// todo move & generate in flying-squid\r\nexport const unsupportedLocalServerFeatures = ['transactionPacketExists', 'teleportUsesOwnPacket']\r\n","import { Vec3 } from 'vec3'\r\nimport { options } from './optionsStorage'\r\n\r\ncustomEvents.on('mineflayerBotCreated', async () => {\r\n  if (!options.customChannels) return\r\n  await new Promise(resolve => {\r\n    bot.once('login', () => {\r\n      resolve(true)\r\n    })\r\n  })\r\n  registerBlockModelsChannel()\r\n})\r\n\r\nconst registerBlockModelsChannel = () => {\r\n  const CHANNEL_NAME = 'minecraft-web-client:blockmodels'\r\n\r\n  const packetStructure = [\r\n    'container',\r\n    [\r\n      {\r\n        name: 'worldName', // currently not used\r\n        type: ['pstring', { countType: 'i16' }]\r\n      },\r\n      {\r\n        name: 'x',\r\n        type: 'i32'\r\n      },\r\n      {\r\n        name: 'y',\r\n        type: 'i32'\r\n      },\r\n      {\r\n        name: 'z',\r\n        type: 'i32'\r\n      },\r\n      {\r\n        name: 'model',\r\n        type: ['pstring', { countType: 'i16' }]\r\n      }\r\n    ]\r\n  ]\r\n\r\n  bot._client.registerChannel(CHANNEL_NAME, packetStructure, true)\r\n\r\n  bot._client.on(CHANNEL_NAME as any, (data) => {\r\n    const { worldName, x, y, z, model } = data\r\n\r\n    const chunkX = Math.floor(x / 16) * 16\r\n    const chunkZ = Math.floor(z / 16) * 16\r\n    const chunkKey = `${chunkX},${chunkZ}`\r\n    const blockPosKey = `${x},${y},${z}`\r\n\r\n    const chunkModels = viewer.world.protocolCustomBlocks.get(chunkKey) || {}\r\n\r\n    if (model) {\r\n      chunkModels[blockPosKey] = model\r\n    } else {\r\n      delete chunkModels[blockPosKey]\r\n    }\r\n\r\n    if (Object.keys(chunkModels).length > 0) {\r\n      viewer.world.protocolCustomBlocks.set(chunkKey, chunkModels)\r\n    } else {\r\n      viewer.world.protocolCustomBlocks.delete(chunkKey)\r\n    }\r\n\r\n    // Trigger update\r\n    if (worldView) {\r\n      const block = worldView.world.getBlock(new Vec3(x, y, z))\r\n      if (block) {\r\n        worldView.world.setBlockStateId(new Vec3(x, y, z), block.stateId)\r\n      }\r\n    }\r\n\r\n  })\r\n\r\n  console.debug(`registered custom channel ${CHANNEL_NAME} channel`)\r\n}\r\n\r\nconst registeredJeiChannel = () => {\r\n  const CHANNEL_NAME = 'minecraft-web-client:jei'\r\n  // id - string, categoryTitle - string, items - string (json array)\r\n  const packetStructure = [\r\n    'container',\r\n    [\r\n      {\r\n        name: 'id',\r\n        type: ['pstring', { countType: 'i16' }]\r\n      },\r\n      {\r\n        name: 'categoryTitle',\r\n        type: ['pstring', { countType: 'i16' }]\r\n      },\r\n      {\r\n        name: 'items',\r\n        type: ['pstring', { countType: 'i16' }]\r\n      },\r\n    ]\r\n  ]\r\n\r\n  bot._client.registerChannel(CHANNEL_NAME, packetStructure, true)\r\n\r\n  bot._client.on(CHANNEL_NAME as any, (data) => {\r\n    const { id, categoryTitle, items } = data\r\n    // ...\r\n  })\r\n\r\n  console.debug(`registered custom channel ${CHANNEL_NAME} channel`)\r\n}\r\n","import { options } from './optionsStorage'\r\n\r\n//@ts-check\r\nconst { EventEmitter } = require('events')\r\nconst debug = require('debug')('minecraft-protocol')\r\nconst states = require('minecraft-protocol/src/states')\r\n\r\nwindow.serverDataChannel ??= {}\r\nexport const customCommunication = {\r\n  sendData(data) {\r\n    setTimeout(() => {\r\n      window.serverDataChannel[this.isServer ? 'emitClient' : 'emitServer'](data)\r\n    })\r\n  },\r\n  receiverSetup(processData) {\r\n    window.serverDataChannel[this.isServer ? 'emitServer' : 'emitClient'] = (data) => {\r\n      processData(data)\r\n    }\r\n  }\r\n}\r\n\r\nclass CustomChannelClient extends EventEmitter {\r\n  constructor(isServer, version) {\r\n    super()\r\n    this.version = version\r\n    this.isServer = !!isServer\r\n    this.state = states.HANDSHAKING\r\n  }\r\n\r\n  get state() {\r\n    return this.protocolState\r\n  }\r\n\r\n  setSerializer(state) {\r\n    customCommunication.receiverSetup.call(this, (/** @type {{name, params, state?}} */parsed) => {\r\n      if (!options.excludeCommunicationDebugEvents.includes(parsed.name)) {\r\n        debug(`receive in ${this.isServer ? 'server' : 'client'}: ${parsed.name}`)\r\n      }\r\n      this.emit(parsed.name, parsed.params, parsed)\r\n      this.emit('packet_name', parsed.name, parsed.params, parsed)\r\n    })\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/adjacent-overload-signatures, grouped-accessor-pairs\r\n  set state(newProperty) {\r\n    const oldProperty = this.protocolState\r\n    this.protocolState = newProperty\r\n\r\n    this.setSerializer(this.protocolState)\r\n\r\n    this.emit('state', newProperty, oldProperty)\r\n  }\r\n\r\n  end(reason) {\r\n    this._endReason = reason\r\n    this.emit('end', this._endReason) // still emits on server side only, doesn't send anything to our client\r\n  }\r\n\r\n  write(name, params) {\r\n    if (!options.excludeCommunicationDebugEvents.includes(name)) {\r\n      debug(`[${this.state}] from ${this.isServer ? 'server' : 'client'}: ` + name)\r\n      debug(params)\r\n    }\r\n\r\n    this.emit('writePacket', name, params)\r\n    customCommunication.sendData.call(this, { name, params, state: this.state })\r\n  }\r\n\r\n  writeBundle(packets) {\r\n    // no-op\r\n  }\r\n\r\n  writeRaw(buffer) {\r\n    // no-op\r\n  }\r\n}\r\n\r\nexport default CustomChannelClient\r\n","import { guiOptionsScheme, tryFindOptionConfig } from './optionsGuiScheme'\r\nimport { options } from './optionsStorage'\r\n\r\nexport const customCommandsConfig = {\r\n  chat: {\r\n    input: [\r\n      {\r\n        type: 'text',\r\n        placeholder: 'Command to send e.g. gamemode creative'\r\n      }\r\n    ],\r\n    handler ([command]) {\r\n      bot.chat(`/${command.replace(/^\\//, '')}`)\r\n    }\r\n  },\r\n  setOrToggleSetting: {\r\n    input: [\r\n      {\r\n        type: 'select',\r\n        // maybe title case?\r\n        options: Object.keys(options)\r\n      },\r\n      {\r\n        type: 'select',\r\n        options: ['toggle', 'set']\r\n      },\r\n      ([setting = '', action = ''] = []) => {\r\n        const value = options[setting]\r\n        if (!action || value === undefined || action === 'toggle') return null\r\n        if (action === 'set') {\r\n          const getBase = () => {\r\n            const config = tryFindOptionConfig(setting as any)\r\n            if (config && 'values' in config) {\r\n              return {\r\n                type: 'select',\r\n                options: config.values\r\n              }\r\n            }\r\n            if (config?.type === 'toggle' || typeof value === 'boolean') {\r\n              return {\r\n                type: 'select',\r\n                options: ['true', 'false']\r\n              }\r\n            }\r\n            if (config?.type === 'slider' || value.type === 'number') {\r\n              return {\r\n                type: 'number',\r\n              }\r\n            }\r\n            return {\r\n              type: 'text'\r\n            }\r\n          }\r\n          return {\r\n            ...getBase(),\r\n            placeholder: value\r\n          }\r\n        }\r\n      }\r\n    ],\r\n    handler ([setting, action, value]) {\r\n      if (action === 'toggle' || action === undefined) {\r\n        const value = options[setting]\r\n        const config = tryFindOptionConfig(setting)\r\n        if (config && 'values' in config && config.values) {\r\n          const { values } = config\r\n          const currentIndex = values.indexOf(value)\r\n          const nextIndex = (currentIndex + 1) % values.length\r\n          options[setting] = values[nextIndex]\r\n        } else {\r\n          options[setting] = typeof value === 'boolean' ? !value : typeof value === 'number' ? value + 1 : value\r\n        }\r\n      } else {\r\n        options[setting] = value\r\n      }\r\n    }\r\n  },\r\n  jsScripts: {\r\n    input: [\r\n      {\r\n        type: 'text',\r\n        placeholder: 'JavaScript code to run in main thread (sensitive!)'\r\n      }\r\n    ],\r\n    handler ([code]) {\r\n      // eslint-disable-next-line no-new-func -- this is a feature, not a bug\r\n      new Function(code)()\r\n    }\r\n  },\r\n  // openCommandsScreen: {}\r\n}\r\n","import EventEmitter from 'events'\r\n\r\nimport CustomChannelClient from './customClient'\r\n\r\nexport class LocalServer extends EventEmitter.EventEmitter {\r\n  socketServer = null\r\n  cipher = null\r\n  decipher = null\r\n  clients = {}\r\n\r\n  constructor (public version, public customPackets, public hideErrors = false) {\r\n    super()\r\n  }\r\n\r\n  listen () {\r\n    this.emit('connection', new CustomChannelClient(true, this.version))\r\n  }\r\n\r\n  close () { }\r\n}\r\n","import { options } from './optionsStorage'\r\nimport { assertDefined } from './utils'\r\nimport { updateBackground } from './water'\r\n\r\nexport default () => {\r\n  const timeUpdated = () => {\r\n    assertDefined(viewer)\r\n    // 0 morning\r\n    const dayTotal = 24_000\r\n    const evening = 11_500\r\n    const night = 13_500\r\n    const morningStart = 23_000\r\n    const morningEnd = 23_961\r\n    const timeProgress = options.dayCycleAndLighting ? bot.time.timeOfDay : 0\r\n\r\n    // todo check actual colors\r\n    const dayColorRainy = { r: 111 / 255, g: 156 / 255, b: 236 / 255 }\r\n    // todo yes, we should make animations (and rain)\r\n    // eslint-disable-next-line unicorn/numeric-separators-style\r\n    const dayColor = bot.isRaining ? dayColorRainy : { r: 0.6784313725490196, g: 0.8470588235294118, b: 0.9019607843137255 } // lightblue\r\n    // let newColor = dayColor\r\n    let int = 1\r\n    if (timeProgress < evening) {\r\n      // stay dayily\r\n    } else if (timeProgress < night) {\r\n      const progressNorm = timeProgress - evening\r\n      const progressMax = night - evening\r\n      int = 1 - progressNorm / progressMax\r\n    } else if (timeProgress < morningStart) {\r\n      int = 0\r\n    } else if (timeProgress < morningEnd) {\r\n      const progressNorm = timeProgress - morningStart\r\n      const progressMax = night - morningEnd\r\n      int = progressNorm / progressMax\r\n    }\r\n    // todo need to think wisely how to set these values & also move directional light around!\r\n    const colorInt = Math.max(int, 0.1)\r\n    updateBackground({ r: dayColor.r * colorInt, g: dayColor.g * colorInt, b: dayColor.b * colorInt })\r\n    if (!options.newVersionsLighting && bot.supportFeature('blockStateId')) {\r\n      viewer.ambientLight.intensity = Math.max(int, 0.25)\r\n      viewer.directionalLight.intensity = Math.min(int, 0.5)\r\n    }\r\n  }\r\n\r\n  bot.on('time', timeUpdated)\r\n  timeUpdated()\r\n}\r\n","module.exports = {\r\n  'motd': 'A Minecraft Server \\nRunning flying-squid',\r\n  // host: '',\r\n  // eslint-disable-next-line unicorn/numeric-separators-style\r\n  'port': 25565,\r\n  'max-players': 10,\r\n  'online-mode': false,\r\n  'gameMode': 0,\r\n  'difficulty': 0,\r\n  'worldFolder': 'world',\r\n  // todo set sid, disable entities auto-spawn\r\n  'generation': {\r\n    // grass_field\r\n    // diamond_square\r\n    // empty\r\n    // superflat\r\n    // all_the_blocks\r\n    // nether\r\n    'name': 'diamond_square',\r\n    options: {}\r\n    // 'options': {\r\n    //   'worldHeight': 80\r\n    // }\r\n  },\r\n  'kickTimeout': 10_000,\r\n  'plugins': {},\r\n  'modpe': false,\r\n  'view-distance': 2,\r\n  'player-list-text': {\r\n    'header': 'Flying squid',\r\n    'footer': 'Integrated server'\r\n  },\r\n  keepAlive: false,\r\n  'everybody-op': true,\r\n  'max-entities': 100,\r\n  'version': '1.18.2',\r\n  versionMajor: '1.18'\r\n}\r\n","import { isMobile } from 'renderer/viewer/lib/simpleUtils'\r\nimport { WorldRendererThree } from 'renderer/viewer/lib/worldrendererThree'\r\n\r\nif (process.env.NODE_ENV === 'development') {\r\n  // mobile devtools\r\n  if (isMobile()) {\r\n    // can be changed to require('eruda')\r\n    //@ts-expect-error\r\n    void import('https://cdn.skypack.dev/eruda').then(({ default: eruda }) => eruda.init())\r\n  }\r\n}\r\nconsole.log('JS Loaded in', Date.now() - window.startLoad)\r\n","// global variables useful for debugging\r\n\r\nimport fs from 'fs'\r\nimport { WorldRendererThree } from 'renderer/viewer/lib/worldrendererThree'\r\nimport { enable, disable, enabled } from 'debug'\r\nimport { Vec3 } from 'vec3'\r\n\r\nwindow.Vec3 = Vec3\r\nwindow.cursorBlockRel = (x = 0, y = 0, z = 0) => {\r\n  const newPos = bot.blockAtCursor(5)?.position.offset(x, y, z)\r\n  if (!newPos) return\r\n  return bot.world.getBlock(newPos)\r\n}\r\n\r\nwindow.entityCursor = () => {\r\n  return bot.mouse.getCursorState().entity\r\n}\r\n\r\n// wanderer\r\nwindow.inspectPlayer = () => require('fs').promises.readFile('/world/playerdata/9e487d23-2ffc-365a-b1f8-f38203f59233.dat').then(window.nbt.parse).then(console.log)\r\n\r\nObject.defineProperty(window, 'debugSceneChunks', {\r\n  get () {\r\n    return (viewer.world as WorldRendererThree).getLoadedChunksRelative?.(bot.entity.position, true)\r\n  },\r\n})\r\n\r\nwindow.chunkKey = (xRel = 0, zRel = 0) => {\r\n  const pos = bot.entity.position\r\n  return `${(Math.floor(pos.x / 16) + xRel) * 16},${(Math.floor(pos.z / 16) + zRel) * 16}`\r\n}\r\n\r\nwindow.sectionKey = (xRel = 0, yRel = 0, zRel = 0) => {\r\n  const pos = bot.entity.position\r\n  return `${(Math.floor(pos.x / 16) + xRel) * 16},${(Math.floor(pos.y / 16) + yRel) * 16},${(Math.floor(pos.z / 16) + zRel) * 16}`\r\n}\r\n\r\nwindow.keys = (obj) => Object.keys(obj)\r\nwindow.values = (obj) => Object.values(obj)\r\n\r\nwindow.len = (obj) => Object.keys(obj).length\r\n\r\ncustomEvents.on('gameLoaded', () => {\r\n  bot._client.on('packet', (data, { name }) => {\r\n    if (sessionStorage.ignorePackets?.includes(name)) {\r\n      console.log('ignoring packet', name)\r\n      const oldEmit = bot._client.emit\r\n      let i = 0\r\n      // ignore next 3 emits\r\n      //@ts-expect-error\r\n      bot._client.emit = (...args) => {\r\n        if (i++ === 3) {\r\n          oldEmit.apply(bot._client, args)\r\n          bot._client.emit = oldEmit\r\n        }\r\n      }\r\n    }\r\n  })\r\n})\r\n\r\nwindow.inspectPacket = (packetName, isFromClient = false, fullOrListener: boolean | ((...args) => void) = false) => {\r\n  if (typeof isFromClient === 'function') {\r\n    fullOrListener = isFromClient\r\n    isFromClient = false\r\n  }\r\n  const listener = typeof fullOrListener === 'function'\r\n    ? (name, ...args) => fullOrListener(...args, name)\r\n    : (name, ...args) => {\r\n      const displayName = name === packetName ? name : `${name} (${packetName})`\r\n      console.log('packet', displayName, fullOrListener ? args : args[0])\r\n    }\r\n\r\n  // Pre-compile regex if using wildcards\r\n  const pattern = typeof packetName === 'string' && packetName.includes('*')\r\n    ? new RegExp('^' + packetName.replaceAll('*', '.*') + '$')\r\n    : null\r\n\r\n  const packetNameListener = (name, data) => {\r\n    if (pattern) {\r\n      if (pattern.test(name)) {\r\n        listener(name, data)\r\n      }\r\n    } else if (name === packetName) {\r\n      listener(name, data)\r\n    }\r\n  }\r\n  const packetListener = (data, { name }) => {\r\n    packetNameListener(name, data)\r\n  }\r\n\r\n  const attach = () => {\r\n    if (isFromClient) {\r\n      bot?._client.prependListener('writePacket', packetNameListener)\r\n    } else {\r\n      bot?._client.prependListener('packet_name', packetNameListener)\r\n      bot?._client.prependListener('packet', packetListener)\r\n    }\r\n  }\r\n  const detach = () => {\r\n    if (isFromClient) {\r\n      bot?._client.removeListener('writePacket', packetNameListener)\r\n    } else {\r\n      bot?._client.removeListener('packet_name', packetNameListener)\r\n      bot?._client.removeListener('packet', packetListener)\r\n    }\r\n  }\r\n  attach()\r\n  customEvents.on('mineflayerBotCreated', attach)\r\n\r\n  const returnobj = {}\r\n  Object.defineProperty(returnobj, 'detach', {\r\n    get () {\r\n      detach()\r\n      customEvents.removeListener('mineflayerBotCreated', attach)\r\n      return true\r\n    },\r\n  })\r\n  return returnobj\r\n}\r\n\r\nwindow.downloadFile = async (path: string) => {\r\n  if (!path.startsWith('/') && localServer) path = `${localServer.options.worldFolder}/${path}`\r\n  const data = await fs.promises.readFile(path)\r\n  const blob = new Blob([data], { type: 'application/octet-stream' })\r\n  const url = URL.createObjectURL(blob)\r\n  const a = document.createElement('a')\r\n  a.href = url\r\n  a.download = path.split('/').at(-1)!\r\n  a.click()\r\n  URL.revokeObjectURL(url)\r\n}\r\n\r\nObject.defineProperty(window, 'debugToggle', {\r\n  get () {\r\n    localStorage.debug = localStorage.debug === '*' ? '' : '*'\r\n    if (enabled('*')) {\r\n      disable()\r\n      return 'disabled debug'\r\n    } else {\r\n      enable('*')\r\n      return 'enabled debug'\r\n    }\r\n  },\r\n  set (v) {\r\n    enable(v)\r\n    localStorage.debug = v\r\n    console.log('Enabled debug for', v)\r\n  }\r\n})\r\n\r\ncustomEvents.on('gameLoaded', () => {\r\n  window.holdingBlock = (viewer.world as WorldRendererThree).holdingBlock\r\n})\r\n\r\nwindow.clearStorage = (...keysToKeep: string[]) => {\r\n  for (let i = 0; i < localStorage.length; i++) {\r\n    const key = localStorage.key(i)\r\n    if (key && !keysToKeep.includes(key)) {\r\n      localStorage.removeItem(key)\r\n    }\r\n  }\r\n  return `Cleared ${localStorage.length - keysToKeep.length} items from localStorage. Kept: ${keysToKeep.join(', ')}`\r\n}\r\n","import prettyBytes from 'pretty-bytes'\r\nimport { openWorldFromHttpDir, openWorldZip } from './browserfs'\r\nimport { getResourcePackNames, installResourcepackPack, resourcePackState, updateTexturePackInstalledState } from './resourcePack'\r\nimport { setLoadingScreenStatus } from './appStatus'\r\nimport { appQueryParams, appQueryParamsArray } from './appParams'\r\nimport { VALID_REPLAY_EXTENSIONS, openFile } from './packetsReplay/replayPackets'\r\nimport { createFullScreenProgressReporter } from './core/progressReporter'\r\n\r\nexport const getFixedFilesize = (bytes: number) => {\r\n  return prettyBytes(bytes, { minimumFractionDigits: 2, maximumFractionDigits: 2 })\r\n}\r\n\r\nconst inner = async () => {\r\n  const { replayFileUrl } = appQueryParams\r\n  if (replayFileUrl) {\r\n    setLoadingScreenStatus('Downloading replay file')\r\n    const response = await fetch(replayFileUrl)\r\n    const contentLength = response.headers?.get('Content-Length')\r\n    const size = contentLength ? +contentLength : undefined\r\n    const filename = replayFileUrl.split('/').pop()\r\n\r\n    let downloadedBytes = 0\r\n    const buffer = await new Response(new ReadableStream({\r\n      async start (controller) {\r\n        if (!response.body) throw new Error('Server returned no response!')\r\n        const reader = response.body.getReader()\r\n\r\n        // eslint-disable-next-line no-constant-condition\r\n        while (true) {\r\n          const { done, value } = await reader.read()\r\n\r\n          if (done) {\r\n            controller.close()\r\n            break\r\n          }\r\n\r\n          downloadedBytes += value.byteLength\r\n\r\n          // Calculate download progress as a percentage\r\n          const progress = size ? (downloadedBytes / size) * 100 : undefined\r\n          setLoadingScreenStatus(`Download replay file progress: ${progress === undefined ? '?' : Math.floor(progress)}% (${getFixedFilesize(downloadedBytes)} / ${size && getFixedFilesize(size)})`, false, true)\r\n\r\n          // Pass the received data to the controller\r\n          controller.enqueue(value)\r\n        }\r\n      },\r\n    })).arrayBuffer()\r\n\r\n    // Convert buffer to text, handling any compression automatically\r\n    const decoder = new TextDecoder()\r\n    const contents = decoder.decode(buffer)\r\n\r\n    openFile({\r\n      contents,\r\n      filename,\r\n      filesize: size\r\n    })\r\n    return true\r\n  }\r\n\r\n  const mapUrlDir = appQueryParamsArray.mapDir ?? []\r\n  const mapUrlDirGuess = appQueryParams.mapDirGuess\r\n  const mapUrlDirBaseUrl = appQueryParams.mapDirBaseUrl\r\n  if (mapUrlDir.length) {\r\n    await openWorldFromHttpDir(mapUrlDir, mapUrlDirBaseUrl ?? undefined)\r\n    return true\r\n  }\r\n  if (mapUrlDirGuess) {\r\n    // await openWorldFromHttpDir(undefined, mapUrlDirGuess)\r\n    return true\r\n  }\r\n  let mapUrl = appQueryParams.map\r\n  const { texturepack } = appQueryParams\r\n  // fixme\r\n  if (texturepack) mapUrl = texturepack\r\n  if (!mapUrl) return false\r\n\r\n  if (texturepack) {\r\n    await updateTexturePackInstalledState()\r\n    if (resourcePackState.resourcePackInstalled) {\r\n      if (!confirm(`You are going to install a new resource pack, which will REPLACE the current one: ${await getResourcePackNames()[0]} Continue?`)) return\r\n    }\r\n  }\r\n  const name = mapUrl.slice(mapUrl.lastIndexOf('/') + 1).slice(-25)\r\n  const downloadThing = texturepack ? 'texturepack' : 'world'\r\n  setLoadingScreenStatus(`Downloading ${downloadThing} ${name}...`)\r\n\r\n  const response = await fetch(mapUrl)\r\n  const contentType = response.headers.get('Content-Type')\r\n  if (!contentType || !contentType.startsWith('application/zip')) {\r\n    alert('Invalid map file')\r\n  }\r\n  const contentLengthStr = response.headers?.get('Content-Length')\r\n  const contentLength = contentLengthStr && +contentLengthStr\r\n  setLoadingScreenStatus(`Downloading ${downloadThing} ${name}: have to download ${contentLength && getFixedFilesize(contentLength)}...`)\r\n\r\n  let downloadedBytes = 0\r\n  const buffer = await new Response(new ReadableStream({\r\n    async start (controller) {\r\n      if (!response.body) throw new Error('Server returned no response!')\r\n      const reader = response.body.getReader()\r\n\r\n      // eslint-disable-next-line no-constant-condition\r\n      while (true) {\r\n        const { done, value } = await reader.read()\r\n\r\n        if (done) {\r\n          controller.close()\r\n          break\r\n        }\r\n\r\n        downloadedBytes += value.byteLength\r\n\r\n        // Calculate download progress as a percentage\r\n        const progress = contentLength ? (downloadedBytes / contentLength) * 100 : undefined\r\n        setLoadingScreenStatus(`Download ${downloadThing} progress: ${progress === undefined ? '?' : Math.floor(progress)}% (${getFixedFilesize(downloadedBytes)} / ${contentLength && getFixedFilesize(contentLength)})`, false, true)\r\n\r\n\r\n        // Pass the received data to the controller\r\n        controller.enqueue(value)\r\n      }\r\n    },\r\n  })).arrayBuffer()\r\n  if (texturepack) {\r\n    const name = mapUrl.slice(mapUrl.lastIndexOf('/') + 1).slice(-30)\r\n    await installResourcepackPack(buffer, createFullScreenProgressReporter(), name)\r\n  } else {\r\n    await openWorldZip(buffer)\r\n  }\r\n}\r\n\r\nexport default async () => {\r\n  try {\r\n    return await inner()\r\n  } catch (err) {\r\n    setLoadingScreenStatus(`Failed to download. Either refresh page or remove map param from URL. Reason: ${err.message}`)\r\n    return true\r\n  }\r\n}\r\n","import { promisify } from 'util'\r\nimport fs from 'fs'\r\nimport * as nbt from 'prismarine-nbt'\r\nimport RegionFile from 'prismarine-provider-anvil/src/region'\r\nimport { versions } from 'minecraft-data'\r\nimport { openWorldDirectory, openWorldZip } from './browserfs'\r\nimport { isGameActive } from './globalState'\r\nimport { showNotification } from './react/NotificationProvider'\r\nimport { openFile, VALID_REPLAY_EXTENSIONS } from './packetsReplay/replayPackets'\r\n\r\nconst parseNbt = promisify(nbt.parse)\r\nconst simplifyNbt = nbt.simplify\r\nwindow.nbt = nbt\r\n\r\n// todo display drop zone\r\nfor (const event of ['drag', 'dragstart', 'dragend', 'dragover', 'dragenter', 'dragleave', 'drop']) {\r\n  window.addEventListener(event, (e: any) => {\r\n    if (e.dataTransfer && !e.dataTransfer.types.includes('Files')) {\r\n      // e.dataTransfer.effectAllowed = \"none\"\r\n      return\r\n    }\r\n    e.preventDefault()\r\n  })\r\n}\r\nwindow.addEventListener('drop', async e => {\r\n  if (!e.dataTransfer?.files.length) return\r\n  const { items } = e.dataTransfer\r\n  const item = items[0]\r\n  if (item.getAsFileSystemHandle) {\r\n    const filehandle = await item.getAsFileSystemHandle() as FileSystemFileHandle | FileSystemDirectoryHandle\r\n    if (filehandle.kind === 'file') {\r\n      const file = await filehandle.getFile()\r\n\r\n      await handleDroppedFile(file)\r\n    } else {\r\n      if (isGameActive(false)) {\r\n        alert('Exit current world first, before loading a new one.')\r\n        return\r\n      }\r\n      await openWorldDirectory(filehandle)\r\n    }\r\n  } else {\r\n    await handleDroppedFile(item.getAsFile()!)\r\n  }\r\n})\r\n\r\nasync function handleDroppedFile (file: File) {\r\n  if (file.name.endsWith('.zip')) {\r\n    void openWorldZip(file)\r\n    return\r\n  }\r\n  // if (file.name.endsWith('.mca')) // TODO let's do something interesting with it: viewer?\r\n  if (file.name.endsWith('.rar')) {\r\n    alert('Rar files are not supported yet!')\r\n    return\r\n  }\r\n  if (VALID_REPLAY_EXTENSIONS.some(ext => file.name.endsWith(ext)) || file.name.startsWith('packets-replay')) {\r\n    const contents = await file.text()\r\n    openFile({\r\n      contents,\r\n      filename: file.name,\r\n      filesize: file.size\r\n    })\r\n    return\r\n  }\r\n  if (file.name.endsWith('.mca')) {\r\n    const tempPath = '/temp/temp.mca'\r\n    try {\r\n      await fs.promises.writeFile(tempPath, Buffer.from(await file.arrayBuffer()) as any)\r\n      const region = new RegionFile(tempPath)\r\n      await region.initialize()\r\n      const chunks: Record<string, any> = {}\r\n      console.log('Reading chunks...')\r\n      console.log(chunks)\r\n      let versionDetected = false\r\n      for (const [i, _] of Array.from({ length: 32 }).entries()) {\r\n        for (const [k, _] of Array.from({ length: 32 }).entries()) {\r\n          // todo, may use faster reading, but features is not commonly used\r\n          // eslint-disable-next-line no-await-in-loop\r\n          const nbt = await region.read(i, k)\r\n          chunks[`${i},${k}`] = nbt\r\n          if (nbt && !versionDetected) {\r\n            const simplified = simplifyNbt(nbt)\r\n            const version = versions.pc.find(x => x['dataVersion'] === simplified.DataVersion)?.minecraftVersion\r\n            console.log('Detected version', version ?? 'unknown')\r\n            versionDetected = true\r\n          }\r\n        }\r\n      }\r\n      Object.defineProperty(chunks, 'simplified', {\r\n        get () {\r\n          const mapped = {}\r\n          for (const [i, _] of Array.from({ length: 32 }).entries()) {\r\n            for (const [k, _] of Array.from({ length: 32 }).entries()) {\r\n              const key = `${i},${k}`\r\n              const chunk = chunks[key]\r\n              if (!chunk) continue\r\n              mapped[key] = simplifyNbt(chunk)\r\n            }\r\n          }\r\n          return mapped\r\n        },\r\n      })\r\n      console.log('Done!', chunks)\r\n    } finally {\r\n      await fs.promises.unlink(tempPath)\r\n    }\r\n    return\r\n  }\r\n\r\n  const buffer = await file.arrayBuffer()\r\n  const parsed = await parseNbt(Buffer.from(buffer)).catch((err) => {\r\n    alert('Couldn\\'t parse nbt, ensure you are opening .dat or file (or .zip/folder with a world)')\r\n    throw err\r\n  })\r\n  showNotification(`${file.name} data available in browser console`)\r\n  console.log('raw', parsed)\r\n  console.log('simplified', nbt.simplify(parsed))\r\n}\r\n","import { Entity } from 'prismarine-entity'\r\nimport { versionToNumber } from 'renderer/viewer/prepare/utils'\r\nimport tracker from '@nxg-org/mineflayer-tracker'\r\nimport { loader as autoJumpPlugin } from '@nxg-org/mineflayer-auto-jump'\r\nimport { subscribeKey } from 'valtio/utils'\r\nimport { options, watchValue } from './optionsStorage'\r\nimport { miscUiState } from './globalState'\r\n\r\n\r\nconst updateAutoJump = () => {\r\n  if (!bot?.autoJumper) return\r\n  const autoJump = options.autoParkour || (options.autoJump === 'auto' ? miscUiState.currentTouch && !miscUiState.usingGamepadInput : options.autoJump === 'always')\r\n  bot.autoJumper.setOpts({\r\n    jumpIntoWater: options.autoParkour,\r\n    jumpOnAllEdges: options.autoParkour,\r\n    // strictBlockCollision: true,\r\n  })\r\n  if (autoJump === bot.autoJumper.enabled) return\r\n  if (autoJump) {\r\n    bot.autoJumper.enable()\r\n  } else {\r\n    bot.autoJumper.disable()\r\n  }\r\n}\r\nsubscribeKey(options, 'autoJump', () => {\r\n  updateAutoJump()\r\n})\r\nsubscribeKey(options, 'autoParkour', () => {\r\n  updateAutoJump()\r\n})\r\nsubscribeKey(miscUiState, 'usingGamepadInput', () => {\r\n  updateAutoJump()\r\n})\r\nsubscribeKey(miscUiState, 'currentTouch', () => {\r\n  updateAutoJump()\r\n})\r\n\r\ncustomEvents.on('gameLoaded', () => {\r\n  bot.loadPlugin(tracker)\r\n  bot.loadPlugin(autoJumpPlugin)\r\n  updateAutoJump()\r\n\r\n  // todo cleanup (move to viewer, also shouldnt be used at all)\r\n  const playerPerAnimation = {} as Record<string, string>\r\n  const entityData = (e: Entity) => {\r\n    if (!e.username) return\r\n    window.debugEntityMetadata ??= {}\r\n    window.debugEntityMetadata[e.username] = e\r\n    // todo entity spawn timing issue, check perf\r\n    const playerObject = viewer.entities.entities[e.id]?.playerObject\r\n    if (playerObject) {\r\n      // todo throttle!\r\n      bot.tracker.trackEntity(e)\r\n      playerObject.backEquipment = e.equipment.some((item) => item?.name === 'elytra') ? 'elytra' : 'cape'\r\n      if (playerObject.cape.map === null) {\r\n        playerObject.cape.visible = false\r\n      }\r\n      // todo (easy, important) elytra flying animation\r\n      // todo cleanup states\r\n    }\r\n  }\r\n\r\n  let lastCall = 0\r\n  bot.on('physicsTick', () => {\r\n    // throttle, tps: 6\r\n    if (Date.now() - lastCall < 166) return\r\n    lastCall = Date.now()\r\n    for (const [id, { tracking, info }] of Object.entries(bot.tracker.trackingData)) {\r\n      if (!tracking) continue\r\n      const e = bot.entities[id]\r\n      if (!e) continue\r\n      const speed = info.avgSpeed\r\n      const WALKING_SPEED = 0.03\r\n      const SPRINTING_SPEED = 0.18\r\n      const isWalking = Math.abs(speed.x) > WALKING_SPEED || Math.abs(speed.z) > WALKING_SPEED\r\n      const isSprinting = Math.abs(speed.x) > SPRINTING_SPEED || Math.abs(speed.z) > SPRINTING_SPEED\r\n      const newAnimation = isWalking ? (isSprinting ? 'running' : 'walking') : 'idle'\r\n      if (newAnimation !== playerPerAnimation[id]) {\r\n        viewer.entities.playAnimation(e.id, newAnimation)\r\n        playerPerAnimation[id] = newAnimation\r\n      }\r\n    }\r\n  })\r\n\r\n  bot.on('entitySwingArm', (e) => {\r\n    if (viewer.entities.entities[e.id]?.playerObject) {\r\n      viewer.entities.playAnimation(e.id, 'oneSwing')\r\n    }\r\n  })\r\n\r\n  bot._client.on('damage_event', (data) => {\r\n    const { entityId, sourceTypeId: damage } = data\r\n    if (viewer.entities.entities[entityId]) {\r\n      viewer.entities.handleDamageEvent(entityId, damage)\r\n    }\r\n  })\r\n\r\n  bot._client.on('entity_status', (data) => {\r\n    if (versionToNumber(bot.version) >= versionToNumber('1.19.4')) return\r\n    const { entityId, entityStatus } = data\r\n    if (entityStatus === 2 && viewer.entities.entities[entityId]) {\r\n      viewer.entities.handleDamageEvent(entityId, entityStatus)\r\n    }\r\n  })\r\n\r\n  const loadedSkinEntityIds = new Set<number>()\r\n\r\n  const playerRenderSkin = (e: Entity) => {\r\n    const mesh = viewer.entities.entities[e.id]\r\n    if (!mesh) return\r\n    if (!mesh.playerObject || !options.loadPlayerSkins) return\r\n    const MAX_DISTANCE_SKIN_LOAD = 128\r\n    const distance = e.position.distanceTo(bot.entity.position)\r\n    if (distance < MAX_DISTANCE_SKIN_LOAD && distance < (bot.settings.viewDistance as number) * 16) {\r\n      if (viewer.entities.entities[e.id]) {\r\n        if (loadedSkinEntityIds.has(e.id)) return\r\n        loadedSkinEntityIds.add(e.id)\r\n        viewer.entities.updatePlayerSkin(e.id, e.username, e.uuid, true, true)\r\n      }\r\n    }\r\n  }\r\n  viewer.entities.addListener('remove', (e) => {\r\n    loadedSkinEntityIds.delete(e.id)\r\n    playerPerAnimation[e.id] = ''\r\n    bot.tracker.stopTrackingEntity(e, true)\r\n  })\r\n\r\n  bot.on('entityMoved', (e) => {\r\n    playerRenderSkin(e)\r\n    entityData(e)\r\n  })\r\n  bot._client.on('entity_velocity', (packet) => {\r\n    const e = bot.entities[packet.entityId]\r\n    if (!e) return\r\n    entityData(e)\r\n  })\r\n\r\n  viewer.entities.addListener('add', (e) => {\r\n    if (!viewer.entities.entities[e.id]) throw new Error('mesh still not loaded')\r\n    playerRenderSkin(e)\r\n  })\r\n\r\n  for (const entity of Object.values(bot.entities)) {\r\n    if (entity !== bot.entity) {\r\n      entityData(entity)\r\n    }\r\n  }\r\n\r\n  bot.on('entitySpawn', entityData)\r\n  bot.on('entityUpdate', entityData)\r\n  bot.on('entityEquip', entityData)\r\n\r\n  watchValue(options, o => {\r\n    viewer.entities.setDebugMode(o.showChunkBorders ? 'basic' : 'none')\r\n  })\r\n\r\n  // Texture override from packet properties\r\n  bot._client.on('player_info', (packet) => {\r\n    for (const playerEntry of packet.data) {\r\n      if (!playerEntry.player && !playerEntry.properties) continue\r\n      let textureProperty = playerEntry.properties?.find(prop => prop?.name === 'textures')\r\n      if (!textureProperty) {\r\n        textureProperty = playerEntry.player?.properties?.find(prop => prop?.key === 'textures')\r\n      }\r\n      if (textureProperty) {\r\n        try {\r\n          const textureData = JSON.parse(Buffer.from(textureProperty.value, 'base64').toString())\r\n          const skinUrl = textureData.textures?.SKIN?.url\r\n          const capeUrl = textureData.textures?.CAPE?.url\r\n\r\n          // Find entity with matching UUID and update skin\r\n          let entityId = ''\r\n          for (const [entId, entity] of Object.entries(bot.entities)) {\r\n            if (entity.uuid === playerEntry.uuid) {\r\n              entityId = entId\r\n              break\r\n            }\r\n          }\r\n          // even if not found, still record to cache\r\n          viewer.entities.updatePlayerSkin(entityId, playerEntry.player?.name, playerEntry.uuid, skinUrl, capeUrl)\r\n        } catch (err) {\r\n          console.error('Error decoding player texture:', err)\r\n        }\r\n      }\r\n    }\r\n\r\n  })\r\n})\r\n","export const guessProblem = (errorMessage: string) => {\r\n  if (errorMessage.endsWith('Socket error: ECONNREFUSED')) {\r\n    return 'Most probably the server is not running.'\r\n  }\r\n}\r\n\r\nexport const loadingTexts = [\r\n  'Like the project? Give us a star on GitHub or rate us on AlternativeTo!',\r\n  'To stay updated with the latest changes, go to the GitHub page, click on \"Watch\", choose \"Custom\", and then opt for \"Releases\"!',\r\n  'Upvote features on GitHub issues to help us prioritize them!',\r\n  'Want to contribute to the project? Check out Contributing.md on GitHub!',\r\n]\r\n","import { saveServer } from './flyingSquidUtils'\r\nimport { watchUnloadForCleanup } from './gameUnload'\r\nimport { showModal } from './globalState'\r\nimport { options } from './optionsStorage'\r\nimport { chatInputValueGlobal } from './react/Chat'\r\nimport { showNotification } from './react/NotificationProvider'\r\n\r\nexport default () => {\r\n  localServer!.on('warpsLoaded', () => {\r\n    if (!localServer) return\r\n    showNotification(`${localServer.warps.length} Warps loaded`, 'Use /warp <name> to teleport to a warp point.', false, 'label-alt', () => {\r\n      chatInputValueGlobal.value = '/warp '\r\n      showModal({ reactType: 'chat' })\r\n    })\r\n  })\r\n\r\n  if (options.singleplayerAutoSave) {\r\n    const autoSaveInterval = setInterval(() => {\r\n      if (options.singleplayerAutoSave) {\r\n        void saveServer(true)\r\n      }\r\n    }, 2000)\r\n    watchUnloadForCleanup(() => {\r\n      clearInterval(autoSaveInterval)\r\n    })\r\n  }\r\n}\r\n","import * as crypto from 'crypto'\r\nimport UUID from 'uuid-1345'\r\nimport { fsState } from './loadSave'\r\n\r\n\r\n// https://github.com/PrismarineJS/node-minecraft-protocol/blob/cf1f67117d586b5e6e21f0d9602da12e9fcf46b6/src/server/login.js#L170\r\nfunction javaUUID (s: string) {\r\n  const hash = crypto.createHash('md5')\r\n  hash.update(s, 'utf8')\r\n  const buffer = hash.digest()\r\n  buffer[6] = (buffer[6] & 15) | 48\r\n  buffer[8] = (buffer[8] & 63) | 128\r\n  return buffer\r\n}\r\n\r\nexport function nameToMcOfflineUUID (name) {\r\n  return (new UUID(javaUUID('OfflinePlayer:' + name))).toString()\r\n}\r\n\r\nexport async function savePlayers (autoSave: boolean) {\r\n  if (autoSave && new URL(location.href).searchParams.get('noSave') === 'true') return\r\n  //@ts-expect-error TODO\r\n  await localServer!.savePlayersSingleplayer()\r\n}\r\n\r\n// todo flying squid should expose save function instead\r\nexport const saveServer = async (autoSave = true) => {\r\n  if (!localServer || fsState.isReadonly) return\r\n  // todo\r\n  console.time('save server')\r\n  const worlds = [(localServer as any).overworld] as Array<import('prismarine-world').world.World>\r\n  await Promise.all([localServer.writeLevelDat(), savePlayers(autoSave), ...worlds.map(async world => world.saveNow())])\r\n  console.timeEnd('save server')\r\n}\r\nexport const disconnect = async () => {\r\n  if (localServer) {\r\n    await saveServer()\r\n    void localServer.quit() // todo investigate we should await\r\n  }\r\n  window.history.replaceState({}, '', `${window.location.pathname}`) // remove qs\r\n  bot.end('You left the server')\r\n  location.reload()\r\n}\r\n","import { subscribe } from 'valtio'\r\nimport { miscUiState } from './globalState'\r\n\r\nlet toCleanup = [] as Array<() => void>\r\n\r\nexport const watchUnloadForCleanup = (func: () => void) => {\r\n  toCleanup.push(func)\r\n}\r\n\r\nsubscribe(miscUiState, () => {\r\n  if (!miscUiState.gameLoaded) {\r\n    for (const func of toCleanup) {\r\n      func()\r\n    }\r\n    toCleanup = []\r\n  }\r\n})\r\n","import latest_gui_title_minecraft from 'mc-assets/dist/other-textures/latest/gui/title/minecraft.png'\nimport other_textures_1_19_gui_icons from 'mc-assets/dist/other-textures/1.19/gui/icons.png'\nimport other_textures_latest_gui_widgets from 'mc-assets/dist/other-textures/latest/gui/widgets.png'\nimport other_textures_latest_gui_bars from 'mc-assets/dist/other-textures/latest/gui/bars.png'\nimport latest_gui_container_inventory from 'mc-assets/dist/other-textures/latest/gui/container/inventory.png'\nimport latest_gui_container_shulker_box from 'mc-assets/dist/other-textures/latest/gui/container/shulker_box.png'\nimport latest_gui_container_generic_54 from 'mc-assets/dist/other-textures/latest/gui/container/generic_54.png'\nimport latest_gui_container_furnace from 'mc-assets/dist/other-textures/latest/gui/container/furnace.png'\nimport latest_gui_container_crafting_table from 'mc-assets/dist/other-textures/latest/gui/container/crafting_table.png'\nimport latest_gui_container_dispenser from 'mc-assets/dist/other-textures/latest/gui/container/dispenser.png'\nimport latest_gui_container_hopper from 'mc-assets/dist/other-textures/latest/gui/container/hopper.png'\nimport latest_gui_container_horse from 'mc-assets/dist/other-textures/latest/gui/container/horse.png'\nimport latest_gui_container_villager2 from 'mc-assets/dist/other-textures/latest/gui/container/villager2.png'\nimport latest_gui_container_enchanting_table from 'mc-assets/dist/other-textures/latest/gui/container/enchanting_table.png'\nimport latest_gui_container_anvil from 'mc-assets/dist/other-textures/latest/gui/container/anvil.png'\nimport latest_gui_container_beacon from 'mc-assets/dist/other-textures/latest/gui/container/beacon.png'\n\nexport const appReplacableResources: { [key in Keys]: { content: any, resourcePackPath: string, cssVar?: string, cssVarRepeat?: number } } = {\n\n  'latest_gui_title_minecraft': {\n    content: latest_gui_title_minecraft,\n    resourcePackPath: 'minecraft/textures/gui/title/minecraft.png',\n    ...{\"cssVar\":\"--title-gui\"}\n  },\n\n  'other_textures_1_19_gui_icons': {\n    content: other_textures_1_19_gui_icons,\n    resourcePackPath: 'minecraft/textures/gui/icons.png',\n    ...{\"cssVar\":\"--gui-icons\",\"cssVarRepeat\":2}\n  },\n\n  'other_textures_latest_gui_widgets': {\n    content: other_textures_latest_gui_widgets,\n    resourcePackPath: 'minecraft/textures/gui/widgets.png',\n    ...{\"cssVar\":\"--widgets-gui-atlas\"}\n  },\n\n  'other_textures_latest_gui_bars': {\n    content: other_textures_latest_gui_bars,\n    resourcePackPath: 'minecraft/textures/gui/bars.png',\n    ...{\"cssVar\":\"--bars-gui-atlas\"}\n  },\n\n  'latest_gui_container_inventory': {\n    content: latest_gui_container_inventory,\n    resourcePackPath: 'minecraft/textures/gui/container/inventory.png',\n    ...{}\n  },\n\n  'latest_gui_container_shulker_box': {\n    content: latest_gui_container_shulker_box,\n    resourcePackPath: 'minecraft/textures/gui/container/shulker_box.png',\n    ...{}\n  },\n\n  'latest_gui_container_generic_54': {\n    content: latest_gui_container_generic_54,\n    resourcePackPath: 'minecraft/textures/gui/container/generic_54.png',\n    ...{}\n  },\n\n  'latest_gui_container_furnace': {\n    content: latest_gui_container_furnace,\n    resourcePackPath: 'minecraft/textures/gui/container/furnace.png',\n    ...{}\n  },\n\n  'latest_gui_container_crafting_table': {\n    content: latest_gui_container_crafting_table,\n    resourcePackPath: 'minecraft/textures/gui/container/crafting_table.png',\n    ...{}\n  },\n\n  'latest_gui_container_dispenser': {\n    content: latest_gui_container_dispenser,\n    resourcePackPath: 'minecraft/textures/gui/container/dispenser.png',\n    ...{}\n  },\n\n  'latest_gui_container_hopper': {\n    content: latest_gui_container_hopper,\n    resourcePackPath: 'minecraft/textures/gui/container/hopper.png',\n    ...{}\n  },\n\n  'latest_gui_container_horse': {\n    content: latest_gui_container_horse,\n    resourcePackPath: 'minecraft/textures/gui/container/horse.png',\n    ...{}\n  },\n\n  'latest_gui_container_villager2': {\n    content: latest_gui_container_villager2,\n    resourcePackPath: 'minecraft/textures/gui/container/villager2.png',\n    ...{}\n  },\n\n  'latest_gui_container_enchanting_table': {\n    content: latest_gui_container_enchanting_table,\n    resourcePackPath: 'minecraft/textures/gui/container/enchanting_table.png',\n    ...{}\n  },\n\n  'latest_gui_container_anvil': {\n    content: latest_gui_container_anvil,\n    resourcePackPath: 'minecraft/textures/gui/container/anvil.png',\n    ...{}\n  },\n\n  'latest_gui_container_beacon': {\n    content: latest_gui_container_beacon,\n    resourcePackPath: 'minecraft/textures/gui/container/beacon.png',\n    ...{}\n  },\n}\ntype Keys = 'latest_gui_title_minecraft' | 'other_textures_1_19_gui_icons' | 'other_textures_latest_gui_widgets' | 'other_textures_latest_gui_bars' | 'latest_gui_container_inventory' | 'latest_gui_container_shulker_box' | 'latest_gui_container_generic_54' | 'latest_gui_container_furnace' | 'latest_gui_container_crafting_table' | 'latest_gui_container_dispenser' | 'latest_gui_container_hopper' | 'latest_gui_container_horse' | 'latest_gui_container_villager2' | 'latest_gui_container_enchanting_table' | 'latest_gui_container_anvil' | 'latest_gui_container_beacon'\nexport const resourcesContentOriginal = {\n\n  'latest_gui_title_minecraft': latest_gui_title_minecraft,\n\n  'other_textures_1_19_gui_icons': other_textures_1_19_gui_icons,\n\n  'other_textures_latest_gui_widgets': other_textures_latest_gui_widgets,\n\n  'other_textures_latest_gui_bars': other_textures_latest_gui_bars,\n\n  'latest_gui_container_inventory': latest_gui_container_inventory,\n\n  'latest_gui_container_shulker_box': latest_gui_container_shulker_box,\n\n  'latest_gui_container_generic_54': latest_gui_container_generic_54,\n\n  'latest_gui_container_furnace': latest_gui_container_furnace,\n\n  'latest_gui_container_crafting_table': latest_gui_container_crafting_table,\n\n  'latest_gui_container_dispenser': latest_gui_container_dispenser,\n\n  'latest_gui_container_hopper': latest_gui_container_hopper,\n\n  'latest_gui_container_horse': latest_gui_container_horse,\n\n  'latest_gui_container_villager2': latest_gui_container_villager2,\n\n  'latest_gui_container_enchanting_table': latest_gui_container_enchanting_table,\n\n  'latest_gui_container_anvil': latest_gui_container_anvil,\n\n  'latest_gui_container_beacon': latest_gui_container_beacon,\n}\n","import { getRenamedData } from 'flying-squid/dist/blockRenames'\r\nimport outputInteractionShapesJson from './interactionShapesGenerated.json'\r\nimport './getCollisionShapes'\r\n\r\nexport default () => {\r\n  customEvents.on('gameLoaded', () => {\r\n    // todo also remap block states (e.g. redstone)!\r\n    const renamedBlocksInteraction = getRenamedData('blocks', Object.keys(outputInteractionShapesJson), '1.20.2', bot.version)\r\n    const interactionShapes = {\r\n      ...outputInteractionShapesJson,\r\n      ...Object.fromEntries(Object.entries(outputInteractionShapesJson).map(([block, shape], i) => [renamedBlocksInteraction[i], shape]))\r\n    }\r\n    interactionShapes[''] = interactionShapes['air']\r\n    // todo make earlier\r\n    window.interactionShapes = interactionShapes\r\n  })\r\n}\r\n","import { getRenamedData } from 'flying-squid/dist/blockRenames'\r\nimport collisionShapesInit from '../generated/latestBlockCollisionsShapes.json'\r\n\r\n// defining globally to be used in loaded data, not sure of better workaround\r\nwindow.globalGetCollisionShapes = (version) => {\r\n  // todo use the same in resourcepack\r\n  const versionFrom = collisionShapesInit.version\r\n  const renamedBlocks = getRenamedData('blocks', Object.keys(collisionShapesInit.blocks), versionFrom, version)\r\n  const collisionShapes = {\r\n    ...collisionShapesInit,\r\n    blocks: Object.fromEntries(Object.entries(collisionShapesInit.blocks).map(([, shape], i) => [renamedBlocks[i], shape]))\r\n  }\r\n  return collisionShapes\r\n}\r\n","import { saveServer } from './flyingSquidUtils'\r\nimport { isGameActive, activeModalStack } from './globalState'\r\nimport { options } from './optionsStorage'\r\nimport { isInRealGameSession } from './utils'\r\n\r\nwindow.addEventListener('unload', (e) => {\r\n  if (!window.justReloaded) {\r\n    sessionStorage.justReloaded = false\r\n  }\r\n  void saveServer()\r\n})\r\n\r\ndocument.addEventListener('visibilitychange', () => {\r\n  if (document.visibilityState === 'hidden') void saveServer()\r\n})\r\ndocument.addEventListener('blur', () => {\r\n  void saveServer()\r\n})\r\n\r\nwindow.addEventListener('beforeunload', (event) => {\r\n  if (!window.justReloaded) {\r\n    sessionStorage.justReloaded = false\r\n  }\r\n\r\n  // todo-low maybe exclude chat?\r\n  if (!isGameActive(true) && activeModalStack.at(-1)?.elem?.id !== 'chat') return\r\n  if (sessionStorage.lastReload && !options.preventDevReloadWhilePlaying) return\r\n  if (!options.closeConfirmation) return\r\n  if (!isInRealGameSession()) return\r\n\r\n  // For major browsers doning only this is enough\r\n  event.preventDefault()\r\n\r\n  // Display a confirmation prompt\r\n  event.returnValue = '' // Required for some browsers\r\n  return 'The game is running. Are you sure you want to close this page?'\r\n})\r\n","//@ts-check\r\n\r\nimport { proxy, ref, subscribe } from 'valtio'\r\nimport type { WorldWarp } from 'flying-squid/dist/lib/modules/warps'\r\nimport type { OptionsGroupType } from './optionsGuiScheme'\r\nimport { options, disabledSettings } from './optionsStorage'\r\nimport { AppConfig } from './appConfig'\r\n\r\n// todo: refactor structure with support of hideNext=false\r\n\r\nexport const notHideableModalsWithoutForce = new Set(['app-status'])\r\n\r\ntype Modal = ({ elem?: HTMLElement & Record<string, any> } & { reactType: string })\r\n\r\ntype ContextMenuItem = { callback; label }\r\n\r\nexport const activeModalStack: Modal[] = proxy([])\r\n\r\nexport const insertActiveModalStack = (name: string, newModalStack = activeModalStacks[name]) => {\r\n  hideModal(undefined, undefined, { restorePrevious: false, force: true })\r\n  activeModalStack.splice(0, activeModalStack.length, ...newModalStack)\r\n  const last = activeModalStack.at(-1)\r\n  if (last) showModalInner(last)\r\n}\r\n\r\nexport const activeModalStacks: Record<string, Modal[]> = {}\r\n\r\nwindow.activeModalStack = activeModalStack\r\n\r\n/**\r\n * @returns true if operation was successful\r\n */\r\nconst showModalInner = (modal: Modal) => {\r\n  const cancel = modal.elem?.show?.()\r\n  return true\r\n}\r\n\r\nexport const showModal = (elem: /* (HTMLElement & Record<string, any>) |  */{ reactType: string }) => {\r\n  const resolved = elem\r\n  const curModal = activeModalStack.at(-1)\r\n  if (/* elem === curModal?.elem ||  */(elem.reactType && elem.reactType === curModal?.reactType) || !showModalInner(resolved)) return\r\n  activeModalStack.push(resolved)\r\n}\r\n\r\n/**\r\n *\r\n * @returns true if previous modal was restored\r\n */\r\nexport const hideModal = (modal = activeModalStack.at(-1), data: any = undefined, options: { force?: boolean; restorePrevious?: boolean } = {}) => {\r\n  const { force = false, restorePrevious = true } = options\r\n  if (!modal) return\r\n  let cancel = notHideableModalsWithoutForce.has(modal.reactType) ? !force : undefined\r\n  if (force) {\r\n    cancel = undefined\r\n  }\r\n\r\n  if (!cancel) {\r\n    const lastModal = activeModalStack.at(-1)\r\n    for (let i = activeModalStack.length - 1; i >= 0; i--) {\r\n      if (activeModalStack[i].reactType === modal.reactType) {\r\n        activeModalStack.splice(i, 1)\r\n        break\r\n      }\r\n    }\r\n    const newModal = activeModalStack.at(-1)\r\n    if (newModal && lastModal !== newModal && restorePrevious) {\r\n      // would be great to ignore cancel I guess?\r\n      showModalInner(newModal)\r\n    }\r\n    return true\r\n  }\r\n}\r\n\r\nexport const hideCurrentModal = (_data?, onHide?: () => void) => {\r\n  if (hideModal(undefined, undefined)) {\r\n    onHide?.()\r\n  }\r\n}\r\n\r\nexport const hideAllModals = () => {\r\n  while (activeModalStack.length > 0) {\r\n    if (!hideModal()) break\r\n  }\r\n  return activeModalStack.length === 0\r\n}\r\n\r\nexport const openOptionsMenu = (group: OptionsGroupType) => {\r\n  showModal({ reactType: `options-${group}` })\r\n}\r\n\r\nsubscribe(activeModalStack, () => {\r\n  document.body.style.setProperty('--has-modals-z', activeModalStack.length ? '-1' : null)\r\n})\r\n\r\n// ---\r\n\r\nexport const currentContextMenu = proxy({ items: [] as ContextMenuItem[] | null, x: 0, y: 0 })\r\n\r\nexport const showContextmenu = (items: ContextMenuItem[], { clientX, clientY }) => {\r\n  Object.assign(currentContextMenu, {\r\n    items,\r\n    x: clientX,\r\n    y: clientY,\r\n  })\r\n}\r\n\r\n// ---\r\n\r\nexport const miscUiState = proxy({\r\n  currentDisplayQr: null as string | null,\r\n  currentTouch: null as boolean | null,\r\n  hasErrors: false,\r\n  singleplayer: false,\r\n  flyingSquid: false,\r\n  wanOpened: false,\r\n  wanOpening: false,\r\n  /** wether game hud is shown (in playing state) */\r\n  gameLoaded: false,\r\n  showUI: true,\r\n  loadedServerIndex: '',\r\n  /** currently trying to load or loaded mc version, after all data is loaded */\r\n  loadedDataVersion: null as string | null,\r\n  fsReady: false,\r\n  singleplayerAvailable: false,\r\n  usingGamepadInput: false,\r\n  appConfig: null as AppConfig | null,\r\n  displaySearchInput: false,\r\n  displayFullmap: false\r\n})\r\n\r\nexport const isGameActive = (foregroundCheck: boolean) => {\r\n  if (foregroundCheck && activeModalStack.length) return false\r\n  return miscUiState.gameLoaded\r\n}\r\n\r\nwindow.miscUiState = miscUiState\r\n\r\n// state that is not possible to get via bot and in-game specific\r\nexport const gameAdditionalState = proxy({\r\n  isFlying: false,\r\n  isSprinting: false,\r\n  isSneaking: false,\r\n  isZooming: false,\r\n  warps: [] as WorldWarp[],\r\n  noConnection: false,\r\n  poorConnection: false,\r\n  viewerConnection: false,\r\n\r\n  usingServerResourcePack: false,\r\n})\r\n\r\nwindow.gameAdditionalState = gameAdditionalState\r\n","import EventEmitter from 'events'\r\n\r\nwindow.reportError = window.reportError ?? console.error\r\nwindow.bot = undefined\r\nwindow.THREE = undefined\r\nwindow.localServer = undefined\r\nwindow.worldView = undefined\r\nwindow.viewer = undefined\r\nwindow.loadedData = undefined\r\nwindow.customEvents = new EventEmitter()\r\n","import { GoogleOAuthProvider, useGoogleLogin } from '@react-oauth/google'\r\nimport { proxy, ref, subscribe } from 'valtio'\r\nimport React from 'react'\r\nimport { loadScript } from 'renderer/viewer/lib/utils'\r\nimport { loadGoogleDriveApi, loadInMemorySave } from './react/SingleplayerProvider'\r\nimport { setLoadingScreenStatus } from './appStatus'\r\nimport { mountGoogleDriveFolder } from './browserfs'\r\nimport { showOptionsModal } from './react/SelectOption'\r\nimport { appQueryParams } from './appParams'\r\n\r\nconst CLIENT_ID = '137156026346-igv2gkjsj2hlid92rs3q7cjjnc77s132.apps.googleusercontent.com'\r\n// const CLIENT_ID = process.env.GOOGLE_CLIENT_ID\r\nconst SCOPES = 'https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/drive.install'\r\nexport const APP_ID = CLIENT_ID.split('-')[0]\r\n\r\nexport const GoogleDriveProvider = ({ children }) => {\r\n  return React.createElement(GoogleOAuthProvider, { clientId: CLIENT_ID } as any, children)\r\n  // return <GoogleOAuthProvider clientId={CLIENT_ID}><Root /></GoogleOAuthProvider>\r\n}\r\n\r\nexport const isGoogleDriveAvailable = () => {\r\n  return !!CLIENT_ID\r\n}\r\n\r\nexport const useGoogleLogIn = () => {\r\n  const login = useGoogleLogin({\r\n    onSuccess (tokenResponse) {\r\n      localStorage.hasEverLoggedIn = true\r\n      googleProviderState.accessToken = tokenResponse.access_token\r\n      googleProviderState.expiresIn = ref(new Date(Date.now() + tokenResponse.expires_in * 1000))\r\n      googleProviderState.hasEverLoggedIn = true\r\n    },\r\n    // prompt: hasEverLoggedIn ? 'none' : 'consent',\r\n    scope: SCOPES,\r\n    flow: 'implicit',\r\n    onError (error) {\r\n      const accessDenied = error.error === 'access_denied' || error.error === 'invalid_scope' || (error as any).error_subtype === 'access_denied'\r\n      if (accessDenied) {\r\n        googleProviderState.hasEverLoggedIn = false\r\n      }\r\n    }\r\n  })\r\n  return () => login({\r\n    prompt: googleProviderState.hasEverLoggedIn ? 'none' : 'consent'\r\n  })\r\n}\r\n\r\nexport const possiblyHandleStateVariable = async () => {\r\n  const stateParam = appQueryParams.state\r\n  if (!stateParam) return\r\n  setLoadingScreenStatus('Opening world in read only mode, waiting for login...')\r\n  await loadGoogleDriveApi()\r\n  await loadScript('https://accounts.google.com/gsi/client')\r\n  const parsed = JSON.parse(stateParam) as {\r\n    ids: [string]\r\n    action: 'open'\r\n    userId: string\r\n  }\r\n  const tokenClient = window.google.accounts.oauth2.initTokenClient({\r\n    client_id: CLIENT_ID,\r\n    scope: SCOPES,\r\n    async callback (response) {\r\n      if (response.error) {\r\n        setLoadingScreenStatus('Error: ' + response.error, true)\r\n        googleProviderState.hasEverLoggedIn = false\r\n        return\r\n      }\r\n      setLoadingScreenStatus('Opening world in read only mode...')\r\n      googleProviderState.accessToken = response.access_token\r\n      await mountGoogleDriveFolder(true, parsed.ids[0])\r\n      await loadInMemorySave('/google')\r\n    }\r\n  })\r\n  const choice = await showOptionsModal('Select an action...', ['Login'])\r\n  if (choice === 'Login') {\r\n    tokenClient.requestAccessToken({\r\n      prompt: googleProviderState.hasEverLoggedIn ? '' : 'consent',\r\n    })\r\n  } else {\r\n    window.close()\r\n  }\r\n}\r\n\r\nexport const googleProviderState = proxy({\r\n  accessToken: (localStorage.saveAccessToken ? localStorage.accessToken : null) as string | null,\r\n  hasEverLoggedIn: !!(localStorage.hasEverLoggedIn),\r\n  isReady: false,\r\n  expiresIn: localStorage.saveAccessToken ? ref(new Date(Date.now() + 1000 * 60 * 60)) : null,\r\n  readonlyMode: localStorage.googleReadonlyMode ? localStorage.googleReadonlyMode === 'true' : true,\r\n  lastSelectedFolder: (localStorage.lastSelectedFolder ? JSON.parse(localStorage.lastSelectedFolder) : null) as {\r\n    id: string\r\n    name: string\r\n  } | null\r\n})\r\n\r\nsubscribe(googleProviderState, () => {\r\n  localStorage.googleReadonlyMode = googleProviderState.readonlyMode\r\n  localStorage.lastSelectedFolder = googleProviderState.lastSelectedFolder ? JSON.stringify(googleProviderState.lastSelectedFolder) : null\r\n  if (googleProviderState.hasEverLoggedIn) {\r\n    localStorage.hasEverLoggedIn = true\r\n  } else {\r\n    delete localStorage.hasEverLoggedIn\r\n  }\r\n\r\n  if (localStorage.saveAccessToken && googleProviderState) {\r\n    // For testing only\r\n    localStorage.accessToken = googleProviderState.accessToken || null\r\n  } else {\r\n    delete localStorage.accessToken\r\n  }\r\n})\r\n","// workaround for mineflayer\r\nglobalThis.window ??= globalThis\r\nglobalThis.localStorage ??= {}\r\nprocess.versions.node = '18.0.0'\r\n\r\nif (!navigator.getGamepads) {\r\n  console.warn('navigator.getGamepads is not available, adding a workaround')\r\n  navigator.getGamepads ??= () => []\r\n}\r\n","/* eslint-disable import/order */\r\nimport './importsWorkaround'\r\nimport './styles.css'\r\nimport './testCrasher'\r\nimport './globals'\r\nimport './devtools'\r\nimport './entities'\r\nimport './customChannels'\r\nimport './globalDomListeners'\r\nimport './mineflayer/maps'\r\nimport './mineflayer/cameraShake'\r\nimport './shims/patchShims'\r\nimport './mineflayer/java-tester/index'\r\nimport './external'\r\nimport './appConfig'\r\nimport { getServerInfo } from './mineflayer/mc-protocol'\r\nimport { onGameLoad, renderSlot } from './inventoryWindows'\r\nimport { GeneralInputItem, RenderItem } from './mineflayer/items'\r\nimport initCollisionShapes from './getCollisionInteractionShapes'\r\nimport protocolMicrosoftAuth from 'minecraft-protocol/src/client/microsoftAuth'\r\nimport microsoftAuthflow from './microsoftAuthflow'\r\nimport { Duplex } from 'stream'\r\n\r\nimport './scaleInterface'\r\nimport { initWithRenderer } from './topRightStats'\r\n\r\nimport { options, watchValue } from './optionsStorage'\r\nimport './reactUi'\r\nimport { lockUrl, onBotCreate } from './controls'\r\nimport './dragndrop'\r\nimport { possiblyCleanHandle, resetStateAfterDisconnect } from './browserfs'\r\nimport { watchOptionsAfterViewerInit, watchOptionsAfterWorldViewInit } from './watchOptions'\r\nimport downloadAndOpenFile from './downloadAndOpenFile'\r\n\r\nimport fs from 'fs'\r\nimport net from 'net'\r\nimport mineflayer from 'mineflayer'\r\nimport { WorldDataEmitter, Viewer } from 'renderer/viewer'\r\nimport pathfinder from 'mineflayer-pathfinder'\r\n\r\nimport * as THREE from 'three'\r\nimport MinecraftData from 'minecraft-data'\r\nimport debug from 'debug'\r\nimport { defaultsDeep } from 'lodash-es'\r\nimport initializePacketsReplay from './packetsReplay/packetsReplayLegacy'\r\n\r\nimport { initVR } from './vr'\r\nimport {\r\n  activeModalStack,\r\n  activeModalStacks,\r\n  hideModal,\r\n  insertActiveModalStack,\r\n  isGameActive,\r\n  miscUiState,\r\n  showModal,\r\n  gameAdditionalState,\r\n} from './globalState'\r\n\r\nimport { parseServerAddress } from './parseServerAddress'\r\nimport { setLoadingScreenStatus } from './appStatus'\r\nimport { isCypress } from './standaloneUtils'\r\n\r\nimport {\r\n  removePanorama\r\n} from './panorama'\r\nimport { getItemDefinition } from 'mc-assets/dist/itemDefinitions'\r\n\r\nimport { startLocalServer, unsupportedLocalServerFeatures } from './createLocalServer'\r\nimport defaultServerOptions from './defaultLocalServerOptions'\r\nimport dayCycle from './dayCycle'\r\n\r\nimport { onAppLoad, resourcepackReload, resourcePackState } from './resourcePack'\r\nimport { ConnectPeerOptions, connectToPeer } from './localServerMultiplayer'\r\nimport CustomChannelClient from './customClient'\r\nimport { registerServiceWorker } from './serviceWorker'\r\nimport { appStatusState, lastConnectOptions } from './react/AppStatusProvider'\r\n\r\nimport { fsState } from './loadSave'\r\nimport { watchFov } from './rendererUtils'\r\nimport { loadInMemorySave } from './react/SingleplayerProvider'\r\n\r\nimport { ua } from './react/utils'\r\nimport { possiblyHandleStateVariable } from './googledrive'\r\nimport flyingSquidEvents from './flyingSquidEvents'\r\nimport { hideNotification, notificationProxy, showNotification } from './react/NotificationProvider'\r\nimport { saveToBrowserMemory } from './react/PauseScreen'\r\nimport { ViewerWrapper } from 'renderer/viewer/lib/viewerWrapper'\r\nimport './devReload'\r\nimport './water'\r\nimport { ConnectOptions, loadMinecraftData, getVersionAutoSelect, downloadOtherGameData, downloadAllMinecraftData } from './connect'\r\nimport { ref, subscribe } from 'valtio'\r\nimport { signInMessageState } from './react/SignInMessageProvider'\r\nimport { updateAuthenticatedAccountData, updateLoadedServerData, updateServerConnectionHistory } from './react/serversStorage'\r\nimport { versionToNumber } from 'renderer/viewer/prepare/utils'\r\nimport packetsPatcher from './mineflayer/plugins/packetsPatcher'\r\nimport { mainMenuState } from './react/MainMenuRenderApp'\r\nimport { ItemsRenderer } from 'mc-assets/dist/itemsRenderer'\r\nimport './mobileShim'\r\nimport { parseFormattedMessagePacket } from './botUtils'\r\nimport { getViewerVersionData, getWsProtocolStream, handleCustomChannel } from './viewerConnector'\r\nimport { getWebsocketStream } from './mineflayer/websocket-core'\r\nimport { appQueryParams, appQueryParamsArray } from './appParams'\r\nimport { playerState, PlayerStateManager } from './mineflayer/playerState'\r\nimport { states } from 'minecraft-protocol'\r\nimport { initMotionTracking } from './react/uiMotion'\r\nimport { UserError } from './mineflayer/userError'\r\nimport ping from './mineflayer/plugins/ping'\r\nimport mouse from './mineflayer/plugins/mouse'\r\nimport { LocalServer } from './customServer'\r\nimport { startLocalReplayServer } from './packetsReplay/replayPackets'\r\nimport { localRelayServerPlugin } from './mineflayer/plugins/packetsRecording'\r\nimport { createFullScreenProgressReporter } from './core/progressReporter'\r\nimport { getItemModelName } from './resourcesManager'\r\nimport { importLargeData } from '../generated/large-data-aliases'\r\n\r\nwindow.debug = debug\r\nwindow.THREE = THREE\r\nwindow.beforeRenderFrame = []\r\n\r\n// ACTUAL CODE\r\n\r\nvoid registerServiceWorker().then(() => {\r\n  mainMenuState.serviceWorkerLoaded = true\r\n})\r\nwatchFov()\r\ninitCollisionShapes()\r\ninitializePacketsReplay()\r\npacketsPatcher()\r\nonAppLoad()\r\n\r\n// Create three.js context, add to page\r\nlet renderer: THREE.WebGLRenderer\r\ntry {\r\n  renderer = new THREE.WebGLRenderer({\r\n    powerPreference: options.gpuPreference,\r\n    preserveDrawingBuffer: true,\r\n    logarithmicDepthBuffer: true,\r\n  })\r\n} catch (err) {\r\n  console.error(err)\r\n  throw new Error(`Failed to create WebGL context, not possible to render (restart browser): ${err.message}`)\r\n}\r\n\r\n// renderer.localClippingEnabled = true\r\ninitWithRenderer(renderer.domElement)\r\nconst renderWrapper = new ViewerWrapper(renderer.domElement, renderer)\r\nrenderWrapper.addToPage()\r\nwatchValue(options, (o) => {\r\n  renderWrapper.renderInterval = o.frameLimit ? 1000 / o.frameLimit : 0\r\n  renderWrapper.renderIntervalUnfocused = o.backgroundRendering === '5fps' ? 1000 / 5 : o.backgroundRendering === '20fps' ? 1000 / 20 : undefined\r\n})\r\n\r\nconst isFirefox = ua.getBrowser().name === 'Firefox'\r\nif (isFirefox) {\r\n  // set custom property\r\n  document.body.style.setProperty('--thin-if-firefox', 'thin')\r\n}\r\n\r\nconst isIphone = ua.getDevice().model === 'iPhone' // todo ipad?\r\n\r\nif (isIphone) {\r\n  document.documentElement.style.setProperty('--hud-bottom-max', '21px') // env-safe-aria-inset-bottom\r\n}\r\n\r\nif (appQueryParams.testCrashApp === '2') throw new Error('test')\r\n\r\n// Create viewer\r\nconst viewer: import('renderer/viewer/lib/viewer').Viewer = new Viewer(renderer, undefined, playerState)\r\nwindow.viewer = viewer\r\nObject.defineProperty(window, 'world', {\r\n  get () {\r\n    return viewer.world\r\n  },\r\n})\r\n// todo unify\r\nviewer.entities.getItemUv = (item, specificProps) => {\r\n  const idOrName = item.itemId ?? item.blockId ?? item.name\r\n  try {\r\n    const name = typeof idOrName === 'number' ? loadedData.items[idOrName]?.name : idOrName\r\n    if (!name) throw new Error(`Item not found: ${idOrName}`)\r\n\r\n    const model = getItemModelName({\r\n      ...item,\r\n      name,\r\n    } as GeneralInputItem, specificProps)\r\n\r\n    const renderInfo = renderSlot({\r\n      modelName: model,\r\n    }, false, true)\r\n\r\n    if (!renderInfo) throw new Error(`Failed to get render info for item ${name}`)\r\n\r\n    const textureThree = renderInfo.texture === 'blocks' ? viewer.world.material.map! : viewer.entities.itemsTexture!\r\n    const img = textureThree.image\r\n\r\n    if (renderInfo.blockData) {\r\n      return {\r\n        resolvedModel: renderInfo.blockData.resolvedModel,\r\n        modelName: renderInfo.modelName!\r\n      }\r\n    }\r\n    if (renderInfo.slice) {\r\n      // Get slice coordinates from either block or item texture\r\n      const [x, y, w, h] = renderInfo.slice\r\n      const [u, v, su, sv] = [x / img.width, y / img.height, (w / img.width), (h / img.height)]\r\n      return {\r\n        u, v, su, sv,\r\n        texture: textureThree,\r\n        modelName: renderInfo.modelName\r\n      }\r\n    }\r\n\r\n    throw new Error(`Invalid render info for item ${name}`)\r\n  } catch (err) {\r\n    reportError?.(err)\r\n    // Return default UV coordinates for missing texture\r\n    return {\r\n      u: 0,\r\n      v: 0,\r\n      su: 16 / viewer.world.material.map!.image.width,\r\n      sv: 16 / viewer.world.material.map!.image.width,\r\n      texture: viewer.world.material.map!\r\n    }\r\n  }\r\n}\r\n\r\nviewer.entities.entitiesOptions = {\r\n  fontFamily: 'mojangles'\r\n}\r\nwatchOptionsAfterViewerInit()\r\n\r\nfunction hideCurrentScreens () {\r\n  activeModalStacks['main-menu'] = [...activeModalStack]\r\n  insertActiveModalStack('', [])\r\n}\r\n\r\nconst loadSingleplayer = (serverOverrides = {}, flattenedServerOverrides = {}) => {\r\n  const serverSettingsQsRaw = appQueryParamsArray.serverSetting ?? []\r\n  const serverSettingsQs = serverSettingsQsRaw.map(x => x.split(':')).reduce<Record<string, string>>((acc, [key, value]) => {\r\n    acc[key] = JSON.parse(value)\r\n    return acc\r\n  }, {})\r\n  void connect({ singleplayer: true, username: options.localUsername, serverOverrides, serverOverridesFlat: { ...flattenedServerOverrides, ...serverSettingsQs } })\r\n}\r\nfunction listenGlobalEvents () {\r\n  window.addEventListener('connect', e => {\r\n    const options = (e as CustomEvent).detail\r\n    void connect(options)\r\n  })\r\n  window.addEventListener('singleplayer', (e) => {\r\n    loadSingleplayer((e as CustomEvent).detail)\r\n  })\r\n}\r\n\r\nlet listeners = [] as Array<{ target, event, callback }>\r\nlet cleanupFunctions = [] as Array<() => void>\r\n// only for dom listeners (no removeAllListeners)\r\n// todo refactor them out of connect fn instead\r\nconst registerListener: import('./utilsTs').RegisterListener = (target, event, callback) => {\r\n  target.addEventListener(event, callback)\r\n  listeners.push({ target, event, callback })\r\n}\r\nconst removeAllListeners = () => {\r\n  for (const { target, event, callback } of listeners) {\r\n    target.removeEventListener(event, callback)\r\n  }\r\n  for (const cleanupFunction of cleanupFunctions) {\r\n    cleanupFunction()\r\n  }\r\n  cleanupFunctions = []\r\n  listeners = []\r\n}\r\n\r\nexport async function connect (connectOptions: ConnectOptions) {\r\n  if (miscUiState.gameLoaded) return\r\n  miscUiState.hasErrors = false\r\n  lastConnectOptions.value = connectOptions\r\n  removePanorama()\r\n\r\n  const { singleplayer } = connectOptions\r\n  const p2pMultiplayer = !!connectOptions.peerId\r\n  miscUiState.singleplayer = singleplayer\r\n  miscUiState.flyingSquid = singleplayer || p2pMultiplayer\r\n\r\n  // Track server connection in history\r\n  if (!singleplayer && !p2pMultiplayer && connectOptions.server && connectOptions.saveServerToHistory !== false) {\r\n    const parsedServer = parseServerAddress(connectOptions.server)\r\n    updateServerConnectionHistory(parsedServer.host, connectOptions.botVersion)\r\n  }\r\n\r\n  const { renderDistance: renderDistanceSingleplayer, multiplayerRenderDistance } = options\r\n\r\n  const parsedServer = parseServerAddress(connectOptions.server)\r\n  const server = { host: parsedServer.host, port: parsedServer.port }\r\n  if (connectOptions.proxy?.startsWith(':')) {\r\n    connectOptions.proxy = `${location.protocol}//${location.hostname}${connectOptions.proxy}`\r\n  }\r\n  if (connectOptions.proxy && location.port !== '80' && location.port !== '443' && !/:\\d+$/.test(connectOptions.proxy)) {\r\n    const https = connectOptions.proxy.startsWith('https://') || location.protocol === 'https:'\r\n    connectOptions.proxy = `${connectOptions.proxy}:${https ? 443 : 80}`\r\n  }\r\n  const parsedProxy = parseServerAddress(connectOptions.proxy, false)\r\n  const proxy = { host: parsedProxy.host, port: parsedProxy.port }\r\n  let { username } = connectOptions\r\n\r\n  if (connectOptions.server) {\r\n    console.log(`connecting to ${server.host}:${server.port ?? 25_565}`)\r\n  }\r\n  console.log('using player username', username)\r\n\r\n  hideCurrentScreens()\r\n  const progress = createFullScreenProgressReporter()\r\n  const loggingInMsg = connectOptions.server ? 'Connecting to server' : 'Logging in'\r\n  progress.beginStage('connect', loggingInMsg)\r\n\r\n  let ended = false\r\n  let bot!: typeof __type_bot\r\n  const destroyAll = () => {\r\n    if (ended) return\r\n    ended = true\r\n    viewer.resetAll()\r\n    progress.end()\r\n    localServer = window.localServer = window.server = undefined\r\n    gameAdditionalState.viewerConnection = false\r\n\r\n    renderWrapper.postRender = () => { }\r\n    if (bot) {\r\n      bot.end()\r\n      // ensure mineflayer plugins receive this event for cleanup\r\n      bot.emit('end', '')\r\n      bot.removeAllListeners()\r\n      bot._client.removeAllListeners()\r\n      //@ts-expect-error TODO?\r\n      bot._client = undefined\r\n      //@ts-expect-error\r\n      window.bot = bot = undefined\r\n    }\r\n    resetStateAfterDisconnect()\r\n    cleanFs()\r\n    removeAllListeners()\r\n  }\r\n  const cleanFs = () => {\r\n    if (singleplayer && !fsState.inMemorySave) {\r\n      possiblyCleanHandle(() => {\r\n        // todo: this is not enough, we need to wait for all async operations to finish\r\n      })\r\n    }\r\n  }\r\n  let lastPacket = undefined as string | undefined\r\n  const onPossibleErrorDisconnect = () => {\r\n    if (lastPacket && bot?._client && bot._client.state !== states.PLAY) {\r\n      appStatusState.descriptionHint = `Last Server Packet: ${lastPacket}`\r\n    }\r\n  }\r\n  const handleError = (err) => {\r\n    console.error(err)\r\n    if (err === 'ResizeObserver loop completed with undelivered notifications.') {\r\n      return\r\n    }\r\n    errorAbortController.abort()\r\n    if (isCypress()) throw err\r\n    miscUiState.hasErrors = true\r\n    if (miscUiState.gameLoaded) return\r\n\r\n    setLoadingScreenStatus(`Error encountered. ${err}`, true)\r\n    appStatusState.showReconnect = true\r\n    onPossibleErrorDisconnect()\r\n    destroyAll()\r\n  }\r\n\r\n  const errorAbortController = new AbortController()\r\n  window.addEventListener('unhandledrejection', (e) => {\r\n    if (e.reason.name === 'ServerPluginLoadFailure') {\r\n      if (confirm(`Failed to load server plugin ${e.reason.pluginName} (invoking ${e.reason.pluginMethod}). Continue?`)) {\r\n        return\r\n      }\r\n    }\r\n    handleError(e.reason)\r\n  }, {\r\n    signal: errorAbortController.signal\r\n  })\r\n  window.addEventListener('error', (e) => {\r\n    handleError(e.message)\r\n  }, {\r\n    signal: errorAbortController.signal\r\n  })\r\n\r\n  let clientDataStream: Duplex | undefined\r\n\r\n  if (connectOptions.server && !connectOptions.viewerWsConnect && !parsedServer.isWebSocket) {\r\n    console.log(`using proxy ${proxy.host}:${proxy.port || location.port}`)\r\n    net['setProxy']({ hostname: proxy.host, port: proxy.port })\r\n  }\r\n\r\n  const renderDistance = singleplayer ? renderDistanceSingleplayer : multiplayerRenderDistance\r\n  let updateDataAfterJoin = () => { }\r\n  let localServer\r\n  let localReplaySession: ReturnType<typeof startLocalReplayServer> | undefined\r\n  try {\r\n    const serverOptions = defaultsDeep({}, connectOptions.serverOverrides ?? {}, options.localServerOptions, defaultServerOptions)\r\n    Object.assign(serverOptions, connectOptions.serverOverridesFlat ?? {})\r\n\r\n    await progress.executeWithMessage('Downloading minecraft data', 'download-mcdata', async () => {\r\n      await Promise.all([\r\n        downloadAllMinecraftData(),\r\n        downloadOtherGameData()\r\n      ])\r\n    })\r\n\r\n    let dataDownloaded = false\r\n    const downloadMcData = async (version: string) => {\r\n      if (dataDownloaded) return\r\n      dataDownloaded = true\r\n\r\n      await progress.executeWithMessage(\r\n        'Applying user-installed resource pack',\r\n        async () => {\r\n          await loadMinecraftData(version)\r\n          try {\r\n            await resourcepackReload(version)\r\n          } catch (err) {\r\n            console.error(err)\r\n            const doContinue = confirm('Failed to apply texture pack. See errors in the console. Continue?')\r\n            if (!doContinue) {\r\n              throw err\r\n            }\r\n          }\r\n        }\r\n      )\r\n\r\n      await progress.executeWithMessage(\r\n        'Loading minecraft models',\r\n        async () => {\r\n          viewer.world.blockstatesModels = await importLargeData('blockStatesModels')\r\n          void viewer.setVersion(version, options.useVersionsTextures === 'latest' ? version : options.useVersionsTextures)\r\n          miscUiState.loadedDataVersion = version\r\n        }\r\n      )\r\n    }\r\n\r\n    let finalVersion = connectOptions.botVersion || (singleplayer ? serverOptions.version : undefined)\r\n\r\n    if (connectOptions.worldStateFileContents) {\r\n      try {\r\n        localReplaySession = startLocalReplayServer(connectOptions.worldStateFileContents)\r\n      } catch (err) {\r\n        console.error(err)\r\n        throw new UserError(`Failed to start local replay server: ${err}`)\r\n      }\r\n      finalVersion = localReplaySession.version\r\n    }\r\n\r\n    if (singleplayer) {\r\n      // SINGLEPLAYER EXPLAINER:\r\n      // Note 1: here we have custom sync communication between server Client (flying-squid) and game client (mineflayer)\r\n      // Note 2: custom Server class is used which simplifies communication & Client creation on it's side\r\n      // local server started\r\n      // mineflayer.createBot (see source def)\r\n      // bot._client = bot._client ?? mc.createClient(options) <-- mc-protocol package\r\n      // tcpDns() skipped since we define connect option\r\n      // in setProtocol: we emit 'connect' here below so in that file we send set_protocol and login_start (onLogin handler)\r\n      // Client (class) of flying-squid (in server/login.js of mc-protocol): onLogin handler: skip most logic & go to loginClient() which assigns uuid and sends 'success' back to client (onLogin handler) and emits 'login' on the server (login.js in flying-squid handler)\r\n      // flying-squid: 'login' -> player.login -> now sends 'login' event to the client (handled in many plugins in mineflayer) -> then 'update_health' is sent which emits 'spawn' in mineflayer\r\n\r\n      localServer = window.localServer = window.server = startLocalServer(serverOptions)\r\n      // todo need just to call quit if started\r\n      // loadingScreen.maybeRecoverable = false\r\n      // init world, todo: do it for any async plugins\r\n      if (!localServer.pluginsReady) {\r\n        await progress.executeWithMessage(\r\n          'Starting local server',\r\n          async () => {\r\n            await new Promise(resolve => {\r\n              localServer.once('pluginsReady', resolve)\r\n            })\r\n          }\r\n        )\r\n      }\r\n\r\n      localServer.on('newPlayer', (player) => {\r\n        player.on('loadingStatus', (newStatus) => {\r\n          progress.setMessage(newStatus)\r\n        })\r\n      })\r\n      flyingSquidEvents()\r\n    }\r\n\r\n    if (connectOptions.authenticatedAccount) username = 'you'\r\n    let initialLoadingText: string\r\n    if (singleplayer) {\r\n      initialLoadingText = 'Local server is still starting'\r\n    } else if (p2pMultiplayer) {\r\n      initialLoadingText = 'Connecting to peer'\r\n    } else if (connectOptions.server) {\r\n      if (!finalVersion) {\r\n        const versionAutoSelect = getVersionAutoSelect()\r\n        setLoadingScreenStatus(`Fetching server version. Preffered: ${versionAutoSelect}`)\r\n        const autoVersionSelect = await getServerInfo(server.host, server.port ? Number(server.port) : undefined, versionAutoSelect)\r\n        finalVersion = autoVersionSelect.version\r\n      }\r\n      initialLoadingText = `Connecting to server ${server.host}:${server.port ?? 25_565} with version ${finalVersion}`\r\n    } else if (connectOptions.viewerWsConnect) {\r\n      initialLoadingText = `Connecting to Mineflayer WebSocket server ${connectOptions.viewerWsConnect}`\r\n    } else if (connectOptions.worldStateFileContents) {\r\n      initialLoadingText = `Loading local replay server`\r\n    } else {\r\n      initialLoadingText = 'We have no idea what to do'\r\n    }\r\n    setLoadingScreenStatus(initialLoadingText)\r\n\r\n    if (parsedServer.isWebSocket) {\r\n      clientDataStream = (await getWebsocketStream(server.host)).mineflayerStream\r\n    }\r\n\r\n    let newTokensCacheResult = null as any\r\n    const cachedTokens = typeof connectOptions.authenticatedAccount === 'object' ? connectOptions.authenticatedAccount.cachedTokens : {}\r\n    const authData = connectOptions.authenticatedAccount ? await microsoftAuthflow({\r\n      tokenCaches: cachedTokens,\r\n      proxyBaseUrl: connectOptions.proxy,\r\n      setProgressText (text) {\r\n        setLoadingScreenStatus(text)\r\n      },\r\n      setCacheResult (result) {\r\n        newTokensCacheResult = result\r\n      },\r\n      connectingServer: server.host\r\n    }) : undefined\r\n\r\n    if (p2pMultiplayer) {\r\n      clientDataStream = await connectToPeer(connectOptions.peerId!, connectOptions.peerOptions)\r\n    }\r\n    if (connectOptions.viewerWsConnect) {\r\n      const { version, time, requiresPass } = await getViewerVersionData(connectOptions.viewerWsConnect)\r\n      let password\r\n      if (requiresPass) {\r\n        password = prompt('Enter password')\r\n        if (!password) {\r\n          throw new UserError('Password is required')\r\n        }\r\n      }\r\n      console.log('Latency:', Date.now() - time, 'ms')\r\n      // const version = '1.21.1'\r\n      finalVersion = version\r\n      await downloadMcData(version)\r\n      setLoadingScreenStatus(`Connecting to WebSocket server ${connectOptions.viewerWsConnect}`)\r\n      clientDataStream = (await getWsProtocolStream(connectOptions.viewerWsConnect)).clientDuplex\r\n      if (password) {\r\n        clientDataStream.write(password)\r\n      }\r\n      gameAdditionalState.viewerConnection = true\r\n    }\r\n\r\n    if (finalVersion) {\r\n      // ensure data is downloaded\r\n      await downloadMcData(finalVersion)\r\n    }\r\n\r\n    bot = mineflayer.createBot({\r\n      host: server.host,\r\n      port: server.port ? +server.port : undefined,\r\n      version: finalVersion || false,\r\n      ...clientDataStream ? {\r\n        stream: clientDataStream as any,\r\n      } : {},\r\n      ...singleplayer || p2pMultiplayer || localReplaySession ? {\r\n        keepAlive: false,\r\n      } : {},\r\n      ...singleplayer ? {\r\n        version: serverOptions.version,\r\n        connect () { },\r\n        Client: CustomChannelClient as any,\r\n      } : {},\r\n      ...localReplaySession ? {\r\n        connect () { },\r\n        Client: CustomChannelClient as any,\r\n      } : {},\r\n      onMsaCode (data) {\r\n        signInMessageState.code = data.user_code\r\n        signInMessageState.link = data.verification_uri\r\n        signInMessageState.expiresOn = Date.now() + data.expires_in * 1000\r\n      },\r\n      sessionServer: authData?.sessionEndpoint?.toString(),\r\n      auth: connectOptions.authenticatedAccount ? async (client, options) => {\r\n        authData!.setOnMsaCodeCallback(options.onMsaCode)\r\n        authData?.setConnectingVersion(client.version)\r\n        //@ts-expect-error\r\n        client.authflow = authData!.authFlow\r\n        try {\r\n          signInMessageState.abortController = ref(new AbortController())\r\n          await Promise.race([\r\n            protocolMicrosoftAuth.authenticate(client, options),\r\n            new Promise((_r, reject) => {\r\n              signInMessageState.abortController.signal.addEventListener('abort', () => {\r\n                reject(new UserError('Aborted by user'))\r\n              })\r\n            })\r\n          ])\r\n          if (signInMessageState.shouldSaveToken) {\r\n            updateAuthenticatedAccountData(accounts => {\r\n              const existingAccount = accounts.find(a => a.username === client.username)\r\n              if (existingAccount) {\r\n                existingAccount.cachedTokens = { ...existingAccount.cachedTokens, ...newTokensCacheResult }\r\n              } else {\r\n                accounts.push({\r\n                  username: client.username,\r\n                  cachedTokens: { ...cachedTokens, ...newTokensCacheResult }\r\n                })\r\n              }\r\n              return accounts\r\n            })\r\n            updateDataAfterJoin = () => {\r\n              updateLoadedServerData(s => ({ ...s, authenticatedAccountOverride: client.username }), connectOptions.serverIndex)\r\n            }\r\n          } else {\r\n            updateDataAfterJoin = () => {\r\n              updateLoadedServerData(s => ({ ...s, authenticatedAccountOverride: undefined }), connectOptions.serverIndex)\r\n            }\r\n          }\r\n          setLoadingScreenStatus('Authentication successful. Logging in to server')\r\n        } finally {\r\n          signInMessageState.code = ''\r\n        }\r\n      } : undefined,\r\n      username,\r\n      viewDistance: renderDistance,\r\n      checkTimeoutInterval: 240 * 1000,\r\n      // noPongTimeout: 240 * 1000,\r\n      closeTimeout: 240 * 1000,\r\n      respawn: options.autoRespawn,\r\n      maxCatchupTicks: 0,\r\n      'mapDownloader-saveToFile': false,\r\n      // \"mapDownloader-saveInternal\": false, // do not save into memory, todo must be implemeneted as we do really care of ram\r\n    }) as unknown as typeof __type_bot\r\n    window.bot = bot\r\n    if (connectOptions.viewerWsConnect) {\r\n      void handleCustomChannel()\r\n    }\r\n    customEvents.emit('mineflayerBotCreated')\r\n    if (singleplayer || p2pMultiplayer || localReplaySession) {\r\n      if (singleplayer || p2pMultiplayer) {\r\n        // in case of p2pMultiplayer there is still flying-squid on the host side\r\n        const _supportFeature = bot.supportFeature\r\n        bot.supportFeature = ((feature) => {\r\n          if (unsupportedLocalServerFeatures.includes(feature)) {\r\n            return false\r\n          }\r\n          return _supportFeature(feature)\r\n        }) as typeof bot.supportFeature\r\n      }\r\n\r\n      bot.emit('inject_allowed')\r\n      bot._client.emit('connect')\r\n    } else if (clientDataStream) {\r\n      // bot.emit('inject_allowed')\r\n      bot._client.emit('connect')\r\n    } else {\r\n      const setupConnectHandlers = () => {\r\n        bot._client.socket.on('connect', () => {\r\n          console.log('Proxy WebSocket connection established')\r\n          //@ts-expect-error\r\n          bot._client.socket._ws.addEventListener('close', () => {\r\n            console.log('WebSocket connection closed')\r\n            setTimeout(() => {\r\n              if (bot) {\r\n                bot.emit('end', 'WebSocket connection closed with unknown reason')\r\n              }\r\n            }, 1000)\r\n          })\r\n          bot._client.socket.on('close', () => {\r\n            setTimeout(() => {\r\n              if (bot) {\r\n                bot.emit('end', 'WebSocket connection closed with unknown reason')\r\n              }\r\n            })\r\n          })\r\n        })\r\n      }\r\n      // socket setup actually can be delayed because of dns lookup\r\n      if (bot._client.socket) {\r\n        setupConnectHandlers()\r\n      } else {\r\n        const originalSetSocket = bot._client.setSocket.bind(bot._client)\r\n        bot._client.setSocket = (socket) => {\r\n          if (!bot) return\r\n          originalSetSocket(socket)\r\n          setupConnectHandlers()\r\n        }\r\n      }\r\n\r\n    }\r\n  } catch (err) {\r\n    handleError(err)\r\n  }\r\n  if (!bot) return\r\n\r\n  if (connectOptions.server) {\r\n    bot.loadPlugin(ping)\r\n  }\r\n  bot.loadPlugin(mouse)\r\n  if (!localReplaySession) {\r\n    bot.loadPlugin(localRelayServerPlugin)\r\n  }\r\n\r\n  const p2pConnectTimeout = p2pMultiplayer ? setTimeout(() => { throw new UserError('Spawn timeout. There might be error on the other side, check console.') }, 20_000) : undefined\r\n\r\n  // bot.on('inject_allowed', () => {\r\n  //   loadingScreen.maybeRecoverable = false\r\n  // })\r\n\r\n  bot.on('error', handleError)\r\n\r\n  bot.on('kicked', (kickReason) => {\r\n    console.log('You were kicked!', kickReason)\r\n    const { formatted: kickReasonFormatted, plain: kickReasonString } = parseFormattedMessagePacket(kickReason)\r\n    setLoadingScreenStatus(`The Minecraft server kicked you. Kick reason: ${kickReasonString}`, true, undefined, undefined, kickReasonFormatted)\r\n    appStatusState.showReconnect = true\r\n    destroyAll()\r\n  })\r\n\r\n  // bot.emit('kicked', '{\"translate\":\"disconnect.genericReason\",\"with\":[\"Internal Exception: io.netty.handler.codec.EncoderException: com.viaversion.viaversion.exception.InformativeException: Please report this on the Via support Discord or open an issue on the relevant GitHub repository\\\\nPacket Type: SYSTEM_CHAT, Index: 1, Type: TagType, Data: [], Packet ID: 103, Source 0: com.viaversion.viabackwards.protocol.v1_20_3to1_20_2.Protocol1_20_3To1_20_2$$Lambda/0x00007f9930f63080\"]}', false)\r\n\r\n  const packetBeforePlay = (_, __, ___, fullBuffer) => {\r\n    lastPacket = fullBuffer.toString()\r\n  }\r\n  bot._client.on('packet', packetBeforePlay as any)\r\n  const playStateSwitch = (newState) => {\r\n    if (newState === 'play') {\r\n      bot._client.removeListener('packet', packetBeforePlay)\r\n    }\r\n  }\r\n  bot._client.on('state', playStateSwitch)\r\n\r\n  bot.on('end', (endReason) => {\r\n    if (ended) return\r\n    console.log('disconnected for', endReason)\r\n    if (endReason === 'socketClosed') {\r\n      endReason = 'Connection with server lost'\r\n    }\r\n    setLoadingScreenStatus(`You have been disconnected from the server. End reason: ${endReason}`, true)\r\n    appStatusState.showReconnect = true\r\n    onPossibleErrorDisconnect()\r\n    destroyAll()\r\n    if (isCypress()) throw new Error(`disconnected: ${endReason}`)\r\n  })\r\n\r\n  onBotCreate()\r\n\r\n  bot.once('login', () => {\r\n    setLoadingScreenStatus('Loading world')\r\n  })\r\n\r\n  const start = Date.now()\r\n  let worldWasReady = false\r\n  void viewer.world.renderUpdateEmitter.on('update', () => {\r\n    // todo might not emit as servers simply don't send chunk if it's empty\r\n    if (!viewer.world.allChunksFinished || worldWasReady) return\r\n    worldWasReady = true\r\n    console.log('All chunks done and ready! Time from renderer open to ready', (Date.now() - start) / 1000, 's')\r\n    viewer.render() // ensure the last state is rendered\r\n    document.dispatchEvent(new Event('cypress-world-ready'))\r\n  })\r\n\r\n  const spawnEarlier = !singleplayer && !p2pMultiplayer\r\n  // don't use spawn event, player can be dead\r\n  bot.once(spawnEarlier ? 'forcedMove' : 'health', async () => {\r\n    if (resourcePackState.isServerInstalling) {\r\n      await new Promise<void>(resolve => {\r\n        subscribe(resourcePackState, () => {\r\n          if (!resourcePackState.isServerInstalling) {\r\n            resolve()\r\n          }\r\n        })\r\n      })\r\n    }\r\n    window.focus?.()\r\n    errorAbortController.abort()\r\n\r\n    if (p2pConnectTimeout) clearTimeout(p2pConnectTimeout)\r\n    playerState.onlineMode = !!connectOptions.authenticatedAccount\r\n\r\n    setLoadingScreenStatus('Placing blocks (starting viewer)')\r\n    if (!connectOptions.worldStateFileContents || connectOptions.worldStateFileContents.length < 3 * 1024 * 1024) {\r\n      localStorage.lastConnectOptions = JSON.stringify(connectOptions)\r\n      if (process.env.NODE_ENV === 'development' && !localStorage.lockUrl && !Object.keys(window.debugQueryParams).length) {\r\n        lockUrl()\r\n      }\r\n    } else {\r\n      localStorage.removeItem('lastConnectOptions')\r\n    }\r\n    connectOptions.onSuccessfulPlay?.()\r\n    updateDataAfterJoin()\r\n    if (connectOptions.autoLoginPassword) {\r\n      bot.chat(`/login ${connectOptions.autoLoginPassword}`)\r\n    }\r\n\r\n    console.log('bot spawned - starting viewer')\r\n\r\n    const center = bot.entity.position\r\n\r\n    const worldView = window.worldView = new WorldDataEmitter(bot.world, renderDistance, center)\r\n    watchOptionsAfterWorldViewInit()\r\n\r\n    void initVR()\r\n    initMotionTracking()\r\n\r\n    renderWrapper.postRender = () => {\r\n      viewer.setFirstPersonCamera(null, bot.entity.yaw, bot.entity.pitch)\r\n    }\r\n\r\n    // Link WorldDataEmitter and Viewer\r\n    viewer.connect(worldView)\r\n    worldView.listenToBot(bot)\r\n    void worldView.init(bot.entity.position)\r\n\r\n    dayCycle()\r\n\r\n    // Bot position callback\r\n    function botPosition () {\r\n      viewer.world.lastCamUpdate = Date.now()\r\n      // this might cause lag, but not sure\r\n      viewer.setFirstPersonCamera(bot.entity.position, bot.entity.yaw, bot.entity.pitch)\r\n      void worldView.updatePosition(bot.entity.position)\r\n    }\r\n    bot.on('move', botPosition)\r\n    botPosition()\r\n\r\n    setLoadingScreenStatus('Setting callbacks')\r\n\r\n    onGameLoad(() => {})\r\n\r\n    if (appStatusState.isError) return\r\n\r\n    const waitForChunks = async () => {\r\n      if (appQueryParams.sp === '1') return //todo\r\n      const waitForChunks = options.waitForChunksRender === 'sp-only' ? !!singleplayer : options.waitForChunksRender\r\n      if (viewer.world.allChunksFinished || !waitForChunks) {\r\n        return\r\n      }\r\n\r\n      await progress.executeWithMessage(\r\n        'Loading chunks',\r\n        'chunks',\r\n        async () => {\r\n          await new Promise<void>(resolve => {\r\n            let wasFinished = false\r\n            void viewer.world.renderUpdateEmitter.on('update', () => {\r\n              if (wasFinished) return\r\n              if (viewer.world.allChunksFinished) {\r\n                wasFinished = true\r\n                resolve()\r\n              } else {\r\n                const perc = Math.round(Object.keys(viewer.world.finishedChunks).length / viewer.world.chunksLength * 100)\r\n                progress.reportProgress('chunks', perc / 100)\r\n              }\r\n            })\r\n          })\r\n        }\r\n      )\r\n    }\r\n\r\n    await waitForChunks()\r\n\r\n    setTimeout(() => {\r\n      if (appQueryParams.suggest_save) {\r\n        showNotification('Suggestion', 'Save the world to keep your progress!', false, undefined, async () => {\r\n          const savePath = await saveToBrowserMemory()\r\n          if (!savePath) return\r\n          const saveName = savePath.split('/').pop()\r\n          bot.end()\r\n          // todo hot reload\r\n          location.search = `loadSave=${saveName}`\r\n        })\r\n      }\r\n    }, 600)\r\n\r\n    miscUiState.gameLoaded = true\r\n    miscUiState.loadedServerIndex = connectOptions.serverIndex ?? ''\r\n    customEvents.emit('gameLoaded')\r\n    progress.end()\r\n    setLoadingScreenStatus(undefined)\r\n  })\r\n\r\n  if (singleplayer && connectOptions.serverOverrides.worldFolder) {\r\n    fsState.saveLoaded = true\r\n  }\r\n\r\n  if (!connectOptions.ignoreQs || process.env.NODE_ENV === 'development') {\r\n    // todo cleanup\r\n    customEvents.on('gameLoaded', () => {\r\n      const commands = appQueryParamsArray.command ?? []\r\n      for (let command of commands) {\r\n        if (!command.startsWith('/')) command = `/${command}`\r\n        bot.chat(command)\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nconst reconnectOptions = sessionStorage.getItem('reconnectOptions') ? JSON.parse(sessionStorage.getItem('reconnectOptions')!) : undefined\r\n\r\nlistenGlobalEvents()\r\nconst unsubscribe = subscribe(miscUiState, async () => {\r\n  if (miscUiState.fsReady && miscUiState.appConfig) {\r\n    unsubscribe()\r\n    if (reconnectOptions) {\r\n      sessionStorage.removeItem('reconnectOptions')\r\n      if (Date.now() - reconnectOptions.timestamp < 1000 * 60 * 2) {\r\n        void connect(reconnectOptions.value)\r\n      }\r\n    } else {\r\n      if (appQueryParams.singleplayer === '1' || appQueryParams.sp === '1') {\r\n        loadSingleplayer({}, {\r\n          worldFolder: undefined,\r\n          ...appQueryParams.version ? { version: appQueryParams.version } : {}\r\n        })\r\n      }\r\n      if (appQueryParams.loadSave) {\r\n        const savePath = `/data/worlds/${appQueryParams.loadSave}`\r\n        try {\r\n          await fs.promises.stat(savePath)\r\n        } catch (err) {\r\n          alert(`Save ${savePath} not found`)\r\n          return\r\n        }\r\n        await loadInMemorySave(savePath)\r\n      }\r\n    }\r\n  }\r\n})\r\n\r\n// #region fire click event on touch as we disable default behaviors\r\nlet activeTouch: { touch: Touch, elem: HTMLElement, start: number } | undefined\r\ndocument.body.addEventListener('touchend', (e) => {\r\n  if (!isGameActive(true)) return\r\n  if (activeTouch?.touch.identifier !== e.changedTouches[0].identifier) return\r\n  if (Date.now() - activeTouch.start > 500) {\r\n    activeTouch.elem.dispatchEvent(new Event('longtouch', { bubbles: true }))\r\n  } else {\r\n    activeTouch.elem.click()\r\n  }\r\n  activeTouch = undefined\r\n})\r\ndocument.body.addEventListener('touchstart', (e) => {\r\n  const ignoreElem = (e.target as HTMLElement).matches('vercel-live-feedback') || (e.target as HTMLElement).closest('.hotbar')\r\n  if (!isGameActive(true) || ignoreElem) return\r\n  // we always prevent default behavior to disable magnifier on ios, but by doing so we also disable click events\r\n  e.preventDefault()\r\n  let firstClickable // todo remove composedPath and this workaround when lit-element is fully dropped\r\n  const path = e.composedPath() as Array<{ click?: () => void }>\r\n  for (const elem of path) {\r\n    if (elem.click) {\r\n      firstClickable = elem\r\n      break\r\n    }\r\n  }\r\n  if (!firstClickable) return\r\n  activeTouch = {\r\n    touch: e.touches[0],\r\n    elem: firstClickable,\r\n    start: Date.now(),\r\n  }\r\n}, { passive: false })\r\n// #endregion\r\n\r\n// qs open actions\r\nif (!reconnectOptions) {\r\n  downloadAndOpenFile().then((downloadAction) => {\r\n    if (downloadAction) return\r\n    if (appQueryParams.reconnect && process.env.NODE_ENV === 'development') {\r\n      const lastConnect = JSON.parse(localStorage.lastConnectOptions ?? {})\r\n      void connect({\r\n        botVersion: appQueryParams.version ?? undefined,\r\n        ...lastConnect,\r\n        ip: appQueryParams.ip || undefined\r\n      })\r\n      return\r\n    }\r\n    if (appQueryParams.ip || appQueryParams.proxy) {\r\n      const waitAppConfigLoad = !appQueryParams.proxy\r\n      const openServerEditor = () => {\r\n        hideModal()\r\n        showModal({ reactType: 'editServer' })\r\n      }\r\n      showModal({ reactType: 'empty' })\r\n      if (waitAppConfigLoad) {\r\n        const unsubscribe = subscribe(miscUiState, checkCanDisplay)\r\n        checkCanDisplay()\r\n        // eslint-disable-next-line no-inner-declarations\r\n        function checkCanDisplay () {\r\n          if (miscUiState.appConfig) {\r\n            unsubscribe()\r\n            openServerEditor()\r\n            return true\r\n          }\r\n        }\r\n      } else {\r\n        openServerEditor()\r\n      }\r\n    }\r\n\r\n    void Promise.resolve().then(() => {\r\n      // try to connect to peer\r\n      const peerId = appQueryParams.connectPeer\r\n      const peerOptions = {} as ConnectPeerOptions\r\n      if (appQueryParams.server) {\r\n        peerOptions.server = appQueryParams.server\r\n      }\r\n      const version = appQueryParams.peerVersion\r\n      if (peerId) {\r\n        let username: string | null = options.guestUsername\r\n        if (options.askGuestName) username = prompt('Enter your username', username)\r\n        if (!username) return\r\n        options.guestUsername = username\r\n        void connect({\r\n          username,\r\n          botVersion: version || undefined,\r\n          peerId,\r\n          peerOptions\r\n        })\r\n      }\r\n    })\r\n\r\n    if (appQueryParams.serversList) {\r\n      showModal({ reactType: 'serversList' })\r\n    }\r\n\r\n    const viewerWsConnect = appQueryParams.viewerConnect\r\n    if (viewerWsConnect) {\r\n      void connect({\r\n        username: `viewer-${Math.random().toString(36).slice(2, 10)}`,\r\n        viewerWsConnect,\r\n      })\r\n    }\r\n\r\n    if (appQueryParams.modal) {\r\n      const modals = appQueryParams.modal.split(',')\r\n      for (const modal of modals) {\r\n        showModal({ reactType: modal })\r\n      }\r\n    }\r\n  }, (err) => {\r\n    console.error(err)\r\n    alert(`Failed to download file: ${err}`)\r\n  })\r\n}\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\r\nconst initialLoader = document.querySelector('.initial-loader') as HTMLElement | null\r\nif (initialLoader) {\r\n  initialLoader.style.opacity = '0'\r\n  initialLoader.style.pointerEvents = 'none'\r\n}\r\nwindow.pageLoaded = true\r\n\r\nvoid possiblyHandleStateVariable()\r\n","import { proxy, subscribe } from 'valtio'\r\nimport { showInventory } from 'minecraft-inventory-gui/web/ext.mjs'\r\n\r\n// import Dirt from 'mc-assets/dist/other-textures/latest/blocks/dirt.png'\r\nimport { RecipeItem } from 'minecraft-data'\r\nimport { flat, fromFormattedString } from '@xmcl/text-component'\r\nimport { splitEvery, equals } from 'rambda'\r\nimport PItem, { Item } from 'prismarine-item'\r\nimport { versionToNumber } from 'renderer/viewer/prepare/utils'\r\nimport { getRenamedData } from 'flying-squid/dist/blockRenames'\r\nimport PrismarineChatLoader from 'prismarine-chat'\r\nimport { BlockModel } from 'mc-assets'\r\nimport { activeGuiAtlas } from 'renderer/viewer/lib/guiRenderer'\r\nimport Generic95 from '../assets/generic_95.png'\r\nimport { appReplacableResources } from './generated/resources'\r\nimport { activeModalStack, hideCurrentModal, hideModal, miscUiState, showModal } from './globalState'\r\nimport { options } from './optionsStorage'\r\nimport { assertDefined, inGameError } from './utils'\r\nimport { displayClientChat } from './botUtils'\r\nimport { currentScaling } from './scaleInterface'\r\nimport { getItemDescription } from './itemsDescriptions'\r\nimport { MessageFormatPart } from './chatUtils'\r\nimport { GeneralInputItem, getItemMetadata, getItemNameRaw, RenderItem } from './mineflayer/items'\r\nimport { getItemModelName } from './resourcesManager'\r\n\r\nconst loadedImagesCache = new Map<string, HTMLImageElement>()\r\nconst cleanLoadedImagesCache = () => {\r\n  loadedImagesCache.delete('blocks')\r\n}\r\n\r\nlet lastWindow: ReturnType<typeof showInventory>\r\n/** bot version */\r\nlet version: string\r\nlet PrismarineItem: typeof Item\r\n\r\nexport const allImagesLoadedState = proxy({\r\n  value: false\r\n})\r\n\r\nexport const jeiCustomCategories = proxy({\r\n  value: [] as Array<{ id: string, categoryTitle: string, items: any[] }>\r\n})\r\n\r\nexport const onGameLoad = (onLoad) => {\r\n  allImagesLoadedState.value = false\r\n  version = bot.version\r\n\r\n  const checkIfLoaded = () => {\r\n    if (!viewer.world.itemsAtlasParser) return\r\n    if (!allImagesLoadedState.value) {\r\n      onLoad?.()\r\n    }\r\n    allImagesLoadedState.value = false\r\n    setTimeout(() => {\r\n      allImagesLoadedState.value = true\r\n    }, 0)\r\n  }\r\n  viewer.world.renderUpdateEmitter.on('textureDownloaded', checkIfLoaded)\r\n  checkIfLoaded()\r\n\r\n  PrismarineItem = PItem(version)\r\n\r\n  const mapWindowType = (type: string, inventoryStart: number) => {\r\n    if (type === 'minecraft:container') {\r\n      if (inventoryStart === 45 - 9 * 4) return 'minecraft:generic_9x1'\r\n      if (inventoryStart === 45 - 9 * 3) return 'minecraft:generic_9x2'\r\n      if (inventoryStart === 45 - 9 * 2) return 'minecraft:generic_9x3'\r\n      if (inventoryStart === 45 - 9) return 'minecraft:generic_9x4'\r\n      if (inventoryStart === 45) return 'minecraft:generic_9x5'\r\n      if (inventoryStart === 45 + 9) return 'minecraft:generic_9x6'\r\n    }\r\n    return type\r\n  }\r\n\r\n  bot.on('windowOpen', (win) => {\r\n    const implementedWindow = implementedContainersGuiMap[mapWindowType(win.type as string, win.inventoryStart)]\r\n    if (implementedWindow) {\r\n      openWindow(implementedWindow)\r\n    } else if (options.unimplementedContainers) {\r\n      openWindow('ChestWin')\r\n    } else {\r\n      // todo format\r\n      displayClientChat(`[client error] cannot open unimplemented window ${win.id} (${win.type}). Slots: ${win.slots.map(item => getItemName(item)).filter(Boolean).join(', ')}`)\r\n      bot.currentWindow?.['close']()\r\n    }\r\n  })\r\n\r\n  // workaround: singleplayer player inventory crafting\r\n  let skipUpdate = false\r\n  bot.inventory.on('updateSlot', ((_oldSlot, oldItem, newItem) => {\r\n    const currentSlot = _oldSlot as number\r\n    if (!miscUiState.singleplayer || oldItem === newItem || skipUpdate) return\r\n    const { craftingResultSlot } = bot.inventory\r\n    if (currentSlot === craftingResultSlot && oldItem && !newItem) {\r\n      for (let i = 1; i < 5; i++) {\r\n        const count = bot.inventory.slots[i]?.count\r\n        if (count && count > 1) {\r\n          const slot = bot.inventory.slots[i]!\r\n          slot.count--\r\n          void bot.creative.setInventorySlot(i, slot)\r\n        } else {\r\n          void bot.creative.setInventorySlot(i, null)\r\n        }\r\n      }\r\n      return\r\n    }\r\n    if (currentSlot > 4) return\r\n    const craftingSlots = bot.inventory.slots.slice(1, 5)\r\n    try {\r\n      const resultingItem = getResultingRecipe(craftingSlots, 2)\r\n      skipUpdate = true\r\n      void bot.creative.setInventorySlot(craftingResultSlot, resultingItem ?? null).then(() => {\r\n        skipUpdate = false\r\n      })\r\n    } catch (err) {\r\n      console.error(err)\r\n      // todo resolve the error! and why would we ever get here on every update?\r\n    }\r\n  }) as any)\r\n\r\n  bot.on('windowClose', () => {\r\n    // todo hide up to the window itself!\r\n    if (lastWindow) {\r\n      hideCurrentModal()\r\n    }\r\n  })\r\n  bot.on('respawn', () => { // todo validate logic against native client (maybe login)\r\n    if (lastWindow) {\r\n      hideCurrentModal()\r\n    }\r\n  })\r\n\r\n  customEvents.on('search', (q) => {\r\n    if (!lastWindow) return\r\n    upJei(q)\r\n  })\r\n}\r\n\r\nconst getImageSrc = (path): string | HTMLImageElement => {\r\n  assertDefined(viewer)\r\n  switch (path) {\r\n    case 'gui/container/inventory': return appReplacableResources.latest_gui_container_inventory.content\r\n    case 'blocks': return viewer.world.blocksAtlasParser!.latestImage\r\n    case 'items': return viewer.world.itemsAtlasParser!.latestImage\r\n    case 'gui/container/dispenser': return appReplacableResources.latest_gui_container_dispenser.content\r\n    case 'gui/container/furnace': return appReplacableResources.latest_gui_container_furnace.content\r\n    case 'gui/container/crafting_table': return appReplacableResources.latest_gui_container_crafting_table.content\r\n    case 'gui/container/shulker_box': return appReplacableResources.latest_gui_container_shulker_box.content\r\n    case 'gui/container/generic_54': return appReplacableResources.latest_gui_container_generic_54.content\r\n    case 'gui/container/generic_95': return Generic95\r\n    case 'gui/container/hopper': return appReplacableResources.latest_gui_container_hopper.content\r\n    case 'gui/container/horse': return appReplacableResources.latest_gui_container_horse.content\r\n    case 'gui/container/villager2': return appReplacableResources.latest_gui_container_villager2.content\r\n    case 'gui/container/enchanting_table': return appReplacableResources.latest_gui_container_enchanting_table.content\r\n    case 'gui/container/anvil': return appReplacableResources.latest_gui_container_anvil.content\r\n    case 'gui/container/beacon': return appReplacableResources.latest_gui_container_beacon.content\r\n    case 'gui/widgets': return appReplacableResources.other_textures_latest_gui_widgets.content\r\n  }\r\n  // empty texture\r\n  return 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII='\r\n}\r\n\r\nconst getImage = ({ path = undefined as string | undefined, texture = undefined as string | undefined, blockData = undefined as any, image = undefined as HTMLImageElement | undefined }, onLoad = () => { }) => {\r\n  if (image) {\r\n    return image\r\n  }\r\n  if (!path && !texture) throw new Error('Either pass path or texture')\r\n  const loadPath = (blockData ? 'blocks' : path ?? texture)!\r\n  if (loadedImagesCache.has(loadPath)) {\r\n    onLoad()\r\n  } else {\r\n    const imageSrc = getImageSrc(loadPath)\r\n    let image: HTMLImageElement\r\n    if (imageSrc instanceof Image) {\r\n      image = imageSrc\r\n    } else {\r\n      image = new Image()\r\n      image.src = imageSrc\r\n    }\r\n    image.onload = onLoad\r\n    loadedImagesCache.set(loadPath, image)\r\n  }\r\n  return loadedImagesCache.get(loadPath)\r\n}\r\n\r\nexport type ResolvedItemModelRender = {\r\n  modelName: string,\r\n}\r\n\r\nexport const renderSlot = (model: ResolvedItemModelRender, debugIsQuickbar = false, fullBlockModelSupport = false): {\r\n  texture: string,\r\n  blockData?: Record<string, { slice, path }> & { resolvedModel: BlockModel },\r\n  scale?: number,\r\n  slice?: number[],\r\n  modelName?: string,\r\n  image?: HTMLImageElement\r\n} | undefined => {\r\n  let itemModelName = model.modelName\r\n  const originalItemName = itemModelName\r\n  const isItem = loadedData.itemsByName[itemModelName]\r\n\r\n  // #region normalize item name\r\n  if (versionToNumber(bot.version) < versionToNumber('1.13')) itemModelName = getRenamedData(isItem ? 'items' : 'blocks', itemModelName, bot.version, '1.13.1') as string\r\n  // #endregion\r\n\r\n\r\n  let itemTexture\r\n\r\n  if (!fullBlockModelSupport) {\r\n    const atlas = activeGuiAtlas.atlas?.json\r\n    // todo atlas holds all rendered blocks, not all possibly rendered item/block models, need to request this on demand instead (this is how vanilla works)\r\n    const item = atlas?.textures[itemModelName.replace('minecraft:', '').replace('block/', '').replace('blocks/', '').replace('item/', '').replace('items/', '').replace('_inventory', '').replace('_bottom', '')]\r\n    if (item) {\r\n      const x = item.u * atlas.width\r\n      const y = item.v * atlas.height\r\n      return {\r\n        texture: 'gui',\r\n        image: activeGuiAtlas.atlas!.image,\r\n        slice: [x, y, atlas.tileSize, atlas.tileSize],\r\n        scale: 0.25,\r\n      }\r\n    }\r\n  }\r\n\r\n  try {\r\n    assertDefined(viewer.world.itemsRenderer)\r\n    itemTexture =\r\n      viewer.world.itemsRenderer.getItemTexture(itemModelName, {}, false, fullBlockModelSupport)\r\n      ?? viewer.world.itemsRenderer.getItemTexture('item/missing_texture')!\r\n  } catch (err) {\r\n    inGameError(`Failed to render item ${itemModelName} (original: ${originalItemName}) on ${bot.version} (resourcepack: ${options.enabledResourcepack}): ${err.stack}`)\r\n    itemTexture = viewer.world.itemsRenderer!.getItemTexture('block/errored')!\r\n  }\r\n\r\n\r\n  if ('type' in itemTexture) {\r\n    // is item\r\n    return {\r\n      texture: itemTexture.type,\r\n      slice: itemTexture.slice,\r\n      modelName: itemModelName\r\n    }\r\n  } else {\r\n    // is block\r\n    return {\r\n      texture: 'blocks',\r\n      blockData: itemTexture,\r\n      modelName: itemModelName\r\n    }\r\n  }\r\n}\r\n\r\nconst getItemName = (slot: Item | RenderItem | null) => {\r\n  const parsed = getItemNameRaw(slot)\r\n  if (!parsed) return\r\n  // todo display full text renderer from sign renderer\r\n  const text = flat(parsed as MessageFormatPart).map(x => x.text)\r\n  return text.join('')\r\n}\r\n\r\nlet lastMappedSots = [] as any[]\r\nconst itemToVisualKey = (slot: RenderItem | Item | null) => {\r\n  if (!slot) return null\r\n  return slot.name + (slot['metadata'] ?? '-') + (slot.nbt ? JSON.stringify(slot.nbt) : '') + (slot['components'] ? JSON.stringify(slot['components']) : '')\r\n}\r\nconst mapSlots = (slots: Array<RenderItem | Item | null>, isJei = false) => {\r\n  const newSlots = slots.map((slot, i) => {\r\n    // todo stateid\r\n    if (!slot) return\r\n\r\n    if (!isJei) {\r\n      const oldKey = itemToVisualKey(lastMappedSots[i])\r\n      if (oldKey && oldKey === itemToVisualKey(slot)) {\r\n        return lastMappedSots[i]\r\n      }\r\n    }\r\n\r\n    try {\r\n      if (slot.durabilityUsed && slot.maxDurability) slot.durabilityUsed = Math.min(slot.durabilityUsed, slot.maxDurability)\r\n      const debugIsQuickbar = !isJei && i === bot.inventory.hotbarStart + bot.quickBarSlot\r\n      const modelName = getItemModelName(slot, { 'minecraft:display_context': 'gui', })\r\n      const slotCustomProps = renderSlot({ modelName }, debugIsQuickbar)\r\n      const itemCustomName = getItemName(slot)\r\n      Object.assign(slot, { ...slotCustomProps, displayName: itemCustomName ?? slot.displayName })\r\n      //@ts-expect-error\r\n      slot.toJSON = () => {\r\n        // Allow to serialize slot to JSON as minecraft-inventory-gui creates icon property as cache (recursively)\r\n        //@ts-expect-error\r\n        const { icon, ...rest } = slot\r\n        return rest\r\n      }\r\n    } catch (err) {\r\n      inGameError(err)\r\n    }\r\n    return slot\r\n  })\r\n  lastMappedSots = newSlots\r\n  return newSlots\r\n}\r\n\r\nexport const upInventoryItems = (isInventory: boolean, invWindow = lastWindow) => {\r\n  // inv.pwindow.inv.slots[2].displayName = 'test'\r\n  // inv.pwindow.inv.slots[2].blockData = getBlockData('dirt')\r\n  const customSlots = mapSlots((isInventory ? bot.inventory : bot.currentWindow)!.slots)\r\n  invWindow.pwindow.setSlots(customSlots)\r\n}\r\n\r\nexport const onModalClose = (callback: () => any) => {\r\n  const modal = activeModalStack.at(-1)\r\n  const unsubscribe = subscribe(activeModalStack, () => {\r\n    const newModal = activeModalStack.at(-1)\r\n    if (modal?.reactType !== newModal?.reactType) {\r\n      callback()\r\n      unsubscribe()\r\n    }\r\n  }, true)\r\n}\r\n\r\nconst implementedContainersGuiMap = {\r\n  // todo allow arbitrary size instead!\r\n  'minecraft:generic_9x1': 'ChestWin',\r\n  'minecraft:generic_9x2': 'ChestWin',\r\n  'minecraft:generic_9x3': 'ChestWin',\r\n  'minecraft:generic_9x4': 'Generic95Win',\r\n  'minecraft:generic_9x5': 'Generic95Win',\r\n  // hopper\r\n  'minecraft:generic_5x1': 'HopperWin',\r\n  'minecraft:generic_9x6': 'LargeChestWin',\r\n  'minecraft:generic_3x3': 'DropDispenseWin',\r\n  'minecraft:furnace': 'FurnaceWin',\r\n  'minecraft:smoker': 'FurnaceWin',\r\n  'minecraft:crafting': 'CraftingWin',\r\n  'minecraft:crafting3x3': 'CraftingWin', // todo different result slot\r\n  'minecraft:anvil': 'AnvilWin',\r\n  // enchant\r\n  'minecraft:enchanting_table': 'EnchantingWin',\r\n  // horse\r\n  'minecraft:horse': 'HorseWin',\r\n  // villager\r\n  'minecraft:villager': 'VillagerWin',\r\n}\r\n\r\nconst upJei = (search: string) => {\r\n  search = search.toLowerCase()\r\n  // todo fix pre flat\r\n  const itemsArray = [\r\n    ...jeiCustomCategories.value.flatMap(x => x.items).filter(x => x !== null),\r\n    ...loadedData.itemsArray.filter(x => x.displayName.toLowerCase().includes(search)).map(item => new PrismarineItem(item.id, 1)).filter(x => x !== null)\r\n  ]\r\n  const matchedSlots = itemsArray.map(x => {\r\n    x.displayName = getItemName(x) ?? x.displayName\r\n    if (!x.displayName.toLowerCase().includes(search)) return null\r\n    return x\r\n  }).filter(a => a !== null)\r\n  lastWindow.pwindow.win.jeiSlotsPage = 0\r\n  lastWindow.pwindow.win.jeiSlots = mapSlots(matchedSlots, true)\r\n}\r\n\r\nexport const openItemsCanvas = (type, _bot = bot as typeof bot | null) => {\r\n  const inv = showInventory(type, getImage, {}, _bot);\r\n  (inv.canvasManager.children[0].callbacks as any).getItemRecipes = (item) => {\r\n    const allRecipes = getAllItemRecipes(item.name)\r\n    inv.canvasManager.children[0].messageDisplay = ''\r\n    const itemDescription = getItemDescription(item)\r\n    if (!allRecipes?.length && !itemDescription) {\r\n      inv.canvasManager.children[0].messageDisplay = `No recipes found for ${item.displayName}`\r\n    }\r\n    return [...allRecipes ?? [], ...itemDescription ? [\r\n      [\r\n        'GenericDescription',\r\n        mapSlots([item], true)[0],\r\n        [],\r\n        itemDescription\r\n      ]\r\n    ] : []]\r\n  }\r\n  (inv.canvasManager.children[0].callbacks as any).getItemUsages = (item) => {\r\n    const allItemUsages = getAllItemUsages(item.name)\r\n    inv.canvasManager.children[0].messageDisplay = ''\r\n    if (!allItemUsages?.length) {\r\n      inv.canvasManager.children[0].messageDisplay = `No usages found for ${item.displayName}`\r\n    }\r\n    return allItemUsages\r\n  }\r\n  return inv\r\n}\r\n\r\nlet skipClosePacketSending = false\r\nconst openWindow = (type: string | undefined) => {\r\n  // if (activeModalStack.some(x => x.reactType?.includes?.('player_win:'))) {\r\n  if (activeModalStack.length) { // game is not in foreground, don't close current modal\r\n    if (type) {\r\n      skipClosePacketSending = true\r\n      hideCurrentModal()\r\n    } else {\r\n      bot.currentWindow?.['close']()\r\n      return\r\n    }\r\n  }\r\n  showModal({\r\n    reactType: `player_win:${type}`,\r\n  })\r\n  onModalClose(() => {\r\n    // might be already closed (event fired)\r\n    if (type !== undefined && bot.currentWindow && !skipClosePacketSending) bot.currentWindow['close']()\r\n    lastWindow.destroy()\r\n    lastWindow = null as any\r\n    window.lastWindow = lastWindow\r\n    miscUiState.displaySearchInput = false\r\n    destroyFn()\r\n    skipClosePacketSending = false\r\n  })\r\n  cleanLoadedImagesCache()\r\n  const inv = openItemsCanvas(type)\r\n  inv.canvasManager.children[0].mobileHelpers = miscUiState.currentTouch\r\n  const title = bot.currentWindow?.title\r\n  const PrismarineChat = PrismarineChatLoader(bot.version)\r\n  try {\r\n    inv.canvasManager.children[0].customTitleText = title ?\r\n      typeof title === 'string' ?\r\n        fromFormattedString(title).text :\r\n        new PrismarineChat(title).toString() :\r\n      undefined\r\n  } catch (err) {\r\n    reportError?.(err)\r\n    inv.canvasManager.children[0].customTitleText = undefined\r\n  }\r\n  // todo\r\n  inv.canvasManager.setScale(currentScaling.scale === 1 ? 1.5 : currentScaling.scale)\r\n  inv.canvas.style.zIndex = '10'\r\n  inv.canvas.style.position = 'fixed'\r\n  inv.canvas.style.inset = '0'\r\n\r\n  inv.canvasManager.onClose = async () => {\r\n    await new Promise(resolve => {\r\n      setTimeout(resolve, 0)\r\n    })\r\n    if (activeModalStack.at(-1)?.reactType?.includes('player_win:')) {\r\n      hideModal(undefined, undefined, { force: true })\r\n    }\r\n    inv.canvasManager.destroy()\r\n  }\r\n\r\n  lastWindow = inv\r\n  const upWindowItems = () => {\r\n    if (!lastWindow && bot.currentWindow) {\r\n      // edge case: might happen due to high ping, inventory should be closed soon!\r\n      // openWindow(implementedContainersGuiMap[bot.currentWindow.type])\r\n      return\r\n    }\r\n    void Promise.resolve().then(() => upInventoryItems(type === undefined))\r\n  }\r\n  upWindowItems()\r\n\r\n  lastWindow.pwindow.touch = miscUiState.currentTouch ?? false\r\n  const oldOnInventoryEvent = lastWindow.pwindow.onInventoryEvent.bind(lastWindow.pwindow)\r\n  lastWindow.pwindow.onInventoryEvent = (type, containing, windowIndex, inventoryIndex, item) => {\r\n    if (inv.canvasManager.children[0].currentGuide) {\r\n      const isRightClick = type === 'rightclick'\r\n      const isLeftClick = type === 'leftclick'\r\n      if (isLeftClick || isRightClick) {\r\n        inv.canvasManager.children[0].showRecipesOrUsages(isLeftClick, item)\r\n      }\r\n    } else {\r\n      oldOnInventoryEvent(type, containing, windowIndex, inventoryIndex, item)\r\n    }\r\n  }\r\n  lastWindow.pwindow.onJeiClick = (slotItem, _index, isRightclick) => {\r\n    // slotItem is the slot from mapSlots\r\n    const itemId = loadedData.itemsByName[slotItem.name]?.id\r\n    if (!itemId) {\r\n      inGameError(`Item for block ${slotItem.name} not found`)\r\n      return\r\n    }\r\n    const item = PrismarineItem.fromNotch({\r\n      ...slotItem,\r\n      itemId,\r\n      itemCount: isRightclick ? 64 : 1,\r\n      components: slotItem.components ?? [],\r\n      removeComponents: slotItem.removedComponents ?? [],\r\n      itemDamage: slotItem.metadata ?? 0,\r\n      nbt: slotItem.nbt,\r\n    })\r\n    if (bot.game.gameMode === 'creative') {\r\n      const freeSlot = bot.inventory.firstEmptyInventorySlot()\r\n      if (freeSlot === null) return\r\n      void bot.creative.setInventorySlot(freeSlot, item)\r\n    } else {\r\n      inv.canvasManager.children[0].showRecipesOrUsages(!isRightclick, mapSlots([item], true)[0])\r\n    }\r\n  }\r\n\r\n  const isJeiEnabled = () => {\r\n    if (typeof options.jeiEnabled === 'boolean') return options.jeiEnabled\r\n    if (Array.isArray(options.jeiEnabled)) {\r\n      return options.jeiEnabled.includes(bot.game?.gameMode as any)\r\n    }\r\n    return false\r\n  }\r\n\r\n  if (isJeiEnabled()) {\r\n    lastWindow.pwindow.win.jeiSlotsPage = 0\r\n    // todo workaround so inventory opens immediately (though it still lags)\r\n    setTimeout(() => {\r\n      upJei('')\r\n    })\r\n    miscUiState.displaySearchInput = true\r\n  } else {\r\n    lastWindow.pwindow.win.jeiSlots = []\r\n    miscUiState.displaySearchInput = false\r\n  }\r\n\r\n  if (type === undefined) {\r\n    // player inventory\r\n    bot.inventory.on('updateSlot', upWindowItems)\r\n    destroyFn = () => {\r\n      bot.inventory.off('updateSlot', upWindowItems)\r\n    }\r\n  } else {\r\n    //@ts-expect-error\r\n    bot.currentWindow.on('updateSlot', () => {\r\n      upWindowItems()\r\n    })\r\n  }\r\n}\r\n\r\nlet destroyFn = () => { }\r\n\r\nexport const openPlayerInventory = () => {\r\n  openWindow(undefined)\r\n}\r\n\r\nconst getResultingRecipe = (slots: Array<Item | null>, gridRows: number) => {\r\n  const inputSlotsItems = slots.map(blockSlot => blockSlot?.type)\r\n  let currentShape = splitEvery(gridRows, inputSlotsItems as Array<number | undefined | null>)\r\n  // todo rewrite with candidates search\r\n  if (currentShape.length > 1) {\r\n    // eslint-disable-next-line @typescript-eslint/no-for-in-array\r\n    for (const slotX in currentShape[0]) {\r\n      if (currentShape[0][slotX] !== undefined) {\r\n        for (const [otherY] of Array.from({ length: gridRows }).entries()) {\r\n          if (currentShape[otherY]?.[slotX] === undefined) {\r\n            currentShape[otherY]![slotX] = null\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  currentShape = currentShape.map(arr => arr.filter(x => x !== undefined)).filter(x => x.length !== 0)\r\n\r\n  // todo rewrite\r\n  // eslint-disable-next-line @typescript-eslint/require-array-sort-compare\r\n  const slotsIngredients = [...inputSlotsItems].sort().filter(item => item !== undefined)\r\n  type Result = RecipeItem | undefined\r\n  let shapelessResult: Result\r\n  let shapeResult: Result\r\n  outer: for (const [id, recipeVariants] of Object.entries(loadedData.recipes)) {\r\n    for (const recipeVariant of recipeVariants) {\r\n      if ('inShape' in recipeVariant && equals(currentShape, recipeVariant.inShape as number[][])) {\r\n        shapeResult = recipeVariant.result!\r\n        break outer\r\n      }\r\n      if ('ingredients' in recipeVariant && equals(slotsIngredients, recipeVariant.ingredients?.sort() as number[])) {\r\n        shapelessResult = recipeVariant.result\r\n        break outer\r\n      }\r\n    }\r\n  }\r\n  const result = shapeResult ?? shapelessResult\r\n  if (!result) return\r\n  const id = typeof result === 'number' ? result : Array.isArray(result) ? result[0] : result.id\r\n  if (!id) return\r\n  const count = (typeof result === 'number' ? undefined : Array.isArray(result) ? result[1] : result.count) ?? 1\r\n  const metadata = typeof result === 'object' && !Array.isArray(result) ? result.metadata : undefined\r\n  const item = new PrismarineItem(id, count, metadata)\r\n  return item\r\n}\r\n\r\nconst ingredientToItem = (recipeItem) => (recipeItem === null ? null : new PrismarineItem(recipeItem, 1))\r\n\r\nconst getAllItemRecipes = (itemName: string) => {\r\n  const item = loadedData.itemsByName[itemName]\r\n  if (!item) return\r\n  const itemId = item.id\r\n  const recipes = loadedData.recipes[itemId]\r\n  if (!recipes) return\r\n  const results = [] as Array<{\r\n    result: Item,\r\n    ingredients: Array<Item | null>,\r\n    description?: string\r\n  }>\r\n\r\n  // get recipes here\r\n  for (const recipe of recipes) {\r\n    const { result } = recipe\r\n    if (!result) continue\r\n    const resultId = typeof result === 'number' ? result : Array.isArray(result) ? result[0]! : result.id\r\n    const resultCount = (typeof result === 'number' ? undefined : Array.isArray(result) ? result[1] : result.count) ?? 1\r\n    const resultMetadata = typeof result === 'object' && !Array.isArray(result) ? result.metadata : undefined\r\n    const resultItem = new PrismarineItem(resultId!, resultCount, resultMetadata)\r\n    if ('inShape' in recipe) {\r\n      const ingredients = recipe.inShape\r\n      if (!ingredients) continue\r\n\r\n      const ingredientsItems = ingredients.flatMap(items => items.map(item => ingredientToItem(item)))\r\n      results.push({ result: resultItem, ingredients: ingredientsItems })\r\n    }\r\n    if ('ingredients' in recipe) {\r\n      const { ingredients } = recipe\r\n      if (!ingredients) continue\r\n      const ingredientsItems = ingredients.map(item => ingredientToItem(item))\r\n      results.push({ result: resultItem, ingredients: ingredientsItems, description: 'Shapeless' })\r\n    }\r\n  }\r\n  return results.map(({ result, ingredients, description }) => {\r\n    return [\r\n      'CraftingTableGuide',\r\n      mapSlots([result], true)[0],\r\n      mapSlots(ingredients, true),\r\n      description\r\n    ]\r\n  })\r\n}\r\n\r\nconst getAllItemUsages = (itemName: string) => {\r\n  const item = loadedData.itemsByName[itemName]\r\n  if (!item) return\r\n  const foundRecipeIds = [] as string[]\r\n\r\n  for (const [id, recipes] of Object.entries(loadedData.recipes)) {\r\n    for (const recipe of recipes) {\r\n      if ('inShape' in recipe) {\r\n        if (recipe.inShape.some(row => row.includes(item.id))) {\r\n          foundRecipeIds.push(id)\r\n        }\r\n      }\r\n      if ('ingredients' in recipe) {\r\n        if (recipe.ingredients.includes(item.id)) {\r\n          foundRecipeIds.push(id)\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return foundRecipeIds.flatMap(id => {\r\n    // todo should use exact match, not include all recipes!\r\n    return getAllItemRecipes(loadedData.items[id].name)\r\n  })\r\n}\r\n","\r\nexport const descriptionGenerators = new Map<RegExp | string[], string | ((name) => string)>()\r\ndescriptionGenerators.set(/_slab$/, name => 'Craft it by placing 3 blocks of the material in a row in a crafting table.')\r\ndescriptionGenerators.set(/_stairs$/, name => 'Craft it by placing 6 blocks of the material in a stair shape in a crafting table.')\r\ndescriptionGenerators.set(/_log$/, name => 'You can get it by chopping down a tree. To chop down a tree, hold down the left mouse button until the tree breaks.')\r\ndescriptionGenerators.set(/_leaves$/, name => 'You can get it by breaking the leaves of a tree with a tool that has the Silk Touch enchantment or by using shears.')\r\ndescriptionGenerators.set(['mangrove_roots'], name => 'You can get it by breaking the roots of a mangrove tree.')\r\ndescriptionGenerators.set(['mud'], 'Mud is a block found abundantly in mangrove swamps or created by using a water bottle on a dirt block. It can be used for crafting or converted into clay using pointed dripstone.')\r\ndescriptionGenerators.set(['clay'], 'Clay is a block found underwater or created by using a water bottle on a mud block. It can be used for crafting or converted into terracotta using a furnace.')\r\ndescriptionGenerators.set(['terracotta'], 'Terracotta is a block created by smelting clay in a furnace. It can be used for crafting or decoration.')\r\ndescriptionGenerators.set(['stone'], 'Stone is a block found underground.')\r\ndescriptionGenerators.set(['dirt'], 'Dirt is a block found on the surface.')\r\ndescriptionGenerators.set(['sand'], 'Sand is a block found on the surface near water.')\r\ndescriptionGenerators.set(['gravel'], 'Gravel is a block found on the surface and sometimes underground.')\r\ndescriptionGenerators.set(['sandstone'], 'Sandstone is a block found in deserts.')\r\ndescriptionGenerators.set(['red_sandstone'], 'Red sandstone is a block found in mesas.')\r\ndescriptionGenerators.set(['granite', 'diorite', 'andesite'], name => `${name.charAt(0).toUpperCase() + name.slice(1)} is a block found underground.`)\r\ndescriptionGenerators.set(['netherrack', 'soul_sand', 'soul_soil', 'glowstone'], name => `${name.charAt(0).toUpperCase() + name.slice(1)} is a block found in the Nether.`)\r\ndescriptionGenerators.set(['end_stone'], 'End stone is a block found in the End.')\r\ndescriptionGenerators.set(['obsidian'], 'Obsidian is a block created by pouring water on lava.')\r\ndescriptionGenerators.set(['glass'], 'Glass is a block created by smelting sand in a furnace.')\r\ndescriptionGenerators.set(['bedrock'], 'Bedrock is an indestructible block found at the bottom of the world in the Overworld and at the top of the world in the Nether.')\r\ndescriptionGenerators.set(['water', 'lava'], name => `${name.charAt(0).toUpperCase() + name.slice(1)} is a fluid found in the Overworld.`)\r\ndescriptionGenerators.set(/_sapling$/, name => `${name} drops from the leaves of a tree when it decays or is broken. It can be planted on dirt to grow a new tree.`)\r\ndescriptionGenerators.set(/^stripped_/, name => `${name} is created by using an axe on the block.`)\r\ndescriptionGenerators.set(['sponge'], 'Sponge is a block found in ocean monuments.')\r\ndescriptionGenerators.set(/^music_disc_/, name => `Music discs are rare items that can be found in dungeons or by trading with villagers. Also dropped by creepers when killed by a skeleton.`)\r\ndescriptionGenerators.set(/^enchanted_book$/, 'Enchanted books are rare items that can be found in dungeons or by trading with villagers.')\r\ndescriptionGenerators.set(/_spawn_egg$/, name => `${name} is an item that can be used to spawn a mob in Creative mode. Cannot be obtained in Survival mode.`)\r\ndescriptionGenerators.set(/_pottery_sherd$/, name => `${name} can be obtained only by brushing suspicious blocks, with the variants of sherd obtainable being dependent on the structure.`)\r\ndescriptionGenerators.set(['cracked_deepslate_bricks'], `Deepslate Bricks and Cracked Deepslate Bricks generate naturally in ancient cities.`)\r\n\r\nconst moreGeneratedBlocks = {\r\n  'natural_blocks': {\r\n    'air': {\r\n      'obtained_from': 'Naturally occurs in the world.'\r\n    },\r\n    'deepslate': {\r\n      'obtained_from': 'Mined with a pickaxe in layers -64 to 16.',\r\n      'rarity': 'Common'\r\n    },\r\n    'cobbled_deepslate': {\r\n      'obtained_from': 'Mined from deepslate with any pickaxe.'\r\n    },\r\n    'calcite': {\r\n      'obtained_from': 'Mined with a pickaxe, found in geodes.'\r\n    },\r\n    'tuff': {\r\n      'obtained_from': 'Mined with a pickaxe in layers -64 to 16.',\r\n      'rarity': 'Common'\r\n    },\r\n    'chiseled_tuff': {\r\n      'obtained_from': 'Crafted from tuff.'\r\n    },\r\n    'polished_tuff': {\r\n      'obtained_from': 'Crafted from tuff.'\r\n    },\r\n    'tuff_bricks': {\r\n      'obtained_from': 'Crafted from tuff.'\r\n    },\r\n    'chiseled_tuff_bricks': {\r\n      'obtained_from': 'Crafted from tuff bricks.'\r\n    },\r\n    'grass_block': {\r\n      'obtained_from': 'Mined with a tool enchanted with Silk Touch.'\r\n    },\r\n    'podzol': {\r\n      'obtained_from': 'Mined with a tool enchanted with Silk Touch, found in giant tree taiga biomes.'\r\n    },\r\n    'rooted_dirt': {\r\n      'obtained_from': 'Mined with a shovel, found under azalea trees.'\r\n    },\r\n    'crimson_nylium': {\r\n      'obtained_from': 'Mined with a pickaxe, found in the Nether.'\r\n    },\r\n    'warped_nylium': {\r\n      'obtained_from': 'Mined with a pickaxe, found in the Nether.'\r\n    },\r\n    'cobblestone': {\r\n      'obtained_from': 'Mined from stone, or from breaking stone structures.'\r\n    },\r\n    'mangrove_propagule': {\r\n      'obtained_from': 'Harvested from mangrove trees.'\r\n    },\r\n    'suspicious_sand': {\r\n      'obtained_from': 'Found in deserts and beaches.'\r\n    },\r\n    'suspicious_gravel': {\r\n      'obtained_from': 'Found underwater.'\r\n    },\r\n    'red_sand': {\r\n      'obtained_from': 'Mined from red sand in badlands biomes.'\r\n    },\r\n    'coal_ore': {\r\n      'obtained_from': 'Mined with a pickaxe in layers 0 to 128.',\r\n      'rarity': 'Common'\r\n    },\r\n    'deepslate_coal_ore': {\r\n      'obtained_from': 'Mined with a pickaxe in layers -64 to 0.',\r\n      'rarity': 'Rare'\r\n    },\r\n    'iron_ore': {\r\n      'obtained_from': 'Mined with a pickaxe in layers 0 to 63.',\r\n      'rarity': 'Common'\r\n    },\r\n    'deepslate_iron_ore': {\r\n      'obtained_from': 'Mined with a pickaxe in layers -64 to 0.',\r\n      'rarity': 'Uncommon'\r\n    },\r\n    'copper_ore': {\r\n      'obtained_from': 'Mined with a pickaxe in layers 0 to 96.',\r\n      'rarity': 'Common'\r\n    },\r\n    'deepslate_copper_ore': {\r\n      'obtained_from': 'Mined with a pickaxe in layers -16 to 64.',\r\n      'rarity': 'Uncommon'\r\n    },\r\n    'gold_ore': {\r\n      'obtained_from': 'Mined with a pickaxe in layers -64 to 32.',\r\n      'rarity': 'Uncommon'\r\n    },\r\n    'deepslate_gold_ore': {\r\n      'obtained_from': 'Mined with a pickaxe in layers -64 to 0.',\r\n      'rarity': 'Rare'\r\n    },\r\n    'redstone_ore': {\r\n      'obtained_from': 'Mined with an iron pickaxe or higher in layers -64 to 16.',\r\n      'rarity': 'Uncommon'\r\n    },\r\n    'deepslate_redstone_ore': {\r\n      'obtained_from': 'Mined with an iron pickaxe or higher in layers -64 to 0.',\r\n      'rarity': 'Uncommon'\r\n    },\r\n    'emerald_ore': {\r\n      'obtained_from': 'Mined with an iron pickaxe or higher in mountain biomes, layers -16 to 256.',\r\n      'rarity': 'Rare'\r\n    },\r\n    'deepslate_emerald_ore': {\r\n      'obtained_from': 'Mined with an iron pickaxe or higher in mountain biomes, layers -64 to 0.',\r\n      'rarity': 'Very Rare'\r\n    },\r\n    'lapis_ore': {\r\n      'obtained_from': 'Mined with a stone pickaxe or higher in layers -64 to 32.',\r\n      'rarity': 'Uncommon'\r\n    },\r\n    'deepslate_lapis_ore': {\r\n      'obtained_from': 'Mined with a stone pickaxe or higher in layers -64 to 0.',\r\n      'rarity': 'Rare'\r\n    },\r\n    'diamond_ore': {\r\n      'obtained_from': 'Mined with an iron pickaxe or higher in layers -64 to 16.',\r\n      'rarity': 'Rare'\r\n    },\r\n    'deepslate_diamond_ore': {\r\n      'obtained_from': 'Mined with an iron pickaxe or higher in layers -64 to 0.',\r\n      'rarity': 'Very Rare'\r\n    },\r\n    'nether_gold_ore': {\r\n      'obtained_from': 'Mined with any pickaxe in the Nether.'\r\n    },\r\n    'nether_quartz_ore': {\r\n      'obtained_from': 'Mined with any pickaxe in the Nether.'\r\n    },\r\n    'ancient_debris': {\r\n      'obtained_from': 'Mined with a diamond or netherite pickaxe in the Nether, layers 8 to 22.',\r\n      'rarity': 'Very Rare'\r\n    },\r\n    'budding_amethyst': {\r\n      'obtained_from': 'Found in amethyst geodes, cannot be obtained as an item.'\r\n    },\r\n    'exposed_copper': {\r\n      'obtained_from': 'Exposed copper block obtained through mining.'\r\n    },\r\n    'weathered_copper': {\r\n      'obtained_from': 'Weathered copper block obtained through mining.'\r\n    },\r\n    'oxidized_copper': {\r\n      'obtained_from': 'Oxidized copper block obtained through mining.'\r\n    },\r\n    'chiseled_copper': {\r\n      'obtained_from': 'Crafted from copper blocks.'\r\n    },\r\n    'exposed_chiseled_copper': {\r\n      'obtained_from': 'Exposed chiseled copper block obtained through mining.'\r\n    },\r\n    'weathered_chiseled_copper': {\r\n      'obtained_from': 'Weathered chiseled copper block obtained through mining.'\r\n    },\r\n    'oxidized_chiseled_copper': {\r\n      'obtained_from': 'Oxidized chiseled copper block obtained through mining.'\r\n    },\r\n    'waxed_chiseled_copper': {\r\n      'obtained_from': 'Crafted from copper blocks, waxed to prevent oxidation.'\r\n    },\r\n    'waxed_exposed_chiseled_copper': {\r\n      'obtained_from': 'Waxed exposed chiseled copper block obtained through mining.'\r\n    },\r\n    'waxed_weathered_chiseled_copper': {\r\n      'obtained_from': 'Waxed weathered chiseled copper block obtained through mining.'\r\n    },\r\n    'waxed_oxidized_chiseled_copper': {\r\n      'obtained_from': 'Waxed oxidized chiseled copper block obtained through mining.'\r\n    },\r\n    'crimson_stem': {\r\n      'obtained_from': 'Mined from crimson trees in the Nether.'\r\n    },\r\n    'warped_stem': {\r\n      'obtained_from': 'Mined from warped trees in the Nether.'\r\n    },\r\n    'stripped_crimson_stem': {\r\n      'obtained_from': 'Stripped from crimson stem with an axe.'\r\n    },\r\n    'stripped_warped_stem': {\r\n      'obtained_from': 'Stripped from warped stem with an axe.'\r\n    },\r\n    'stripped_bamboo_block': {\r\n      'obtained_from': 'Crafted from bamboo.'\r\n    },\r\n    'sponge': {\r\n      'obtained_from': 'Found in ocean monuments.'\r\n    },\r\n    'wet_sponge': {\r\n      'obtained_from': 'Absorbs water, can be dried in a furnace.'\r\n    },\r\n    'cobweb': {\r\n      'obtained_from': 'Mined with a sword or shears, found in mineshafts.'\r\n    },\r\n    'short_grass': {\r\n      'obtained_from': 'Sheared from grass.'\r\n    },\r\n    'fern': {\r\n      'obtained_from': 'Sheared from ferns in forest biomes.'\r\n    },\r\n    'azalea': {\r\n      'obtained_from': 'Found in lush caves.'\r\n    },\r\n    'flowering_azalea': {\r\n      'obtained_from': 'Found in lush caves.'\r\n    },\r\n    'dead_bush': {\r\n      'obtained_from': 'Mined with shears in desert biomes.'\r\n    },\r\n    'seagrass': {\r\n      'obtained_from': 'Sheared from underwater grass.'\r\n    },\r\n    'sea_pickle': {\r\n      'obtained_from': 'Mined with shears from coral reefs.'\r\n    },\r\n    'dandelion': {\r\n      'type': 'natural',\r\n      'description': 'Dandelions are common flowers that spawn in plains, forests, and meadows.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'poppy': {\r\n      'type': 'natural',\r\n      'description': 'Poppies are common flowers that generate in plains, forests, and meadows.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'blue_orchid': {\r\n      'type': 'natural',\r\n      'description': 'Blue orchids spawn naturally in swamp biomes.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'allium': {\r\n      'type': 'natural',\r\n      'description': 'Alliums are flowers that generate in flower forest biomes.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'azure_bluet': {\r\n      'type': 'natural',\r\n      'description': 'Azure bluets are common flowers that spawn in plains and flower forest biomes.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'red_tulip': {\r\n      'type': 'natural',\r\n      'description': 'Red tulips are flowers found in flower forests and plains.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'orange_tulip': {\r\n      'type': 'natural',\r\n      'description': 'Orange tulips are flowers found in flower forests and plains.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'white_tulip': {\r\n      'type': 'natural',\r\n      'description': 'White tulips are flowers found in flower forests and plains.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'pink_tulip': {\r\n      'type': 'natural',\r\n      'description': 'Pink tulips are flowers found in flower forests and plains.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'oxeye_daisy': {\r\n      'type': 'natural',\r\n      'description': 'Oxeye daisies are common flowers that generate in plains and flower forest biomes.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'cornflower': {\r\n      'type': 'natural',\r\n      'description': 'Cornflowers spawn in plains, flower forests, and meadows.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'lily_of_the_valley': {\r\n      'type': 'natural',\r\n      'description': 'Lily of the valleys generate in flower forest biomes.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'wither_rose': {\r\n      'type': 'dropped',\r\n      'description': 'Wither roses are dropped when a mob is killed by the Wither boss.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'torchflower': {\r\n      'type': 'crafted',\r\n      'description': 'Torchflowers can be grown using torchflower seeds, which are found in archeology loot or by trading.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'pitcher_plant': {\r\n      'type': 'crafted',\r\n      'description': 'Pitcher plants can be grown using pitcher pods, which are found in archeology loot or by trading.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'spore_blossom': {\r\n      'type': 'natural',\r\n      'description': 'Spore blossoms generate naturally on the ceilings of lush caves.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'brown_mushroom': {\r\n      'type': 'natural',\r\n      'description': 'Brown mushrooms are found in dark areas, swamps, mushroom fields, and forests.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'red_mushroom': {\r\n      'type': 'natural',\r\n      'description': 'Red mushrooms are found in dark areas, swamps, mushroom fields, and forests.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'crimson_fungus': {\r\n      'type': 'natural',\r\n      'description': 'Crimson fungi generate naturally in crimson forests in the Nether.',\r\n      'spawn_range': 'Nether'\r\n    },\r\n    'warped_fungus': {\r\n      'type': 'natural',\r\n      'description': 'Warped fungi generate naturally in warped forests in the Nether.',\r\n      'spawn_range': 'Nether'\r\n    },\r\n    'crimson_roots': {\r\n      'type': 'natural',\r\n      'description': 'Crimson roots generate naturally in crimson forests in the Nether.',\r\n      'spawn_range': 'Nether'\r\n    },\r\n    'warped_roots': {\r\n      'type': 'natural',\r\n      'description': 'Warped roots generate naturally in warped forests in the Nether.',\r\n      'spawn_range': 'Nether'\r\n    },\r\n    'nether_sprouts': {\r\n      'type': 'natural',\r\n      'description': 'Nether sprouts generate naturally in warped forests in the Nether.',\r\n      'spawn_range': 'Nether'\r\n    },\r\n    'weeping_vines': {\r\n      'type': 'natural',\r\n      'description': 'Weeping vines generate naturally in crimson forests in the Nether and grow downward from netherrack.',\r\n      'spawn_range': 'Nether'\r\n    },\r\n    'twisting_vines': {\r\n      'type': 'natural',\r\n      'description': 'Twisting vines generate naturally in warped forests in the Nether and grow upward from the ground.',\r\n      'spawn_range': 'Nether'\r\n    },\r\n    'sugar_cane': {\r\n      'type': 'natural',\r\n      'description': 'Sugar cane is found near water in most biomes.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'kelp': {\r\n      'type': 'natural',\r\n      'description': 'Kelp generates underwater in most ocean biomes.',\r\n      'spawn_range': 'Water'\r\n    },\r\n    'pink_petals': {\r\n      'type': 'natural',\r\n      'description': 'Pink petals generate naturally in cherry grove biomes.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'moss_block': {\r\n      'type': 'natural',\r\n      'description': 'Moss blocks generate in lush caves and can also be obtained through trading or by using bone meal on moss carpets.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'hanging_roots': {\r\n      'type': 'natural',\r\n      'description': 'Hanging roots generate naturally in lush caves.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'big_dripleaf': {\r\n      'type': 'natural',\r\n      'description': 'Big dripleaf plants generate in lush caves and can also be obtained through trading.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'small_dripleaf': {\r\n      'type': 'natural',\r\n      'description': 'Small dripleaf plants generate in lush caves and can also be obtained through trading.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'bamboo': {\r\n      'type': 'natural',\r\n      'description': 'Bamboo generates in jungle biomes, especially bamboo jungles.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'smooth_quartz': {\r\n      'type': 'crafted',\r\n      'description': 'Smooth quartz is obtained by smelting blocks of quartz.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'smooth_red_sandstone': {\r\n      'type': 'crafted',\r\n      'description': 'Smooth red sandstone is obtained by smelting red sandstone.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'smooth_sandstone': {\r\n      'type': 'crafted',\r\n      'description': 'Smooth sandstone is obtained by smelting sandstone.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'smooth_stone': {\r\n      'type': 'crafted',\r\n      'description': 'Smooth stone is obtained by smelting regular stone.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'chorus_plant': {\r\n      'type': 'natural',\r\n      'description': 'Chorus plants generate naturally in the End and can be grown from chorus flowers.',\r\n      'spawn_range': 'End'\r\n    },\r\n    'chorus_flower': {\r\n      'type': 'natural',\r\n      'description': 'Chorus flowers generate naturally in the End on top of chorus plants.',\r\n      'spawn_range': 'End'\r\n    },\r\n    'spawner': {\r\n      'type': 'natural',\r\n      'description': 'Spawners generate in dungeons, mineshafts, and other structures.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'farmland': {\r\n      'type': 'crafted',\r\n      'description': 'Farmland is created by using a hoe on dirt or grass blocks.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'ice': {\r\n      'type': 'natural',\r\n      'description': 'Ice generates in snowy and icy biomes and can also be obtained by breaking ice blocks with a Silk Touch tool.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'cactus': {\r\n      'type': 'natural',\r\n      'description': 'Cacti generate naturally in desert biomes.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'pumpkin': {\r\n      'type': 'natural',\r\n      'description': 'Pumpkins generate naturally in most grassy biomes and can also be grown from pumpkin seeds.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'carved_pumpkin': {\r\n      'type': 'crafted',\r\n      'description': 'Carved pumpkins are obtained by using shears on a pumpkin.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'basalt': {\r\n      'type': 'natural',\r\n      'description': 'Basalt generates in the Nether in basalt deltas and can also be created by lava flowing over soul soil next to blue ice.',\r\n      'spawn_range': 'Nether'\r\n    },\r\n    'smooth_basalt': {\r\n      'type': 'natural',\r\n      'description': 'Smooth basalt is found around amethyst geodes or can be obtained by smelting basalt.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'infested_stone': {\r\n      'type': 'natural',\r\n      'description': 'Infested stone blocks contain silverfish and generate in strongholds, underground.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'infested_cobblestone': {\r\n      'type': 'natural',\r\n      'description': 'Infested cobblestone blocks contain silverfish and generate in strongholds, underground.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'infested_stone_bricks': {\r\n      'type': 'natural',\r\n      'description': 'Infested stone bricks contain silverfish and generate in strongholds, underground.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'infested_mossy_stone_bricks': {\r\n      'type': 'natural',\r\n      'description': 'Infested mossy stone bricks contain silverfish and generate in strongholds, underground.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'infested_cracked_stone_bricks': {\r\n      'type': 'natural',\r\n      'description': 'Infested cracked stone bricks contain silverfish and generate in strongholds, underground.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'infested_chiseled_stone_bricks': {\r\n      'type': 'natural',\r\n      'description': 'Infested chiseled stone bricks contain silverfish and generate in strongholds, underground.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'infested_deepslate': {\r\n      'type': 'natural',\r\n      'description': 'Infested deepslate contains silverfish and generates in the deepslate layer underground.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'cracked_stone_bricks': {\r\n      'type': 'crafted',\r\n      'description': 'Cracked stone bricks are obtained by smelting stone bricks.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'cracked_deepslate_bricks': {\r\n      'type': 'crafted',\r\n      'description': 'Cracked deepslate bricks are obtained by smelting deepslate bricks.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'cracked_deepslate_tiles': {\r\n      'type': 'crafted',\r\n      'description': 'Cracked deepslate tiles are obtained by smelting deepslate tiles.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'reinforced_deepslate': {\r\n      'type': 'crafted',\r\n      'description': 'Reinforced deepslate is a strong block that cannot be obtained in survival mode.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'brown_mushroom_block': {\r\n      'type': 'natural',\r\n      'description': 'Brown mushroom blocks generate as part of huge mushrooms in dark forest biomes and mushroom fields.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'red_mushroom_block': {\r\n      'type': 'natural',\r\n      'description': 'Red mushroom blocks generate as part of huge mushrooms in dark forest biomes and mushroom fields.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'mushroom_stem': {\r\n      'type': 'natural',\r\n      'description': 'Mushroom stems generate as part of huge mushrooms in dark forest biomes and mushroom fields.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'vine': {\r\n      'type': 'natural',\r\n      'description': 'Vines generate naturally on trees and walls in jungle biomes, swamps, and lush caves.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'glow_lichen': {\r\n      'type': 'natural',\r\n      'description': 'Glow lichen generates naturally in caves and can spread to other blocks using bone meal.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'mycelium': {\r\n      'type': 'natural',\r\n      'description': 'Mycelium generates naturally in mushroom field biomes and spreads to dirt blocks.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'lily_pad': {\r\n      'type': 'natural',\r\n      'description': 'Lily pads generate naturally on the surface of water in swamps.',\r\n      'spawn_range': 'Water'\r\n    },\r\n    'cracked_nether_bricks': {\r\n      'type': 'crafted',\r\n      'description': 'Cracked nether bricks are obtained by smelting nether bricks.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'sculk': {\r\n      'type': 'natural',\r\n      'description': 'Sculk generates naturally in the deep dark biome and spreads using a sculk catalyst.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'sculk_vein': {\r\n      'type': 'natural',\r\n      'description': 'Sculk veins generate naturally in the deep dark biome and spread using a sculk catalyst.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'sculk_catalyst': {\r\n      'type': 'natural',\r\n      'description': 'Sculk catalysts generate naturally in the deep dark biome and spread sculk blocks when mobs die nearby.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'sculk_shrieker': {\r\n      'type': 'natural',\r\n      'description': 'Sculk shriekers generate naturally in the deep dark biome and emit a loud shriek when activated.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'end_portal_frame': {\r\n      'type': 'natural',\r\n      'description': 'End portal frames generate naturally in strongholds, forming the structure of end portals.',\r\n      'spawn_range': 'Underground'\r\n    },\r\n    'dragon_egg': {\r\n      'type': 'dropped',\r\n      'description': 'The dragon egg is dropped when the Ender Dragon is defeated for the first time.',\r\n      'spawn_range': 'End'\r\n    },\r\n    'command_block': {\r\n      'type': 'crafted',\r\n      'description': 'Command blocks are powerful blocks used in commands and redstone, obtainable only via commands.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'chipped_anvil': {\r\n      'type': 'crafted',\r\n      'description': 'Chipped anvils are damaged versions of anvils and are used for repairing and enchanting.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'damaged_anvil': {\r\n      'type': 'crafted',\r\n      'description': 'Damaged anvils are further damaged versions of anvils and are used for repairing and enchanting.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'barrier': {\r\n      'type': 'crafted',\r\n      'description': 'Barriers are invisible blocks used in map-making and obtainable only via commands.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'light': {\r\n      'type': 'crafted',\r\n      'description': 'Light blocks are invisible blocks that emit light, obtainable only via commands.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'dirt_path': {\r\n      'type': 'crafted',\r\n      'description': 'Dirt paths are created by using a shovel on grass blocks and are commonly found in villages.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'sunflower': {\r\n      'type': 'natural',\r\n      'description': 'Sunflowers generate naturally in sunflower plains biomes.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'lilac': {\r\n      'type': 'natural',\r\n      'description': 'Lilacs generate naturally in forest biomes.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'rose_bush': {\r\n      'type': 'natural',\r\n      'description': 'Rose bushes generate naturally in forest biomes.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'peony': {\r\n      'type': 'natural',\r\n      'description': 'Peonies generate naturally in forest biomes.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'tall_grass': {\r\n      'type': 'natural',\r\n      'description': 'Tall grass generates naturally in various biomes and can be grown using bone meal.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'large_fern': {\r\n      'type': 'natural',\r\n      'description': 'Large ferns generate naturally in taiga biomes.',\r\n      'spawn_range': 'Surface'\r\n    },\r\n    'repeating_command_block': {\r\n      'type': 'crafted',\r\n      'description': 'Repeating command blocks execute commands every tick and are obtainable only via commands.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'chain_command_block': {\r\n      'type': 'crafted',\r\n      'description': 'Chain command blocks execute commands when triggered and are obtainable only via commands.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'warped_wart_block': {\r\n      'type': 'natural',\r\n      'description': 'Warped wart blocks generate naturally in warped forests in the Nether.',\r\n      'spawn_range': 'Nether'\r\n    },\r\n    'structure_void': {\r\n      'type': 'crafted',\r\n      'description': 'Structure voids are used in structure blocks to exclude certain blocks from being saved and are obtainable only via commands.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'white_shulker_box': {\r\n      'type': 'crafted',\r\n      'description': 'White shulker boxes are crafted from shulker shells and dye, and they function as portable storage.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'orange_shulker_box': {\r\n      'type': 'crafted',\r\n      'description': 'Orange shulker boxes are crafted from shulker shells and dye, and they function as portable storage.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'magenta_shulker_box': {\r\n      'type': 'crafted',\r\n      'description': 'Magenta shulker boxes are crafted from shulker shells and dye, and they function as portable storage.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'light_blue_shulker_box': {\r\n      'type': 'crafted',\r\n      'description': 'Light blue shulker boxes are crafted from shulker shells and dye, and they function as portable storage.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'yellow_shulker_box': {\r\n      'type': 'crafted',\r\n      'description': 'Yellow shulker boxes are crafted from shulker shells and dye, and they function as portable storage.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'lime_shulker_box': {\r\n      'type': 'crafted',\r\n      'description': 'Lime shulker boxes are crafted from shulker shells and dye, and they function as portable storage.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'pink_shulker_box': {\r\n      'type': 'crafted',\r\n      'description': 'Pink shulker boxes are crafted from shulker shells and dye, and they function as portable storage.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'gray_shulker_box': {\r\n      'type': 'crafted',\r\n      'description': 'Gray shulker boxes are crafted from shulker shells and dye, and they function as portable storage.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'light_gray_shulker_box': {\r\n      'type': 'crafted',\r\n      'description': 'Light gray shulker boxes are crafted from shulker shells and dye, and they function as portable storage.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'cyan_shulker_box': {\r\n      'type': 'crafted',\r\n      'description': 'Cyan shulker boxes are crafted from shulker shells and dye, and they function as portable storage.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'purple_shulker_box': {\r\n      'type': 'crafted',\r\n      'description': 'Purple shulker boxes are crafted from shulker shells and dye, and they function as portable storage.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'blue_shulker_box': {\r\n      'type': 'crafted',\r\n      'description': 'Blue shulker boxes are crafted from shulker shells and dye, and they function as portable storage.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'brown_shulker_box': {\r\n      'type': 'crafted',\r\n      'description': 'Brown shulker boxes are crafted from shulker shells and dye, and they function as portable storage.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'green_shulker_box': {\r\n      'type': 'crafted',\r\n      'description': 'Green shulker boxes are crafted from shulker shells and dye, and they function as portable storage.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'red_shulker_box': {\r\n      'type': 'crafted',\r\n      'description': 'Red shulker boxes are crafted from shulker shells and dye, and they function as portable storage.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'black_shulker_box': {\r\n      'type': 'crafted',\r\n      'description': 'Black shulker boxes are crafted from shulker shells and dye, and they function as portable storage.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'white_glazed_terracotta': {\r\n      'type': 'crafted',\r\n      'description': 'White glazed terracotta is obtained by smelting white terracotta and features decorative patterns.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'orange_glazed_terracotta': {\r\n      'type': 'crafted',\r\n      'description': 'Orange glazed terracotta is obtained by smelting orange terracotta and features decorative patterns.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'magenta_glazed_terracotta': {\r\n      'type': 'crafted',\r\n      'description': 'Magenta glazed terracotta is obtained by smelting magenta terracotta and features decorative patterns.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'light_blue_glazed_terracotta': {\r\n      'type': 'crafted',\r\n      'description': 'Light blue glazed terracotta is obtained by smelting light blue terracotta and features decorative patterns.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'yellow_glazed_terracotta': {\r\n      'type': 'crafted',\r\n      'description': 'Yellow glazed terracotta is obtained by smelting yellow terracotta and features decorative patterns.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'lime_glazed_terracotta': {\r\n      'type': 'crafted',\r\n      'description': 'Lime glazed terracotta is obtained by smelting lime terracotta and features decorative patterns.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'pink_glazed_terracotta': {\r\n      'type': 'crafted',\r\n      'description': 'Pink glazed terracotta is obtained by smelting pink terracotta and features decorative patterns.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'gray_glazed_terracotta': {\r\n      'type': 'crafted',\r\n      'description': 'Gray glazed terracotta is obtained by smelting gray terracotta and features decorative patterns.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'light_gray_glazed_terracotta': {\r\n      'type': 'crafted',\r\n      'description': 'Light gray glazed terracotta is obtained by smelting light gray terracotta and features decorative patterns.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'cyan_glazed_terracotta': {\r\n      'type': 'crafted',\r\n      'description': 'Cyan glazed terracotta is obtained by smelting cyan terracotta and features decorative patterns.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'purple_glazed_terracotta': {\r\n      'type': 'crafted',\r\n      'description': 'Purple glazed terracotta is obtained by smelting purple terracotta and features decorative patterns.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'blue_glazed_terracotta': {\r\n      'type': 'crafted',\r\n      'description': 'Blue glazed terracotta is obtained by smelting blue terracotta and features decorative patterns.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'brown_glazed_terracotta': {\r\n      'type': 'crafted',\r\n      'description': 'Brown glazed terracotta is obtained by smelting brown terracotta and features decorative patterns.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'green_glazed_terracotta': {\r\n      'type': 'crafted',\r\n      'description': 'Green glazed terracotta is obtained by smelting green terracotta and features decorative patterns.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'red_glazed_terracotta': {\r\n      'type': 'crafted',\r\n      'description': 'Red glazed terracotta is obtained by smelting red terracotta and features decorative patterns.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'black_glazed_terracotta': {\r\n      'type': 'crafted',\r\n      'description': 'Black glazed terracotta is obtained by smelting black terracotta and features decorative patterns.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'white_concrete': {\r\n      'type': 'crafted',\r\n      'description': 'White concrete is crafted from concrete powder and hardens when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'orange_concrete': {\r\n      'type': 'crafted',\r\n      'description': 'Orange concrete is crafted from concrete powder and hardens when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'magenta_concrete': {\r\n      'type': 'crafted',\r\n      'description': 'Magenta concrete is crafted from concrete powder and hardens when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'light_blue_concrete': {\r\n      'type': 'crafted',\r\n      'description': 'Light blue concrete is crafted from concrete powder and hardens when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'yellow_concrete': {\r\n      'type': 'crafted',\r\n      'description': 'Yellow concrete is crafted from concrete powder and hardens when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'lime_concrete': {\r\n      'type': 'crafted',\r\n      'description': 'Lime concrete is crafted from concrete powder and hardens when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'pink_concrete': {\r\n      'type': 'crafted',\r\n      'description': 'Pink concrete is crafted from concrete powder and hardens when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'gray_concrete': {\r\n      'type': 'crafted',\r\n      'description': 'Gray concrete is crafted from concrete powder and hardens when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'light_gray_concrete': {\r\n      'type': 'crafted',\r\n      'description': 'Light gray concrete is crafted from concrete powder and hardens when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'cyan_concrete': {\r\n      'type': 'crafted',\r\n      'description': 'Cyan concrete is crafted from concrete powder and hardens when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'purple_concrete': {\r\n      'type': 'crafted',\r\n      'description': 'Purple concrete is crafted from concrete powder and hardens when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'blue_concrete': {\r\n      'type': 'crafted',\r\n      'description': 'Blue concrete is crafted from concrete powder and hardens when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'brown_concrete': {\r\n      'type': 'crafted',\r\n      'description': 'Brown concrete is crafted from concrete powder and hardens when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'green_concrete': {\r\n      'type': 'crafted',\r\n      'description': 'Green concrete is crafted from concrete powder and hardens when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'red_concrete': {\r\n      'type': 'crafted',\r\n      'description': 'Red concrete is crafted from concrete powder and hardens when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'black_concrete': {\r\n      'type': 'crafted',\r\n      'description': 'Black concrete is crafted from concrete powder and hardens when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'white_concrete_powder': {\r\n      'type': 'crafted',\r\n      'description': 'White concrete powder is crafted from sand, gravel, and dye, and hardens into concrete when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'orange_concrete_powder': {\r\n      'type': 'crafted',\r\n      'description': 'Orange concrete powder is crafted from sand, gravel, and dye, and hardens into concrete when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'magenta_concrete_powder': {\r\n      'type': 'crafted',\r\n      'description': 'Magenta concrete powder is crafted from sand, gravel, and dye, and hardens into concrete when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'light_blue_concrete_powder': {\r\n      'type': 'crafted',\r\n      'description': 'Light blue concrete powder is crafted from sand, gravel, and dye, and hardens into concrete when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'yellow_concrete_powder': {\r\n      'type': 'crafted',\r\n      'description': 'Yellow concrete powder is crafted from sand, gravel, and dye, and hardens into concrete when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'lime_concrete_powder': {\r\n      'type': 'crafted',\r\n      'description': 'Lime concrete powder is crafted from sand, gravel, and dye, and hardens into concrete when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'pink_concrete_powder': {\r\n      'type': 'crafted',\r\n      'description': 'Pink concrete powder is crafted from sand, gravel, and dye, and hardens into concrete when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'gray_concrete_powder': {\r\n      'type': 'crafted',\r\n      'description': 'Gray concrete powder is crafted from sand, gravel, and dye, and hardens into concrete when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'light_gray_concrete_powder': {\r\n      'type': 'crafted',\r\n      'description': 'Light gray concrete powder is crafted from sand, gravel, and dye, and hardens into concrete when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'cyan_concrete_powder': {\r\n      'type': 'crafted',\r\n      'description': 'Cyan concrete powder is crafted from sand, gravel, and dye, and hardens into concrete when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'purple_concrete_powder': {\r\n      'type': 'crafted',\r\n      'description': 'Purple concrete powder is crafted from sand, gravel, and dye, and hardens into concrete when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'blue_concrete_powder': {\r\n      'type': 'crafted',\r\n      'description': 'Blue concrete powder is crafted from sand, gravel, and dye, and hardens into concrete when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'brown_concrete_powder': {\r\n      'type': 'crafted',\r\n      'description': 'Brown concrete powder is crafted from sand, gravel, and dye, and hardens into concrete when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'green_concrete_powder': {\r\n      'type': 'crafted',\r\n      'description': 'Green concrete powder is crafted from sand, gravel, and dye, and hardens into concrete when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'red_concrete_powder': {\r\n      'type': 'crafted',\r\n      'description': 'Red concrete powder is crafted from sand, gravel, and dye, and hardens into concrete when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'black_concrete_powder': {\r\n      'type': 'crafted',\r\n      'description': 'Black concrete powder is crafted from sand, gravel, and dye, and hardens into concrete when in contact with water.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'cyan_candle': {\r\n      'type': 'crafted',\r\n      'description': 'Cyan candles are crafted from string and dye and can be placed on blocks to emit light.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'pink_candle': {\r\n      'type': 'crafted',\r\n      'description': 'Pink candles are crafted from string and dye and can be placed on blocks to emit light.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'purple_candle': {\r\n      'type': 'crafted',\r\n      'description': 'Purple candles are crafted from string and dye and can be placed on blocks to emit light.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'blue_candle': {\r\n      'type': 'crafted',\r\n      'description': 'Blue candles are crafted from string and dye and can be placed on blocks to emit light.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'brown_candle': {\r\n      'type': 'crafted',\r\n      'description': 'Brown candles are crafted from string and dye and can be placed on blocks to emit light.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'green_candle': {\r\n      'type': 'crafted',\r\n      'description': 'Green candles are crafted from string and dye and can be placed on blocks to emit light.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'red_candle': {\r\n      'type': 'crafted',\r\n      'description': 'Red candles are crafted from string and dye and can be placed on blocks to emit light.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'black_candle': {\r\n      'type': 'crafted',\r\n      'description': 'Black candles are crafted from string and dye and can be placed on blocks to emit light.',\r\n      'spawn_range': 'N/A'\r\n    },\r\n    'turtle_egg': 'can be obtained via turtle breeding on beaches, where turtles lay eggs that can be collected.',\r\n    'sniffer_egg': 'can be found in buried treasure or ancient ruins, used to hatch sniffers.',\r\n    'dead_tube_coral_block': 'can be obtained by mining tube coral blocks with a pickaxe without Silk Touch or when exposed to air.',\r\n    'dead_brain_coral_block': 'can be obtained by mining brain coral blocks with a pickaxe without Silk Touch or when exposed to air.',\r\n    'dead_bubble_coral_block': 'can be obtained by mining bubble coral blocks with a pickaxe without Silk Touch or when exposed to air.',\r\n    'dead_fire_coral_block': 'can be obtained by mining fire coral blocks with a pickaxe without Silk Touch or when exposed to air.',\r\n    'dead_horn_coral_block': 'can be obtained by mining horn coral blocks with a pickaxe without Silk Touch or when exposed to air.',\r\n    'tube_coral_block': 'can be obtained by mining with a pickaxe enchanted with Silk Touch, found in warm ocean biomes.',\r\n    'brain_coral_block': 'can be obtained by mining with a pickaxe enchanted with Silk Touch, found in warm ocean biomes.',\r\n    'bubble_coral_block': 'can be obtained by mining with a pickaxe enchanted with Silk Touch, found in warm ocean biomes.',\r\n    'fire_coral_block': 'can be obtained by mining with a pickaxe enchanted with Silk Touch, found in warm ocean biomes.',\r\n    'horn_coral_block': 'can be obtained by mining with a pickaxe enchanted with Silk Touch, found in warm ocean biomes.',\r\n    'tube_coral': 'can be obtained by mining with a pickaxe enchanted with Silk Touch, found in warm ocean biomes.',\r\n    'brain_coral': 'can be obtained by mining with a pickaxe enchanted with Silk Touch, found in warm ocean biomes.',\r\n    'bubble_coral': 'can be obtained by mining with a pickaxe enchanted with Silk Touch, found in warm ocean biomes.',\r\n    'fire_coral': 'can be obtained by mining with a pickaxe enchanted with Silk Touch, found in warm ocean biomes.',\r\n    'horn_coral': 'can be obtained by mining with a pickaxe enchanted with Silk Touch, found in warm ocean biomes.',\r\n    'dead_brain_coral': 'can be obtained by mining brain coral without Silk Touch or when exposed to air.',\r\n    'dead_bubble_coral': 'can be obtained by mining bubble coral without Silk Touch or when exposed to air.',\r\n    'dead_fire_coral': 'can be obtained by mining fire coral without Silk Touch or when exposed to air.',\r\n    'dead_horn_coral': 'can be obtained by mining horn coral without Silk Touch or when exposed to air.',\r\n    'dead_tube_coral': 'can be obtained by mining tube coral without Silk Touch or when exposed to air.',\r\n    'tube_coral_fan': 'can be obtained by mining with a pickaxe enchanted with Silk Touch, found in warm ocean biomes.',\r\n    'brain_coral_fan': 'can be obtained by mining with a pickaxe enchanted with Silk Touch, found in warm ocean biomes.',\r\n    'bubble_coral_fan': 'can be obtained by mining with a pickaxe enchanted with Silk Touch, found in warm ocean biomes.',\r\n    'fire_coral_fan': 'can be obtained by mining with a pickaxe enchanted with Silk Touch, found in warm ocean biomes.',\r\n    'horn_coral_fan': 'can be obtained by mining with a pickaxe enchanted with Silk Touch, found in warm ocean biomes.',\r\n    'dead_tube_coral_fan': 'can be obtained by mining tube coral fans without Silk Touch or when exposed to air.',\r\n    'dead_brain_coral_fan': 'can be obtained by mining brain coral fans without Silk Touch or when exposed to air.',\r\n    'dead_bubble_coral_fan': 'can be obtained by mining bubble coral fans without Silk Touch or when exposed to air.',\r\n    'dead_fire_coral_fan': 'can be obtained by mining fire coral fans without Silk Touch or when exposed to air.',\r\n    'dead_horn_coral_fan': 'can be obtained by mining horn coral fans without Silk Touch or when exposed to air.',\r\n    'sculk_sensor': 'can be obtained via Silk Touch enchantment on a pickaxe or found in ancient cities in the deep dark biome.',\r\n    'copper_door': 'can be crafted using copper ingots.',\r\n    'exposed_copper_door': 'can be obtained by allowing copper doors to oxidize or can be crafted directly.',\r\n    'weathered_copper_door': 'can be obtained by allowing exposed copper doors to further oxidize or can be crafted directly.',\r\n    'oxidized_copper_door': 'can be obtained by allowing weathered copper doors to fully oxidize or can be crafted directly.',\r\n    'waxed_copper_door': 'can be crafted using copper ingots and honeycomb.',\r\n    'waxed_exposed_copper_door': 'can be crafted using exposed copper doors and honeycomb.',\r\n    'waxed_weathered_copper_door': 'can be crafted using weathered copper doors and honeycomb.',\r\n    'waxed_oxidized_copper_door': 'can be crafted using oxidized copper doors and honeycomb.',\r\n    'copper_trapdoor': 'can be crafted using copper ingots.',\r\n    'exposed_copper_trapdoor': 'can be obtained by allowing copper trapdoors to oxidize or can be crafted directly.',\r\n    'weathered_copper_trapdoor': 'can be obtained by allowing exposed copper trapdoors to further oxidize or can be crafted directly.',\r\n    'oxidized_copper_trapdoor': 'can be obtained by allowing weathered copper trapdoors to fully oxidize or can be crafted directly.',\r\n    'waxed_copper_trapdoor': 'can be crafted using copper ingots and honeycomb.',\r\n    'waxed_exposed_copper_trapdoor': 'can be crafted using exposed copper trapdoors and honeycomb.',\r\n    'waxed_weathered_copper_trapdoor': 'can be crafted using weathered copper trapdoors and honeycomb.',\r\n    'waxed_oxidized_copper_trapdoor': 'can be crafted using oxidized copper trapdoors and honeycomb.',\r\n    'saddle': 'can be obtained from fishing, dungeon chests, or trading with leatherworkers.',\r\n    'elytra': 'can be found in end ships within end cities.',\r\n    'structure_block': 'can be obtained using commands or in creative mode, used to save and load structures.',\r\n    'jigsaw': 'can be obtained using commands or in creative mode, used to generate structures.',\r\n    'scute': 'can be obtained when baby turtles grow into adults.',\r\n    'apple': 'can be obtained by breaking oak and dark oak leaves or found in chests.',\r\n    'charcoal': 'can be obtained by smelting logs or wood in a furnace.',\r\n    'quartz': 'can be obtained by mining nether quartz ore in the Nether.',\r\n    'amethyst_shard': 'can be obtained by mining amethyst clusters found in geodes with a pickaxe.',\r\n    'netherite_scrap': 'can be obtained by smelting ancient debris found in the Nether.',\r\n    'netherite_sword': 'can be crafted using a diamond sword and netherite ingot.',\r\n    'netherite_shovel': 'can be crafted using a diamond shovel and netherite ingot.',\r\n    'netherite_pickaxe': 'can be crafted using a diamond pickaxe and netherite ingot.',\r\n    'netherite_axe': 'can be crafted using a diamond axe and netherite ingot.',\r\n    'netherite_hoe': 'can be crafted using a diamond hoe and netherite ingot.',\r\n    'string': 'can be obtained from killing spiders or breaking cobwebs.',\r\n    'feather': 'can be obtained from killing chickens.',\r\n    'gunpowder': 'can be obtained from killing creepers, ghasts, and witches.',\r\n    'wheat_seeds': 'can be obtained by breaking tall grass or harvesting wheat crops.',\r\n    'chainmail_helmet': 'can be obtained from chest loot, trading with villagers, or killing mobs wearing it.',\r\n    'chainmail_chestplate': 'can be obtained from chest loot, trading with villagers, or killing mobs wearing it.',\r\n    'chainmail_leggings': 'can be obtained from chest loot, trading with villagers, or killing mobs wearing it.',\r\n    'chainmail_boots': 'can be obtained from chest loot, trading with villagers, or killing mobs wearing it.',\r\n    'netherite_helmet': 'can be crafted using a diamond helmet and netherite ingot.',\r\n    'netherite_chestplate': 'can be crafted using a diamond chestplate and netherite ingot.',\r\n    'netherite_leggings': 'can be crafted using diamond leggings and netherite ingot.',\r\n    'netherite_boots': 'can be crafted using diamond boots and netherite ingot.',\r\n    'flint': 'can be obtained by breaking gravel blocks.',\r\n    'porkchop': 'can be obtained by killing pigs.',\r\n    'cooked_porkchop': 'can be obtained by cooking porkchop in a furnace, smoker, or campfire.',\r\n    'enchanted_golden_apple': 'can be found in dungeon, bastion remnant, and mineshaft chests.',\r\n    'water_bucket': 'can be obtained by using a bucket on a water source block.',\r\n    'lava_bucket': 'can be obtained by using a bucket on a lava source block.',\r\n    'powder_snow_bucket': 'can be obtained by using a bucket on powder snow.',\r\n    'snowball': 'can be obtained by breaking snow blocks or using a shovel on snow.',\r\n    'milk_bucket': 'can be obtained by using a bucket on a cow or mooshroom.',\r\n    'pufferfish_bucket': 'can be obtained by using a bucket on a pufferfish in water.',\r\n    'salmon_bucket': 'can be obtained by using a bucket on a salmon in water.',\r\n    'cod_bucket': 'can be obtained by using a bucket on a cod in water.',\r\n    'tropical_fish_bucket': 'can be obtained by using a bucket on a tropical fish in water.',\r\n    'axolotl_bucket': 'can be obtained by using a bucket on an axolotl in water.',\r\n    'tadpole_bucket': 'can be obtained by using a bucket on a tadpole in water.',\r\n    'brick': 'can be obtained by smelting clay in a furnace.',\r\n    'clay_ball': 'can be obtained by breaking clay blocks or from chest loot.',\r\n    'egg': 'can be obtained from chickens periodically.',\r\n    'bundle': 'can be crafted using rabbit hide and string.',\r\n    'glowstone_dust': 'can be obtained by breaking glowstone blocks or killing witches.',\r\n    'cod': 'can be obtained by fishing or killing cod in water.',\r\n    'salmon': 'can be obtained by fishing or killing salmon in water.',\r\n    'tropical_fish': 'can be obtained by fishing or killing tropical fish in water.',\r\n    'pufferfish': 'can be obtained by fishing or killing pufferfish in water.',\r\n    'cooked_cod': 'can be obtained by cooking cod in a furnace, smoker, or campfire.',\r\n    'cooked_salmon': 'can be obtained by cooking salmon in a furnace, smoker, or campfire.',\r\n    'ink_sac': 'can be obtained by killing squid or as loot from wandering traders.',\r\n    'glow_ink_sac': 'can be obtained by killing glow squid.',\r\n    'cocoa_beans': 'can be obtained from cocoa pods found on jungle trees.',\r\n    'green_dye': 'can be obtained by smelting cactus in a furnace.',\r\n    'bone': 'can be obtained by killing skeletons or from chest loot.',\r\n    'crafter': 'can be obtained via crafting using specific materials (details vary by mod or version).',\r\n    'filled_map': 'can be obtained by using an empty map item.',\r\n    'melon_slice': 'can be obtained by breaking melon blocks.',\r\n    'beef': 'can be obtained by killing cows.',\r\n    'cooked_beef': 'can be obtained by cooking beef in a furnace, smoker, or campfire.',\r\n    'chicken': 'can be obtained by killing chickens.',\r\n    'cooked_chicken': 'can be obtained by cooking chicken in a furnace, smoker, or campfire.',\r\n    'rotten_flesh': 'can be obtained by killing zombies or drowned.',\r\n    'ender_pearl': 'can be obtained by killing endermen.',\r\n    'blaze_rod': 'can be obtained by killing blazes in the Nether.',\r\n    'ghast_tear': 'can be obtained by killing ghasts in the Nether.',\r\n    'nether_wart': 'can be found in Nether fortresses and bastion remnants.',\r\n    'potion': 'can be brewed using a brewing stand with various ingredients.',\r\n    'spider_eye': 'can be obtained by killing spiders or witches.',\r\n    'experience_bottle': 'can be obtained from trading with villagers or found in chest loot.',\r\n    'written_book': 'can be crafted using a book and quill after writing in it.',\r\n    'carrot': 'can be obtained by harvesting carrot crops or found in village farms.',\r\n    'potato': 'can be obtained by harvesting potato crops or found in village farms.',\r\n    'baked_potato': 'can be obtained by cooking potatoes in a furnace, smoker, or campfire.',\r\n    'poisonous_potato': 'can be obtained by harvesting potato crops (rare chance).',\r\n    'skeleton_skull': 'can be obtained by killing skeletons with a charged creeper explosion.',\r\n    'wither_skeleton_skull': 'can be obtained by killing wither skeletons (rare drop).',\r\n    'player_head': 'can be obtained via commands or by killing players in certain conditions (e.g., with a charged creeper).',\r\n    'zombie_head': 'can be obtained by killing zombies with a charged creeper explosion.',\r\n    'creeper_head': 'can be obtained by killing creepers with a charged creeper explosion.',\r\n    'dragon_head': 'can be found at the end of end ships in end cities.',\r\n    'piglin_head': 'can be obtained by killing piglins with a charged creeper explosion.',\r\n    'nether_star': 'can be obtained by defeating the Wither boss.',\r\n    'firework_star': 'can be crafted using gunpowder and dye.',\r\n    'nether_brick': 'can be obtained by smelting netherrack in a furnace or found in Nether fortresses.',\r\n    'prismarine_shard': 'can be obtained by killing guardians and elder guardians.',\r\n    'prismarine_crystals': 'can be obtained by killing guardians and elder guardians or breaking sea lanterns.',\r\n    'rabbit': 'can be obtained by killing rabbits.',\r\n    'cooked_rabbit': 'can be obtained by cooking rabbit in a furnace, smoker, or campfire.',\r\n    'rabbit_foot': 'can be obtained by killing rabbits (rare drop).',\r\n    'rabbit_hide': 'can be obtained by killing rabbits.',\r\n    'iron_horse_armor': 'can be found in dungeon, temple, and stronghold chests.',\r\n    'golden_horse_armor': 'can be found in dungeon, temple, and stronghold chests.',\r\n    'diamond_horse_armor': 'can be found in dungeon, temple, and stronghold chests.',\r\n    'name_tag': 'can be obtained by fishing, dungeon chests, or trading with librarians.',\r\n    'command_block_minecart': 'can be obtained using commands in creative mode.',\r\n    'mutton': 'can be obtained by killing sheep.',\r\n    'cooked_mutton': 'can be obtained by cooking mutton in a furnace, smoker, or campfire.',\r\n    'chorus_fruit': 'can be obtained by breaking chorus plants found in the End.',\r\n    'popped_chorus_fruit': 'can be obtained by smelting chorus fruit in a furnace.',\r\n    'torchflower_seeds': 'can be obtained from torchflower plants, used for breeding and decoration.',\r\n    'pitcher_pod': 'can be obtained from pitcher plants, used for breeding and decoration.',\r\n    'beetroot': 'can be obtained by harvesting beetroot crops or found in village farms.',\r\n    'beetroot_seeds': 'can be obtained by harvesting beetroot crops or from chests.',\r\n    'dragon_breath': 'can be obtained by using an empty bottle on the ender dragon\\'s breath attack.',\r\n    'splash_potion': 'can be brewed using a brewing stand and gunpowder with various potions.',\r\n    'tipped_arrow': 'can be crafted using arrows and lingering potions.',\r\n    'lingering_potion': 'can be brewed using a brewing stand and dragon\\'s breath with various potions.',\r\n    'totem_of_undying': 'can be obtained by killing evokers in woodland mansions and during raids.',\r\n    'shulker_shell': 'can be obtained by killing shulkers in end cities.',\r\n    'knowledge_book': 'can be obtained using commands or given in custom advancements.',\r\n    'debug_stick': 'can be obtained using commands in creative mode.',\r\n    'disc_fragment_5': 'can be found in ancient city chests, used to craft music disc 5.',\r\n    'trident': 'can be obtained by killing drowned (rare drop).',\r\n    'phantom_membrane': 'can be obtained by killing phantoms.',\r\n    'nautilus_shell': 'can be obtained from fishing, drowned, or wandering traders.',\r\n    'heart_of_the_sea': 'can be found in buried treasure chests.',\r\n    'suspicious_stew': 'can be crafted using mushrooms and various flowers or found in chests.',\r\n    'globe_banner_pattern': 'can be obtained from trading with cartographer villagers.',\r\n    'piglin_banner_pattern': 'can be obtained from bastion remnant chests.',\r\n    'goat_horn': 'can be obtained when a goat rams a solid block.',\r\n    'bell': 'can be obtained from village structures or crafted using iron ingots and wood.',\r\n    'sweet_berries': 'can be obtained from sweet berry bushes found in taiga biomes.',\r\n    'glow_berries': 'can be found in lush cave biomes or by trading with wandering traders.',\r\n    'shroomlight': 'can be obtained by breaking shroomlights found in Nether forests.',\r\n    'honeycomb': 'can be obtained by using shears on beehives or bee nests.',\r\n    'bee_nest': 'can be found in forest biomes with birch or oak trees, especially in flower forests.',\r\n    'crying_obsidian': 'can be found in ruined portals, bastion remnants, or bartered from piglins.',\r\n    'blackstone': 'can be found in basalt deltas, bastion remnants, or crafted from polished blackstone.',\r\n    'gilded_blackstone': 'can be found in bastion remnants.',\r\n    'cracked_polished_blackstone_bricks': 'can be obtained by smelting polished blackstone bricks.',\r\n    'small_amethyst_bud': 'can be found growing in amethyst geodes.',\r\n    'medium_amethyst_bud': 'can be found growing in amethyst geodes.',\r\n    'large_amethyst_bud': 'can be found growing in amethyst geodes.',\r\n    'amethyst_cluster': 'can be found growing in amethyst geodes.',\r\n    'pointed_dripstone': 'can be found in dripstone caves or created by placing a dripstone block under a water source block.',\r\n    'ochre_froglight': 'can be obtained by leading a frog to eat a magma cube, dropping this item.',\r\n    'verdant_froglight': 'can be obtained by leading a frog to eat a magma cube, dropping this item.',\r\n    'pearlescent_froglight': 'can be obtained by leading a frog to eat a magma cube, dropping this item.',\r\n    'frogspawn': 'Frogspawn is an item that can be found in the game Minecraft and is primarily used to breed frogs.',\r\n    'echo_shard': 'Echo Shard is an item in Minecraft Dungeons, primarily used as a currency for trading with Piglin vendors.',\r\n    'copper_grate': 'Copper Grate is a block in Minecraft that can be crafted from copper ingots, primarily used as a decorative block.',\r\n    'exposed_copper_grate': 'Exposed Copper Grate is a variant of Copper Grate in Minecraft that has weathered to the exposed state over time.',\r\n    'weathered_copper_grate': 'Weathered Copper Grate is a variant of Copper Grate in Minecraft that has weathered to the weathered state over time.',\r\n    'oxidized_copper_grate': 'Oxidized Copper Grate is a variant of Copper Grate in Minecraft that has weathered to the oxidized state over time.',\r\n    'waxed_copper_grate': 'Waxed Copper Grate is a variant of Copper Grate in Minecraft that has been waxed to prevent further weathering.',\r\n    'waxed_exposed_copper_grate': 'Waxed Exposed Copper Grate is a variant of Exposed Copper Grate in Minecraft that has been waxed to prevent further weathering.',\r\n    'waxed_weathered_copper_grate': 'Waxed Weathered Copper Grate is a variant of Weathered Copper Grate in Minecraft that has been waxed to prevent further weathering.',\r\n    'waxed_oxidized_copper_grate': 'Waxed Oxidized Copper Grate is a variant of Oxidized Copper Grate in Minecraft that has been waxed to prevent further weathering.',\r\n    'copper_bulb': 'Copper Bulb is a block in Minecraft that can be crafted from copper ingots, primarily used as a decorative block.',\r\n    'exposed_copper_bulb': 'Exposed Copper Bulb is a variant of Copper Bulb in Minecraft that has weathered to the exposed state over time.',\r\n    'weathered_copper_bulb': 'Weathered Copper Bulb is a variant of Copper Bulb in Minecraft that has weathered to the weathered state over time.',\r\n    'oxidized_copper_bulb': 'Oxidized Copper Bulb is a variant of Copper Bulb in Minecraft that has weathered to the oxidized state over time.',\r\n    'waxed_copper_bulb': 'Waxed Copper Bulb is a variant of Copper Bulb in Minecraft that has been waxed to prevent further weathering.',\r\n    'waxed_exposed_copper_bulb': 'Waxed Exposed Copper Bulb is a variant of Exposed Copper Bulb in Minecraft that has been waxed to prevent further weathering.',\r\n    'waxed_weathered_copper_bulb': 'Waxed Weathered Copper Bulb is a variant of Weathered Copper Bulb in Minecraft that has been waxed to prevent further weathering.',\r\n    'waxed_oxidized_copper_bulb': 'Waxed Oxidized Copper Bulb is a variant of Oxidized Copper Bulb in Minecraft that has been waxed to prevent further weathering.',\r\n    'trial_spawner': 'Trial Spawner is an item in Minecraft Dungeons, used in the Ancient Hunt game mode to summon trials for unique rewards.',\r\n    'trial_key': 'Trial Key is an item in Minecraft Dungeons, obtained from defeating Ancient mobs in the Ancient Hunt game mode, used to unlock trials.'\r\n  }\r\n}\r\n\r\nconst lowerCaseFirstLetter = (string) => string.charAt(0).toLowerCase() + string.slice(1)\r\nfor (const [name, data] of Object.entries(moreGeneratedBlocks.natural_blocks)) {\r\n  let description = '' as string | ((name: string) => string)\r\n  if (typeof data === 'object') {\r\n    const obtainedFrom = 'obtained_from' in data ? data.obtained_from : 'description' in data ? data.description : ''\r\n    description = obtainedFrom + ('rarity' in data ? ` Rarity: ${data.rarity}` : '') + ('spawn_range' in data ? ` Spawn range: ${data.spawn_range}` : '')\r\n  } else {\r\n    description = (name) => `${lowerCaseFirstLetter(name)}: ${data}`\r\n  }\r\n  descriptionGenerators.set([name], description)\r\n}\r\n\r\nexport const getItemDescription = (item: import('prismarine-item').Item) => {\r\n  const { name } = item\r\n  let result: string | ((name: string) => string) = ''\r\n  for (const [names, description] of descriptionGenerators) {\r\n    if (Array.isArray(names) && names.includes(name)) {\r\n      result = description\r\n    }\r\n    if (typeof names === 'string' && names === name) {\r\n      result = description\r\n    }\r\n    if (names instanceof RegExp && names.test(name)) {\r\n      result = description\r\n    }\r\n  }\r\n  return typeof result === 'function' ? result(item.displayName) : result\r\n}\r\n","import fs from 'fs'\r\nimport path from 'path'\r\nimport * as nbt from 'prismarine-nbt'\r\nimport { proxy } from 'valtio'\r\nimport { gzip } from 'node-gzip'\r\nimport { versionToNumber } from 'renderer/viewer/prepare/utils'\r\nimport { options } from './optionsStorage'\r\nimport { nameToMcOfflineUUID, disconnect } from './flyingSquidUtils'\r\nimport { existsViaStats, forceCachedDataPaths, forceRedirectPaths, mkdirRecursive } from './browserfs'\r\nimport { isMajorVersionGreater } from './utils'\r\n\r\nimport { activeModalStacks, insertActiveModalStack, miscUiState } from './globalState'\r\nimport supportedVersions from './supportedVersions.mjs'\r\nimport { appQueryParams } from './appParams'\r\n\r\n// todo include name of opened handle (zip)!\r\n// additional fs metadata\r\nexport const fsState = proxy({\r\n  isReadonly: false,\r\n  syncFs: false,\r\n  inMemorySave: false,\r\n  saveLoaded: false,\r\n  openReadOperations: 0,\r\n  openWriteOperations: 0,\r\n  remoteBackend: false\r\n})\r\n\r\nconst PROPOSE_BACKUP = true\r\n\r\nexport function longArrayToNumber (longArray: number[]) {\r\n  const [high, low] = longArray\r\n  return (high << 32) + low\r\n}\r\n\r\nexport const readLevelDat = async (path) => {\r\n  let levelDatContent\r\n  try {\r\n    // todo-low cache reading\r\n    levelDatContent = await fs.promises.readFile(`${path}/level.dat`)\r\n  } catch (err) {\r\n    if (err.code === 'ENOENT') {\r\n      return undefined\r\n    }\r\n    throw err\r\n  }\r\n  const { parsed } = await nbt.parse(Buffer.from(levelDatContent))\r\n  const levelDat: import('./mcTypes').LevelDat = nbt.simplify(parsed).Data\r\n  return { levelDat, dataRaw: parsed.value.Data!.value as Record<string, any> }\r\n}\r\n\r\nexport const loadSave = async (root = '/world') => {\r\n  // todo test\r\n  if (miscUiState.gameLoaded) {\r\n    await disconnect()\r\n    await new Promise(resolve => {\r\n      setTimeout(resolve)\r\n    })\r\n  }\r\n\r\n  const disablePrompts = options.disableLoadPrompts\r\n\r\n  // todo do it in singleplayer as well\r\n  // eslint-disable-next-line guard-for-in\r\n  for (const key in forceCachedDataPaths) {\r\n\r\n    delete forceCachedDataPaths[key]\r\n  }\r\n  // eslint-disable-next-line guard-for-in\r\n  for (const key in forceRedirectPaths) {\r\n\r\n    delete forceRedirectPaths[key]\r\n  }\r\n  // todo check jsHeapSizeLimit\r\n\r\n  const warnings: string[] = []\r\n  const { levelDat, dataRaw } = (await readLevelDat(root))!\r\n  if (levelDat === undefined) {\r\n    if (fsState.isReadonly) {\r\n      throw new Error('level.dat not found, ensure you are loading world folder')\r\n    } else {\r\n      warnings.push('level.dat not found, world in current folder will be created')\r\n    }\r\n  }\r\n\r\n  let version: string | undefined | null\r\n  let isFlat = false\r\n  if (levelDat) {\r\n    version = appQueryParams.mapVersion ?? levelDat.Version?.Name\r\n    if (!version) {\r\n      // const newVersion = disablePrompts ? '1.8.8' : prompt(`In 1.8 and before world save doesn't contain version info, please enter version you want to use to load the world.\\nSupported versions ${supportedVersions.join(', ')}`, '1.8.8')\r\n      // if (!newVersion) return\r\n      // todo detect world load issues\r\n      const newVersion = '1.8.8'\r\n      version = newVersion\r\n    }\r\n    const lastSupportedVersion = supportedVersions.at(-1)!\r\n    const firstSupportedVersion = supportedVersions[0]\r\n    const lowerBound = isMajorVersionGreater(firstSupportedVersion, version)\r\n    const upperBound = versionToNumber(version) > versionToNumber(lastSupportedVersion)\r\n    if (lowerBound || upperBound) {\r\n      version = prompt(`Version ${version} is not supported, supported versions are ${supportedVersions.join(', ')}, what try to use instead?`, lowerBound ? firstSupportedVersion : lastSupportedVersion)\r\n      if (!version) return\r\n    }\r\n    if (levelDat.WorldGenSettings) {\r\n      for (const [key, value] of Object.entries(levelDat.WorldGenSettings.dimensions)) {\r\n        if (key.slice(10) === 'overworld') {\r\n          if (value.generator.type === 'flat') isFlat = true\r\n          break\r\n        }\r\n      }\r\n    }\r\n\r\n    if (levelDat.generatorName) {\r\n      isFlat = levelDat.generatorName === 'flat'\r\n    }\r\n    if (!isFlat && levelDat.generatorName !== 'default' && levelDat.generatorName !== 'customized') {\r\n      // warnings.push(`Generator ${levelDat.generatorName} may not be supported yet, be careful of new chunks writes`)\r\n    }\r\n\r\n    const playerUuid = nameToMcOfflineUUID(options.localUsername)\r\n    const playerDatPath = `${root}/playerdata/${playerUuid}.dat`\r\n    const playerDataOverride = dataRaw.Player\r\n    if (playerDataOverride) {\r\n      const playerDat = await gzip(nbt.writeUncompressed({ name: '', ...playerDataOverride }))\r\n      if (fsState.isReadonly) {\r\n        forceCachedDataPaths[playerDatPath] = playerDat\r\n      } else {\r\n        await mkdirRecursive(path.dirname(playerDatPath))\r\n        await fs.promises.writeFile(playerDatPath, playerDat)\r\n      }\r\n    }\r\n  }\r\n\r\n  if (warnings.length && !disablePrompts) {\r\n    const doContinue = confirm(`Continue with following warnings?\\n${warnings.join('\\n')}`)\r\n    if (!doContinue) return\r\n  }\r\n\r\n  if (PROPOSE_BACKUP) {\r\n    // const doBackup = options.alwaysBackupWorldBeforeLoading ?? confirm('Do you want to backup your world files before loading it?')\r\n    // // const doBackup = true\r\n    // if (doBackup) {\r\n    //   // todo do it in flying squid instead\r\n    //   await fs.promises.copyFile('/world/level.dat', `/world/level.dat_old`)\r\n    //   try {\r\n    //     await fs.promises.mkdir('/backups/region.old', { recursive: true })\r\n    //   } catch (err) { }\r\n    //   const files = await fs.promises.readdir('/world/region')\r\n    //   for (const file of files) {\r\n    //     await fs.promises.copyFile(`/world/region/${file}`, `/world/region.old/${file}`)\r\n    //   }\r\n    // }\r\n  }\r\n\r\n  if (!fsState.isReadonly && !fsState.inMemorySave && !disablePrompts) {\r\n    // todo allow also to ctrl+s\r\n    alert('Note: the world is saved on interval, /save or disconnect! Ensure you have backup and be careful of new chunks writes!')\r\n  }\r\n\r\n  // improve compatibility with community saves\r\n  const rootRemapFiles = ['Warp files']\r\n  for (const rootRemapFile of rootRemapFiles) {\r\n    // eslint-disable-next-line no-await-in-loop\r\n    if (await existsViaStats(path.join(root, '..', rootRemapFile))) {\r\n      forceRedirectPaths[path.join(root, rootRemapFile)] = path.join(root, '..', rootRemapFile)\r\n    }\r\n  }\r\n\r\n  // todo reimplement\r\n  if (activeModalStacks['main-menu']) {\r\n    insertActiveModalStack('main-menu')\r\n  }\r\n  // todo use general logic\r\n  // if (activeModalStack.at(-1)?.reactType === 'app-status' && !appStatusState.isError) {\r\n  //   alert('Wait for operations to finish before loading a new world')\r\n  //   return\r\n  // }\r\n  // for (const _i of activeModalStack) {\r\n  //   hideModal(undefined, undefined, { force: true })\r\n  // }\r\n\r\n  // todo should not be set here\r\n  fsState.saveLoaded = true\r\n  window.dispatchEvent(new CustomEvent('singleplayer', {\r\n    // todo check gamemode level.dat data etc\r\n    detail: {\r\n      version,\r\n      ...isFlat ? {\r\n        generation: {\r\n          name: 'superflat'\r\n        }\r\n      } : {},\r\n      ...root === '/world' ? {} : {\r\n        'worldFolder': root\r\n      }\r\n    },\r\n  }))\r\n}\r\n","import { Duplex } from 'stream'\r\nimport Peer, { DataConnection } from 'peerjs'\r\nimport Client from 'minecraft-protocol/src/client'\r\nimport { resolveTimeout } from './utils'\r\nimport { setLoadingScreenStatus } from './appStatus'\r\nimport { miscUiState } from './globalState'\r\n\r\nclass CustomDuplex extends Duplex {\r\n  constructor (options, public writeAction) {\r\n    super(options)\r\n  }\r\n\r\n  _read () { }\r\n\r\n  _write (chunk, encoding, callback) {\r\n    this.writeAction(chunk)\r\n    callback()\r\n  }\r\n}\r\n\r\nlet peerInstance: Peer | undefined\r\n\r\nlet overridePeerJsServer = null as string | null\r\n\r\nexport const getJoinLink = () => {\r\n  if (!peerInstance) return\r\n  const url = new URL(window.location.href)\r\n  for (const key of url.searchParams.keys()) {\r\n    url.searchParams.delete(key)\r\n  }\r\n  url.searchParams.set('connectPeer', peerInstance.id)\r\n  url.searchParams.set('peerVersion', localServer!.options.version)\r\n  const host = (overridePeerJsServer ?? miscUiState.appConfig?.peerJsServer) ?? undefined\r\n  if (host) {\r\n    // TODO! use miscUiState.appConfig.peerJsServer\r\n    url.searchParams.set('server', host)\r\n  }\r\n  return url.toString()\r\n}\r\n\r\nconst copyJoinLink = async () => {\r\n  miscUiState.wanOpened = true\r\n  const joinLink = getJoinLink()!\r\n  if (navigator.clipboard) {\r\n    await navigator.clipboard.writeText(joinLink)\r\n  } else {\r\n    window.prompt('Copy to clipboard: Ctrl+C, Enter', joinLink)\r\n  }\r\n}\r\n\r\nexport const openToWanAndCopyJoinLink = async (writeText: (text) => void, doCopy = true) => {\r\n  if (!localServer) return\r\n  if (peerInstance) {\r\n    if (doCopy) await copyJoinLink()\r\n    return 'Already opened to wan. Join link copied'\r\n  }\r\n  miscUiState.wanOpening = true\r\n  const host = (overridePeerJsServer ?? miscUiState.appConfig?.peerJsServer) || undefined\r\n  const params = host ? parseUrl(host) : undefined\r\n  const peer = new Peer({\r\n    debug: 3,\r\n    ...params\r\n  })\r\n  peerInstance = peer\r\n  peer.on('connection', (connection) => {\r\n    console.log('connection')\r\n    const serverDuplex = new CustomDuplex({}, async (data) => connection.send(data))\r\n    const client = new Client(true, localServer.options.version, undefined)\r\n    client.setSocket(serverDuplex)\r\n    localServer._server.emit('connection', client)\r\n\r\n    connection.on('data', (data: any) => {\r\n      serverDuplex.push(Buffer.from(data))\r\n    })\r\n    // our side disconnect\r\n    const endConnection = () => {\r\n      console.log('connection.close')\r\n      serverDuplex.end()\r\n      connection.close()\r\n    }\r\n    serverDuplex.on('end', endConnection)\r\n    serverDuplex.on('force-close', endConnection)\r\n    client.on('end', endConnection)\r\n\r\n    const disconnected = () => {\r\n      serverDuplex.end()\r\n      client.end()\r\n    }\r\n    connection.on('iceStateChanged', (state) => {\r\n      console.log('iceStateChanged', state)\r\n      if (state === 'disconnected') {\r\n        disconnected()\r\n      }\r\n    })\r\n    connection.on('close', disconnected)\r\n    connection.on('error', disconnected)\r\n  })\r\n  const fallbackServer = miscUiState.appConfig?.peerJsServerFallback\r\n  const hasFallback = fallbackServer && peer.options.host !== fallbackServer\r\n  let hadErrorReported = false\r\n  peer.on('error', (error) => {\r\n    console.error('peerJS error', error)\r\n    if (error.type === 'server-error' && hasFallback) {\r\n      return\r\n    }\r\n    hadErrorReported = true\r\n    writeText(error.message || JSON.stringify(error))\r\n  })\r\n  let timeout\r\n  const destroy = () => {\r\n    clearTimeout(timeout)\r\n    timeout = undefined\r\n    peer.destroy()\r\n    peerInstance = undefined\r\n  }\r\n\r\n  const result = await new Promise<string>(resolve => {\r\n    peer.on('open', async () => {\r\n      await copyJoinLink()\r\n      resolve('Copied join link to clipboard')\r\n    })\r\n    timeout = setTimeout(() => {\r\n      if (!hadErrorReported && timeout !== undefined) {\r\n        writeText('timeout')\r\n      }\r\n      resolve('Failed to open to wan (timeout)')\r\n    }, 6000)\r\n\r\n    // fallback\r\n    peer.on('error', async (error) => {\r\n      if (!peer.open) {\r\n        if (hasFallback) {\r\n          destroy()\r\n\r\n          overridePeerJsServer = fallbackServer\r\n          console.log('Trying fallback server', fallbackServer)\r\n          resolve((await openToWanAndCopyJoinLink(writeText, doCopy))!)\r\n        }\r\n      }\r\n    })\r\n  })\r\n  if (!peerInstance.open) {\r\n    destroy()\r\n  }\r\n  miscUiState.wanOpening = false\r\n  return result\r\n}\r\n\r\nconst parseUrl = (url: string) => {\r\n  // peerJS does this internally for some reason: const url = new URL(`${protocol}://${host}:${port}${path}${key}/${method}`)\r\n  if (!url.startsWith('http')) url = `${location.protocol}//${url}`\r\n  const urlObj = new URL(url)\r\n  const key = urlObj.searchParams.get('key')\r\n  return {\r\n    host: urlObj.hostname,\r\n    path: urlObj.pathname,\r\n    protocol: urlObj.protocol.slice(0, -1),\r\n    ...urlObj.port ? { port: +urlObj.port } : {},\r\n    ...key ? { key } : {},\r\n  }\r\n}\r\n\r\nexport const closeWan = () => {\r\n  peerInstance?.destroy()\r\n  peerInstance = undefined\r\n  miscUiState.wanOpened = false\r\n  return 'Closed WAN'\r\n}\r\n\r\nexport type ConnectPeerOptions = {\r\n  server?: string\r\n}\r\n\r\nexport const connectToPeer = async (peerId: string, options: ConnectPeerOptions = {}) => {\r\n  setLoadingScreenStatus('Connecting to peer server')\r\n  // todo destroy connection on error\r\n  // TODO! use miscUiState.appConfig.peerJsServer\r\n  const host = options.server\r\n  const params = host ? parseUrl(host) : undefined\r\n  const peer = new Peer({\r\n    debug: 3,\r\n    ...params\r\n  })\r\n  await resolveTimeout(new Promise(resolve => {\r\n    peer.once('open', resolve)\r\n  }))\r\n  setLoadingScreenStatus('Connecting to the peer')\r\n  const connection = peer.connect(peerId, {\r\n    serialization: 'raw',\r\n  })\r\n  await resolveTimeout(new Promise<void>((resolve, reject) => {\r\n    connection.once('error', (error) => {\r\n      console.log(error.type, error.name)\r\n      console.log(error)\r\n      reject(error.message)\r\n    })\r\n    connection.once('open', resolve)\r\n  }))\r\n\r\n  const clientDuplex = new CustomDuplex({}, (data) => {\r\n    // todo debug until play state\r\n    // console.debug('sending', data.toString())\r\n    connection.send(data)\r\n  })\r\n  connection.on('data', (data: any) => {\r\n    console.debug('received', Buffer.from(data).toString())\r\n    clientDuplex.push(Buffer.from(data))\r\n  })\r\n  connection.on('close', () => {\r\n    console.log('connection closed')\r\n    clientDuplex.end()\r\n    // bot._client.end()\r\n    // bot.end()\r\n    bot.emit('end', 'Disconnected.')\r\n  })\r\n  connection.on('error', (error) => {\r\n    console.error(error)\r\n    clientDuplex.end()\r\n  })\r\n\r\n  return clientDuplex\r\n}\r\n","import { remark } from 'remark'\r\n\r\nexport default (markdown: string) => {\r\n  const arr = markdown.split('\\n\\n')\r\n  const lines = ['', '', '', '']\r\n  for (const [i, ast] of arr.map(md => remark().parse(md)).entries()) {\r\n    lines[i] = transformToMinecraftJSON(ast as Element)\r\n  }\r\n  return lines\r\n}\r\n\r\nfunction transformToMinecraftJSON (element: Element): any {\r\n  switch (element.type) {\r\n    case 'root': {\r\n      if (!element.children) return\r\n      return element.children.map(child => transformToMinecraftJSON(child)).filter(Boolean)\r\n    }\r\n    case 'paragraph': {\r\n      if (!element.children) return\r\n      const transformedChildren = element.children.map(child => transformToMinecraftJSON(child)).filter(Boolean)\r\n      return transformedChildren.flat()\r\n    }\r\n    case 'strong': {\r\n      if (!element.children) return\r\n      return [{ bold: true, text: element.children[0].value }]\r\n    }\r\n    case 'text': {\r\n      return { text: element.value }\r\n    }\r\n    case 'emphasis': {\r\n      if (!element.children) return\r\n      return [{ italic: true, text: element.children[0].value }]\r\n    }\r\n    default:\r\n      // todo leave untouched eg links\r\n      return element.value\r\n  }\r\n}\r\n\r\ninterface Position {\r\n  start: {\r\n    line: number;\r\n    column: number;\r\n    offset: number;\r\n  };\r\n  end: {\r\n    line: number;\r\n    column: number;\r\n    offset: number;\r\n  };\r\n}\r\n\r\ninterface Element {\r\n  type: string;\r\n  children?: Element[];\r\n  value?: string;\r\n  position: Position;\r\n}\r\n","export const getProxyDetails = async (proxyBaseUrl: string) => {\r\n  if (!proxyBaseUrl.startsWith('http')) proxyBaseUrl = `${isPageSecure() ? 'https' : 'http'}://${proxyBaseUrl}`\r\n  const url = `${proxyBaseUrl}/api/vm/net/connect`\r\n  let result: Response\r\n  try {\r\n    result = await fetch(url)\r\n  } catch (err) {\r\n    throw new Error(`Selected proxy server ${proxyBaseUrl} most likely is down`)\r\n  }\r\n  return result\r\n}\r\n\r\nexport default async ({ tokenCaches, proxyBaseUrl, setProgressText = (text) => { }, setCacheResult, connectingServer }) => {\r\n  let onMsaCodeCallback\r\n  let connectingVersion = ''\r\n  // const authEndpoint = 'http://localhost:3000/'\r\n  // const sessionEndpoint = 'http://localhost:3000/session'\r\n  let authEndpoint: URL | undefined\r\n  let sessionEndpoint: URL | undefined\r\n  const result = await getProxyDetails(proxyBaseUrl)\r\n\r\n  try {\r\n    const json = await result.json()\r\n    authEndpoint = urlWithBase(json.capabilities.authEndpoint, proxyBaseUrl)\r\n    sessionEndpoint = urlWithBase(json.capabilities.sessionEndpoint, proxyBaseUrl)\r\n    if (!authEndpoint) throw new Error('No auth endpoint')\r\n  } catch (err) {\r\n    console.error(err)\r\n    throw new Error(`Selected proxy server ${proxyBaseUrl} does not support Microsoft authentication`)\r\n  }\r\n  const authFlow = {\r\n    async getMinecraftJavaToken () {\r\n      setProgressText('Authenticating with Microsoft account')\r\n      if (!window.crypto && !isPageSecure()) throw new Error('Crypto API is available only in secure contexts. Be sure to use https!')\r\n      let result = null\r\n      await fetch(authEndpoint, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          ...tokenCaches,\r\n          // important to set this param and not fake it as auth server might reject the request otherwise\r\n          connectingServer,\r\n          connectingServerVersion: connectingVersion\r\n        }),\r\n      })\r\n        .catch(e => {\r\n          throw new Error(`Failed to connect to auth server (network error): ${e.message}`)\r\n        })\r\n        .then(async response => {\r\n          if (!response.ok) {\r\n            throw new Error(`Auth server error (${response.status}): ${await response.text()}`)\r\n          }\r\n\r\n          const reader = response.body!.getReader()\r\n          const decoder = new TextDecoder('utf8')\r\n\r\n          const processText = ({ done, value = undefined as Uint8Array | undefined }) => {\r\n            if (done) {\r\n              return\r\n            }\r\n\r\n            const processChunk = (chunkStr) => {\r\n              let json: any\r\n              try {\r\n                json = JSON.parse(chunkStr)\r\n              } catch (err) {}\r\n              if (!json) return\r\n              if (json.user_code) {\r\n                onMsaCodeCallback(json)\r\n                // this.codeCallback(json)\r\n              }\r\n              if (json.error) throw new Error(json.error)\r\n              if (json.token) result = json\r\n              if (json.newCache) setCacheResult(json.newCache)\r\n            }\r\n\r\n            const strings = decoder.decode(value)\r\n\r\n            for (const chunk of strings.split('\\n\\n')) {\r\n              processChunk(chunk)\r\n            }\r\n\r\n            return reader.read().then(processText)\r\n          }\r\n          return reader.read().then(processText)\r\n        })\r\n      const restoredData = await restoreData(result)\r\n      if (restoredData?.certificates?.profileKeys?.privatePEM) {\r\n        restoredData.certificates.profileKeys.private = restoredData.certificates.profileKeys.privatePEM\r\n      }\r\n      return restoredData\r\n    }\r\n  }\r\n  return {\r\n    authFlow,\r\n    sessionEndpoint,\r\n    setOnMsaCodeCallback (callback) {\r\n      onMsaCodeCallback = callback\r\n    },\r\n    setConnectingVersion (version) {\r\n      connectingVersion = version\r\n    }\r\n  }\r\n}\r\n\r\nfunction isPageSecure (url = window.location.href) {\r\n  return !url.startsWith('http:')\r\n}\r\n\r\n// restore dates from strings\r\nconst restoreData = async (json) => {\r\n  const promises = [] as Array<Promise<void>>\r\n  if (typeof json === 'object' && json) {\r\n    for (const [key, value] of Object.entries(json)) {\r\n      if (typeof value === 'string') {\r\n        promises.push(tryRestorePublicKey(value, key, json))\r\n        if (value.endsWith('Z')) {\r\n          const date = new Date(value)\r\n          if (!isNaN(date.getTime())) {\r\n            json[key] = date\r\n          }\r\n        }\r\n      }\r\n      if (typeof value === 'object') {\r\n        // eslint-disable-next-line no-await-in-loop\r\n        await restoreData(value)\r\n      }\r\n    }\r\n  }\r\n\r\n  await Promise.all(promises)\r\n\r\n  return json\r\n}\r\n\r\nconst tryRestorePublicKey = async (value: string, name: string, parent: { [x: string]: any }) => {\r\n  value = value.trim()\r\n  if (!name.endsWith('PEM') || !value.startsWith('-----BEGIN RSA PUBLIC KEY-----') || !value.endsWith('-----END RSA PUBLIC KEY-----')) return\r\n  const der = pemToArrayBuffer(value)\r\n  const key = await window.crypto.subtle.importKey(\r\n    'spki', // Specify that the data is in SPKI format\r\n    der,\r\n    {\r\n      name: 'RSA-OAEP',\r\n      hash: { name: 'SHA-256' }\r\n    },\r\n    true,\r\n    ['encrypt'] // Specify key usages\r\n  )\r\n  const originalName = name.replace('PEM', '')\r\n  const exported = await window.crypto.subtle.exportKey('spki', key)\r\n  const exportedBuffer = new Uint8Array(exported)\r\n  parent[originalName] = {\r\n    export () {\r\n      return exportedBuffer\r\n    }\r\n  }\r\n}\r\n\r\nfunction pemToArrayBuffer (pem) {\r\n  // Fetch the part of the PEM string between header and footer\r\n  const pemHeader = '-----BEGIN RSA PUBLIC KEY-----'\r\n  const pemFooter = '-----END RSA PUBLIC KEY-----'\r\n  const pemContents = pem.slice(pemHeader.length, pem.length - pemFooter.length).trim()\r\n  const binaryDerString = atob(pemContents.replaceAll(/\\s/g, ''))\r\n  const binaryDer = new Uint8Array(binaryDerString.length)\r\n  for (let i = 0; i < binaryDerString.length; i++) {\r\n    binaryDer[i] = binaryDerString.codePointAt(i)!\r\n  }\r\n  return binaryDer.buffer\r\n}\r\n\r\nconst urlWithBase = (url: string, base: string) => {\r\n  const defaultBase = isPageSecure() ? 'https' : 'http'\r\n  if (!base.startsWith('http')) base = `${defaultBase}://${base}`\r\n  const urlObj = new URL(url, base)\r\n  base = base.replace(/^https?:\\/\\//, '')\r\n  urlObj.host = base.includes(':') ? base : `${base}:${isPageSecure(base) ? '443' : '80'}`\r\n  return urlObj\r\n}\r\n","import * as THREE from 'three'\r\n\r\nclass CameraShake {\r\n  private rollAngle = 0\r\n  private get damageRollAmount () { return 5 }\r\n  private get damageAnimDuration () { return 200 }\r\n  private rollAnimation?: { startTime: number, startRoll: number, targetRoll: number, duration: number, returnToZero?: boolean }\r\n\r\n  constructor () {\r\n    this.rollAngle = 0\r\n  }\r\n\r\n  shakeFromDamage (yaw?: number) {\r\n    // Add roll animation\r\n    const startRoll = this.rollAngle\r\n    const targetRoll = startRoll + (yaw ?? (Math.random() < 0.5 ? -1 : 1)) * this.damageRollAmount\r\n\r\n    this.rollAnimation = {\r\n      startTime: performance.now(),\r\n      startRoll,\r\n      targetRoll,\r\n      duration: this.damageAnimDuration / 2\r\n    }\r\n  }\r\n\r\n  update () {\r\n    // Update roll animation\r\n    if (this.rollAnimation) {\r\n      const now = performance.now()\r\n      const elapsed = now - this.rollAnimation.startTime\r\n      const progress = Math.min(elapsed / this.rollAnimation.duration, 1)\r\n\r\n      if (this.rollAnimation.returnToZero) {\r\n        // Ease back to zero\r\n        this.rollAngle = this.rollAnimation.startRoll * (1 - this.easeInOut(progress))\r\n        if (progress === 1) {\r\n          this.rollAnimation = undefined\r\n        }\r\n      } else {\r\n        // Initial roll\r\n        this.rollAngle = this.rollAnimation.startRoll + (this.rollAnimation.targetRoll - this.rollAnimation.startRoll) * this.easeOut(progress)\r\n        if (progress === 1) {\r\n          // Start return to zero animation\r\n          this.rollAnimation = {\r\n            startTime: now,\r\n            startRoll: this.rollAngle,\r\n            targetRoll: 0,\r\n            duration: this.damageAnimDuration / 2,\r\n            returnToZero: true\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // Apply roll in camera's local space to maintain consistent left/right roll\r\n    const { camera } = viewer\r\n    const rollQuat = new THREE.Quaternion()\r\n    rollQuat.setFromAxisAngle(new THREE.Vector3(0, 0, 1), THREE.MathUtils.degToRad(this.rollAngle))\r\n\r\n    // Get camera's current rotation\r\n    const camQuat = new THREE.Quaternion()\r\n    camera.getWorldQuaternion(camQuat)\r\n\r\n    // Apply roll after camera rotation\r\n    const finalQuat = camQuat.multiply(rollQuat)\r\n    camera.setRotationFromQuaternion(finalQuat)\r\n  }\r\n\r\n  private easeOut (t: number): number {\r\n    return 1 - (1 - t) * (1 - t)\r\n  }\r\n\r\n  private easeInOut (t: number): number {\r\n    return t < 0.5 ? 2 * t * t : 1 - (-2 * t + 2) ** 2 / 2\r\n  }\r\n}\r\n\r\nlet cameraShake: CameraShake\r\n\r\ncustomEvents.on('mineflayerBotCreated', () => {\r\n  if (!cameraShake) {\r\n    cameraShake = new CameraShake()\r\n    beforeRenderFrame.push(() => {\r\n      cameraShake.update()\r\n    })\r\n  }\r\n\r\n  customEvents.on('hurtAnimation', (yaw) => {\r\n    cameraShake.shakeFromDamage(yaw)\r\n  })\r\n\r\n  bot._client.on('hurt_animation', ({ entityId, yaw }) => {\r\n    if (entityId === bot.entity.id) {\r\n      customEvents.emit('hurtAnimation', yaw)\r\n    }\r\n  })\r\n  bot.on('entityHurt', ({ id }) => {\r\n    if (id === bot.entity.id) {\r\n      customEvents.emit('hurtAnimation')\r\n    }\r\n  })\r\n  let { health } = bot\r\n  bot.on('health', () => {\r\n    if (bot.health < health) {\r\n      customEvents.emit('hurtAnimation')\r\n    }\r\n    health = bot.health\r\n  })\r\n})\r\n","import mojangson from 'mojangson'\r\nimport nbt from 'prismarine-nbt'\r\nimport { fromFormattedString } from '@xmcl/text-component'\r\nimport { MessageFormatPart } from '../chatUtils'\r\n\r\ntype RenderSlotComponent = {\r\n  type: string,\r\n  data: any\r\n  // example\r\n  // {\r\n  //   \"type\": \"item_model\",\r\n  //   \"data\": \"aa:ss\"\r\n  // }\r\n}\r\nexport type RenderItem = Pick<import('prismarine-item').Item, 'name' | 'displayName' | 'durabilityUsed' | 'maxDurability' | 'enchants' | 'nbt'> & {\r\n  components?: RenderSlotComponent[],\r\n  // componentMap?: Map<string, RenderSlotComponent>\r\n}\r\nexport type GeneralInputItem = Pick<import('prismarine-item').Item, 'name' | 'nbt'> & {\r\n  components?: RenderSlotComponent[],\r\n  displayName?: string\r\n  modelResolved?: boolean\r\n}\r\n\r\ntype JsonString = string\r\ntype PossibleItemProps = {\r\n  Damage?: number\r\n  display?: { Name?: JsonString } // {\"text\":\"Knife\",\"color\":\"white\",\"italic\":\"true\"}\r\n}\r\n\r\nexport const getItemMetadata = (item: GeneralInputItem) => {\r\n  let customText = undefined as string | any | undefined\r\n  let customModel = undefined as string | undefined\r\n  if (item.components) {\r\n    const componentMap = new Map<string, RenderSlotComponent>()\r\n    for (const component of item.components) {\r\n      componentMap.set(component.type, component)\r\n    }\r\n\r\n    const customTextComponent = componentMap.get('custom_name') || componentMap.get('item_name')\r\n    if (customTextComponent) {\r\n      customText = typeof customTextComponent.data === 'string' ? customTextComponent.data : nbt.simplify(customTextComponent.data)\r\n    }\r\n    const customModelComponent = componentMap.get('item_model')\r\n    if (customModelComponent) {\r\n      customModel = customModelComponent.data\r\n    }\r\n    const loreComponent = componentMap.get('lore')\r\n    if (loreComponent) {\r\n      customText ??= item.displayName ?? item.name\r\n      // todo test\r\n      customText += `\\n${JSON.stringify(loreComponent.data)}`\r\n    }\r\n  }\r\n  if (item.nbt) {\r\n    const itemNbt: PossibleItemProps = nbt.simplify(item.nbt)\r\n    const customName = itemNbt.display?.Name\r\n    if (customName) {\r\n      customText = customName\r\n    }\r\n  }\r\n\r\n  return {\r\n    customText,\r\n    customModel\r\n  }\r\n}\r\n\r\n\r\nexport const getItemNameRaw = (item: Pick<import('prismarine-item').Item, 'nbt'> | null) => {\r\n  const { customText } = getItemMetadata(item as any)\r\n  if (!customText) return\r\n  try {\r\n    if (typeof customText === 'object') {\r\n      return customText\r\n    }\r\n    const parsed = customText.startsWith('{') && customText.endsWith('}') ? mojangson.simplify(mojangson.parse(customText)) : fromFormattedString(customText)\r\n    if (parsed.extra) {\r\n      return parsed as Record<string, any>\r\n    } else {\r\n      return parsed as MessageFormatPart\r\n    }\r\n  } catch (err) {\r\n    return {\r\n      text: JSON.stringify(customText)\r\n    }\r\n  }\r\n}\r\n","import { versionToNumber } from 'flying-squid/dist/utils'\r\n\r\nconst customStickNbt = (tags: Record<string, any>) => {\r\n  let cmd = '/give @p stick'\r\n  const wrapIntoQuotes = versionToNumber(bot.version) < versionToNumber('1.21.5')\r\n  cmd += `[${Object.entries(tags).map(([key, value]) => {\r\n    if (typeof value === 'object') {\r\n      value = JSON.stringify(value)\r\n    }\r\n    return `${key}=${wrapIntoQuotes ? `'${value}'` : value}`\r\n  }).join(',')}]`\r\n  return cmd\r\n}\r\n\r\nconst writeCmd = (cmd: string) => {\r\n  if (!cmd.startsWith('/')) cmd = `/${cmd}`\r\n  console.log('Executing', cmd)\r\n  bot.chat(cmd)\r\n}\r\n\r\nlet msg = 0\r\nconst LIMIT_MSG = 100\r\nexport const javaServerTester = {\r\n  itemCustomLore () {\r\n    const cmd = customStickNbt({\r\n      lore: [{ text: 'This Stick is very sticky.' }]\r\n    })\r\n    writeCmd(cmd)\r\n  },\r\n\r\n  itemCustomModel () {\r\n    const cmd = customStickNbt({\r\n      item_model: 'minecraft:diamond'\r\n    })\r\n    writeCmd(cmd)\r\n  },\r\n  itemCustomModel2 () {\r\n    const cmd = customStickNbt({\r\n      item_model: 'diamond'\r\n    })\r\n    writeCmd(cmd)\r\n  },\r\n\r\n  itemCustomName () {\r\n    const cmd = customStickNbt({\r\n      custom_name: [{ text: 'diamond' }]\r\n    })\r\n    writeCmd(cmd)\r\n  },\r\n  itemCustomName2 () {\r\n    const cmd = customStickNbt({\r\n      custom_name: [{ translate: 'item.diamond.name' }]\r\n    })\r\n    writeCmd(cmd)\r\n  },\r\n\r\n  spamChat () {\r\n    for (let i = msg; i < msg + LIMIT_MSG; i++) {\r\n      bot.chat('Hello, world, ' + i)\r\n    }\r\n    msg += LIMIT_MSG\r\n  },\r\n  spamChatComplexMessage () {\r\n    for (let i = msg; i < msg + LIMIT_MSG; i++) {\r\n      bot.chat('/tell @a ' + i)\r\n    }\r\n  }\r\n}\r\n","import { javaServerTester } from './commands'\r\n\r\nwindow.javaServerTester = javaServerTester\r\ncustomEvents.on('mineflayerBotCreated', () => {\r\n  //\r\n})\r\n","import { mapDownloader } from 'mineflayer-item-map-downloader'\r\nimport { setImageConverter } from 'mineflayer-item-map-downloader/lib/util'\r\n\r\nsetImageConverter((buf: Uint8Array) => {\r\n  const canvas = document.createElement('canvas')\r\n  const ctx = canvas.getContext('2d')!\r\n  canvas.width = 128\r\n  canvas.height = 128\r\n  const imageData = ctx.createImageData(canvas.width, canvas.height)\r\n  imageData.data.set(buf)\r\n  ctx.putImageData(imageData, 0, 0)\r\n  // data url\r\n  return canvas.toDataURL('image/png')\r\n})\r\n\r\ncustomEvents.on('mineflayerBotCreated', () => {\r\n  bot.on('login', () => {\r\n    bot.loadPlugin(mapDownloader)\r\n    bot.mapDownloader.on('new_map', ({ png, id }) => {\r\n      viewer.entities.updateMap(id, png)\r\n    })\r\n  })\r\n})\r\n","import { Client } from 'minecraft-protocol'\r\nimport { appQueryParams } from '../appParams'\r\nimport { downloadAllMinecraftData, getVersionAutoSelect } from '../connect'\r\nimport { gameAdditionalState } from '../globalState'\r\nimport { pingServerVersion, validatePacket } from './minecraft-protocol-extra'\r\nimport { getWebsocketStream } from './websocket-core'\r\n\r\nlet lastPacketTime = 0\r\ncustomEvents.on('mineflayerBotCreated', () => {\r\n  // todo move more code here\r\n  if (!appQueryParams.noPacketsValidation) {\r\n    (bot._client as unknown as Client).on('packet', (data, packetMeta, buffer, fullBuffer) => {\r\n      validatePacket(packetMeta.name, data, fullBuffer, true)\r\n      lastPacketTime = performance.now()\r\n    });\r\n    (bot._client as unknown as Client).on('writePacket', (name, params) => {\r\n      validatePacket(name, params, Buffer.alloc(0), false)\r\n    })\r\n  }\r\n})\r\n\r\nsetInterval(() => {\r\n  if (!bot || !lastPacketTime) return\r\n  if (bot.player?.ping > 500) { // TODO: we cant rely on server ping 1. weird calculations 2. available with delays instead patch minecraft-protocol to get latency of keep_alive packet\r\n    gameAdditionalState.poorConnection = true\r\n  } else {\r\n    gameAdditionalState.poorConnection = false\r\n  }\r\n  if (performance.now() - lastPacketTime < 2000) {\r\n    gameAdditionalState.noConnection = false\r\n    return\r\n  }\r\n  gameAdditionalState.noConnection = true\r\n}, 1000)\r\n\r\n\r\nexport const getServerInfo = async (ip: string, port?: number, preferredVersion = getVersionAutoSelect(), ping = false) => {\r\n  await downloadAllMinecraftData()\r\n  const isWebSocket = ip.startsWith('ws://') || ip.startsWith('wss://')\r\n  let stream\r\n  if (isWebSocket) {\r\n    stream = (await getWebsocketStream(ip)).mineflayerStream\r\n  }\r\n  return pingServerVersion(ip, port, {\r\n    ...(stream ? { stream } : {}),\r\n    ...(ping ? { noPongTimeout: 3000 } : {}),\r\n    ...(preferredVersion ? { version: preferredVersion } : {}),\r\n  })\r\n}\r\n","import EventEmitter from 'events'\r\nimport clientAutoVersion from 'minecraft-protocol/src/client/autoVersion'\r\n\r\nexport const pingServerVersion = async (ip: string, port?: number, mergeOptions: Record<string, any> = {}) => {\r\n  const fakeClient = new EventEmitter() as any\r\n  fakeClient.on('error', (err) => {\r\n    throw new Error(err.message ?? err)\r\n  })\r\n  const options = {\r\n    host: ip,\r\n    port,\r\n    noPongTimeout: Infinity, // disable timeout\r\n    ...mergeOptions,\r\n  }\r\n  let latency = 0\r\n  let fullInfo: any = null\r\n  fakeClient.autoVersionHooks = [(res) => {\r\n    latency = res.latency\r\n    fullInfo = res\r\n  }]\r\n\r\n  // TODO! use client.socket.destroy() instead of client.end() for faster cleanup\r\n  await clientAutoVersion(fakeClient, options)\r\n\r\n  await new Promise<void>((resolve, reject) => {\r\n    fakeClient.once('connect_allowed', resolve)\r\n  })\r\n  return {\r\n    version: fakeClient.version,\r\n    latency,\r\n    fullInfo,\r\n  }\r\n}\r\n\r\nconst MAX_PACKET_SIZE = 2_097_152 // 2mb\r\nconst CHAT_MAX_PACKET_DEPTH = 200 // todo improve perf\r\n\r\nconst CHAT_VALIDATE_PACKETS = new Set([\r\n  'chat',\r\n  'system_chat',\r\n  'player_chat',\r\n  'profileless_chat',\r\n  'kick_disconnect',\r\n  'resource_pack_send',\r\n  'action_bar',\r\n  'set_title_text',\r\n  'set_title_subtitle',\r\n  'title',\r\n  'death_combat_event',\r\n  'server_data',\r\n  'scoreboard_objective',\r\n  'scoreboard_team',\r\n  'playerlist_header',\r\n  'boss_bar'\r\n])\r\n\r\nexport const validatePacket = (name: string, data: any, fullBuffer: Buffer, isFromServer: boolean) => {\r\n  // todo find out why chat is so slow with react\r\n  if (!isFromServer) return\r\n\r\n  if (fullBuffer.length > MAX_PACKET_SIZE) {\r\n    console.groupCollapsed(`Packet ${name} is too large: ${fullBuffer.length} bytes`)\r\n    console.log(data)\r\n    console.groupEnd()\r\n    throw new Error(`Packet ${name} is too large: ${fullBuffer.length} bytes`)\r\n  }\r\n\r\n  if (CHAT_VALIDATE_PACKETS.has(name)) {\r\n    // todo count total number of objects instead of max depth\r\n    const maxDepth = getObjectMaxDepth(data)\r\n    if (maxDepth > CHAT_MAX_PACKET_DEPTH) {\r\n      console.groupCollapsed(`Packet ${name} have too many nested objects: ${maxDepth}`)\r\n      console.log(data)\r\n      console.groupEnd()\r\n      throw new Error(`Packet ${name} have too many nested objects: ${maxDepth}`)\r\n    }\r\n  }\r\n}\r\n\r\nfunction getObjectMaxDepth (obj: unknown, currentDepth = 0): number {\r\n  // Base case: null or primitive types have depth 0\r\n  if (obj === null || typeof obj !== 'object' || obj instanceof Buffer) {\r\n    return currentDepth\r\n  }\r\n\r\n  // Handle arrays and objects\r\n  let maxDepth = currentDepth\r\n\r\n  if (Array.isArray(obj)) {\r\n    // For arrays, check each element\r\n    for (const item of obj) {\r\n      const depth = getObjectMaxDepth(item, currentDepth + 1)\r\n      maxDepth = Math.max(maxDepth, depth)\r\n    }\r\n  } else {\r\n    // For objects, check each value\r\n    // eslint-disable-next-line guard-for-in\r\n    for (const key in obj) {\r\n      const depth = getObjectMaxDepth(obj[key], currentDepth + 1)\r\n      maxDepth = Math.max(maxDepth, depth)\r\n    }\r\n  }\r\n\r\n  return maxDepth\r\n}\r\n","import { EventEmitter } from 'events'\r\nimport { Vec3 } from 'vec3'\r\nimport { IPlayerState, ItemSpecificContextProperties, MovementState, PlayerStateEvents } from 'renderer/viewer/lib/basePlayerState'\r\nimport { HandItemBlock } from 'renderer/viewer/lib/holdingBlock'\r\nimport TypedEmitter from 'typed-emitter'\r\nimport { ItemSelector } from 'mc-assets/dist/itemDefinitions'\r\nimport { proxy } from 'valtio'\r\nimport { gameAdditionalState } from '../globalState'\r\n\r\nexport class PlayerStateManager implements IPlayerState {\r\n  disableStateUpdates = false\r\n  private static instance: PlayerStateManager\r\n  readonly events = new EventEmitter() as TypedEmitter<PlayerStateEvents>\r\n\r\n  // Movement and physics state\r\n  private lastVelocity = new Vec3(0, 0, 0)\r\n  private movementState: MovementState = 'NOT_MOVING'\r\n  private timeOffGround = 0\r\n  private lastUpdateTime = performance.now()\r\n\r\n  // Held item state\r\n  private heldItem?: HandItemBlock\r\n  private offHandItem?: HandItemBlock\r\n  private itemUsageTicks = 0\r\n  private isUsingItem = false\r\n  private ready = false\r\n  onlineMode = false\r\n  get username () {\r\n    return bot.player?.username ?? ''\r\n  }\r\n\r\n  reactive = proxy({\r\n    playerSkin: undefined as string | undefined,\r\n  })\r\n\r\n  static getInstance (): PlayerStateManager {\r\n    if (!this.instance) {\r\n      this.instance = new PlayerStateManager()\r\n    }\r\n    return this.instance\r\n  }\r\n\r\n  private constructor () {\r\n    this.updateState = this.updateState.bind(this)\r\n    customEvents.on('mineflayerBotCreated', () => {\r\n      this.ready = false\r\n      bot.on('inject_allowed', () => {\r\n        if (this.ready) return\r\n        this.ready = true\r\n        this.botCreated()\r\n      })\r\n    })\r\n  }\r\n\r\n  private botCreated () {\r\n    // Movement tracking\r\n    bot.on('move', this.updateState)\r\n\r\n    // Item tracking\r\n    bot.on('heldItemChanged', () => {\r\n      return this.updateHeldItem(false)\r\n    })\r\n    bot.inventory.on('updateSlot', (index) => {\r\n      if (index === 45) this.updateHeldItem(true)\r\n    })\r\n    bot.on('physicsTick', () => {\r\n      if (this.isUsingItem) this.itemUsageTicks++\r\n    })\r\n\r\n    // Initial held items setup\r\n    this.updateHeldItem(false)\r\n    this.updateHeldItem(true)\r\n  }\r\n\r\n  // #region Movement and Physics State\r\n  private updateState () {\r\n    if (!bot.player?.entity || this.disableStateUpdates) return\r\n\r\n    const { velocity } = bot.player.entity\r\n    const isOnGround = bot.entity.onGround\r\n    const VELOCITY_THRESHOLD = 0.01\r\n    const SPRINTING_VELOCITY = 0.15\r\n    const OFF_GROUND_THRESHOLD = 0 // ms before switching to SNEAKING when off ground\r\n\r\n    const now = performance.now()\r\n    const deltaTime = now - this.lastUpdateTime\r\n    this.lastUpdateTime = now\r\n\r\n    this.lastVelocity = velocity\r\n\r\n    // Update time off ground\r\n    if (isOnGround) {\r\n      this.timeOffGround = 0\r\n    } else {\r\n      this.timeOffGround += deltaTime\r\n    }\r\n\r\n    if (this.isSneaking() || this.isFlying() || (this.timeOffGround > OFF_GROUND_THRESHOLD)) {\r\n      this.movementState = 'SNEAKING'\r\n    } else if (Math.abs(velocity.x) > VELOCITY_THRESHOLD || Math.abs(velocity.z) > VELOCITY_THRESHOLD) {\r\n      this.movementState = Math.abs(velocity.x) > SPRINTING_VELOCITY || Math.abs(velocity.z) > SPRINTING_VELOCITY\r\n        ? 'SPRINTING'\r\n        : 'WALKING'\r\n    } else {\r\n      this.movementState = 'NOT_MOVING'\r\n    }\r\n  }\r\n\r\n  getMovementState (): MovementState {\r\n    return this.movementState\r\n  }\r\n\r\n  getVelocity (): Vec3 {\r\n    return this.lastVelocity\r\n  }\r\n\r\n  getEyeHeight (): number {\r\n    return bot.controlState.sneak ? 1.27 : 1.62\r\n  }\r\n\r\n  isOnGround (): boolean {\r\n    return bot?.entity?.onGround ?? true\r\n  }\r\n\r\n  isSneaking (): boolean {\r\n    return gameAdditionalState.isSneaking\r\n  }\r\n\r\n  isFlying (): boolean {\r\n    return gameAdditionalState.isFlying\r\n  }\r\n\r\n  isSprinting (): boolean {\r\n    return gameAdditionalState.isSprinting\r\n  }\r\n  // #endregion\r\n\r\n  // #region Held Item State\r\n  private updateHeldItem (isLeftHand: boolean) {\r\n    const newItem = isLeftHand ? bot.inventory.slots[45] : bot.heldItem\r\n    if (!newItem) {\r\n      if (isLeftHand) {\r\n        this.offHandItem = undefined\r\n      } else {\r\n        this.heldItem = undefined\r\n      }\r\n      this.events.emit('heldItemChanged', undefined, isLeftHand)\r\n      return\r\n    }\r\n\r\n    const block = loadedData.blocksByName[newItem.name]\r\n    const blockProperties = block ? new window.PrismarineBlock(block.id, 'void', newItem.metadata).getProperties() : {}\r\n    const item: HandItemBlock = {\r\n      name: newItem.name,\r\n      properties: blockProperties,\r\n      id: newItem.type,\r\n      type: block ? 'block' : 'item',\r\n      fullItem: newItem,\r\n    }\r\n\r\n    if (isLeftHand) {\r\n      this.offHandItem = item\r\n    } else {\r\n      this.heldItem = item\r\n    }\r\n    this.events.emit('heldItemChanged', item, isLeftHand)\r\n  }\r\n\r\n  startUsingItem () {\r\n    if (this.isUsingItem) return\r\n    this.isUsingItem = true\r\n    this.itemUsageTicks = 0\r\n  }\r\n\r\n  stopUsingItem () {\r\n    this.isUsingItem = false\r\n    this.itemUsageTicks = 0\r\n  }\r\n\r\n  getItemUsageTicks (): number {\r\n    return this.itemUsageTicks\r\n  }\r\n\r\n  getHeldItem (isLeftHand = false): HandItemBlock | undefined {\r\n    return isLeftHand ? this.offHandItem : this.heldItem\r\n  }\r\n\r\n  getItemSelector (specificProperties: ItemSpecificContextProperties, item?: import('prismarine-item').Item): ItemSelector['properties'] {\r\n    return {\r\n      ...specificProperties,\r\n      'minecraft:date': new Date(),\r\n      // \"minecraft:context_dimension\": bot.entityp,\r\n      'minecraft:time': bot.time.timeOfDay / 24_000,\r\n    }\r\n  }\r\n  // #endregion\r\n}\r\n\r\nexport const playerState = PlayerStateManager.getInstance()\r\nwindow.playerState = playerState\r\n","import { createMouse } from 'mineflayer-mouse'\r\nimport * as THREE from 'three'\r\nimport { Bot } from 'mineflayer'\r\nimport { Block } from 'prismarine-block'\r\nimport { Vec3 } from 'vec3'\r\nimport { LineMaterial } from 'three-stdlib'\r\nimport { subscribeKey } from 'valtio/utils'\r\nimport { disposeObject } from 'renderer/viewer/lib/threeJsUtils'\r\nimport { isGameActive, showModal } from '../../globalState'\r\n\r\n// wouldn't better to create atlas instead?\r\nimport destroyStage0 from '../../../assets/destroy_stage_0.png'\r\nimport destroyStage1 from '../../../assets/destroy_stage_1.png'\r\nimport destroyStage2 from '../../../assets/destroy_stage_2.png'\r\nimport destroyStage3 from '../../../assets/destroy_stage_3.png'\r\nimport destroyStage4 from '../../../assets/destroy_stage_4.png'\r\nimport destroyStage5 from '../../../assets/destroy_stage_5.png'\r\nimport destroyStage6 from '../../../assets/destroy_stage_6.png'\r\nimport destroyStage7 from '../../../assets/destroy_stage_7.png'\r\nimport destroyStage8 from '../../../assets/destroy_stage_8.png'\r\nimport destroyStage9 from '../../../assets/destroy_stage_9.png'\r\nimport { options } from '../../optionsStorage'\r\nimport { isCypress } from '../../standaloneUtils'\r\nimport { playerState } from '../playerState'\r\n\r\nfunction createDisplayManager (bot: Bot, scene: THREE.Scene, renderer: THREE.WebGLRenderer) {\r\n  // State\r\n  const state = {\r\n    blockBreakMesh: null as THREE.Mesh | null,\r\n    breakTextures: [] as THREE.Texture[],\r\n  }\r\n\r\n  // Initialize break mesh and textures\r\n  const loader = new THREE.TextureLoader()\r\n  const destroyStagesImages = [\r\n    destroyStage0, destroyStage1, destroyStage2, destroyStage3, destroyStage4,\r\n    destroyStage5, destroyStage6, destroyStage7, destroyStage8, destroyStage9\r\n  ]\r\n\r\n  for (let i = 0; i < 10; i++) {\r\n    const texture = loader.load(destroyStagesImages[i])\r\n    texture.magFilter = THREE.NearestFilter\r\n    texture.minFilter = THREE.NearestFilter\r\n    state.breakTextures.push(texture)\r\n  }\r\n\r\n  const breakMaterial = new THREE.MeshBasicMaterial({\r\n    transparent: true,\r\n    blending: THREE.MultiplyBlending,\r\n    alphaTest: 0.5,\r\n  })\r\n  state.blockBreakMesh = new THREE.Mesh(new THREE.BoxGeometry(1, 1, 1), breakMaterial)\r\n  state.blockBreakMesh.visible = false\r\n  state.blockBreakMesh.renderOrder = 999\r\n  state.blockBreakMesh.name = 'blockBreakMesh'\r\n  scene.add(state.blockBreakMesh)\r\n\r\n  // Update functions\r\n  function updateLineMaterial () {\r\n    const inCreative = bot.game.gameMode === 'creative'\r\n    const pixelRatio = viewer.renderer.getPixelRatio()\r\n\r\n    viewer.world.threejsCursorLineMaterial = new LineMaterial({\r\n      color: (() => {\r\n        switch (options.highlightBlockColor) {\r\n          case 'blue':\r\n            return 0x40_80_ff\r\n          case 'classic':\r\n            return 0x00_00_00\r\n          default:\r\n            return inCreative ? 0x40_80_ff : 0x00_00_00\r\n        }\r\n      })(),\r\n      linewidth: Math.max(pixelRatio * 0.7, 1) * 2,\r\n      // dashed: true,\r\n      // dashSize: 5,\r\n    })\r\n  }\r\n\r\n  function updateDisplay () {\r\n    if (viewer.world.threejsCursorLineMaterial) {\r\n      const { renderer } = viewer\r\n      viewer.world.threejsCursorLineMaterial.resolution.set(renderer.domElement.width, renderer.domElement.height)\r\n      viewer.world.threejsCursorLineMaterial.dashOffset = performance.now() / 750\r\n    }\r\n  }\r\n  beforeRenderFrame.push(updateDisplay)\r\n\r\n  // Update cursor line material on game mode change\r\n  bot.on('game', updateLineMaterial)\r\n  // Update material when highlight color setting changes\r\n  subscribeKey(options, 'highlightBlockColor', updateLineMaterial)\r\n\r\n  function updateBreakAnimation (block: Block | undefined, stage: number | null) {\r\n    hideBreakAnimation()\r\n    if (!state.blockBreakMesh) return // todo\r\n    if (stage === null || !block) return\r\n\r\n    const mergedShape = bot.mouse.getMergedCursorShape(block)\r\n    if (!mergedShape) return\r\n    const { position, width, height, depth } = bot.mouse.getDataFromShape(mergedShape)\r\n    state.blockBreakMesh.scale.set(width * 1.001, height * 1.001, depth * 1.001)\r\n    position.add(block.position)\r\n    state.blockBreakMesh.position.set(position.x, position.y, position.z)\r\n    state.blockBreakMesh.visible = true\r\n\r\n    //@ts-expect-error\r\n    state.blockBreakMesh.material.map = state.breakTextures[stage] ?? state.breakTextures.at(-1)\r\n    //@ts-expect-error\r\n    state.blockBreakMesh.material.needsUpdate = true\r\n  }\r\n\r\n  function hideBreakAnimation () {\r\n    if (state.blockBreakMesh) {\r\n      state.blockBreakMesh.visible = false\r\n    }\r\n  }\r\n\r\n  function updateCursorBlock (data?: { block: Block }) {\r\n    if (!data?.block) {\r\n      viewer.world.setHighlightCursorBlock(null)\r\n      return\r\n    }\r\n\r\n    const { block } = data\r\n    viewer.world.setHighlightCursorBlock(block.position, bot.mouse.getBlockCursorShapes(block).map(shape => {\r\n      return bot.mouse.getDataFromShape(shape)\r\n    }))\r\n  }\r\n\r\n  bot.on('highlightCursorBlock', updateCursorBlock)\r\n\r\n  bot.on('blockBreakProgressStage', updateBreakAnimation)\r\n\r\n  bot.on('end', () => {\r\n    disposeObject(state.blockBreakMesh!, true)\r\n    scene.remove(state.blockBreakMesh!)\r\n    viewer.world.setHighlightCursorBlock(null)\r\n  })\r\n}\r\n\r\nexport default (bot: Bot) => {\r\n  bot.loadPlugin(createMouse({}))\r\n\r\n  domListeners(bot)\r\n  createDisplayManager(bot, viewer.scene, viewer.renderer)\r\n\r\n  otherListeners()\r\n}\r\n\r\nconst otherListeners = () => {\r\n  bot.on('startDigging', (block) => {\r\n    customEvents.emit('digStart')\r\n  })\r\n\r\n  bot.on('goingToSleep', () => {\r\n    showModal({ reactType: 'bed' })\r\n  })\r\n\r\n  bot.on('botArmSwingStart', (hand) => {\r\n    viewer.world.changeHandSwingingState(true, hand === 'left')\r\n  })\r\n\r\n  bot.on('botArmSwingEnd', (hand) => {\r\n    viewer.world.changeHandSwingingState(false, hand === 'left')\r\n  })\r\n\r\n  bot.on('startUsingItem', (item, slot, isOffhand, duration) => {\r\n    customEvents.emit('activateItem', item, isOffhand ? 45 : bot.quickBarSlot, isOffhand)\r\n    playerState.startUsingItem()\r\n  })\r\n\r\n  bot.on('stopUsingItem', () => {\r\n    playerState.stopUsingItem()\r\n  })\r\n}\r\n\r\nconst domListeners = (bot: Bot) => {\r\n  document.addEventListener('mousedown', (e) => {\r\n    if (e.isTrusted && !document.pointerLockElement && !isCypress()) return\r\n    if (!isGameActive(true)) return\r\n\r\n    if (e.button === 0) {\r\n      bot.leftClickStart()\r\n    } else if (e.button === 2) {\r\n      bot.rightClickStart()\r\n    }\r\n  })\r\n\r\n  document.addEventListener('mouseup', (e) => {\r\n    if (e.button === 0) {\r\n      bot.leftClickEnd()\r\n    } else if (e.button === 2) {\r\n      bot.rightClickEnd()\r\n    }\r\n  })\r\n\r\n  bot.mouse.beforeUpdateChecks = () => {\r\n    if (!document.hasFocus()) {\r\n      // deactive all buttons\r\n      bot.mouse.buttons.fill(false)\r\n    }\r\n  }\r\n}\r\n","export default () => {\r\n  // not plugin so its loaded earlier\r\n  customEvents.on('mineflayerBotCreated', () => {\r\n    botInit()\r\n  })\r\n}\r\n\r\nconst waitingPackets = {} as Record<string, Array<{ name: string, data: any }>>\r\n\r\nconst botInit = () => {\r\n  // PATCH READING\r\n  bot._client.on('packet', (data, meta) => {\r\n    if (meta.name === 'map_chunk') {\r\n      if (data.groundUp && data.bitMap === 1 && data.chunkData.every(x => x === 0)) {\r\n        data.chunkData = Buffer.from(Array.from({ length: 12_544 }).fill(0) as any)\r\n      }\r\n    }\r\n  })\r\n\r\n  // PATCH WRITING\r\n\r\n  const clientWrite = bot._client.write.bind(bot._client)\r\n  const sendAllPackets = (name: string, data: any) => {\r\n    for (const packet of waitingPackets[name]) {\r\n      clientWrite(packet.name, packet.data)\r\n    }\r\n    delete waitingPackets[name]\r\n  }\r\n\r\n  //@ts-expect-error\r\n  bot._client.write = (name: string, data: any) => {\r\n    // if (name === 'position' || name === 'position_look' || name === 'look' || name === 'teleport_confirm') {\r\n    //   const chunkX = Math.floor(bot.entity.position.x / 16)\r\n    //   const chunkZ = Math.floor(bot.entity.position.z / 16)\r\n    //   const loadedColumns = bot.world.getColumns()\r\n    //   if (loadedColumns.some((c) => c.chunkX === chunkX && c.chunkZ === chunkZ)) {\r\n    //     sendAllPackets('position', data)\r\n    //   } else {\r\n    //     waitingPackets['position'] = [...(waitingPackets['position'] || []), { name, data }]\r\n    //     return\r\n    //   }\r\n    // }\r\n    if (name === 'settings') {\r\n      data['viewDistance'] = Math.max(data['viewDistance'], 3)\r\n    }\r\n    return clientWrite(name, data)\r\n  }\r\n\r\n  // PATCH INTERACTIONS\r\n}\r\n","import { viewerConnector } from 'mcraft-fun-mineflayer'\r\nimport { PACKETS_REPLAY_FILE_EXTENSION, WORLD_STATE_FILE_EXTENSION } from 'mcraft-fun-mineflayer/build/worldState'\r\nimport { Bot } from 'mineflayer'\r\nimport CircularBuffer from 'flying-squid/dist/circularBuffer'\r\nimport { PacketsLogger } from 'mcraft-fun-mineflayer/build/packetsLogger'\r\nimport { subscribe } from 'valtio'\r\nimport { lastConnectOptions } from '../../react/AppStatusProvider'\r\nimport { packetsRecordingState } from '../../packetsReplay/packetsReplayLegacy'\r\nimport { packetsReplayState } from '../../react/state/packetsReplayState'\r\n\r\nconst AUTO_CAPTURE_PACKETS_COUNT = 30\r\nlet circularBuffer: CircularBuffer | undefined\r\nlet lastConnectVersion = ''\r\n\r\nexport const localRelayServerPlugin = (bot: Bot) => {\r\n  lastConnectVersion = bot.version\r\n  let ended = false\r\n  bot.on('end', () => {\r\n    ended = true\r\n  })\r\n\r\n  bot.loadPlugin(\r\n    viewerConnector({\r\n      tcpEnabled: false,\r\n      websocketEnabled: false,\r\n    })\r\n  )\r\n\r\n  const downloadFile = (contents: string, filename: string) => {\r\n    const a = document.createElement('a')\r\n    const blob = new Blob([contents], { type: 'text/plain' })\r\n    const url = URL.createObjectURL(blob)\r\n    a.href = url\r\n    a.download = filename\r\n    a.click()\r\n    URL.revokeObjectURL(url)\r\n  }\r\n\r\n  bot.downloadCurrentWorldState = () => {\r\n    const worldState = bot.webViewer._unstable.createStateCaptureFile()\r\n    // add readable timestamp to filename\r\n    const timestamp = new Date().toISOString().replaceAll(/[-:Z]/g, '')\r\n    downloadFile(worldState.contents, `${bot.username}-world-state-${timestamp}.${WORLD_STATE_FILE_EXTENSION}`)\r\n  }\r\n\r\n  let logger: PacketsLogger | undefined\r\n  bot.startPacketsRecording = () => {\r\n    bot.webViewer._unstable.startRecording((l) => {\r\n      logger = l\r\n    })\r\n  }\r\n\r\n  bot.stopPacketsRecording = () => {\r\n    if (!logger) return\r\n    const packets = logger?.contents\r\n    logger = undefined\r\n    const timestamp = new Date().toISOString().replaceAll(/[-:Z]/g, '')\r\n    downloadFile(packets, `${bot.username}-packets-${timestamp}.${PACKETS_REPLAY_FILE_EXTENSION}`)\r\n    bot.webViewer._unstable.stopRecording()\r\n  }\r\n\r\n  circularBuffer = new CircularBuffer(AUTO_CAPTURE_PACKETS_COUNT)\r\n  let position = 0\r\n  bot._client.on('writePacket' as any, (name, params) => {\r\n    circularBuffer!.add({ name, state: bot._client.state, params, isFromServer: false, timestamp: Date.now() })\r\n    if (packetsRecordingState.active) {\r\n      packetsReplayState.packetsPlayback.push({\r\n        name,\r\n        data: params,\r\n        isFromClient: true,\r\n        isUpcoming: false,\r\n        position: position++,\r\n        timestamp: Date.now(),\r\n      })\r\n    }\r\n  })\r\n  bot._client.on('packet', (data, { name }) => {\r\n    if (name === 'map_chunk') data = { x: data.x, z: data.z }\r\n    circularBuffer!.add({ name, state: bot._client.state, params: data, isFromServer: true, timestamp: Date.now() })\r\n    if (packetsRecordingState.active) {\r\n      packetsReplayState.packetsPlayback.push({\r\n        name,\r\n        data,\r\n        isFromClient: false,\r\n        isUpcoming: false,\r\n        position: position++,\r\n        timestamp: Date.now(),\r\n      })\r\n    }\r\n  })\r\n\r\n  upPacketsReplayPanel()\r\n}\r\n\r\nconst upPacketsReplayPanel = () => {\r\n  if (packetsRecordingState.active && bot) {\r\n    packetsReplayState.isOpen = true\r\n    packetsReplayState.replayName = 'Recording all packets for ' + bot.username\r\n  }\r\n}\r\n\r\nsubscribe(packetsRecordingState, () => {\r\n  upPacketsReplayPanel()\r\n})\r\n\r\ndeclare module 'mineflayer' {\r\n  interface Bot {\r\n    downloadCurrentWorldState: () => void\r\n    startPacketsRecording: () => void\r\n    stopPacketsRecording: () => void\r\n  }\r\n}\r\n\r\nexport const getLastAutoCapturedPackets = () => circularBuffer?.size\r\nexport const downloadAutoCapturedPackets = () => {\r\n  const logger = new PacketsLogger({ minecraftVersion: lastConnectVersion })\r\n  logger.relativeTime = false\r\n  logger.formattedTime = true\r\n  for (const packet of circularBuffer?.getLastElements() ?? []) {\r\n    logger.log(packet.isFromServer, { name: packet.name, state: packet.state, time: packet.timestamp }, packet.params)\r\n  }\r\n  const textContents = logger.contents\r\n  const blob = new Blob([textContents], { type: 'text/plain' })\r\n  const url = URL.createObjectURL(blob)\r\n  const a = document.createElement('a')\r\n  a.href = url\r\n  a.download = `${lastConnectOptions.value?.server ?? 'unknown-server'}-${lastConnectOptions.value?.username ?? 'unknown-username'}-auto-captured-packets.txt`\r\n  a.click()\r\n  URL.revokeObjectURL(url)\r\n}\r\n","import { versionToNumber } from 'renderer/viewer/prepare/utils'\r\n\r\nexport default () => {\r\n  let i = 0\r\n  bot.pingProxy = async () => {\r\n    const curI = ++i\r\n    return new Promise(resolve => {\r\n      //@ts-expect-error\r\n      bot._client.socket._ws.send(`ping:${curI}`)\r\n      const date = Date.now()\r\n      const onPong = (received) => {\r\n        if (received !== curI.toString()) return\r\n        bot._client.socket.off('pong' as any, onPong)\r\n        resolve(Date.now() - date)\r\n      }\r\n      bot._client.socket.on('pong' as any, onPong)\r\n    })\r\n  }\r\n\r\n  let pingId = 0\r\n  bot.pingServer = async () => {\r\n    if (versionToNumber(bot.version) < versionToNumber('1.20.2')) return bot.player.ping\r\n    return new Promise<number>((resolve) => {\r\n      const curId = pingId++\r\n      bot._client.write('ping_request', { id: BigInt(curId) })\r\n      const date = Date.now()\r\n      const onPong = (data: { id: bigint }) => {\r\n        if (BigInt(data.id) !== BigInt(curId)) return\r\n        bot._client.off('ping_response' as any, onPong)\r\n        resolve(Date.now() - date)\r\n      }\r\n      bot._client.on('ping_response' as any, onPong)\r\n    })\r\n  }\r\n}\r\n\r\ndeclare module 'mineflayer' {\r\n  interface Bot {\r\n    pingProxy: () => Promise<number>\r\n    pingServer: () => Promise<number | undefined>\r\n  }\r\n}\r\n","export class UserError extends Error {\r\n  constructor (message: string) {\r\n    super(message)\r\n    this.name = 'UserError'\r\n  }\r\n}\r\n","import { Duplex } from 'stream'\r\nimport { UserError } from './userError'\r\n\r\nclass CustomDuplex extends Duplex {\r\n  constructor (options, public writeAction) {\r\n    super(options)\r\n  }\r\n\r\n  override _read () {}\r\n\r\n  override _write (chunk, encoding, callback) {\r\n    this.writeAction(chunk)\r\n    callback()\r\n  }\r\n}\r\n\r\nexport const getWebsocketStream = async (host: string) => {\r\n  const baseProtocol = location.protocol === 'https:' ? 'wss' : host.startsWith('ws://') ? 'ws' : 'wss'\r\n  const hostClean = host.replace('ws://', '').replace('wss://', '')\r\n  const ws = new WebSocket(`${baseProtocol}://${hostClean}`)\r\n  const clientDuplex = new CustomDuplex(undefined, data => {\r\n    ws.send(data)\r\n  })\r\n\r\n  ws.addEventListener('message', async message => {\r\n    let { data } = message\r\n    if (data instanceof Blob) {\r\n      data = await data.arrayBuffer()\r\n    }\r\n    clientDuplex.push(Buffer.from(data))\r\n  })\r\n\r\n  ws.addEventListener('close', () => {\r\n    console.log('ws closed')\r\n    clientDuplex.end()\r\n  })\r\n\r\n  ws.addEventListener('error', err => {\r\n    console.log('ws error', err)\r\n  })\r\n\r\n  await new Promise((resolve, reject) => {\r\n    ws.addEventListener('open', resolve)\r\n    ws.addEventListener('error', err => {\r\n      console.log('ws error', err)\r\n      reject(new UserError('Failed to open websocket connection'))\r\n    })\r\n  })\r\n\r\n  return {\r\n    mineflayerStream: clientDuplex,\r\n    ws,\r\n  }\r\n}\r\n","// fix double tap on mobile\r\n\r\nlet lastElement = null as {\r\n  clickTime: number\r\n  element: HTMLElement\r\n} | null\r\ndocument.addEventListener('touchstart', (e) => {\r\n  if (e.touches.length > 1) {\r\n    lastElement = null\r\n    return\r\n  }\r\n  if (lastElement && Date.now() - lastElement.clickTime < 500 && lastElement.element === e.target) {\r\n    lastElement.element.dispatchEvent(new MouseEvent('dblclick', { bubbles: true }))\r\n    lastElement = null\r\n  }\r\n  lastElement = {\r\n    clickTime: Date.now(),\r\n    element: e.target as HTMLElement\r\n  }\r\n}, { passive: false })\r\n","import { versionToNumber } from 'renderer/viewer/prepare/utils'\r\n\r\ntype IdMap = Record<string, number>\r\n\r\ntype DiffData = {\r\n  removed: number[],\r\n  changed: any[],\r\n  removedProps: Array<[number, number[]]>,\r\n  added\r\n}\r\n\r\ntype SourceData = {\r\n  keys: IdMap,\r\n  properties: IdMap\r\n  source: Record<number, any>\r\n  diffs: Record<string, DiffData>\r\n  arrKey?\r\n  __IS_OPTIMIZED__: true\r\n}\r\n\r\nfunction getRecipesProcessorProcessRecipes (items, blocks) {\r\n  return (current) => {\r\n    // can require the same multiple times per different versions\r\n    const itemsIdsMap = Object.fromEntries(items.map((b) => [b.name, b.id]))\r\n    const blocksIdsMap = Object.fromEntries(blocks.map((b) => [b.name, b.id]))\r\n    const keys = Object.keys(current)\r\n    for (const key of keys) {\r\n      if (key === '_proccessed') {\r\n        delete current[key]\r\n        continue\r\n      }\r\n      const mapId = (id) => {\r\n        if (typeof id !== 'string' && typeof id !== 'number') throw new Error('Incorrect type')\r\n        const mapped = itemsIdsMap[id] ?? blocksIdsMap[id]\r\n        if (!mapped) {\r\n          throw new Error(`No item/block name with id ${id}`)\r\n        }\r\n        return mapped\r\n      }\r\n      const processRecipe = (obj) => {\r\n        // if (!obj) return\r\n        // if (Array.isArray(obj)) {\r\n        //   obj.forEach((id, i) => {\r\n        //     obj[i] = mapId(obj[id])\r\n        //   })\r\n        // } else if (obj && typeof obj === 'object') {\r\n        //   if (!'count metadata id'.split(' ').every(x => x in obj)) {\r\n        //     throw new Error(`process error: Unknown deep object pattern: ${JSON.stringify(obj)}`)\r\n        //   }\r\n        //   obj.id = mapId(obj.id)\r\n        // } else {\r\n        //   throw new Error('unknown type')\r\n        // }\r\n        const parseRecipeItem = (item) => {\r\n          if (typeof item === 'number' || typeof item === 'string') return mapId(item)\r\n          if (Array.isArray(item)) return [mapId(item), ...item.slice(1)]\r\n          if (!item) {\r\n            return item\r\n          }\r\n          if ('id' in item) {\r\n            item.id = mapId(item.id)\r\n            return item\r\n          }\r\n          throw new Error('unhandled')\r\n        }\r\n        const maybeProccessShape = (shape) => {\r\n          if (!shape) return\r\n          for (const shapeRow of shape) {\r\n            for (const [i, item] of shapeRow.entries()) {\r\n              shapeRow[i] = parseRecipeItem(item)\r\n            }\r\n          }\r\n        }\r\n        if (obj.result) obj.result = parseRecipeItem(obj.result)\r\n        maybeProccessShape(obj.inShape)\r\n        maybeProccessShape(obj.outShape)\r\n        if (obj.ingredients) {\r\n          for (const [i, ingredient] of obj.ingredients.entries()) {\r\n            obj.ingredients[i] = parseRecipeItem(ingredient)\r\n          }\r\n        }\r\n      }\r\n      // eslint-disable-next-line no-useless-catch\r\n      try {\r\n        const name = mapId(key)\r\n        for (const [i, recipe] of current[key].entries()) {\r\n          // eslint-disable-next-line no-useless-catch\r\n          try {\r\n            processRecipe(recipe)\r\n          } catch (err) {\r\n            // console.warn(`${version} [warn] Removing incorrect recipe: ${err}`)\r\n            // delete current[i]\r\n            throw err\r\n          }\r\n        }\r\n        current[name] = current[key]\r\n      } catch (err) {\r\n        // console.warn(`${version} [warn] Removing incorrect recipe: ${err}`)\r\n        throw err\r\n      }\r\n      delete current[key]\r\n    }\r\n  }\r\n}\r\n\r\nexport const restoreMinecraftData = (allVersionData: any, type: string, version: string) => {\r\n  let restorer\r\n  if (type === 'recipes') {\r\n    restorer = getRecipesProcessorProcessRecipes(\r\n      JsonOptimizer.restoreData(allVersionData.items, version, undefined),\r\n      JsonOptimizer.restoreData(allVersionData.blocks, version, undefined),\r\n    )\r\n  }\r\n  return JsonOptimizer.restoreData(allVersionData[type], version, restorer)\r\n}\r\n\r\nexport default class JsonOptimizer {\r\n  keys = {} as IdMap\r\n  idToKey = {} as Record<number, string>\r\n  properties = {} as IdMap\r\n  source = {}\r\n  previousKeys = [] as number[]\r\n  previousValues = {} as Record<number, any>\r\n  diffs = {} as Record<string, DiffData>\r\n\r\n  constructor (public arrKey?: string, public ignoreChanges = false, public ignoreRemoved = false) { }\r\n\r\n  export () {\r\n    const { keys, properties, source, arrKey, diffs } = this\r\n    return {\r\n      keys,\r\n      properties,\r\n      source,\r\n      arrKey,\r\n      diffs,\r\n      '__IS_OPTIMIZED__': true\r\n    } satisfies SourceData\r\n  }\r\n\r\n  diffObj (diffing): DiffData {\r\n    const removed = [] as number[]\r\n    const changed = [] as any[]\r\n    const removedProps = [] as any[]\r\n    const { arrKey, ignoreChanges, ignoreRemoved } = this\r\n    const added = [] as number[]\r\n\r\n    if (!diffing || typeof diffing !== 'object') throw new Error('diffing data is not object')\r\n    if (Array.isArray(diffing) && !arrKey) throw new Error('arrKey is required for arrays')\r\n    const diffingObj = Array.isArray(diffing) ? Object.fromEntries(diffing.map(x => {\r\n      const key = JsonOptimizer.getByArrKey(x, arrKey!)\r\n      return [key, x]\r\n    })) : diffing\r\n\r\n    const possiblyNewKeys = Object.keys(diffingObj)\r\n    this.keys ??= {}\r\n    this.properties ??= {}\r\n    let lastRootKeyId = Object.values(this.keys).length\r\n    let lastItemKeyId = Object.values(this.properties).length\r\n    for (const key of possiblyNewKeys) {\r\n      this.keys[key] ??= lastRootKeyId++\r\n      this.idToKey[this.keys[key]] = key\r\n    }\r\n    const DEBUG = false\r\n\r\n    const addDiff = (key, newVal, prevVal) => {\r\n      const valueMapped = [] as any[]\r\n      const isItemObj = typeof newVal === 'object' && newVal\r\n      const keyId = this.keys[key]\r\n      if (isItemObj) {\r\n        const removedPropsLocal = [] as any[]\r\n        for (const [prop, val] of Object.entries(newVal)) {\r\n          // mc-data: why push only changed props? eg for blocks only stateId are different between all versions so we skip a lot of duplicated data like block props\r\n          if (!isEqualStructured(newVal[prop], prevVal[prop])) {\r\n            let keyMapped = this.properties[prop]\r\n            if (keyMapped === undefined) {\r\n              this.properties[prop] = lastItemKeyId++\r\n              keyMapped = this.properties[prop]\r\n            }\r\n            valueMapped.push(DEBUG ? prop : keyMapped, newVal[prop])\r\n          }\r\n        }\r\n        // also add undefined for removed props\r\n        for (const prop of Object.keys(prevVal)) {\r\n          if (prop in newVal) continue\r\n          let keyMapped = this.properties[prop]\r\n          if (keyMapped === undefined) {\r\n            this.properties[prop] = lastItemKeyId++\r\n            keyMapped = this.properties[prop]\r\n          }\r\n          removedPropsLocal.push(DEBUG ? prop : keyMapped)\r\n        }\r\n        removedProps.push([keyId, removedPropsLocal])\r\n      }\r\n      changed.push(DEBUG ? key : keyId, isItemObj ? valueMapped : newVal)\r\n    }\r\n    for (const [id, sourceVal] of Object.entries(this.source)) {\r\n      const key = this.idToKey[id]\r\n      const diffVal = diffingObj[key]\r\n      if (!ignoreChanges && diffVal !== undefined) {\r\n        this.previousValues[id] ??= this.source[id]\r\n        const prevVal = this.previousValues[id]\r\n        if (!isEqualStructured(prevVal, diffVal)) {\r\n          addDiff(key, diffVal, prevVal)\r\n        }\r\n        this.previousValues[id] = diffVal\r\n      }\r\n    }\r\n    for (const [key, val] of Object.entries(diffingObj)) {\r\n      const id = this.keys[key]\r\n      if (!this.source[id]) {\r\n        this.source[id] = val\r\n      }\r\n      added.push(id)\r\n    }\r\n\r\n    for (const previousKey of this.previousKeys) {\r\n      const key = this.idToKey[previousKey]\r\n      if (diffingObj[key] === undefined && !ignoreRemoved) {\r\n        removed.push(previousKey)\r\n      }\r\n    }\r\n\r\n    for (const toRemove of removed) {\r\n      this.previousKeys.splice(this.previousKeys.indexOf(toRemove), 1)\r\n    }\r\n\r\n    for (const previousKey of this.previousKeys) {\r\n      const index = added.indexOf(previousKey)\r\n      if (index === -1) continue\r\n      added.splice(index, 1)\r\n    }\r\n\r\n    this.previousKeys = [...this.previousKeys, ...added]\r\n\r\n    return {\r\n      removed,\r\n      changed,\r\n      added,\r\n      removedProps\r\n    }\r\n  }\r\n\r\n  recordDiff (key: string, diffObj: string) {\r\n    const diff = this.diffObj(diffObj)\r\n    // problem is that 274 key 10.20.6 no removed keys in diff created\r\n    this.diffs[key] = diff\r\n  }\r\n\r\n  static isOptimizedChangeDiff (changePossiblyArrDiff) {\r\n    if (!Array.isArray(changePossiblyArrDiff)) return false\r\n    if (changePossiblyArrDiff.length % 2 !== 0) return false\r\n    for (let i = 0; i < changePossiblyArrDiff.length; i += 2) {\r\n      if (typeof changePossiblyArrDiff[i] !== 'number') return false\r\n    }\r\n    return true\r\n  }\r\n\r\n  static restoreData ({ keys, properties, source, arrKey, diffs }: SourceData, targetKey: string, dataRestorer: ((data) => void) | undefined) {\r\n    // if (!diffs[targetKey]) throw new Error(`The requested data to restore with key ${targetKey} does not exist`)\r\n    source = structuredClone(source)\r\n    const keysById = Object.fromEntries(Object.entries(keys).map(x => [x[1], x[0]]))\r\n    const propertiesById = Object.fromEntries(Object.entries(properties).map(x => [x[1], x[0]]))\r\n    const dataByKeys = {} as Record<string, any>\r\n    for (const [versionKey, { added, changed, removed, removedProps }] of Object.entries(diffs)) {\r\n      for (const toAdd of added) {\r\n        dataByKeys[toAdd] = source[toAdd]\r\n      }\r\n      for (const toRemove of removed) {\r\n        delete dataByKeys[toRemove]\r\n      }\r\n      for (let i = 0; i < changed.length; i += 2) {\r\n        const key = changed[i]\r\n        const change = changed[i + 1]\r\n        const isOptimizedChange = JsonOptimizer.isOptimizedChangeDiff(change)\r\n        if (isOptimizedChange) {\r\n          // apply optimized diff\r\n          for (let k = 0; k < change.length; k += 2) {\r\n            const propId = change[k]\r\n            const newVal = change[k + 1]\r\n            const prop = propertiesById[propId]\r\n            // const prop = propId\r\n            if (prop === undefined) throw new Error(`Property id change is undefined: ${propId}`)\r\n            dataByKeys[key][prop] = newVal\r\n          }\r\n        } else {\r\n          dataByKeys[key] = change\r\n        }\r\n      }\r\n      for (const [key, removePropsId] of removedProps) {\r\n        for (const removePropId of removePropsId) {\r\n          const removeProp = propertiesById[removePropId]\r\n          // todo: this is not correct!\r\n          if (Array.isArray(dataByKeys[key])) {\r\n            dataByKeys[key].splice(removeProp as any, 1) // splice accepts strings as well\r\n          } else {\r\n            delete dataByKeys[key][removeProp]\r\n          }\r\n        }\r\n      }\r\n      if (versionToNumber(versionKey) <= versionToNumber(targetKey)) {\r\n        break\r\n      }\r\n    }\r\n    let data\r\n    if (arrKey) {\r\n      data = Object.values(dataByKeys)\r\n    } else {\r\n      data = Object.fromEntries(Object.entries(dataByKeys).map(([key, val]) => [keysById[key], val]))\r\n    }\r\n    dataRestorer?.(data)\r\n    return data\r\n  }\r\n\r\n  static getByArrKey (item: any, arrKey: string) {\r\n    return arrKey.split('+').map(x => item[x]).join('+')\r\n  }\r\n\r\n  static resolveDefaults (arr) {\r\n    if (!Array.isArray(arr)) throw new Error('not an array')\r\n    const propsValueCount = {} as {\r\n      [key: string]: {\r\n        [val: string]: number\r\n      }\r\n    }\r\n    for (const obj of arr) {\r\n      if (typeof obj !== 'object' || !obj) continue\r\n      for (const [key, val] of Object.entries(obj)) {\r\n        const valJson = JSON.stringify(val)\r\n        propsValueCount[key] ??= {}\r\n        propsValueCount[key][valJson] ??= 0\r\n        propsValueCount[key][valJson] += 1\r\n      }\r\n    }\r\n    const defaults = Object.fromEntries(Object.entries(propsValueCount).map(([prop, values]) => {\r\n      const defaultValue = Object.entries(values).sort(([, count1], [, count2]) => count2 - count1)[0][0]\r\n      return [prop, defaultValue]\r\n    }))\r\n\r\n    const newData = [] as any[]\r\n    const noData = {}\r\n    for (const [i, obj] of arr.entries()) {\r\n      if (typeof obj !== 'object' || !obj) {\r\n        newData.push(obj)\r\n        continue\r\n      }\r\n      for (const key of Object.keys(defaults)) {\r\n        const val = obj[key]\r\n        if (!val) {\r\n          noData[key] ??= []\r\n          noData[key].push(key)\r\n          continue\r\n        }\r\n        if (defaults[key] === JSON.stringify(val)) {\r\n          delete obj[key]\r\n        }\r\n      }\r\n      newData.push(obj)\r\n    }\r\n\r\n    return {\r\n      data: newData,\r\n      defaults\r\n    }\r\n  }\r\n}\r\n\r\nconst isEqualStructured = (val1, val2) => {\r\n  return JSON.stringify(val1) === JSON.stringify(val2)\r\n}\r\n","import { useRef, useState } from 'react'\r\nimport { useSnapshot } from 'valtio'\r\nimport { openURL } from 'renderer/viewer/lib/simpleUtils'\r\nimport { noCase } from 'change-case'\r\nimport { versionToNumber } from 'mc-assets/dist/utils'\r\nimport { gameAdditionalState, miscUiState, openOptionsMenu, showModal } from './globalState'\r\nimport { AppOptions, getChangedSettings, options, resetOptions } from './optionsStorage'\r\nimport Button from './react/Button'\r\nimport { OptionMeta, OptionSlider } from './react/OptionsItems'\r\nimport Slider from './react/Slider'\r\nimport { getScreenRefreshRate } from './utils'\r\nimport { setLoadingScreenStatus } from './appStatus'\r\nimport { openFilePicker, resetLocalStorage } from './browserfs'\r\nimport { completeResourcepackPackInstall, getResourcePackNames, resourcePackState, uninstallResourcePack } from './resourcePack'\r\nimport { downloadPacketsReplay, packetsRecordingState } from './packetsReplay/packetsReplayLegacy'\r\nimport { showInputsModal, showOptionsModal } from './react/SelectOption'\r\nimport supportedVersions from './supportedVersions.mjs'\r\nimport { getVersionAutoSelect } from './connect'\r\nimport { createNotificationProgressReporter } from './core/progressReporter'\r\nimport { customKeymaps } from './controls'\r\nimport { appStorage } from './react/appStorageProvider'\r\n\r\nexport const guiOptionsScheme: {\r\n  [t in OptionsGroupType]: Array<{ [K in keyof AppOptions]?: Partial<OptionMeta<AppOptions[K]>> } & { custom? }>\r\n} = {\r\n  render: [\r\n    {\r\n      custom () {\r\n        const frameLimitValue = useSnapshot(options).frameLimit\r\n        const [frameLimitMax, setFrameLimitMax] = useState(null as number | null)\r\n\r\n        return <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n          <Slider\r\n            style={{ width: 130 }}\r\n            label='Frame Limit'\r\n            disabledReason={frameLimitMax ? undefined : 'press lock button first'}\r\n            unit={frameLimitValue ? 'fps' : ''}\r\n            valueDisplay={frameLimitValue || 'VSync'}\r\n            value={frameLimitValue || frameLimitMax! + 1} min={20}\r\n            max={frameLimitMax! + 1} updateValue={(newVal) => {\r\n              options.frameLimit = newVal > frameLimitMax! ? false : newVal\r\n            }}\r\n          />\r\n          <Button\r\n            style={{ width: 20 }} icon='pixelarticons:lock-open' onClick={async () => {\r\n              const rate = await getScreenRefreshRate()\r\n              setFrameLimitMax(rate)\r\n            }}\r\n          />\r\n        </div>\r\n      }\r\n    },\r\n    {\r\n      gpuPreference: {\r\n        text: 'GPU Preference',\r\n        tooltip: 'You will need to reload the page for this to take effect.',\r\n        values: [['default', 'Auto'], ['high-performance', 'Dedicated'], ['low-power', 'Low Power']]\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Button label='Guide: Disable VSync' onClick={() => openURL('https://gist.github.com/zardoy/6e5ce377d2b4c1e322e660973da069cd')} inScreen />\r\n      },\r\n    },\r\n    {\r\n      backgroundRendering: {\r\n        text: 'Background FPS limit',\r\n        values: [\r\n          ['full', 'NO'],\r\n          ['5fps', '5 FPS'],\r\n          ['20fps', '20 FPS'],\r\n        ],\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Category>Experimental</Category>\r\n      },\r\n      dayCycleAndLighting: {\r\n        text: 'Day Cycle',\r\n      },\r\n      smoothLighting: {},\r\n      newVersionsLighting: {\r\n        text: 'Lighting in Newer Versions',\r\n      },\r\n      lowMemoryMode: {\r\n        text: 'Low Memory Mode',\r\n        enableWarning: 'Enabling it will make chunks load ~4x slower',\r\n        disabledDuringGame: true\r\n      },\r\n      starfieldRendering: {},\r\n      renderEntities: {},\r\n      keepChunksDistance: {\r\n        max: 5,\r\n        unit: '',\r\n        tooltip: 'Additional distance to keep the chunks loading before unloading them by marking them as too far',\r\n      },\r\n      renderEars: {\r\n        tooltip: 'Enable rendering Deadmau5 ears for all players if their skin contains textures for it',\r\n      },\r\n      renderDebug: {\r\n        values: [\r\n          'advanced',\r\n          'basic',\r\n          'none'\r\n        ],\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Category>Resource Packs</Category>\r\n      },\r\n      serverResourcePacks: {\r\n        text: 'Download From Server',\r\n        values: [\r\n          'prompt',\r\n          'always',\r\n          'never'\r\n        ],\r\n      }\r\n    }\r\n  ],\r\n  main: [\r\n    {\r\n      fov: {\r\n        min: 30,\r\n        max: 110,\r\n        unit: '',\r\n      }\r\n    },\r\n    {\r\n      custom () {\r\n        const sp = miscUiState.singleplayer || !miscUiState.gameLoaded\r\n        const id = sp ? 'renderDistance' : 'multiplayerRenderDistance' // cant be changed when settings are open\r\n        return <OptionSlider item={{\r\n          type: 'slider',\r\n          id,\r\n          text: 'Render Distance',\r\n          unit: '',\r\n          max: sp ? 16 : 12,\r\n          min: 1\r\n        }}\r\n        />\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Button label='Render...' onClick={() => openOptionsMenu('render')} inScreen />\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Button label='Interface...' onClick={() => openOptionsMenu('interface')} inScreen />\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Button label='Controls...' onClick={() => openOptionsMenu('controls')} inScreen />\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Button label='Sound...' onClick={() => openOptionsMenu('sound')} inScreen />\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        const { resourcePackInstalled } = useSnapshot(resourcePackState)\r\n        const { usingServerResourcePack } = useSnapshot(gameAdditionalState)\r\n        const { enabledResourcepack } = useSnapshot(options)\r\n        return <Button\r\n          label={`Resource Pack: ${usingServerResourcePack ? 'SERVER ON' : resourcePackInstalled ? enabledResourcepack ? 'ON' : 'OFF' : 'NO'}`} inScreen onClick={async () => {\r\n            if (resourcePackState.resourcePackInstalled) {\r\n              const names = Object.keys(await getResourcePackNames())\r\n              const name = names[0]\r\n              const choices = [\r\n                options.enabledResourcepack ? 'Disable' : 'Enable',\r\n                'Uninstall',\r\n              ]\r\n              const choice = await showOptionsModal(`Resource Pack ${name} action`, choices)\r\n              if (!choice) return\r\n              if (choice === 'Disable') {\r\n                options.enabledResourcepack = null\r\n                return\r\n              }\r\n              if (choice === 'Enable') {\r\n                options.enabledResourcepack = name\r\n                await completeResourcepackPackInstall(name, name, false, createNotificationProgressReporter())\r\n                return\r\n              }\r\n              if (choice === 'Uninstall') {\r\n              // todo make hidable\r\n                setLoadingScreenStatus('Uninstalling texturepack')\r\n                await uninstallResourcePack()\r\n                setLoadingScreenStatus(undefined)\r\n              }\r\n            } else {\r\n            // if (!fsState.inMemorySave && isGameActive(false)) {\r\n            //   alert('Unable to install resource pack in loaded save for now')\r\n            //   return\r\n            // }\r\n              openFilePicker('resourcepack')\r\n            }\r\n          }}\r\n        />\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Button label='Advanced...' onClick={() => openOptionsMenu('advanced')} inScreen />\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Button label='VR...' onClick={() => openOptionsMenu('VR')} inScreen />\r\n      },\r\n    }\r\n  ],\r\n  interface: [\r\n    {\r\n      guiScale: {\r\n        max: 4,\r\n        min: 1,\r\n        unit: '',\r\n        delayApply: true,\r\n      },\r\n      custom () {\r\n        return <Category>Chat</Category>\r\n      },\r\n      chatWidth: {\r\n        max: 320,\r\n        unit: 'px',\r\n      },\r\n      chatHeight: {\r\n        max: 180,\r\n        unit: 'px',\r\n      },\r\n      chatOpacity: {\r\n      },\r\n      chatOpacityOpened: {\r\n      },\r\n      chatSelect: {\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Category>World</Category>\r\n      },\r\n      highlightBlockColor: {\r\n        text: 'Block Highlight Color',\r\n        values: [\r\n          ['auto', 'Auto'],\r\n          ['blue', 'Blue'],\r\n          ['classic', 'Classic']\r\n        ],\r\n      },\r\n      showHand: {\r\n        text: 'Show Hand',\r\n      },\r\n      viewBobbing: {\r\n        text: 'View Bobbing',\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Category>Sign Editor</Category>\r\n      },\r\n      autoSignEditor: {\r\n        text: 'Enable Sign Editor',\r\n      },\r\n      wysiwygSignEditor: {\r\n        text: 'WYSIWG Editor',\r\n        values: [\r\n          'auto',\r\n          'always',\r\n          'never'\r\n        ],\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Category>Map</Category>\r\n      },\r\n      showMinimap: {\r\n        text: 'Enable Minimap',\r\n        values: [\r\n          'always',\r\n          'singleplayer',\r\n          'never'\r\n        ],\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Category>Experimental</Category>\r\n      },\r\n      displayBossBars: {\r\n        text: 'Boss Bars',\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <UiToggleButton name='title' addUiText />\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <UiToggleButton name='chat' addUiText />\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <UiToggleButton name='scoreboard' addUiText />\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <UiToggleButton name='effects-indicators' />\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <UiToggleButton name='hotbar' />\r\n      },\r\n    },\r\n  ],\r\n  controls: [\r\n    {\r\n      custom () {\r\n        return <Category>Keyboard & Mouse</Category>\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Button\r\n          inScreen\r\n          onClick={() => {\r\n            showModal({ reactType: 'keybindings' })\r\n          }}\r\n        >Keybindings\r\n        </Button>\r\n      },\r\n      mouseSensX: {},\r\n      mouseSensY: {\r\n        min: -1,\r\n        valueText (value) {\r\n          return value === -1 ? 'Same as X' : `${value}`\r\n        },\r\n      },\r\n      mouseRawInput: {\r\n        tooltip: 'Wether to disable any mouse acceleration (MC does it by default). Most probably it is still supported only by Chrome.',\r\n        // eslint-disable-next-line no-extra-boolean-cast\r\n        disabledReason: Boolean(document.documentElement.requestPointerLock) ? undefined : 'Your browser does not support pointer lock.',\r\n      },\r\n      autoFullScreen: {\r\n        tooltip: 'Auto Fullscreen allows you to use Ctrl+W and Escape having to wait/click on screen again.',\r\n        disabledReason: navigator['keyboard'] ? undefined : 'Your browser doesn\\'t support keyboard lock API'\r\n      },\r\n      autoExitFullscreen: {\r\n        tooltip: 'Exit fullscreen on escape (pause menu open). But note you can always do it with F11.',\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Category>Touch Controls</Category>\r\n      },\r\n      alwaysShowMobileControls: {\r\n        text: 'Always Mobile Controls',\r\n      },\r\n      touchButtonsSize: {\r\n        min: 40,\r\n        disableIf: [\r\n          'touchMovementType',\r\n          'modern'\r\n        ],\r\n      },\r\n      touchButtonsOpacity: {\r\n        min: 10,\r\n        max: 90,\r\n        disableIf: [\r\n          'touchMovementType',\r\n          'modern'\r\n        ],\r\n      },\r\n      touchButtonsPosition: {\r\n        max: 80,\r\n        disableIf: [\r\n          'touchMovementType',\r\n          'modern'\r\n        ],\r\n      },\r\n      touchMovementType: {\r\n        text: 'Movement Controls',\r\n        values: [['modern', 'Modern'], ['classic', 'Classic']],\r\n      },\r\n      touchInteractionType: {\r\n        text: 'Interaction Controls',\r\n        values: [['classic', 'Classic'], ['buttons', 'Buttons']],\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        const { touchInteractionType, touchMovementType } = useSnapshot(options)\r\n        return <Button label='Setup Touch Buttons' onClick={() => showModal({ reactType: 'touch-buttons-setup' })} inScreen disabled={touchInteractionType === 'classic' && touchMovementType === 'classic'} />\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Category>Auto Jump</Category>\r\n      },\r\n      autoJump: {\r\n        values: [\r\n          'always',\r\n          'auto',\r\n          'never'\r\n        ],\r\n        disableIf: [\r\n          'autoParkour',\r\n          true\r\n        ],\r\n      },\r\n      autoParkour: {},\r\n    }\r\n  ],\r\n  sound: [\r\n    { volume: {} },\r\n    {\r\n      custom () {\r\n        return <Button label='Sound Muffler' onClick={() => showModal({ reactType: 'sound-muffler' })} inScreen />\r\n      },\r\n    }\r\n    // { ignoreSilentSwitch: {} },\r\n  ],\r\n\r\n  VR: [\r\n    {\r\n      custom () {\r\n        return (\r\n          <>\r\n            <span style={{ fontSize: 9, display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\r\n              VR currently has basic support\r\n            </span>\r\n            <div />\r\n          </>\r\n        )\r\n      },\r\n      vrSupport: {}\r\n    },\r\n  ],\r\n  advanced: [\r\n    {\r\n      custom () {\r\n        return <Button\r\n          inScreen\r\n          onClick={() => {\r\n            if (confirm('Are you sure you want to reset all settings?')) resetOptions()\r\n          }}\r\n        >Reset settings</Button>\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Button\r\n          inScreen\r\n          onClick={() => {\r\n            if (confirm('Are you sure you want to remove all data (settings, keybindings, servers, username, auth, proxies)?')) resetLocalStorage()\r\n          }}\r\n        >Remove all data</Button>\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Category>Developer</Category>\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        return <Button label='Export/Import...' onClick={() => openOptionsMenu('export-import')} inScreen />\r\n      }\r\n    },\r\n    {\r\n      custom () {\r\n        const { active } = useSnapshot(packetsRecordingState)\r\n        return <Button\r\n          inScreen\r\n          onClick={() => {\r\n            packetsRecordingState.active = !active\r\n          }}\r\n        >{active ? 'Stop' : 'Start'} Packets Replay Logging</Button>\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        const { active, hasRecordedPackets } = useSnapshot(packetsRecordingState)\r\n        return <Button\r\n          disabled={!hasRecordedPackets}\r\n          inScreen\r\n          onClick={() => {\r\n            void downloadPacketsReplay()\r\n          }}\r\n        >Download Packets Replay</Button>\r\n      },\r\n    },\r\n    {\r\n      packetsLoggerPreset: {\r\n        text: 'Packets Logger Preset',\r\n        values: [\r\n          ['all', 'All'],\r\n          ['no-buffers', 'No Buffers']\r\n        ],\r\n      },\r\n    },\r\n    {\r\n      custom () {\r\n        const { serversAutoVersionSelect } = useSnapshot(options)\r\n        const allVersions = [...[...supportedVersions].sort((a, b) => versionToNumber(a) - versionToNumber(b)), 'latest', 'auto']\r\n        const currentIndex = allVersions.indexOf(serversAutoVersionSelect)\r\n\r\n        const getDisplayValue = (version: string) => {\r\n          const versionAutoSelect = getVersionAutoSelect(version)\r\n          if (version === 'latest') return `latest (${versionAutoSelect})`\r\n          if (version === 'auto') return `auto (${versionAutoSelect})`\r\n          return version\r\n        }\r\n\r\n        return <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n          <Slider\r\n            style={{ width: 150 }}\r\n            label='Prefer Server Version'\r\n            value={currentIndex}\r\n            min={0}\r\n            max={allVersions.length - 1}\r\n            unit=''\r\n            valueDisplay={getDisplayValue(serversAutoVersionSelect)}\r\n            updateValue={(newVal) => {\r\n              options.serversAutoVersionSelect = allVersions[newVal]\r\n            }}\r\n          />\r\n        </div>\r\n      },\r\n    },\r\n  ],\r\n  'export-import': [\r\n    {\r\n      custom () {\r\n        return <Category>Export/Import Data</Category>\r\n      }\r\n    },\r\n    {\r\n      custom () {\r\n        return <Button\r\n          inScreen\r\n          disabled={true}\r\n          onClick={() => {}}\r\n        >Import Data</Button>\r\n      }\r\n    },\r\n    {\r\n      custom () {\r\n        return <Button\r\n          inScreen\r\n          onClick={async () => {\r\n            const data = await showInputsModal('Export Profile', {\r\n              profileName: {\r\n                type: 'text',\r\n              },\r\n              exportSettings: {\r\n                type: 'checkbox',\r\n                defaultValue: true,\r\n              },\r\n              exportKeybindings: {\r\n                type: 'checkbox',\r\n                defaultValue: true,\r\n              },\r\n              exportServers: {\r\n                type: 'checkbox',\r\n                defaultValue: true,\r\n              },\r\n              saveUsernameAndProxy: {\r\n                type: 'checkbox',\r\n                defaultValue: true,\r\n              },\r\n            })\r\n            const fileName = `${data.profileName ? `${data.profileName}-` : ''}web-client-profile.json`\r\n            const json = {\r\n              _about: 'Minecraft Web Client (mcraft.fun) Profile',\r\n              ...data.exportSettings ? {\r\n                options: getChangedSettings(),\r\n              } : {},\r\n              ...data.exportKeybindings ? {\r\n                keybindings: customKeymaps,\r\n              } : {},\r\n              ...data.exportServers ? {\r\n                servers: appStorage.serversList,\r\n              } : {},\r\n              ...data.saveUsernameAndProxy ? {\r\n                username: appStorage.username,\r\n                proxy: appStorage.proxiesData?.selected,\r\n              } : {},\r\n            }\r\n            const blob = new Blob([JSON.stringify(json, null, 2)], { type: 'application/json' })\r\n            const url = URL.createObjectURL(blob)\r\n            const a = document.createElement('a')\r\n            a.href = url\r\n            a.download = fileName\r\n            a.click()\r\n            URL.revokeObjectURL(url)\r\n          }}\r\n        >Export Data</Button>\r\n      }\r\n    },\r\n    {\r\n      custom () {\r\n        return <Button\r\n          inScreen\r\n          disabled\r\n        >Export Worlds</Button>\r\n      }\r\n    },\r\n    {\r\n      custom () {\r\n        return <Button\r\n          inScreen\r\n          disabled\r\n        >Export Resource Pack</Button>\r\n      }\r\n    }\r\n  ],\r\n}\r\nexport type OptionsGroupType = 'main' | 'render' | 'interface' | 'controls' | 'sound' | 'advanced' | 'VR' | 'export-import'\r\n\r\nconst Category = ({ children }) => <div style={{\r\n  fontSize: 9,\r\n  textAlign: 'center',\r\n  gridColumn: 'span 2'\r\n}}>{children}</div>\r\n\r\nconst UiToggleButton = ({ name, addUiText = false, label = noCase(name) }) => {\r\n  const { disabledUiParts } = useSnapshot(options)\r\n\r\n  const currentlyDisabled = disabledUiParts.includes(name)\r\n  if (addUiText) label = `${label} UI`\r\n  return <Button\r\n    inScreen\r\n    onClick={() => {\r\n      const newDisabledUiParts = currentlyDisabled ? disabledUiParts.filter(x => x !== name) : [...disabledUiParts, name]\r\n      options.disabledUiParts = newDisabledUiParts\r\n    }}\r\n  >{currentlyDisabled ? 'Enable' : 'Disable'} {label}</Button>\r\n}\r\n\r\nexport const tryFindOptionConfig = (option: keyof AppOptions) => {\r\n  for (const group of Object.values(guiOptionsScheme)) {\r\n    for (const optionConfig of group) {\r\n      if (option in optionConfig) {\r\n        return optionConfig[option]\r\n      }\r\n    }\r\n  }\r\n\r\n  return null\r\n}\r\n","import { proxy, subscribe } from 'valtio/vanilla'\r\nimport { subscribeKey } from 'valtio/utils'\r\nimport { omitObj } from '@zardoy/utils'\r\nimport { appQueryParamsArray } from './appParams'\r\nimport type { AppConfig } from './appConfig'\r\nimport { appStorage } from './react/appStorageProvider'\r\n\r\nconst isDev = process.env.NODE_ENV === 'development'\r\nconst initialAppConfig = process.env?.INLINED_APP_CONFIG as AppConfig ?? {}\r\nconst defaultOptions = {\r\n  renderDistance: 3,\r\n  keepChunksDistance: 1,\r\n  multiplayerRenderDistance: 3,\r\n  closeConfirmation: true,\r\n  autoFullScreen: false,\r\n  mouseRawInput: true,\r\n  autoExitFullscreen: false,\r\n  localUsername: 'wanderer',\r\n  mouseSensX: 50,\r\n  mouseSensY: -1,\r\n  chatWidth: 320,\r\n  chatHeight: 180,\r\n  chatScale: 100,\r\n  chatOpacity: 100,\r\n  chatOpacityOpened: 100,\r\n  messagesLimit: 200,\r\n  volume: 50,\r\n  enableMusic: false,\r\n  // fov: 70,\r\n  fov: 75,\r\n  guiScale: 3,\r\n  autoRequestCompletions: true,\r\n  touchButtonsSize: 40,\r\n  touchButtonsOpacity: 80,\r\n  touchButtonsPosition: 12,\r\n  touchControlsPositions: getDefaultTouchControlsPositions(),\r\n  touchMovementType: 'modern' as 'modern' | 'classic',\r\n  touchInteractionType: 'classic' as 'classic' | 'buttons',\r\n  gpuPreference: 'default' as 'default' | 'high-performance' | 'low-power',\r\n  backgroundRendering: '20fps' as 'full' | '20fps' | '5fps',\r\n  /** @unstable */\r\n  disableAssets: false,\r\n  /** @unstable */\r\n  debugLogNotFrequentPackets: false,\r\n  unimplementedContainers: false,\r\n  dayCycleAndLighting: true,\r\n  loadPlayerSkins: true,\r\n  renderEars: true,\r\n  lowMemoryMode: false,\r\n  starfieldRendering: true,\r\n  enabledResourcepack: null as string | null,\r\n  useVersionsTextures: 'latest',\r\n  serverResourcePacks: 'prompt' as 'prompt' | 'always' | 'never',\r\n  showHand: true,\r\n  viewBobbing: true,\r\n  displayRecordButton: true,\r\n  packetsLoggerPreset: 'all' as 'all' | 'no-buffers',\r\n  serversAutoVersionSelect: 'auto' as 'auto' | 'latest' | '1.20.4' | string,\r\n  customChannels: false,\r\n  packetsReplayAutoStart: false,\r\n  preciseMouseInput: false,\r\n  // todo ui setting, maybe enable by default?\r\n  waitForChunksRender: 'sp-only' as 'sp-only' | boolean,\r\n  jeiEnabled: true as boolean | Array<'creative' | 'survival' | 'adventure' | 'spectator'>,\r\n\r\n  // antiAliasing: false,\r\n\r\n  clipWorldBelowY: undefined as undefined | number, // will be removed\r\n  disableSignsMapsSupport: false,\r\n  singleplayerAutoSave: false,\r\n  showChunkBorders: false, // todo rename option\r\n  frameLimit: false as number | false,\r\n  alwaysBackupWorldBeforeLoading: undefined as boolean | undefined | null,\r\n  alwaysShowMobileControls: false,\r\n  excludeCommunicationDebugEvents: [],\r\n  preventDevReloadWhilePlaying: false,\r\n  numWorkers: 4,\r\n  localServerOptions: {\r\n    gameMode: 1\r\n  } as any,\r\n  preferLoadReadonly: false,\r\n  disableLoadPrompts: false,\r\n  guestUsername: 'guest',\r\n  askGuestName: true,\r\n  errorReporting: true,\r\n  /** Actually might be useful */\r\n  showCursorBlockInSpectator: false,\r\n  renderEntities: true,\r\n  smoothLighting: true,\r\n  newVersionsLighting: false,\r\n  chatSelect: true,\r\n  autoJump: 'auto' as 'auto' | 'always' | 'never',\r\n  autoParkour: false,\r\n  vrSupport: true, // doesn't directly affect the VR mode, should only disable the button which is annoying to android users\r\n  renderDebug: (isDev ? 'advanced' : 'basic') as 'none' | 'advanced' | 'basic',\r\n\r\n  // advanced bot options\r\n  autoRespawn: false,\r\n  mutedSounds: [] as string[],\r\n  plugins: [] as Array<{ enabled: boolean, name: string, description: string, script: string }>,\r\n  /** Wether to popup sign editor on server action */\r\n  autoSignEditor: true,\r\n  wysiwygSignEditor: 'auto' as 'auto' | 'always' | 'never',\r\n  showMinimap: 'never' as 'always' | 'singleplayer' | 'never',\r\n  minimapOptimizations: true,\r\n  displayBossBars: true,\r\n  disabledUiParts: [] as string[],\r\n  neighborChunkUpdates: true,\r\n  highlightBlockColor: 'auto' as 'auto' | 'blue' | 'classic',\r\n}\r\n\r\nfunction getDefaultTouchControlsPositions () {\r\n  return {\r\n    action: [\r\n      70,\r\n      76\r\n    ],\r\n    sneak: [\r\n      84,\r\n      76\r\n    ],\r\n    break: [\r\n      70,\r\n      60\r\n    ],\r\n    jump: [\r\n      84,\r\n      60\r\n    ],\r\n  } as Record<string, [number, number]>\r\n}\r\n\r\n// const qsOptionsRaw = new URLSearchParams(location.search).getAll('setting')\r\nconst qsOptionsRaw = appQueryParamsArray.setting ?? []\r\nexport const qsOptions = Object.fromEntries(qsOptionsRaw.map(o => {\r\n  const [key, value] = o.split(':')\r\n  return [key, JSON.parse(value)]\r\n}))\r\n\r\n// Track which settings are disabled (controlled by QS or forced by config)\r\nexport const disabledSettings = proxy({\r\n  value: new Set<string>(Object.keys(qsOptions))\r\n})\r\n\r\nconst migrateOptions = (options: Partial<AppOptions & Record<string, any>>) => {\r\n  if (options.highPerformanceGpu) {\r\n    options.gpuPreference = 'high-performance'\r\n    delete options.highPerformanceGpu\r\n  }\r\n  if (Object.keys(options.touchControlsPositions ?? {}).length === 0) {\r\n    options.touchControlsPositions = defaultOptions.touchControlsPositions\r\n  }\r\n  if (options.touchControlsPositions?.jump === undefined) {\r\n    options.touchControlsPositions!.jump = defaultOptions.touchControlsPositions.jump\r\n  }\r\n  if (options.touchControlsType === 'joystick-buttons') {\r\n    options.touchInteractionType = 'buttons'\r\n  }\r\n\r\n  return options\r\n}\r\n\r\nexport type AppOptions = typeof defaultOptions\r\n\r\nconst isDeepEqual = (a: any, b: any): boolean => {\r\n  if (a === b) return true\r\n  if (typeof a !== typeof b) return false\r\n  if (typeof a !== 'object') return false\r\n  if (a === null || b === null) return a === b\r\n  if (Array.isArray(a) && Array.isArray(b)) {\r\n    if (a.length !== b.length) return false\r\n    return a.every((item, index) => isDeepEqual(item, b[index]))\r\n  }\r\n  const keysA = Object.keys(a)\r\n  const keysB = Object.keys(b)\r\n  if (keysA.length !== keysB.length) return false\r\n  return keysA.every(key => isDeepEqual(a[key], b[key]))\r\n}\r\n\r\nexport const getChangedSettings = () => {\r\n  return Object.fromEntries(\r\n    Object.entries(options).filter(([key, value]) => !isDeepEqual(defaultOptions[key], value))\r\n  )\r\n}\r\n\r\nexport const options: AppOptions = proxy({\r\n  ...defaultOptions,\r\n  ...initialAppConfig.defaultSettings,\r\n  ...migrateOptions(appStorage.options),\r\n  ...qsOptions\r\n})\r\n\r\nwindow.options = window.settings = options\r\n\r\nexport const resetOptions = () => {\r\n  Object.assign(options, defaultOptions)\r\n}\r\n\r\nObject.defineProperty(window, 'debugChangedOptions', {\r\n  get () {\r\n    return getChangedSettings()\r\n  },\r\n})\r\n\r\nsubscribe(options, () => {\r\n  // Don't save disabled settings to localStorage\r\n  const saveOptions = omitObj(options, [...disabledSettings.value] as any)\r\n  appStorage.options = saveOptions\r\n})\r\n\r\ntype WatchValue = <T extends Record<string, any>>(proxy: T, callback: (p: T, isChanged: boolean) => void) => () => void\r\n\r\nexport const watchValue: WatchValue = (proxy, callback) => {\r\n  const watchedProps = new Set<string>()\r\n  callback(new Proxy(proxy, {\r\n    get (target, p, receiver) {\r\n      watchedProps.add(p.toString())\r\n      return Reflect.get(target, p, receiver)\r\n    },\r\n  }), false)\r\n  const unsubscribes = [] as Array<() => void>\r\n  for (const prop of watchedProps) {\r\n    unsubscribes.push(\r\n      subscribeKey(proxy, prop, () => {\r\n        callback(proxy, true)\r\n      })\r\n    )\r\n  }\r\n\r\n  return () => {\r\n    for (const unsubscribe of unsubscribes) {\r\n      unsubscribe()\r\n    }\r\n  }\r\n}\r\n\r\nwatchValue(options, o => {\r\n  globalThis.excludeCommunicationDebugEvents = o.excludeCommunicationDebugEvents\r\n})\r\n\r\nwatchValue(options, o => {\r\n  document.body.classList.toggle('disable-assets', o.disableAssets)\r\n})\r\nwatchValue(options, o => {\r\n  document.body.style.setProperty('--touch-movement-buttons-opacity', (o.touchButtonsOpacity / 100).toString())\r\n})\r\nwatchValue(options, o => {\r\n  document.body.style.setProperty('--touch-movement-buttons-position', (o.touchButtonsPosition * 2) + 'px')\r\n})\r\n\r\nexport const useOptionValue = (setting, valueCallback) => {\r\n  valueCallback(setting)\r\n  subscribe(setting, valueCallback)\r\n}\r\n","import { proxy } from 'valtio'\r\nimport { PacketsLogger } from 'mcraft-fun-mineflayer/build/packetsLogger'\r\nimport { options } from '../optionsStorage'\r\n\r\nexport const packetsRecordingState = proxy({\r\n  active: options.packetsReplayAutoStart,\r\n  hasRecordedPackets: false\r\n})\r\n\r\n// eslint-disable-next-line import/no-mutable-exports\r\nexport let replayLogger: PacketsLogger | undefined\r\n\r\nconst isBufferData = (data: any): boolean => {\r\n  if (Buffer.isBuffer(data) || data instanceof Uint8Array) return true\r\n  if (typeof data === 'object' && data !== null) {\r\n    return Object.values(data).some(value => isBufferData(value))\r\n  }\r\n  return false\r\n}\r\n\r\nconst processPacketData = (data: any): any => {\r\n  if (options.packetsLoggerPreset === 'no-buffers') {\r\n    if (Buffer.isBuffer(data)) {\r\n      return '[buffer]'\r\n    }\r\n    if (typeof data === 'object' && data !== null) {\r\n      const processed = {}\r\n      for (const [key, value] of Object.entries(data)) {\r\n        processed[key] = isBufferData(value) ? '[buffer]' : value\r\n      }\r\n      return processed\r\n    }\r\n  }\r\n  return data\r\n}\r\n\r\nexport default () => {\r\n  customEvents.on('mineflayerBotCreated', () => {\r\n    replayLogger = new PacketsLogger({ minecraftVersion: bot.version })\r\n    replayLogger.contents = ''\r\n    packetsRecordingState.hasRecordedPackets = false\r\n    const handleServerPacket = (data, { name, state = bot._client.state }) => {\r\n      if (!packetsRecordingState.active) {\r\n        return\r\n      }\r\n      replayLogger!.log(true, { name, state }, processPacketData(data))\r\n      packetsRecordingState.hasRecordedPackets = true\r\n    }\r\n    bot._client.on('packet', handleServerPacket)\r\n    bot._client.on('packet_name' as any, (name, data) => {\r\n      handleServerPacket(data, { name })\r\n    })\r\n\r\n    bot._client.on('writePacket' as any, (name, data) => {\r\n      if (!packetsRecordingState.active) {\r\n        return\r\n      }\r\n      replayLogger!.log(false, { name, state: bot._client.state }, processPacketData(data))\r\n      packetsRecordingState.hasRecordedPackets = true\r\n    })\r\n  })\r\n}\r\n\r\nexport const downloadPacketsReplay = async () => {\r\n  const a = document.createElement('a')\r\n  a.href = `data:text/plain;charset=utf-8,${encodeURIComponent(replayLogger!.contents)}`\r\n  a.download = `packets-replay-${new Date().toISOString()}.txt`\r\n  a.click()\r\n}\r\nglobalThis.downloadPacketsReplay = downloadPacketsReplay\r\n","/* eslint-disable no-await-in-loop */\r\nimport { createServer, ServerClient } from 'minecraft-protocol'\r\nimport { ParsedReplayPacket, parseReplayContents } from 'mcraft-fun-mineflayer/build/packetsLogger'\r\nimport { PACKETS_REPLAY_FILE_EXTENSION, WORLD_STATE_FILE_EXTENSION } from 'mcraft-fun-mineflayer/build/worldState'\r\nimport MinecraftData from 'minecraft-data'\r\nimport { GameMode } from 'mineflayer'\r\nimport { LocalServer } from '../customServer'\r\nimport { UserError } from '../mineflayer/userError'\r\nimport { packetsReplayState } from '../react/state/packetsReplayState'\r\nimport { getFixedFilesize } from '../react/simpleUtils'\r\nimport { appQueryParams } from '../appParams'\r\n\r\nconst SUPPORTED_FORMAT_VERSION = 1\r\n\r\ntype ReplayDefinition = {\r\n  minecraftVersion: string\r\n  replayAgainst?: 'client' | 'server'\r\n  serverIp?: string\r\n}\r\n\r\ninterface OpenFileOptions {\r\n  contents: string\r\n  filename?: string\r\n  filesize?: number\r\n}\r\n\r\nexport function openFile ({ contents, filename = 'unnamed', filesize }: OpenFileOptions) {\r\n  packetsReplayState.replayName = `${filename} (${getFixedFilesize(filesize ?? contents.length)})`\r\n  packetsReplayState.isPlaying = false\r\n\r\n  const connectOptions = {\r\n    worldStateFileContents: contents,\r\n    username: 'replay'\r\n  }\r\n  dispatchEvent(new CustomEvent('connect', { detail: connectOptions }))\r\n}\r\n\r\nexport const startLocalReplayServer = (contents: string) => {\r\n  const { packets, header } = parseReplayContents(contents)\r\n\r\n  packetsReplayState.packetsPlayback = []\r\n  packetsReplayState.isOpen = true\r\n  packetsReplayState.isPlaying = true\r\n  packetsReplayState.progress = {\r\n    current: 0,\r\n    total: packets.filter(packet => packet.isFromServer).length\r\n  }\r\n  packetsReplayState.speed = 1\r\n  packetsReplayState.replayName ||= `local ${getFixedFilesize(contents.length)}`\r\n  packetsReplayState.replayName = `${header.minecraftVersion} ${packetsReplayState.replayName}`\r\n\r\n  if ('formatVersion' in header && header.formatVersion !== SUPPORTED_FORMAT_VERSION) {\r\n    throw new UserError(`Unsupported format version: ${header.formatVersion}`)\r\n  }\r\n  if ('replayAgainst' in header && header.replayAgainst === 'server') {\r\n    throw new Error('not supported')\r\n  }\r\n\r\n  const server = createServer({\r\n    Server: LocalServer as any,\r\n    version: header.minecraftVersion,\r\n    'online-mode': false\r\n  })\r\n\r\n  const data = MinecraftData(header.minecraftVersion)\r\n  server.on(data.supportFeature('hasConfigurationState') ? 'playerJoin' : 'login' as any, async client => {\r\n    await mainPacketsReplayer(\r\n      client,\r\n      packets,\r\n      packetsReplayState.customButtons.validateClientPackets.state ? undefined : true\r\n    )\r\n  })\r\n\r\n  return {\r\n    server,\r\n    version: header.minecraftVersion\r\n  }\r\n}\r\n\r\n// time based packets\r\n// const FLATTEN_CLIENT_PACKETS = new Set(['position', 'position_look'])\r\nconst FLATTEN_CLIENT_PACKETS = new Set([] as string[])\r\n\r\nconst positions = {\r\n  client: 0,\r\n  server: 0\r\n}\r\nconst addPacketToReplayer = (name: string, data, isFromClient: boolean, wasUpcoming = false) => {\r\n  const side = isFromClient ? 'client' : 'server'\r\n\r\n  if (wasUpcoming) {\r\n    const lastUpcoming = packetsReplayState.packetsPlayback.find(p => p.isUpcoming && p.name === name)\r\n    if (lastUpcoming) {\r\n      lastUpcoming.isUpcoming = false\r\n    }\r\n  } else {\r\n    packetsReplayState.packetsPlayback.push({\r\n      name,\r\n      data,\r\n      isFromClient,\r\n      position: ++positions[side]!,\r\n      isUpcoming: false,\r\n      timestamp: Date.now()\r\n    })\r\n  }\r\n\r\n  if (!isFromClient && !wasUpcoming) {\r\n    packetsReplayState.progress.current++\r\n  }\r\n}\r\n\r\nconst IGNORE_SERVER_PACKETS = new Set([\r\n  'kick_disconnect',\r\n])\r\n\r\nconst ADDITIONAL_DELAY = 500\r\n\r\nconst mainPacketsReplayer = async (client: ServerClient, packets: ParsedReplayPacket[], ignoreClientPacketsWait: string[] | true = []) => {\r\n  const writePacket = (name: string, data: any) => {\r\n    data = restoreData(data)\r\n    client.write(name, data)\r\n  }\r\n\r\n  const playPackets = packets.filter(p => p.state === 'play')\r\n\r\n  let clientPackets = [] as Array<{ name: string, params: any }>\r\n  const clientsPacketsWaiter = createPacketsWaiter({\r\n    unexpectedPacketReceived (name, params) {\r\n      console.log('unexpectedPacketReceived', name, params)\r\n      addPacketToReplayer(name, params, true)\r\n    },\r\n    expectedPacketReceived (name, params) {\r\n      console.log('expectedPacketReceived', name, params)\r\n      addPacketToReplayer(name, params, true, true)\r\n    },\r\n    unexpectedPacketsLimit: 15,\r\n    onUnexpectedPacketsLimitReached () {\r\n      addPacketToReplayer('...', {}, true)\r\n    }\r\n  })\r\n\r\n  // Patch console.error to detect errors\r\n  const originalConsoleError = console.error\r\n  let lastSentPacket: { name: string, params: any } | null = null\r\n  console.error = (...args) => {\r\n    if (lastSentPacket) {\r\n      console.log('Got error after packet', lastSentPacket.name, lastSentPacket.params)\r\n    }\r\n    originalConsoleError.apply(console, args)\r\n    if (packetsReplayState.customButtons.stopOnError.state) {\r\n      packetsReplayState.isPlaying = false\r\n      throw new Error('Replay stopped due to error: ' + args.join(' '))\r\n    }\r\n  }\r\n\r\n  const playServerPacket = (name: string, params: any) => {\r\n    try {\r\n      writePacket(name, params)\r\n      addPacketToReplayer(name, params, false)\r\n      lastSentPacket = { name, params }\r\n    } catch (err) {\r\n      console.error('Error processing packet:', err)\r\n      if (packetsReplayState.customButtons.stopOnError.state) {\r\n        packetsReplayState.isPlaying = false\r\n      }\r\n    }\r\n  }\r\n\r\n  try {\r\n    bot.on('error', (err) => {\r\n      console.error('Mineflayer error:', err)\r\n    })\r\n\r\n    bot._client.on('writePacket' as any, (name, params) => {\r\n      clientsPacketsWaiter.addPacket(name, params)\r\n    })\r\n\r\n    console.log('start replaying!')\r\n    for (const [i, packet] of playPackets.entries()) {\r\n      if (!packetsReplayState.isPlaying) {\r\n        await new Promise<void>(resolve => {\r\n          const interval = setInterval(() => {\r\n            if (packetsReplayState.isPlaying) {\r\n              clearInterval(interval)\r\n              resolve()\r\n            }\r\n          }, 100)\r\n        })\r\n      }\r\n\r\n      if (packet.isFromServer) {\r\n        if (packet.params === null) {\r\n          console.warn('packet.params is null', packet)\r\n          continue\r\n        }\r\n        playServerPacket(packet.name, packet.params)\r\n        await new Promise(resolve => {\r\n          setTimeout(resolve, packet.diff * packetsReplayState.speed + ADDITIONAL_DELAY * (packetsReplayState.customButtons.packetsSenderDelay.state ? 1 : 0))\r\n        })\r\n      } else if (ignoreClientPacketsWait !== true && !ignoreClientPacketsWait.includes(packet.name)) {\r\n        clientPackets.push({ name: packet.name, params: packet.params })\r\n        if (playPackets[i + 1]?.isFromServer) {\r\n          // eslint-disable-next-line @typescript-eslint/no-loop-func\r\n          clientPackets = clientPackets.filter((p, index) => {\r\n            return !FLATTEN_CLIENT_PACKETS.has(p.name) || index === clientPackets.findIndex(clientPacket => clientPacket.name === p.name)\r\n          })\r\n          for (const packet of clientPackets) {\r\n            packetsReplayState.packetsPlayback.push({\r\n              name: packet.name,\r\n              data: packet.params,\r\n              isFromClient: true,\r\n              position: positions.client++,\r\n              timestamp: Date.now(),\r\n              isUpcoming: true,\r\n            })\r\n          }\r\n\r\n          await Promise.race([\r\n            clientsPacketsWaiter.waitForPackets(clientPackets.map(p => p.name)),\r\n            ...(packetsReplayState.customButtons.skipMissingOnTimeout.state ? [new Promise(resolve => {\r\n              setTimeout(resolve, 1000)\r\n            })] : [])\r\n          ])\r\n          clientsPacketsWaiter.stopWaiting()\r\n          clientPackets = []\r\n        }\r\n      }\r\n    }\r\n  } finally {\r\n    // Restore original console.error\r\n    console.error = originalConsoleError\r\n  }\r\n}\r\n\r\nexport const switchGameMode = (gameMode: GameMode) => {\r\n  const gamemodes = {\r\n    survival: 0,\r\n    creative: 1,\r\n    adventure: 2,\r\n    spectator: 3\r\n  }\r\n  if (gameMode === 'spectator') {\r\n    bot._client.emit('abilities', {\r\n    // can fly + is flying\r\n      flags: 6\r\n    })\r\n  }\r\n  bot._client.emit('game_state_change', {\r\n    reason: 3,\r\n    gameMode: gamemodes[gameMode]\r\n  })\r\n}\r\n\r\ninterface PacketsWaiterOptions {\r\n  unexpectedPacketReceived?: (name: string, params: any) => void\r\n  expectedPacketReceived?: (name: string, params: any) => void\r\n  onUnexpectedPacketsLimitReached?: () => void\r\n  unexpectedPacketsLimit?: number\r\n}\r\n\r\ninterface PacketsWaiter {\r\n  addPacket(name: string, params: any): void\r\n  waitForPackets(packets: string[]): Promise<void>\r\n  stopWaiting(): void\r\n}\r\n\r\nconst createPacketsWaiter = (options: PacketsWaiterOptions = {}): PacketsWaiter => {\r\n  let packetHandler: ((data: any, name: string) => void) | null = null\r\n  const queuedPackets: Array<{ name: string, params: any }> = []\r\n  let isWaiting = false\r\n  let unexpectedPacketsCount = 0\r\n  const handlePacket = (data: any, name: string, waitingPackets: string[], resolve: () => void) => {\r\n    if (waitingPackets.includes(name)) {\r\n      waitingPackets.splice(waitingPackets.indexOf(name), 1)\r\n      options.expectedPacketReceived?.(name, data)\r\n    } else {\r\n      if (options.unexpectedPacketsLimit && unexpectedPacketsCount < options.unexpectedPacketsLimit) {\r\n        options.unexpectedPacketReceived?.(name, data)\r\n      }\r\n      if (options.onUnexpectedPacketsLimitReached && unexpectedPacketsCount === options.unexpectedPacketsLimit) {\r\n        options.onUnexpectedPacketsLimitReached?.()\r\n      }\r\n      unexpectedPacketsCount++\r\n    }\r\n\r\n    if (waitingPackets.length === 0) {\r\n      resolve()\r\n    }\r\n  }\r\n\r\n  return {\r\n    addPacket (name: string, params: any) {\r\n      if (packetHandler) {\r\n        packetHandler(params, name)\r\n      } else {\r\n        queuedPackets.push({ name, params })\r\n      }\r\n    },\r\n\r\n    async waitForPackets (packets: string[]) {\r\n      if (isWaiting) {\r\n        throw new Error('Already waiting for packets')\r\n      }\r\n      unexpectedPacketsCount = 0\r\n      isWaiting = true\r\n\r\n      try {\r\n        await new Promise<void>(resolve => {\r\n          const waitingPackets = [...packets]\r\n\r\n          packetHandler = (data: any, name: string) => {\r\n            handlePacket(data, name, waitingPackets, resolve)\r\n          }\r\n\r\n          // Process any queued packets\r\n          for (const packet of queuedPackets) {\r\n            handlePacket(packet.params, packet.name, waitingPackets, resolve)\r\n          }\r\n          queuedPackets.length = 0\r\n        })\r\n      } finally {\r\n        isWaiting = false\r\n        packetHandler = null\r\n      }\r\n    },\r\n    stopWaiting () {\r\n      isWaiting = false\r\n      packetHandler = null\r\n      queuedPackets.length = 0\r\n    }\r\n  }\r\n}\r\n\r\nconst isArrayEqual = (a: any[], b: any[]) => {\r\n  if (a.length !== b.length) return false\r\n  for (const [i, element] of a.entries()) {\r\n    if (element !== b[i]) return false\r\n  }\r\n  return true\r\n}\r\n\r\nconst restoreData = (json: any) => {\r\n  if (!json) return json\r\n  const keys = Object.keys(json)\r\n\r\n  if (isArrayEqual(keys.sort(), ['data', 'type'].sort())) {\r\n    if (json.type === 'Buffer') {\r\n      return Buffer.from(json.data)\r\n    }\r\n  }\r\n\r\n  if (typeof json === 'object' && json) {\r\n    for (const [key, value] of Object.entries(json)) {\r\n      if (typeof value === 'object') {\r\n        json[key] = restoreData(value)\r\n      }\r\n    }\r\n  }\r\n\r\n  return json\r\n}\r\n\r\nexport const VALID_REPLAY_EXTENSIONS = [`.${PACKETS_REPLAY_FILE_EXTENSION}`, `.${WORLD_STATE_FILE_EXTENSION}`]\r\n","//@ts-check\r\n\r\nimport { join } from 'path'\r\nimport * as THREE from 'three'\r\nimport { EntityMesh } from 'renderer/viewer/lib/entity/EntityMesh'\r\nimport { WorldDataEmitter } from 'renderer/viewer'\r\nimport { Vec3 } from 'vec3'\r\nimport { getSyncWorld } from 'renderer/playground/shared'\r\nimport * as tweenJs from '@tweenjs/tween.js'\r\nimport { subscribeKey } from 'valtio/utils'\r\nimport { options } from './optionsStorage'\r\nimport { miscUiState } from './globalState'\r\nimport { loadMinecraftData } from './connect'\r\n\r\nlet panoramaCubeMap\r\nlet shouldDisplayPanorama = true\r\n\r\nconst panoramaFiles = [\r\n  'panorama_3.png', // right (+x)\r\n  'panorama_1.png', // left (-x)\r\n  'panorama_4.png', // top (+y)\r\n  'panorama_5.png', // bottom (-y)\r\n  'panorama_0.png', // front (+z)\r\n  'panorama_2.png', // back (-z)\r\n]\r\n\r\nlet unloadPanoramaCallbacks = [] as Array<() => void>\r\n\r\n// Menu panorama background\r\n// TODO-low use abort controller\r\nexport async function addPanoramaCubeMap () {\r\n  if (panoramaCubeMap || miscUiState.loadedDataVersion || options.disableAssets) return\r\n  await new Promise(resolve => {\r\n    setTimeout(resolve, 0) // wait for viewer to be initialized\r\n  })\r\n  viewer.camera.fov = 85\r\n  if (!shouldDisplayPanorama) return\r\n  if (process.env.SINGLE_FILE_BUILD_MODE) {\r\n    void initDemoWorld()\r\n    return\r\n  }\r\n\r\n  let time = 0\r\n  viewer.camera.near = 0.05\r\n  viewer.camera.updateProjectionMatrix()\r\n  viewer.camera.position.set(0, 0, 0)\r\n  viewer.camera.rotation.set(0, 0, 0)\r\n  const panorGeo = new THREE.BoxGeometry(1000, 1000, 1000)\r\n\r\n  const loader = new THREE.TextureLoader()\r\n  const panorMaterials = [] as THREE.MeshBasicMaterial[]\r\n  for (const file of panoramaFiles) {\r\n    const texture = loader.load(join('background', file))\r\n\r\n    // Instead of using repeat/offset to flip, we'll use the texture matrix\r\n    texture.matrixAutoUpdate = false\r\n    texture.matrix.set(\r\n      -1, 0, 1, 0, 1, 0, 0, 0, 1\r\n    )\r\n\r\n    texture.wrapS = THREE.ClampToEdgeWrapping // Changed from RepeatWrapping\r\n    texture.wrapT = THREE.ClampToEdgeWrapping // Changed from RepeatWrapping\r\n    texture.minFilter = THREE.LinearFilter\r\n    texture.magFilter = THREE.LinearFilter\r\n\r\n    panorMaterials.push(new THREE.MeshBasicMaterial({\r\n      map: texture,\r\n      transparent: true,\r\n      side: THREE.DoubleSide,\r\n      depthWrite: false\r\n    }))\r\n  }\r\n\r\n  if (!shouldDisplayPanorama) return\r\n\r\n  const panoramaBox = new THREE.Mesh(panorGeo, panorMaterials)\r\n\r\n  panoramaBox.onBeforeRender = () => {\r\n    time += 0.01\r\n    panoramaBox.rotation.y = Math.PI + time * 0.01\r\n    panoramaBox.rotation.z = Math.sin(-time * 0.001) * 0.001\r\n  }\r\n\r\n  const group = new THREE.Object3D()\r\n  group.add(panoramaBox)\r\n\r\n  // should be rewritten entirely\r\n  for (let i = 0; i < 20; i++) {\r\n    const m = new EntityMesh('1.16.4', 'squid', viewer.world).mesh\r\n    m.position.set(Math.random() * 30 - 15, Math.random() * 20 - 10, Math.random() * 10 - 17)\r\n    m.rotation.set(0, Math.PI + Math.random(), -Math.PI / 4, 'ZYX')\r\n    const v = Math.random() * 0.01\r\n    m.children[0].onBeforeRender = () => {\r\n      m.rotation.y += v\r\n      m.rotation.z = Math.cos(panoramaBox.rotation.y * 3) * Math.PI / 4 - Math.PI / 2\r\n    }\r\n    group.add(m)\r\n  }\r\n\r\n  viewer.scene.add(group)\r\n  panoramaCubeMap = group\r\n}\r\n\r\nif (process.env.SINGLE_FILE_BUILD_MODE) {\r\n  subscribeKey(miscUiState, 'fsReady', () => {\r\n    if (miscUiState.fsReady) {\r\n      // don't do it earlier to load fs and display menu faster\r\n      void addPanoramaCubeMap()\r\n    }\r\n  })\r\n} else {\r\n  void addPanoramaCubeMap()\r\n}\r\n\r\nexport function removePanorama () {\r\n  for (const unloadPanoramaCallback of unloadPanoramaCallbacks) {\r\n    unloadPanoramaCallback()\r\n  }\r\n  unloadPanoramaCallbacks = []\r\n  viewer.camera.fov = options.fov\r\n  shouldDisplayPanorama = false\r\n  if (!panoramaCubeMap) return\r\n  viewer.camera.near = 0.1\r\n  viewer.camera.updateProjectionMatrix()\r\n  viewer.scene.remove(panoramaCubeMap)\r\n  panoramaCubeMap = null\r\n}\r\n\r\nconst initDemoWorld = async () => {\r\n  const abortController = new AbortController()\r\n  unloadPanoramaCallbacks.push(() => {\r\n    abortController.abort()\r\n  })\r\n  const version = '1.21.4'\r\n  console.time(`load ${version} mc-data`)\r\n  await loadMinecraftData(version, true)\r\n  console.timeEnd(`load ${version} mc-data`)\r\n  if (abortController.signal.aborted) return\r\n  console.time('load scene')\r\n  const world = getSyncWorld(version)\r\n  const PrismarineBlock = require('prismarine-block')\r\n  const Block = PrismarineBlock(version)\r\n  const fullBlocks = loadedData.blocksArray.filter(block => {\r\n    // if (block.name.includes('leaves')) return false\r\n    if (/* !block.name.includes('wool') &&  */!block.name.includes('stained_glass')/*  && !block.name.includes('terracotta') */) return false\r\n    const b = Block.fromStateId(block.defaultState, 0)\r\n    if (b.shapes?.length !== 1) return false\r\n    const shape = b.shapes[0]\r\n    return shape[0] === 0 && shape[1] === 0 && shape[2] === 0 && shape[3] === 1 && shape[4] === 1 && shape[5] === 1\r\n  })\r\n  const Z = -15\r\n  const sizeX = 100\r\n  const sizeY = 100\r\n  for (let x = -sizeX; x < sizeX; x++) {\r\n    for (let y = -sizeY; y < sizeY; y++) {\r\n      const block = fullBlocks[Math.floor(Math.random() * fullBlocks.length)]\r\n      world.setBlockStateId(new Vec3(x, y, Z), block.defaultState)\r\n    }\r\n  }\r\n  viewer.camera.updateProjectionMatrix()\r\n  viewer.camera.position.set(0.5, sizeY / 2 + 0.5, 0.5)\r\n  viewer.camera.rotation.set(0, 0, 0)\r\n  const initPos = new Vec3(...viewer.camera.position.toArray())\r\n  const worldView = new WorldDataEmitter(world, 2, initPos)\r\n  // worldView.addWaitTime = 0\r\n  await viewer.world.setVersion(version)\r\n  if (abortController.signal.aborted) return\r\n  viewer.connect(worldView)\r\n  void worldView.init(initPos)\r\n  await viewer.world.waitForChunksToRender()\r\n  if (abortController.signal.aborted) return\r\n  // add small camera rotation to side on mouse move depending on absolute position of the cursor\r\n  const { camera } = viewer\r\n  const initX = camera.position.x\r\n  const initY = camera.position.y\r\n  let prevTwin: tweenJs.Tween<THREE.Vector3> | undefined\r\n  document.body.addEventListener('pointermove', (e) => {\r\n    if (e.pointerType !== 'mouse') return\r\n    const pos = new THREE.Vector2(e.clientX, e.clientY)\r\n    const SCALE = 0.2\r\n    /* -0.5 - 0.5 */\r\n    const xRel = pos.x / window.innerWidth - 0.5\r\n    const yRel = -(pos.y / window.innerHeight - 0.5)\r\n    prevTwin?.stop()\r\n    const to = {\r\n      x: initX + (xRel * SCALE),\r\n      y: initY + (yRel * SCALE)\r\n    }\r\n    prevTwin = new tweenJs.Tween(camera.position).to(to, 0) // todo use the number depending on diff // todo use the number depending on diff\r\n    // prevTwin.easing(tweenJs.Easing.Exponential.InOut)\r\n    prevTwin.start()\r\n    camera.updateProjectionMatrix()\r\n  }, {\r\n    signal: abortController.signal\r\n  })\r\n\r\n  console.timeEnd('load scene')\r\n}\r\n","\r\n\r\nexport const parseServerAddress = (address: string | undefined, removeHttp = true): ParsedServerAddress => {\r\n  if (!address) {\r\n    return { host: '', isWebSocket: false, serverIpFull: '' }\r\n  }\r\n\r\n  if (/^ws:[^/]/.test(address)) address = address.replace('ws:', 'ws://')\r\n  if (/^wss:[^/]/.test(address)) address = address.replace('wss:', 'wss://')\r\n  const isWebSocket = address.startsWith('ws://') || address.startsWith('wss://')\r\n  if (isWebSocket) {\r\n    return { host: address, isWebSocket: true, serverIpFull: address }\r\n  }\r\n\r\n  if (removeHttp) {\r\n    address = address.replace(/^https?:\\/\\//, '')\r\n  }\r\n\r\n  const parts = address.split(':')\r\n\r\n  let version: string | null = null\r\n  let port: string | null = null\r\n\r\n  for (let i = 0; i < parts.length; i++) {\r\n    const part = parts[i]\r\n    if (/^\\d+\\.\\d+(\\.\\d+)?$/.test(part)) {\r\n      version = part\r\n      parts.splice(i, 1)\r\n      i--\r\n    }\r\n    if (/^\\d+$/.test(part)) {\r\n      port = part\r\n      parts.splice(i, 1)\r\n      i--\r\n    }\r\n  }\r\n\r\n  const host = parts.join(':')\r\n  return {\r\n    host,\r\n    ...(port ? { port } : {}),\r\n    ...(version ? { version } : {}),\r\n    isWebSocket: false,\r\n    serverIpFull: port ? `${host}:${port}` : host\r\n  }\r\n}\r\n\r\nexport interface ParsedServerAddress {\r\n  host: string\r\n  port?: string\r\n  version?: string\r\n  isWebSocket: boolean\r\n  serverIpFull: string\r\n}\r\n","import React, { useEffect } from 'react'\r\nimport { appQueryParams } from '../appParams'\r\nimport { fetchServerStatus, isServerValid } from '../api/mcStatusApi'\r\nimport { parseServerAddress } from '../parseServerAddress'\r\nimport Screen from './Screen'\r\nimport Input, { INPUT_LABEL_WIDTH, InputWithLabel } from './Input'\r\nimport Button from './Button'\r\nimport SelectGameVersion from './SelectGameVersion'\r\nimport { usePassesScaledDimensions } from './UIProvider'\r\n\r\nexport interface BaseServerInfo {\r\n  ip: string\r\n  name?: string\r\n  versionOverride?: string\r\n  proxyOverride?: string\r\n  usernameOverride?: string\r\n  /** Username or always use new if true */\r\n  authenticatedAccountOverride?: string | true\r\n}\r\n\r\ninterface Props {\r\n  onBack: () => void\r\n  onConfirm: (info: BaseServerInfo) => void\r\n  title?: string\r\n  initialData?: BaseServerInfo\r\n  parseQs?: boolean\r\n  onQsConnect?: (server: BaseServerInfo) => void\r\n  placeholders?: Pick<BaseServerInfo, 'proxyOverride' | 'usernameOverride'>\r\n  accounts?: string[]\r\n  authenticatedAccounts?: number\r\n  versions?: string[]\r\n  allowAutoConnect?: boolean\r\n}\r\n\r\nexport default ({ onBack, onConfirm, title = 'Add a Server', initialData, parseQs, onQsConnect, placeholders, accounts, versions, allowAutoConnect }: Props) => {\r\n  const isSmallHeight = !usePassesScaledDimensions(null, 350)\r\n  const qsParamName = parseQs ? appQueryParams.name : undefined\r\n  const qsParamIp = parseQs ? appQueryParams.ip : undefined\r\n  const qsParamVersion = parseQs ? appQueryParams.version : undefined\r\n  const qsParamProxy = parseQs ? appQueryParams.proxy : undefined\r\n  const qsParamUsername = parseQs ? appQueryParams.username : undefined\r\n  const qsParamLockConnect = parseQs ? appQueryParams.lockConnect : undefined\r\n  const qsParamAutoConnect = parseQs ? appQueryParams.autoConnect : undefined\r\n\r\n  const parsedQsIp = parseServerAddress(qsParamIp)\r\n  const parsedInitialIp = parseServerAddress(initialData?.ip)\r\n\r\n  const [serverName, setServerName] = React.useState(initialData?.name ?? qsParamName ?? '')\r\n  const [serverIp, setServerIp] = React.useState(parsedQsIp.host || parsedInitialIp.host || '')\r\n  const [serverPort, setServerPort] = React.useState(parsedQsIp.port || parsedInitialIp.port || '')\r\n  const [versionOverride, setVersionOverride] = React.useState(initialData?.versionOverride ?? /* legacy */ initialData?.['version'] ?? qsParamVersion ?? '')\r\n  const [proxyOverride, setProxyOverride] = React.useState(initialData?.proxyOverride ?? qsParamProxy ?? '')\r\n  const [usernameOverride, setUsernameOverride] = React.useState(initialData?.usernameOverride ?? qsParamUsername ?? '')\r\n  const lockConnect = qsParamLockConnect === 'true'\r\n\r\n  const smallWidth = !usePassesScaledDimensions(400)\r\n  const initialAccount = initialData?.authenticatedAccountOverride\r\n  const [accountIndex, setAccountIndex] = React.useState(initialAccount === true ? -2 : initialAccount ? (accounts?.includes(initialAccount) ? accounts.indexOf(initialAccount) : -2) : -1)\r\n\r\n  const freshAccount = accountIndex === -2\r\n  const noAccountSelected = accountIndex === -1\r\n  const authenticatedAccountOverride = noAccountSelected ? undefined : freshAccount ? true : accounts?.[accountIndex]\r\n\r\n  let ipFinal = serverIp.includes(':') ? serverIp : `${serverIp}${serverPort ? `:${serverPort}` : ''}`\r\n  ipFinal = ipFinal.replace(/:$/, '')\r\n  const commonUseOptions: BaseServerInfo = {\r\n    name: serverName,\r\n    ip: ipFinal,\r\n    versionOverride: versionOverride || undefined,\r\n    proxyOverride: proxyOverride || undefined,\r\n    usernameOverride: usernameOverride || undefined,\r\n    authenticatedAccountOverride,\r\n  }\r\n\r\n  const [fetchedServerInfoIp, setFetchedServerInfoIp] = React.useState<string | undefined>(undefined)\r\n  const [serverOnline, setServerOnline] = React.useState(null as boolean | null)\r\n  const [onlinePlayersList, setOnlinePlayersList] = React.useState<string[]>([])\r\n\r\n  useEffect(() => {\r\n    const controller = new AbortController()\r\n\r\n    const checkServer = async () => {\r\n      if (!qsParamIp || !isServerValid(qsParamIp)) return\r\n\r\n      try {\r\n        const status = await fetchServerStatus(qsParamIp)\r\n        if (!status) return\r\n\r\n        setServerOnline(status.raw.online)\r\n        setOnlinePlayersList(status.raw.players?.list.map(p => p.name_raw) ?? [])\r\n        setFetchedServerInfoIp(qsParamIp)\r\n      } catch (err) {\r\n        console.error('Failed to fetch server status:', err)\r\n      }\r\n    }\r\n\r\n    void checkServer()\r\n    return () => controller.abort()\r\n  }, [qsParamIp])\r\n\r\n  const validateUsername = (username: string) => {\r\n    if (!username) return undefined\r\n    if (onlinePlayersList.includes(username)) {\r\n      return { border: 'red solid 1px' }\r\n    }\r\n    const MINECRAFT_USERNAME_REGEX = /^\\w{3,16}$/\r\n    if (!MINECRAFT_USERNAME_REGEX.test(username)) {\r\n      return { border: 'red solid 1px' }\r\n    }\r\n    return undefined\r\n  }\r\n\r\n  const validateServerIp = () => {\r\n    if (!serverIp) return undefined\r\n    if (serverOnline) {\r\n      return { border: 'lightgreen solid 1px' }\r\n    } else {\r\n      return { border: 'red solid 1px' }\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (qsParamAutoConnect && qsParamIp && qsParamVersion && allowAutoConnect) {\r\n      onQsConnect?.(commonUseOptions)\r\n    }\r\n  }, [])\r\n\r\n  const displayConnectButton = qsParamIp\r\n\r\n  return <Screen title={qsParamIp ? 'Connect to Server' : title} backdrop>\r\n    <form\r\n      style={{\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        height: '100%'\r\n      }}\r\n      onSubmit={(e) => {\r\n        e.preventDefault()\r\n        onConfirm(commonUseOptions)\r\n      }}\r\n    >\r\n      <div style={{\r\n        display: smallWidth ? 'flex' : 'grid',\r\n        gap: 3,\r\n        ...(smallWidth ? {\r\n          flexDirection: 'column',\r\n        } : {\r\n          gridTemplateColumns: '1fr 1fr'\r\n        })\r\n      }}\r\n      >\r\n        {!lockConnect && <>\r\n          <div style={{ gridColumn: smallWidth ? '' : 'span 2', display: 'flex', justifyContent: 'center' }}>\r\n            <InputWithLabel label=\"Server Name\" value={serverName} onChange={({ target: { value } }) => setServerName(value)} placeholder='Defaults to IP' />\r\n          </div>\r\n        </>}\r\n        <InputWithLabel\r\n          required\r\n          label=\"Server IP\"\r\n          autoFocus={!lockConnect}\r\n          value={serverIp}\r\n          disabled={lockConnect && parsedQsIp.host !== null}\r\n          onChange={({ target: { value } }) => {\r\n            setServerIp(value)\r\n            setServerOnline(false)\r\n          }}\r\n          validateInput={serverOnline === null || fetchedServerInfoIp !== serverIp ? undefined : validateServerIp}\r\n        />\r\n        <InputWithLabel label=\"Server Port\" value={serverPort} disabled={lockConnect && parsedQsIp.port !== null} onChange={({ target: { value } }) => setServerPort(value)} placeholder={serverIp.startsWith('ws://') || serverIp.startsWith('wss://') ? '' : '25565'} />\r\n        {isSmallHeight ? <div style={{ gridColumn: 'span 2', marginTop: 10, }} /> : <div style={{ gridColumn: smallWidth ? '' : 'span 2' }}>Overrides:</div>}\r\n        <div style={{\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n        }}>\r\n          <label style={{ fontSize: 12, marginBottom: 1, color: 'lightgray' }}>Version Override</label>\r\n          <SelectGameVersion\r\n            selected={{ value: versionOverride, label: versionOverride }}\r\n            versions={versions?.map(v => { return { value: v, label: v } }) ?? []}\r\n            onChange={(value) => {\r\n              setVersionOverride(value)\r\n            }}\r\n            placeholder=\"Optional, but recommended to specify\"\r\n            disabled={lockConnect}\r\n          />\r\n        </div>\r\n\r\n        <InputWithLabel\r\n          label=\"Proxy Override\"\r\n          value={proxyOverride}\r\n          disabled={lockConnect && (qsParamProxy !== null || !!placeholders?.proxyOverride) || serverIp.startsWith('ws://') || serverIp.startsWith('wss://')}\r\n          onChange={({ target: { value } }) => setProxyOverride(value)}\r\n          placeholder={serverIp.startsWith('ws://') || serverIp.startsWith('wss://') ? 'Not needed for websocket servers' : placeholders?.proxyOverride}\r\n        />\r\n        <InputWithLabel\r\n          label=\"Username Override\"\r\n          value={usernameOverride}\r\n          disabled={!noAccountSelected || (lockConnect && qsParamUsername !== null)}\r\n          onChange={({ target: { value } }) => setUsernameOverride(value)}\r\n          placeholder={placeholders?.usernameOverride}\r\n          validateInput={!serverOnline || fetchedServerInfoIp !== serverIp ? undefined : validateUsername}\r\n        />\r\n        <label style={{\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n        }}\r\n        >\r\n          <span style={{ fontSize: 12, marginBottom: 1, color: 'lightgray' }}>Account Override</span>\r\n          <select\r\n            onChange={({ target: { value } }) => setAccountIndex(Number(value))}\r\n            style={{\r\n              background: 'gray',\r\n              color: 'white',\r\n              height: 20,\r\n              fontSize: 13,\r\n            }}\r\n            defaultValue={initialAccount === true ? -2 : initialAccount === undefined ? -1 : (fallbackIfNotFound((accounts ?? []).indexOf(initialAccount)) ?? -2)}\r\n            disabled={lockConnect && qsParamUsername !== null}\r\n          >\r\n            <option value={-1}>Offline Account (Username)</option>\r\n            {accounts?.map((account, i) => <option key={i} value={i}>{account} (Logged In)</option>)}\r\n            <option value={-2}>Any other MS account</option>\r\n          </select>\r\n        </label>\r\n\r\n        {!lockConnect && <>\r\n          <ButtonWrapper onClick={() => {\r\n            onBack()\r\n          }}>\r\n            Cancel\r\n          </ButtonWrapper>\r\n          <ButtonWrapper type='submit'>\r\n            {displayConnectButton ? 'Save' : <strong>Save</strong>}\r\n          </ButtonWrapper>\r\n        </>}\r\n        {displayConnectButton && (\r\n          <div style={{\r\n            gridColumn: smallWidth ? '' : 'span 2',\r\n            display: 'flex',\r\n            justifyContent: 'center'\r\n          }}>\r\n            <ButtonWrapper\r\n              data-test-id='connect-qs'\r\n              onClick={() => {\r\n                onQsConnect?.(commonUseOptions)\r\n              }}\r\n            >\r\n              <strong>Connect</strong>\r\n            </ButtonWrapper>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </form>\r\n  </Screen>\r\n}\r\n\r\nconst ButtonWrapper = ({ ...props }: React.ComponentProps<typeof Button>) => {\r\n  props.style ??= {}\r\n  props.style.width = INPUT_LABEL_WIDTH\r\n  return <Button {...props} />\r\n}\r\n\r\nconst fallbackIfNotFound = (index: number) => (index === -1 ? undefined : index)\r\n","import { useEffect, useState } from 'react'\r\nimport { appQueryParams } from '../appParams'\r\nimport styles from './appStatus.module.css'\r\nimport Button from './Button'\r\nimport Screen from './Screen'\r\nimport LoadingChunks from './LoadingChunks'\r\n\r\nexport default ({\r\n  status,\r\n  isError,\r\n  hideDots = false,\r\n  lastStatus = '',\r\n  backAction = undefined as undefined | (() => void),\r\n  description = '' as string | JSX.Element,\r\n  actionsSlot = null as React.ReactNode | null,\r\n  showReconnect = false,\r\n  onReconnect = undefined as undefined | (() => void),\r\n  children\r\n}) => {\r\n  const [loadingDotIndex, setLoadingDotIndex] = useState(0)\r\n  const lockConnect = appQueryParams.lockConnect === 'true'\r\n\r\n  useEffect(() => {\r\n    const statusRunner = async () => {\r\n      const timer = async (ms) => new Promise((resolve) => { setTimeout(resolve, ms) })\r\n\r\n      const load = async () => {\r\n        // eslint-disable-next-line no-constant-condition\r\n        while (true) {\r\n          setLoadingDotIndex(i => (i + 1) % 4)\r\n          await timer(500) // eslint-disable-line no-await-in-loop\r\n        }\r\n      }\r\n\r\n      void load()\r\n    }\r\n\r\n    void statusRunner()\r\n  }, [])\r\n\r\n\r\n  return (\r\n    <Screen\r\n      className='small-content'\r\n      titleSelectable={isError}\r\n      title={\r\n        <>\r\n          <span style={{\r\n            wordBreak: 'break-word',\r\n          }}\r\n          >\r\n            {status}\r\n          </span>\r\n          <div style={{ display: 'inline-flex', gap: '1px', }} hidden={hideDots || isError}>\r\n            {\r\n              [...'...'].map((dot, i) => {\r\n                return <span\r\n                  key={i} style={{\r\n                    visibility: loadingDotIndex <= i ? 'hidden' : 'visible',\r\n                  }}>{dot}</span>\r\n              })\r\n            }\r\n          </div>\r\n          <p className={styles.description}>{description}</p>\r\n          <p className={styles['last-status']}>{lastStatus ? `Last status: ${lastStatus}` : lastStatus}</p>\r\n        </>\r\n      }\r\n      backdrop='dirt'\r\n    >\r\n      {isError && (\r\n        <>\r\n          {showReconnect && onReconnect && <Button onClick={onReconnect}>\r\n            <b>Reconnect</b>\r\n          </Button>}\r\n          {actionsSlot}\r\n          <Button\r\n            onClick={() => {\r\n              if (location.search) {\r\n                location.search = ''\r\n              } else {\r\n                window.location.reload()\r\n              }\r\n            }}\r\n          >\r\n            <b>Reset App (recommended)</b>\r\n          </Button>\r\n          {!lockConnect && backAction && <Button label=\"Back\" onClick={backAction} />}\r\n        </>\r\n      )}\r\n      {children}\r\n    </Screen>\r\n  )\r\n}\r\n","import { proxy, useSnapshot } from 'valtio'\r\nimport { useEffect, useRef, useState } from 'react'\r\nimport { activeModalStack, activeModalStacks, hideModal, insertActiveModalStack, miscUiState } from '../globalState'\r\nimport { guessProblem } from '../errorLoadingScreenHelpers'\r\nimport type { ConnectOptions } from '../connect'\r\nimport { downloadPacketsReplay, packetsRecordingState, replayLogger } from '../packetsReplay/packetsReplayLegacy'\r\nimport { getProxyDetails } from '../microsoftAuthflow'\r\nimport { downloadAutoCapturedPackets, getLastAutoCapturedPackets } from '../mineflayer/plugins/packetsRecording'\r\nimport AppStatus from './AppStatus'\r\nimport DiveTransition from './DiveTransition'\r\nimport { useDidUpdateEffect } from './utils'\r\nimport { useIsModalActive } from './utilsApp'\r\nimport Button from './Button'\r\nimport { updateAuthenticatedAccountData, updateLoadedServerData, AuthenticatedAccount } from './serversStorage'\r\nimport { showOptionsModal } from './SelectOption'\r\nimport LoadingChunks from './LoadingChunks'\r\nimport MessageFormattedString from './MessageFormattedString'\r\n\r\nconst initialState = {\r\n  status: '',\r\n  lastStatus: '',\r\n  maybeRecoverable: true,\r\n  descriptionHint: '',\r\n  isError: false,\r\n  hideDots: false,\r\n  loadingChunksData: null as null | Record<string, string>,\r\n  loadingChunksDataPlayerChunk: null as null | { x: number, z: number },\r\n  isDisplaying: false,\r\n  minecraftJsonMessage: null as null | Record<string, any>,\r\n  showReconnect: false\r\n}\r\nexport const appStatusState = proxy(initialState)\r\nexport const resetAppStatusState = () => {\r\n  Object.assign(appStatusState, initialState)\r\n}\r\n\r\nexport const lastConnectOptions = {\r\n  value: null as ConnectOptions | null\r\n}\r\nglobalThis.lastConnectOptions = lastConnectOptions\r\n\r\nconst saveReconnectOptions = (options: ConnectOptions) => {\r\n  sessionStorage.setItem('reconnectOptions', JSON.stringify({\r\n    value: options,\r\n    timestamp: Date.now()\r\n  }))\r\n}\r\n\r\nexport const reconnectReload = () => {\r\n  if (lastConnectOptions.value) {\r\n    saveReconnectOptions(lastConnectOptions.value)\r\n    window.location.reload()\r\n  }\r\n}\r\n\r\nexport default () => {\r\n  const lastState = useRef(JSON.parse(JSON.stringify(appStatusState)))\r\n  const currentState = useSnapshot(appStatusState)\r\n  const { active: replayActive } = useSnapshot(packetsRecordingState)\r\n\r\n  const isOpen = useIsModalActive('app-status')\r\n\r\n  if (isOpen) {\r\n    lastState.current = JSON.parse(JSON.stringify(currentState))\r\n  }\r\n\r\n  const usingState = isOpen ? currentState : lastState.current\r\n  const { isError, lastStatus, maybeRecoverable, status, hideDots, descriptionHint, loadingChunksData, loadingChunksDataPlayerChunk, minecraftJsonMessage, showReconnect } = usingState\r\n\r\n  useDidUpdateEffect(() => {\r\n    // todo play effect only when world successfully loaded\r\n    if (!isOpen) {\r\n      const divingElem: HTMLElement = document.querySelector('#viewer-canvas')!\r\n      divingElem.style.animationName = 'dive-animation'\r\n      divingElem.parentElement!.style.perspective = '1200px'\r\n      divingElem.onanimationend = () => {\r\n        divingElem.parentElement!.style.perspective = ''\r\n        divingElem.onanimationend = null\r\n      }\r\n    }\r\n  }, [isOpen])\r\n\r\n  const reconnect = () => {\r\n    resetAppStatusState()\r\n    window.dispatchEvent(new window.CustomEvent('connect', {\r\n      detail: lastConnectOptions.value\r\n    }))\r\n  }\r\n\r\n  useEffect(() => {\r\n    const controller = new AbortController()\r\n    window.addEventListener('keyup', (e) => {\r\n      if ('input textarea select'.split(' ').includes((e.target as HTMLElement).tagName?.toLowerCase() ?? '')) return\r\n      if (activeModalStack.at(-1)?.reactType !== 'app-status') return\r\n      if (e.code !== 'KeyR' || !lastConnectOptions.value) return\r\n      reconnect()\r\n    }, {\r\n      signal: controller.signal\r\n    })\r\n    return () => controller.abort()\r\n  }, [])\r\n\r\n  const displayAuthButton = status.includes('This server appears to be an online server and you are providing no authentication.')\r\n  const displayVpnButton = status.includes('VPN') || status.includes('Proxy')\r\n  const authReconnectAction = async () => {\r\n    let accounts = [] as AuthenticatedAccount[]\r\n    updateAuthenticatedAccountData(oldAccounts => {\r\n      accounts = oldAccounts\r\n      return oldAccounts\r\n    })\r\n\r\n    const account = await showOptionsModal('Choose account to connect with', [...accounts.map(account => account.username), 'Use other account'])\r\n    if (!account) return\r\n    lastConnectOptions.value!.authenticatedAccount = accounts.find(acc => acc.username === account) || true\r\n    reconnect()\r\n  }\r\n\r\n  const lastAutoCapturedPackets = getLastAutoCapturedPackets()\r\n  return <DiveTransition open={isOpen}>\r\n    <AppStatus\r\n      status={status}\r\n      isError={isError || status === ''} // display back button if status is empty as probably our app is errored // display back button if status is empty as probably our app is errored\r\n      hideDots={hideDots}\r\n      lastStatus={lastStatus}\r\n      showReconnect={showReconnect}\r\n      onReconnect={reconnectReload}\r\n      description={<>{\r\n        displayAuthButton ? '' : (isError ? guessProblem(status) : '') || descriptionHint\r\n      }{\r\n        minecraftJsonMessage && <MessageFormattedString message={minecraftJsonMessage} />\r\n      }</>}\r\n      backAction={maybeRecoverable ? () => {\r\n        resetAppStatusState()\r\n        miscUiState.gameLoaded = false\r\n        miscUiState.loadedDataVersion = null\r\n        window.loadedData = undefined\r\n        if (activeModalStacks['main-menu']) {\r\n          insertActiveModalStack('main-menu')\r\n          if (activeModalStack.at(-1)?.reactType === 'app-status') {\r\n            hideModal(undefined, undefined, { force: true }) // workaround: hide loader that was shown on world loading\r\n          }\r\n        } else {\r\n          hideModal(undefined, undefined, { force: true })\r\n        }\r\n      } : undefined}\r\n      actionsSlot={\r\n        <>\r\n          {displayAuthButton && <Button label='Authenticate' onClick={authReconnectAction} />}\r\n          {displayVpnButton && <PossiblyVpnBypassProxyButton reconnect={reconnect} />}\r\n          {replayActive && <Button label={`Download Packets Replay ${replayLogger?.contents.split('\\n').length}L`} onClick={downloadPacketsReplay} />}\r\n          {lastAutoCapturedPackets && <Button label={`Inspect Last ${lastAutoCapturedPackets} Packets`} onClick={() => downloadAutoCapturedPackets()} />}\r\n        </>\r\n      }\r\n    >\r\n      {loadingChunksData && <LoadingChunks regionFiles={Object.keys(loadingChunksData)} stateMap={loadingChunksData} playerChunk={loadingChunksDataPlayerChunk} />}\r\n      {isOpen && <DisplayingIndicator />}\r\n    </AppStatus>\r\n  </DiveTransition>\r\n}\r\n\r\nconst DisplayingIndicator = () => {\r\n  useEffect(() => {\r\n    requestAnimationFrame(() => {\r\n      requestAnimationFrame(() => {\r\n        appStatusState.isDisplaying = true\r\n      })\r\n    })\r\n  }, [])\r\n\r\n  return <div />\r\n}\r\n\r\nconst PossiblyVpnBypassProxyButton = ({ reconnect }: { reconnect: () => void }) => {\r\n  const [vpnBypassProxy, setVpnBypassProxy] = useState('')\r\n\r\n  const useVpnBypassProxyAction = () => {\r\n    updateLoadedServerData((data) => {\r\n      data.proxyOverride = vpnBypassProxy\r\n      return data\r\n    }, lastConnectOptions.value?.serverIndex)\r\n    lastConnectOptions.value!.proxy = vpnBypassProxy\r\n    reconnect()\r\n  }\r\n\r\n  useEffect(() => {\r\n    const proxy = lastConnectOptions.value?.proxy\r\n    if (!proxy) return\r\n    getProxyDetails(proxy)\r\n      .then(async (r) => r.json())\r\n      .then(({ capabilities }) => {\r\n        const { vpnBypassProxy } = capabilities\r\n        if (!vpnBypassProxy) return\r\n        setVpnBypassProxy(vpnBypassProxy)\r\n      })\r\n      .catch(() => { })\r\n  }, [])\r\n\r\n  if (!vpnBypassProxy) return\r\n  return <Button label='Use VPN bypass proxy' onClick={useVpnBypassProxyAction} />\r\n}\r\n","import { useRef, useState, useEffect, CSSProperties } from 'react'\r\nimport SharedHudVars from './SharedHudVars'\r\nimport './ArmorBar.css'\r\n\r\n\r\nexport type ArmorBarProps = {\r\n  armorValue: number,\r\n  style?: CSSProperties\r\n}\r\n\r\nexport default ({\r\n  armorValue,\r\n  style\r\n}: ArmorBarProps) => {\r\n  const armorRef = useRef<HTMLDivElement>(null!)\r\n\r\n  useEffect(() => {\r\n    const armorElement = armorRef.current\r\n    const armors = armorElement.children\r\n\r\n    for (const armor of armors) {\r\n      armor.classList.remove('full')\r\n      armor.classList.remove('half')\r\n    }\r\n\r\n    for (let i = 0; i < Math.ceil(armorValue / 2); i++) {\r\n      if (i >= armors.length) break\r\n\r\n      if (armorValue % 2 !== 0 && Math.ceil(armorValue / 2) === i + 1) {\r\n        armors[i].classList.add('half')\r\n      } else {\r\n        armors[i].classList.add('full')\r\n      }\r\n    }\r\n  }, [armorValue])\r\n\r\n  return <SharedHudVars>\r\n    <div style={style ?? {}} ref={armorRef} className='armor_container' >\r\n      {\r\n        Array.from({ length: 10 }, () => 0)\r\n          .map((num, index) => <div\r\n            key={`armor-${index}`}\r\n            className='armor'\r\n          />)\r\n      }\r\n    </div>\r\n  </SharedHudVars>\r\n}\r\n","const getEffectClass = (effect) => {\r\n  switch (effect.id) {\r\n    case 19:\r\n      return 'poisoned'\r\n    case 20:\r\n      return 'withered'\r\n    case 22:\r\n      return 'absorption'\r\n    default:\r\n      return ''\r\n  }\r\n}\r\n\r\nexport const barEffectAdded = (htmlElement, effect) => {\r\n  const effectClass = getEffectClass(effect)\r\n  if (effectClass) {\r\n    htmlElement.classList.add(effectClass)\r\n  }\r\n}\r\n\r\nexport const barEffectEnded = (htmlElement, effect) => {\r\n  const effectClass = getEffectClass(effect)\r\n  if (effectClass) {\r\n    htmlElement.classList.remove(effectClass)\r\n  }\r\n}\r\n","import { hideCurrentModal } from '../globalState'\r\nimport Button from './Button'\r\nimport { useIsModalActive } from './utilsApp'\r\n\r\nexport default () => {\r\n  const isModalActive = useIsModalActive('bed')\r\n\r\n  if (!isModalActive) return null\r\n\r\n  return <div style={{\r\n    position: 'fixed',\r\n    bottom: 0,\r\n    left: 0,\r\n    right: 0,\r\n    display: 'flex',\r\n    justifyContent: 'center',\r\n  }}\r\n  >\r\n    <Button onClick={() => {\r\n      void bot.wake()\r\n      hideCurrentModal()\r\n    }}>Cancel</Button>\r\n  </div>\r\n}\r\n","import React, { useState, useRef, useEffect, useCallback } from 'react'\r\nimport insideIcon from './book_icons/book.webp'\r\nimport insideHalfIcon from './book_icons/book-half.webp'\r\nimport singlePageInsideIcon from './book_icons/notebook.webp'\r\nimport titleIcon from './book_icons/title.webp'\r\nimport styles from './Book.module.css'\r\nimport Button from './Button'\r\nimport MessageFormattedString from './MessageFormattedString'\r\n\r\nexport interface BookProps {\r\n  textPages: string[]\r\n  editable: boolean\r\n  onSign: (textPages: string[], title: string) => void\r\n  onEdit: (textPages: string[]) => void\r\n  onClose: () => void\r\n  author: string\r\n}\r\n\r\nconst Book: React.FC<BookProps> = ({ textPages, editable, onSign, onEdit, onClose, author }) => {\r\n  const [pages, setPages] = useState<string[]>(textPages)\r\n  const [currentPage, setCurrentPage] = useState(0)\r\n  const [isSinglePage, setIsSinglePage] = useState(window.innerWidth < 972)\r\n  const [insideImage, setInsideImage] = useState(window.innerWidth < 972 ? singlePageInsideIcon : insideIcon)\r\n  const [animateInsideIcon, setAnimateInsideIcon] = useState(0)\r\n  const [animatePageIcon, setAnimatePageIcon] = useState(0)\r\n  const [animateTitleIcon, setAnimateTitleIcon] = useState(0)\r\n  const [signClickedOnce, setSignClickedOnce] = useState(false)\r\n  const textAreaRefs = useRef<HTMLTextAreaElement[]>([])\r\n  const inputRef = useRef<HTMLInputElement>(null)\r\n\r\n  const handleResize = useCallback(() => {\r\n    const isSingle = window.innerWidth < 972\r\n    setIsSinglePage(isSingle)\r\n    setInsideImage(isSingle ? singlePageInsideIcon : insideIcon)\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    handleResize()\r\n    window.addEventListener('resize', handleResize)\r\n    return () => window.removeEventListener('resize', handleResize)\r\n  }, [handleResize])\r\n\r\n  useEffect(() => {\r\n    const index = currentPage * (isSinglePage ? 1 : 2)\r\n    if (textAreaRefs.current[index]) textAreaRefs.current[index].focus()\r\n  }, [currentPage, isSinglePage])\r\n\r\n  useEffect(() => {\r\n    if (signClickedOnce) {\r\n      setTimeout(() => {\r\n        inputRef.current!.focus()\r\n      }, 300) // wait for animation\r\n    }\r\n  }, [signClickedOnce])\r\n\r\n  const handlePageChange = (direction: number) => {\r\n    setCurrentPage((prevPage) => Math.min(Math.max(prevPage + direction, 0), Math.ceil(pages.length / (isSinglePage ? 1 : 2)) - 1))\r\n  }\r\n\r\n  const updatePage = (index, text) => {\r\n    setPages((prevPages) => {\r\n      const updatedPages = [...prevPages]\r\n      updatedPages[index] = text\r\n      return updatedPages\r\n    })\r\n  }\r\n\r\n  const handleTextChange = (e, pageIndex) => {\r\n    const text = e.target.value\r\n    updatePage(pageIndex, text)\r\n\r\n    const nextPageIndex = pageIndex + 1\r\n    const isMaxLengthReached = text.length >= e.target.maxLength\r\n\r\n    if (isMaxLengthReached) {\r\n      if (nextPageIndex < pages.length) {\r\n        setCurrentPage(Math.floor(nextPageIndex / (isSinglePage ? 1 : 2)))\r\n      } else {\r\n        setPages((prevPages) => [...prevPages, ''])\r\n        setCurrentPage(Math.floor(nextPageIndex / (isSinglePage ? 1 : 2)))\r\n      }\r\n      textAreaRefs.current[nextPageIndex]?.focus()\r\n    } else if (text === '' && pageIndex > 0 && e.nativeEvent.inputType === 'deleteContentBackward') {\r\n      setCurrentPage(Math.floor((pageIndex - 1) / (isSinglePage ? 1 : 2)))\r\n      textAreaRefs.current[pageIndex - 1]?.focus()\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    const index = currentPage * (isSinglePage ? 1 : 2)\r\n    textAreaRefs.current[index]?.focus()\r\n  }, [currentPage, isSinglePage])\r\n\r\n  const handlePaste = (e: React.ClipboardEvent<HTMLTextAreaElement>, pageIndex: number) => {\r\n    const pasteText = e.clipboardData.getData('text')\r\n    const updatedPages = [...pages]\r\n    const currentText = updatedPages[pageIndex]\r\n    const selectionStart = e.currentTarget.selectionStart || 0\r\n    const selectionEnd = e.currentTarget.selectionEnd || 0\r\n\r\n    const newText = currentText.slice(0, selectionStart) + pasteText + currentText.slice(selectionEnd)\r\n    updatedPages[pageIndex] = newText\r\n    setPages(updatedPages)\r\n\r\n    if (newText.length > e.currentTarget.maxLength) {\r\n      const remainingText = newText.slice(e.currentTarget.maxLength)\r\n      updatedPages[pageIndex] = newText.slice(0, e.currentTarget.maxLength)\r\n      setPages(updatedPages)\r\n\r\n      const nextPageIndex = pageIndex + 1\r\n\r\n      if (nextPageIndex < pages.length) {\r\n        handlePasteRemainingText(remainingText, nextPageIndex)\r\n      } else {\r\n        setPages((prevPages) => [...prevPages, remainingText])\r\n        setCurrentPage(Math.floor(nextPageIndex / (isSinglePage ? 1 : 2)))\r\n        focusOnTextArea(nextPageIndex)\r\n      }\r\n    }\r\n  }\r\n\r\n  const handlePasteRemainingText = (remainingText: string, nextPageIndex: number) => {\r\n    const updatedPages = [...pages]\r\n    updatedPages[nextPageIndex] = remainingText\r\n    setPages(updatedPages)\r\n    focusOnTextArea(nextPageIndex)\r\n  }\r\n\r\n  const focusOnTextArea = (index: number) => {\r\n    setTimeout(() => {\r\n      textAreaRefs.current[index]?.focus()\r\n    }, 0)\r\n  }\r\n\r\n  const handleSign = useCallback(() => {\r\n    if (editable && signClickedOnce) {\r\n      const title = inputRef.current?.value || ''\r\n      onSign(pages, title)\r\n    }\r\n    setSignClickedOnce(true)\r\n    setAnimatePageIcon(1)\r\n    setAnimateInsideIcon(1)\r\n    setTimeout(() => {\r\n      setAnimateTitleIcon(1)\r\n    }, 150)\r\n  }, [pages, onSign, editable, signClickedOnce])\r\n\r\n  const handleEdit = useCallback(() => {\r\n    setSignClickedOnce(false)\r\n    onEdit(pages)\r\n  }, [pages, onEdit])\r\n\r\n  const handleCancel = useCallback(() => {\r\n    if (signClickedOnce) {\r\n      setSignClickedOnce(false)\r\n      setAnimateTitleIcon(2)\r\n      setTimeout(() => {\r\n        setAnimateInsideIcon(2)\r\n        setTimeout(() => {\r\n          setAnimatePageIcon(2)\r\n        }, 150)\r\n      }, 150)\r\n    } else {\r\n      onClose()\r\n    }\r\n  }, [signClickedOnce, onClose])\r\n\r\n  const setRef = (index: number) => (el: HTMLTextAreaElement | null) => {\r\n    textAreaRefs.current[index] = el!\r\n  }\r\n\r\n  const getAnimationClass = (animationState, baseClass) => {\r\n    switch (animationState) {\r\n      case 1:\r\n        return `${baseClass} ${styles.pageAnimation}`\r\n      case 2:\r\n        return `${baseClass} ${styles.pageAnimationReverse}`\r\n      default:\r\n        return baseClass\r\n    }\r\n  }\r\n\r\n  const renderPage = (index) => (\r\n    <div className={styles.page} key={index}>\r\n      {editable ? (\r\n        <textarea\r\n          onContextMenu={(e) => {\r\n            e.stopPropagation() // allow to open system context menu on text area for better UX\r\n          }}\r\n          ref={setRef(index)}\r\n          value={pages[index]}\r\n          onChange={(e) => handleTextChange(e, index)}\r\n          onPaste={(e) => handlePaste(e, index)}\r\n          className={getAnimationClass(animatePageIcon, styles.textArea)}\r\n          maxLength={500}\r\n        />\r\n      ) : (\r\n        <div className={getAnimationClass(animatePageIcon, '')}>\r\n          <MessageFormattedString message={pages[index]} fallbackColor='black' className={styles.messageFormattedString} />\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n\r\n  return (\r\n    <div className={styles.bookWrapper}>\r\n      <div className={styles.bookContainer}>\r\n        <img\r\n          src={insideImage}\r\n          className={`${styles.insideIcon} ${\r\n            animateInsideIcon === 1\r\n              ? styles.insideAnimation\r\n              : animateTitleIcon === 2\r\n                ? styles.insideAnimationReverse\r\n                : ''\r\n          }`}\r\n          alt=\"inside Icon\"\r\n        />\r\n        <img\r\n          src={insideHalfIcon}\r\n          className={`${styles.insideHalfIcon} ${\r\n            animatePageIcon === 1\r\n              ? styles.pageAnimation\r\n              : animatePageIcon === 2\r\n                ? styles.pageAnimationReverse\r\n                : ''\r\n          }`}\r\n          alt=\"inside Page Icon\"\r\n        />\r\n        <img\r\n          src={titleIcon}\r\n          className={`${styles.titleIcon} ${\r\n            animateTitleIcon === 1\r\n              ? styles.titleAnimation\r\n              : animateTitleIcon === 2\r\n                ? styles.titleAnimationReverse\r\n                : ''\r\n          }`}\r\n          alt=\"Title Icon\"\r\n        />\r\n        <div className={`${styles.inside}`}>\r\n          {renderPage(currentPage * (isSinglePage ? 1 : 2))}\r\n          {!isSinglePage && (currentPage * 2 + 1) < pages.length && renderPage(currentPage * 2 + 1)}\r\n          <Button\r\n            className={`${styles.controlPrev} ${\r\n              animateInsideIcon === 1\r\n                ? styles.hidden\r\n                : animateInsideIcon === 2\r\n                  ? styles.pageButtonAnimationReverse\r\n                  : ''\r\n            }`}\r\n            onClick={() => handlePageChange(-1)}\r\n            disabled={currentPage === 0}\r\n          >\r\n            {' '}\r\n          </Button>\r\n          <Button\r\n            className={`${styles.controlNext} ${\r\n              animateInsideIcon === 1\r\n                ? styles.hidden\r\n                : animateInsideIcon === 2\r\n                  ? styles.pageButtonAnimationReverse\r\n                  : ''\r\n            }`}\r\n            onClick={() => handlePageChange(1)}\r\n            disabled={(currentPage + 1) * (isSinglePage ? 1 : 2) >= pages.length}\r\n          >\r\n            {' '}\r\n          </Button>\r\n        </div>\r\n        <div\r\n          className={`${styles.outSide} ${\r\n            animateTitleIcon === 1\r\n              ? styles.titleContentAnimation\r\n              : animateTitleIcon === 2\r\n                ? styles.titleContentAnimationReverse\r\n                : ''\r\n          }`}\r\n        >\r\n          {editable ? (\r\n            <div className={`${styles.titleContent}`} >\r\n              <MessageFormattedString message=\"Enter Book Title: \" />\r\n              <form onSubmit={(e) => {\r\n                e.preventDefault()\r\n                handleSign()\r\n              }}\r\n              >\r\n                <input\r\n                  ref={inputRef}\r\n                  className=\"\"\r\n                />\r\n                {/* for some reason this is needed to make Enter work on android chrome */}\r\n                <button type='submit' style={{ visibility: 'hidden', height: 0, width: 0 }} />\r\n              </form>\r\n              <MessageFormattedString message={`by ${author}`} />\r\n              <br />\r\n              <MessageFormattedString message=\"Note! When you sign the book, it will no longer be editable.\" />\r\n            </div>\r\n          ) : (\r\n            <div className={`${styles.titleContent}`} >\r\n              <MessageFormattedString message=\"Book Name Here\" />\r\n              <br />\r\n              <MessageFormattedString message=\"by: Author\" />\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n      <div className={styles.actions}>\r\n        {editable && (\r\n          <Button onClick={handleSign}>\r\n            {signClickedOnce ? 'Sign and Save' : 'Sign'}\r\n          </Button>\r\n        )}\r\n\r\n        {editable && !signClickedOnce && <Button onClick={handleSign}>Sign</Button>}\r\n        {editable && !signClickedOnce && <Button onClick={handleEdit}>Edit</Button>}\r\n        <Button onClick={handleCancel}>{signClickedOnce ? 'Cancel' : 'Close'}</Button>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Book\r\n","import { versionToNumber } from 'renderer/viewer/prepare/utils'\r\nimport nbt from 'prismarine-nbt'\r\nimport { useEffect, useState } from 'react'\r\nimport { useSnapshot } from 'valtio'\r\nimport mojangson from 'mojangson'\r\nimport { activeModalStack, hideCurrentModal, showModal } from '../globalState'\r\nimport Book from './Book'\r\nimport { useIsModalActive } from './utilsApp'\r\n\r\ninterface OpenedBook {\r\n  pages: string[]\r\n  title: string\r\n  author: string\r\n  isEditable: boolean\r\n}\r\n\r\nexport default () => {\r\n  const modalActive = useIsModalActive('book')\r\n  // const modalStack = useSnapshot(activeModalStack)\r\n  const [openedBook, setOpenedBook] = useState<OpenedBook | null>(null)\r\n\r\n  const signEditBook = (pages: string[], title: string | undefined) => {\r\n    if (versionToNumber(bot.version) < versionToNumber('1.17.2')) {\r\n      if (title === undefined) {\r\n        void bot.writeBook(bot.inventory.hotbarStart + bot.quickBarSlot, pages)\r\n      } else {\r\n        //@ts-expect-error\r\n        // slot, pages, author, title\r\n        bot.signBook(bot.inventory.hotbarStart + bot.quickBarSlot, pages, title, bot.username)\r\n      }\r\n      hideCurrentModal()\r\n      return\r\n    }\r\n    const currentSlot = bot.quickBarSlot\r\n    // mineflayer has wrong implementation of this action after 1.17.2\r\n    if (title === undefined) {\r\n      bot._client.write('edit_book', {\r\n        hand: currentSlot,\r\n        pages\r\n      })\r\n    } else {\r\n      bot._client.write('edit_book', {\r\n        hand: currentSlot,\r\n        pages,\r\n        title\r\n      })\r\n    }\r\n    hideCurrentModal()\r\n  }\r\n\r\n  // test: /give @p minecraft:written_book{pages:['{\"text\":\"4This is red text. lThis is bold text.\"}'],title:\"Book\",author:\"Author\"}\r\n  useEffect(() => {\r\n    const openBookWithNbt = () => {\r\n      if (activeModalStack.at(-1)?.reactType === 'book') {\r\n        hideCurrentModal()\r\n      }\r\n      const book = bot.inventory.slots[bot.inventory.hotbarStart + bot.quickBarSlot]\r\n      if (!book?.nbt) return\r\n      // {\"type\":\"compound\",\"name\":\"\",\"value\":{\"title\":{\"type\":\"string\",\"value\":\"yes\"},\"author\":{\"type\":\"string\",\"value\":\"bot\"},\"pages\":{\"type\":\"list\",\"value\":{\"type\":\"string\",\"value\":[\"{\\\"text\\\":\\\"1\\\"}\",\"{\\\"text\\\":\\\"4\\\"}\",\"{\\\"text\\\":\\\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\\\"}\"]}\r\n      const parsedData = nbt.simplify(book.nbt as any)\r\n      if (!parsedData.pages) return\r\n      const pages = parsedData.pages.map((page) => {\r\n        if (book.name !== 'written_book') return page\r\n        const parsedPage = mojangson.simplify(mojangson.parse(page))\r\n        return parsedPage.text ?? page\r\n      })\r\n      // const {title, author} = parsedData\r\n      setOpenedBook({\r\n        pages,\r\n        title: parsedData.title ?? '',\r\n        author: parsedData.author ?? '',\r\n        isEditable: book.name === 'writable_book',\r\n      })\r\n      showModal({ reactType: 'book' })\r\n    }\r\n    customEvents.on('activateItem', (item) => {\r\n      if (item.name === 'writable_book') {\r\n        if (item.nbt?.value.pages) {\r\n          openBookWithNbt()\r\n        } else {\r\n          setOpenedBook({\r\n            pages: [],\r\n            title: '',\r\n            author: '',\r\n            isEditable: true,\r\n          })\r\n          showModal({ reactType: 'book' })\r\n        }\r\n      }\r\n    })\r\n    bot._client.on('open_book', openBookWithNbt)\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    if (modalActive) return\r\n    setOpenedBook(null)\r\n  }, [modalActive])\r\n\r\n  if (!openedBook) return null\r\n  return <Book\r\n    textPages={openedBook.pages}\r\n    editable={openedBook.isEditable}\r\n    onSign={(pages, title) => signEditBook(pages, title)}\r\n    onEdit={(pages) => signEditBook(pages, undefined)}\r\n    onClose={() => {\r\n      hideCurrentModal()\r\n    }}\r\n    author={bot.username}\r\n  />\r\n}\r\n","import type { BossBar as BossBarTypeRaw } from 'mineflayer'\r\nimport { useState, useEffect } from 'react'\r\nimport MessageFormattedString from './MessageFormattedString'\r\nimport './BossBarOverlay.css'\r\n\r\nconst colors = ['pink', 'blue', 'red', 'green', 'yellow', 'purple', 'white']\r\nconst divs = [0, 6, 10, 12, 20]\r\n\r\nexport type BossBarType = BossBarTypeRaw & {\r\n  // todo why not use public properties?\r\n  title: string | Record<string, any> | null,\r\n  _title: string | Record<string, any> | null,\r\n  _color: string,\r\n  _dividers: number,\r\n  _health: number,\r\n  lastUpdated: number\r\n}\r\n\r\nexport default ({ bar }: { bar: BossBarType }) => {\r\n  const [title, setTitle] = useState({})\r\n  const [bossBarStyles, setBossBarStyles] = useState<{ [key: string]: string | number }>({})\r\n  const [fillStyles, setFillStyles] = useState<{ [key: string]: string | number }>({})\r\n  const [div1Styles, setDiv1Styles] = useState<{ [key: string]: string | number }>({})\r\n  const [div2Styles, setDiv2Styles] = useState<{ [key: string]: string | number }>({})\r\n\r\n  useEffect(() => {\r\n    setTitle(bar._title ?? bar.title)\r\n    setBossBarStyles(prevStyles => ({\r\n      ...prevStyles,\r\n      backgroundPositionY: `-${colors.indexOf(bar._color) * 10}px`\r\n    }))\r\n    setFillStyles(prevStyles => ({\r\n      ...prevStyles,\r\n      width: `${bar._health * 100}%`,\r\n      backgroundPositionY: `-${colors.indexOf(bar._color) * 10 + 5}px`\r\n    }))\r\n    setDiv1Styles(prevStyles => ({\r\n      ...prevStyles,\r\n      backgroundPositionY: `-${divs.indexOf(bar._dividers) * 10 + 70}px`\r\n    }))\r\n    setDiv2Styles(prevStyles => ({\r\n      ...prevStyles,\r\n      width: `${bar._health * 100}%`,\r\n      backgroundPositionY: `-${divs.indexOf(bar._dividers) * 10 + 75}px`\r\n    }))\r\n  }, [bar])\r\n\r\n  return (\r\n    <div className=\"bossbar-container\">\r\n      <div className=\"bossbar-title\"><MessageFormattedString message={title} /></div>\r\n      <div className=\"bossbar\" style={bossBarStyles}>\r\n        <div className=\"fill\" style={fillStyles} />\r\n        <div className=\"fill\" style={div1Styles} />\r\n        <div className=\"fill\" style={div2Styles} />\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import { useState, useEffect } from 'react'\r\nimport { useSnapshot } from 'valtio'\r\nimport { miscUiState } from '../globalState'\r\nimport './BossBarOverlay.css'\r\nimport BossBar, { BossBarType } from './BossBarOverlay'\r\n\r\n\r\nexport default () => {\r\n  const { currentTouch } = useSnapshot(miscUiState)\r\n  const [bossBars, setBossBars] = useState(new Map<string, BossBarType>())\r\n  const addBossBar = (bossBar: BossBarType) => {\r\n    setBossBars(prevBossBars => new Map(prevBossBars.set(bossBar.entityUUID, {\r\n      ...bossBar,\r\n      lastUpdated: Date.now()\r\n    })))\r\n  }\r\n\r\n  const removeBossBar = (bossBar: BossBarType) => {\r\n    setBossBars(prevBossBars => {\r\n      const newBossBars = new Map(prevBossBars)\r\n      newBossBars.delete(bossBar.entityUUID)\r\n      return newBossBars\r\n    })\r\n  }\r\n\r\n  useEffect(() => {\r\n    bot.on('bossBarCreated', (bossBar) => {\r\n      addBossBar(bossBar as BossBarType)\r\n    })\r\n    bot.on('bossBarUpdated', (bossBar) => {\r\n      if (!bossBar) return\r\n      addBossBar(bossBar as BossBarType)\r\n    })\r\n    bot.on('bossBarDeleted', (bossBar) => {\r\n      if (!bossBar) return\r\n      removeBossBar(bossBar as BossBarType)\r\n    })\r\n  }, [])\r\n\r\n  return (\r\n    <div className={`bossBars ${currentTouch ? 'mobile' : ''}`} id=\"bossBars\">\r\n      {[...bossBars.values()].map(bar => (\r\n        <BossBar key={`${bar.entityUUID}-${bar.lastUpdated}`} bar={bar} />\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n","import { useRef, useEffect } from 'react'\r\nimport SharedHudVars from './SharedHudVars'\r\nimport './BreathBar.css'\r\n\r\nexport type BreathBarProps = {\r\n  oxygen: number,\r\n}\r\n\r\nexport default ({\r\n  oxygen,\r\n}: BreathBarProps) => {\r\n  const breathRef = useRef<HTMLDivElement | null>(null)\r\n\r\n  useEffect(() => {\r\n    const breathbar = breathRef.current\r\n    if (breathbar && oxygen < 20) {\r\n      breathbar.style.display = 'flex'\r\n      breathbar.classList.toggle('low', oxygen <= 5)\r\n\r\n      const breaths = breathbar.children\r\n\r\n      for (const breath of breaths) {\r\n        breath.classList.remove('full')\r\n        breath.classList.remove('half')\r\n      }\r\n\r\n      for (let i = 0; i < Math.ceil(oxygen / 2); i++) {\r\n        if (i >= breaths.length) break\r\n\r\n        if (oxygen % 2 !== 0 && Math.ceil(oxygen / 2) === i + 1) {\r\n          breaths[i].classList.add('half')\r\n        } else {\r\n          breaths[i].classList.add('full')\r\n        }\r\n      }\r\n    } else if (breathbar && oxygen >= 20) {\r\n      breathbar.style.display = 'none'\r\n    }\r\n  }, [oxygen])\r\n\r\n  return <SharedHudVars>\r\n    <div ref={breathRef} className='breathbar'>\r\n      {\r\n        Array.from({ length: 10 }, () => 0)\r\n          .map((num, index) => <div\r\n            key={`breath-${index}`}\r\n            className='breath'\r\n          />)\r\n      }\r\n    </div>\r\n  </SharedHudVars>\r\n}\r\n","import classNames from 'classnames'\r\nimport { createContext, FC, Ref, useContext } from 'react'\r\nimport buttonCss from './button.module.css'\r\nimport SharedHudVars from './SharedHudVars'\r\nimport PixelartIcon from './PixelartIcon'\r\n\r\n// testing in storybook from deathscreen\r\n\r\ninterface Props extends React.ComponentProps<'button'> {\r\n  label?: string\r\n  postLabel?: React.ReactNode\r\n  icon?: string\r\n  children?: React.ReactNode\r\n  inScreen?: boolean\r\n  rootRef?: Ref<HTMLButtonElement>\r\n  overlayColor?: string\r\n}\r\n\r\nconst ButtonContext = createContext({\r\n  onClick () { },\r\n})\r\n\r\nexport const ButtonProvider: FC<{ children, onClick }> = ({ children, onClick }) => {\r\n  return <ButtonContext.Provider value={{ onClick }}>{children}</ButtonContext.Provider>\r\n}\r\n\r\nexport default (({ label, icon, children, inScreen, rootRef, type = 'button', postLabel, overlayColor, ...args }) => {\r\n  const ctx = useContext(ButtonContext)\r\n\r\n  const onClick = (e) => {\r\n    ctx.onClick()\r\n    args.onClick?.(e)\r\n  }\r\n  if (inScreen) {\r\n    args.style ??= {}\r\n    args.style.width = 150\r\n  }\r\n  if (icon) {\r\n    args.style ??= {}\r\n    args.style.width = 20\r\n  }\r\n\r\n  return <SharedHudVars>\r\n    <button ref={rootRef} {...args} className={classNames(buttonCss.button, args.className)} onClick={onClick} type={type}>\r\n      {icon && <PixelartIcon className={buttonCss.icon} iconName={icon} />}\r\n      {label}\r\n      {postLabel}\r\n      {children}\r\n      {overlayColor && <div style={{\r\n        position: 'absolute',\r\n        inset: 0,\r\n        backgroundColor: overlayColor,\r\n        opacity: 0.5,\r\n        pointerEvents: 'none'\r\n      }} />}\r\n    </button>\r\n  </SharedHudVars>\r\n}) satisfies FC<Props>\r\n","import { loadSound, playSound } from '../basicSounds'\r\nimport buttonClickMp3 from '../../assets/button_click.mp3'\r\nimport { ButtonProvider } from './Button'\r\n\r\nvoid loadSound('button_click.mp3', buttonClickMp3)\r\n\r\nexport default ({ children }) => {\r\n  return <ButtonProvider onClick={() => {\r\n    void playSound('button_click.mp3')\r\n  }}>{children}</ButtonProvider>\r\n}\r\n","import { useEffect, useRef, useState } from 'react'\r\nimport { useFloating, arrow, FloatingArrow, offset as offsetMiddleware, Placement } from '@floating-ui/react'\r\nimport Button from './Button'\r\n\r\ninterface Props extends React.ComponentProps<typeof Button> {\r\n  initialTooltip: {\r\n    content: string\r\n    placement?: Placement\r\n    localStorageKey?: string | null\r\n    offset?: number\r\n  }\r\n}\r\n\r\nconst ARROW_HEIGHT = 7\r\nconst GAP = 0\r\n\r\nexport default ({ initialTooltip, ...args }: Props) => {\r\n  const { localStorageKey = 'firstTimeTooltip', offset = 0 } = initialTooltip\r\n  const [showTooltips, setShowTooltips] = useState(localStorageKey ? localStorage[localStorageKey] !== 'false' : true)\r\n\r\n  useEffect(() => {\r\n    let timeout\r\n    function hide () {\r\n      if (!localStorageKey) return\r\n      localStorage[localStorageKey] = 'false'\r\n      setShowTooltips(false)\r\n    }\r\n    if (showTooltips && localStorageKey) {\r\n      // todo wait for user interaction mouseoe\r\n      timeout = setTimeout(() => {\r\n        hide()\r\n      }, 10_000)\r\n    }\r\n\r\n    return () => {\r\n      // unmounted, probably switched view\r\n      if (timeout) clearTimeout(timeout)\r\n      hide()\r\n    }\r\n  }, [])\r\n\r\n  const arrowRef = useRef<any>(null)\r\n  const { refs, floatingStyles, context } = useFloating({\r\n    middleware: [\r\n      arrow({\r\n        element: arrowRef\r\n      }),\r\n      offsetMiddleware(ARROW_HEIGHT + GAP + offset),\r\n    ],\r\n    placement: initialTooltip.placement,\r\n  })\r\n\r\n  return <>\r\n    <Button {...args} rootRef={refs.setReference} />\r\n    <div\r\n      ref={refs.setFloating}\r\n      style={{\r\n        ...floatingStyles,\r\n        background: 'rgba(0, 0, 0, 0.3)',\r\n        fontSize: 8,\r\n        pointerEvents: 'none',\r\n        userSelect: 'text',\r\n        padding: '2px 4px',\r\n        opacity: showTooltips ? 1 : 0,\r\n        transition: 'opacity 0.3s ease-in-out',\r\n        textShadow: '1px 1px 2px BLACK',\r\n        zIndex: 11\r\n      }}\r\n    >\r\n      {initialTooltip.content}\r\n      <FloatingArrow ref={arrowRef} context={context} style={{ opacity: 0.7 }} />\r\n    </div>\r\n  </>\r\n}\r\n","import { proxy, subscribe } from 'valtio'\r\nimport { useEffect, useMemo, useRef, useState } from 'react'\r\nimport { MessageFormatPart } from '../chatUtils'\r\nimport { MessagePart } from './MessageFormatted'\r\nimport './Chat.css'\r\nimport { isIos, reactKeyForMessage } from './utils'\r\nimport Button from './Button'\r\nimport { pixelartIcons } from './PixelartIcon'\r\nimport { useScrollBehavior } from './hooks/useScrollBehavior'\r\n\r\nexport type Message = {\r\n  parts: MessageFormatPart[],\r\n  id: number\r\n  fading?: boolean\r\n  faded?: boolean\r\n}\r\n\r\nconst MessageLine = ({ message }: { message: Message }) => {\r\n  const classes = {\r\n    'chat-message-fadeout': message.fading,\r\n    'chat-message-fade': message.fading,\r\n    'chat-message-faded': message.faded,\r\n    'chat-message': true\r\n  }\r\n\r\n  return <li className={Object.entries(classes).filter(([, val]) => val).map(([name]) => name).join(' ')}>\r\n    {message.parts.map((msg, i) => <MessagePart key={i} part={msg} />)}\r\n  </li>\r\n}\r\n\r\ntype Props = {\r\n  messages: Message[]\r\n  usingTouch: boolean\r\n  opacity?: number\r\n  opened?: boolean\r\n  onClose?: () => void\r\n  sendMessage?: (message: string) => boolean | void\r\n  fetchCompletionItems?: (triggerKind: 'implicit' | 'explicit', completeValue: string, fullValue: string, abortController?: AbortController) => Promise<string[] | void>\r\n  // width?: number\r\n  allowSelection?: boolean\r\n  inputDisabled?: string\r\n  placeholder?: string\r\n}\r\n\r\nexport const chatInputValueGlobal = proxy({\r\n  value: ''\r\n})\r\n\r\nexport const fadeMessage = (message: Message, initialTimeout: boolean, requestUpdate: () => void) => {\r\n  setTimeout(() => {\r\n    message.fading = true\r\n    requestUpdate()\r\n    setTimeout(() => {\r\n      message.faded = true\r\n      requestUpdate()\r\n    }, 3000)\r\n  }, initialTimeout ? 5000 : 0)\r\n}\r\n\r\nexport default ({\r\n  messages,\r\n  opacity = 1,\r\n  fetchCompletionItems,\r\n  opened,\r\n  sendMessage,\r\n  onClose,\r\n  usingTouch,\r\n  allowSelection,\r\n  inputDisabled,\r\n  placeholder\r\n}: Props) => {\r\n  const sendHistoryRef = useRef(JSON.parse(window.sessionStorage.chatHistory || '[]'))\r\n  const [isInputFocused, setIsInputFocused] = useState(false)\r\n  // const [spellCheckEnabled, setSpellCheckEnabled] = useState(false)\r\n  const spellCheckEnabled = false\r\n\r\n  const [completePadText, setCompletePadText] = useState('')\r\n  const completeRequestValue = useRef('')\r\n  const [completionItemsSource, setCompletionItemsSource] = useState([] as string[])\r\n  const [completionItems, setCompletionItems] = useState([] as string[])\r\n\r\n  const chatInput = useRef<HTMLInputElement>(null!)\r\n  const chatMessages = useRef<HTMLDivElement>(null)\r\n  const chatHistoryPos = useRef(sendHistoryRef.current.length)\r\n  const inputCurrentlyEnteredValue = useRef('')\r\n\r\n  const { scrollToBottom } = useScrollBehavior(chatMessages, { messages, opened })\r\n\r\n  const setSendHistory = (newHistory: string[]) => {\r\n    sendHistoryRef.current = newHistory\r\n    window.sessionStorage.chatHistory = JSON.stringify(newHistory)\r\n    chatHistoryPos.current = newHistory.length\r\n  }\r\n\r\n  const acceptComplete = (item: string) => {\r\n    const base = completeRequestValue.current === '/' ? '' : getCompleteValue()\r\n    updateInputValue(base + item)\r\n    // todo would be cool but disabled because some comands don't need args (like ping)\r\n    // // trigger next tab complete\r\n    // this.chatInput.dispatchEvent(new KeyboardEvent('keydown', { code: 'Space' }))\r\n    chatInput.current.focus()\r\n  }\r\n\r\n  const updateInputValue = (newValue: string) => {\r\n    chatInput.current.value = newValue\r\n    onMainInputChange()\r\n    setTimeout(() => {\r\n      chatInput.current.setSelectionRange(newValue.length, newValue.length)\r\n    }, 0)\r\n  }\r\n\r\n  const handleArrowUp = () => {\r\n    if (chatHistoryPos.current === 0) return\r\n    if (chatHistoryPos.current === sendHistoryRef.current.length) { // started navigating history\r\n      inputCurrentlyEnteredValue.current = chatInput.current.value\r\n    }\r\n    chatHistoryPos.current--\r\n    updateInputValue(sendHistoryRef.current[chatHistoryPos.current] || '')\r\n  }\r\n\r\n  const handleArrowDown = () => {\r\n    if (chatHistoryPos.current === sendHistoryRef.current.length) return\r\n    chatHistoryPos.current++\r\n    updateInputValue(sendHistoryRef.current[chatHistoryPos.current] || inputCurrentlyEnteredValue.current || '')\r\n  }\r\n\r\n  const auxInputFocus = (direction: 'up' | 'down') => {\r\n    chatInput.current.focus()\r\n    if (direction === 'up') {\r\n      handleArrowUp()\r\n    } else {\r\n      handleArrowDown()\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    // todo focus input on any keypress except tab\r\n  }, [])\r\n\r\n  const resetCompletionItems = () => {\r\n    setCompletionItemsSource([])\r\n    setCompletionItems([])\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (opened) {\r\n      updateInputValue(chatInputValueGlobal.value)\r\n      chatInputValueGlobal.value = ''\r\n      chatHistoryPos.current = sendHistoryRef.current.length\r\n      if (!usingTouch) {\r\n        chatInput.current.focus()\r\n      }\r\n\r\n      // Add keyboard event listener for letter keys and paste\r\n      const handleKeyDown = (e: KeyboardEvent) => {\r\n        if (['input', 'textarea', 'select'].includes(document.activeElement?.tagName.toLowerCase() ?? '')) return\r\n        // Check if it's a single character key (works with any layout) without modifiers except shift\r\n        const isSingleChar = e.key.length === 1 && !e.ctrlKey && !e.altKey && !e.metaKey\r\n        // Check if it's paste command\r\n        const isPaste = e.code === 'KeyV' && (e.ctrlKey || e.metaKey)\r\n\r\n        if ((isSingleChar || isPaste) && document.activeElement !== chatInput.current) {\r\n          chatInput.current.focus()\r\n        }\r\n      }\r\n\r\n      window.addEventListener('keydown', handleKeyDown)\r\n      const unsubscribeValtio = subscribe(chatInputValueGlobal, () => {\r\n        if (!chatInputValueGlobal.value) return\r\n        updateInputValue(chatInputValueGlobal.value)\r\n        chatInputValueGlobal.value = ''\r\n        chatInput.current.focus()\r\n      })\r\n\r\n      return () => {\r\n        window.removeEventListener('keydown', handleKeyDown)\r\n        unsubscribeValtio()\r\n      }\r\n    }\r\n  }, [opened])\r\n\r\n  useMemo(() => {\r\n    if (opened) {\r\n      completeRequestValue.current = ''\r\n      resetCompletionItems()\r\n    }\r\n  }, [opened])\r\n\r\n  const onMainInputChange = () => {\r\n    const completeValue = getCompleteValue()\r\n    setCompletePadText(completeValue === '/' ? '' : completeValue)\r\n    // not sure if enabling would be useful at all (maybe make as a setting in the future?)\r\n    // setSpellCheckEnabled(!chatInput.current.value.startsWith('/'))\r\n    if (completeRequestValue.current === completeValue) {\r\n      updateFilteredCompleteItems(completionItemsSource)\r\n      return\r\n    }\r\n\r\n    if (completeValue.startsWith('/')) {\r\n      void fetchCompletions(true)\r\n    } else {\r\n      resetCompletionItems()\r\n    }\r\n    completeRequestValue.current = completeValue\r\n    // if (completeValue === '/') {\r\n    //   void fetchCompletions(true)\r\n    // }\r\n  }\r\n\r\n  const fetchCompletions = async (implicit: boolean, inputValue = chatInput.current.value) => {\r\n    const completeValue = getCompleteValue(inputValue)\r\n    completeRequestValue.current = completeValue\r\n    resetCompletionItems()\r\n    const newItems = await fetchCompletionItems?.(implicit ? 'implicit' : 'explicit', completeValue, inputValue) ?? []\r\n    if (completeValue !== completeRequestValue.current) return\r\n    setCompletionItemsSource(newItems)\r\n    updateFilteredCompleteItems(newItems)\r\n  }\r\n\r\n  const updateFilteredCompleteItems = (sourceItems: string[] | Array<{ match: string, toolip: string }>) => {\r\n    const newCompleteItems = sourceItems\r\n      .map((item): string => (typeof item === 'string' ? item : item.match))\r\n      .filter(item => {\r\n        // this regex is imporatnt is it controls the word matching\r\n        // const compareableParts = item.split(/[[\\]{},_:]/)\r\n        const lastWord = chatInput.current.value.slice(0, chatInput.current.selectionEnd ?? chatInput.current.value.length).split(' ').at(-1)!\r\n        // return [item, ...compareableParts].some(compareablePart => compareablePart.startsWith(lastWord))\r\n        return item.includes(lastWord)\r\n      })\r\n    setCompletionItems(newCompleteItems)\r\n  }\r\n\r\n  const getDefaultCompleteValue = () => {\r\n    const raw = chatInput.current.value\r\n    return raw.slice(0, chatInput.current.selectionEnd ?? raw.length)\r\n  }\r\n  const getCompleteValue = (value = getDefaultCompleteValue()) => {\r\n    const valueParts = value.split(' ')\r\n    const lastLength = valueParts.at(-1)!.length\r\n    const completeValue = lastLength ? value.slice(0, -lastLength) : value\r\n    if (valueParts.length === 1 && value.startsWith('/')) return '/'\r\n    return completeValue\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div\r\n        className={`chat-wrapper chat-messages-wrapper ${usingTouch ? 'display-mobile' : ''}`} style={{\r\n          userSelect: opened && allowSelection ? 'text' : undefined,\r\n        }}\r\n      >\r\n        {opacity && <div ref={chatMessages} className={`chat ${opened ? 'opened' : ''}`} id=\"chat-messages\" style={{ opacity }}>\r\n          {messages.map((m) => (\r\n            <MessageLine key={reactKeyForMessage(m)} message={m} />\r\n          ))}\r\n        </div> || undefined}\r\n      </div>\r\n\r\n      <div className={`chat-wrapper chat-input-wrapper ${usingTouch ? 'input-mobile' : ''}`} hidden={!opened}>\r\n        {/* close button */}\r\n        {usingTouch && <Button icon={pixelartIcons.close} onClick={() => onClose?.()} />}\r\n        <div className=\"chat-input\">\r\n          {isInputFocused && completionItems?.length ? (\r\n            <div className=\"chat-completions\">\r\n              <div className=\"chat-completions-pad-text\">{completePadText}</div>\r\n              <div className=\"chat-completions-items\">\r\n                {completionItems.map((item) => (\r\n                  <div\r\n                    key={item}\r\n                    onMouseDown={(e) => {\r\n                      e.preventDefault() // Prevent blur before click\r\n                      acceptComplete(item)\r\n                    }}\r\n                  >\r\n                    {item}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          ) : null}\r\n          <form onSubmit={(e) => {\r\n            e.preventDefault()\r\n            const message = chatInput.current.value\r\n            if (message) {\r\n              setSendHistory([...sendHistoryRef.current, message])\r\n              const result = sendMessage?.(message)\r\n              if (result !== false) {\r\n                onClose?.()\r\n              }\r\n              // Always scroll to bottom after sending a message\r\n              scrollToBottom()\r\n            }\r\n          }}\r\n          >\r\n            {isIos && <input\r\n              value=''\r\n              type=\"text\"\r\n              className=\"chat-mobile-input-hidden chat-mobile-input-hidden-up\"\r\n              id=\"chatinput-next-command\"\r\n              spellCheck={false}\r\n              autoComplete=\"off\"\r\n              onFocus={() => auxInputFocus('up')}\r\n              onChange={() => { }}\r\n            />}\r\n            <input\r\n              defaultValue=''\r\n              // ios doesn't support toggling autoCorrect on the fly so we need to re-create the input\r\n              key={spellCheckEnabled ? 'true' : 'false'}\r\n              ref={chatInput}\r\n              type=\"text\"\r\n              className=\"chat-input\"\r\n              id=\"chatinput\"\r\n              spellCheck={spellCheckEnabled}\r\n              autoCorrect={spellCheckEnabled ? 'on' : 'off'}\r\n              autoComplete=\"off\"\r\n              aria-autocomplete=\"both\"\r\n              onChange={onMainInputChange}\r\n              disabled={!!inputDisabled}\r\n              placeholder={inputDisabled || placeholder}\r\n              onFocus={() => setIsInputFocused(true)}\r\n              onBlur={() => setIsInputFocused(false)}\r\n              onKeyDown={(e) => {\r\n                if (e.code === 'ArrowUp') {\r\n                  handleArrowUp()\r\n                } else if (e.code === 'ArrowDown') {\r\n                  handleArrowDown()\r\n                }\r\n                if (e.code === 'Tab') {\r\n                  if (completionItemsSource.length) {\r\n                    if (completionItems.length) {\r\n                      acceptComplete(completionItems[0])\r\n                    }\r\n                  } else {\r\n                    void fetchCompletions(false)\r\n                  }\r\n                  e.preventDefault()\r\n                }\r\n                if (e.code === 'Space') {\r\n                  resetCompletionItems()\r\n                  if (chatInput.current.value.startsWith('/')) {\r\n                    // alternative we could just simply use keyup, but only with keydown we can display suggestions popup as soon as possible\r\n                    void fetchCompletions(true, getCompleteValue(getDefaultCompleteValue() + ' '))\r\n                  }\r\n                }\r\n              }}\r\n            />\r\n            {isIos && <input\r\n              value=''\r\n              type=\"text\"\r\n              className=\"chat-mobile-input-hidden chat-mobile-input-hidden-down\"\r\n              id=\"chatinput-prev-command\"\r\n              spellCheck={false}\r\n              autoComplete=\"off\"\r\n              onFocus={() => auxInputFocus('down')}\r\n              onChange={() => { }}\r\n            />}\r\n            {/* for some reason this is needed to make Enter work on android chrome */}\r\n            <button type='submit' className=\"chat-submit-button\" />\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n","import { useEffect, useMemo, useRef, useState } from 'react'\r\nimport { useSnapshot } from 'valtio'\r\nimport { formatMessage } from '../chatUtils'\r\nimport { getBuiltinCommandsList, tryHandleBuiltinCommand } from '../builtinCommands'\r\nimport { gameAdditionalState, hideCurrentModal, miscUiState } from '../globalState'\r\nimport { options } from '../optionsStorage'\r\nimport { viewerVersionState } from '../viewerConnector'\r\nimport Chat, { Message, fadeMessage } from './Chat'\r\nimport { useIsModalActive } from './utilsApp'\r\nimport { hideNotification, showNotification } from './NotificationProvider'\r\nimport { updateLoadedServerData } from './serversStorage'\r\nimport { lastConnectOptions } from './AppStatusProvider'\r\n\r\nexport default () => {\r\n  const [messages, setMessages] = useState([] as Message[])\r\n  const isChatActive = useIsModalActive('chat')\r\n  const { messagesLimit, chatOpacity, chatOpacityOpened } = options\r\n  const lastMessageId = useRef(0)\r\n  const usingTouch = useSnapshot(miscUiState).currentTouch\r\n  const { chatSelect } = useSnapshot(options)\r\n  const isUsingMicrosoftAuth = useMemo(() => !!lastConnectOptions.value?.authenticatedAccount, [])\r\n  const { forwardChat } = useSnapshot(viewerVersionState)\r\n  const { viewerConnection } = useSnapshot(gameAdditionalState)\r\n\r\n  useEffect(() => {\r\n    bot.addListener('message', (jsonMsg, position) => {\r\n      if (position === 'game_info') return // ignore action bar messages, they are handled by the TitleProvider\r\n      if (jsonMsg['unsigned']) {\r\n        jsonMsg = jsonMsg['unsigned']\r\n      }\r\n      const parts = formatMessage(jsonMsg)\r\n\r\n      setMessages(m => {\r\n        lastMessageId.current++\r\n        const newMessage: Message = {\r\n          parts,\r\n          id: lastMessageId.current,\r\n          faded: false,\r\n        }\r\n        fadeMessage(newMessage, true, () => {\r\n          // eslint-disable-next-line max-nested-callbacks\r\n          setMessages(m => [...m])\r\n        })\r\n        return [...m, newMessage].slice(-messagesLimit)\r\n      })\r\n    })\r\n  }, [])\r\n\r\n  return <Chat\r\n    allowSelection={chatSelect}\r\n    usingTouch={!!usingTouch}\r\n    opacity={(isChatActive ? chatOpacityOpened : chatOpacity) / 100}\r\n    messages={messages}\r\n    opened={isChatActive}\r\n    placeholder={forwardChat || !viewerConnection ? undefined : 'Chat forwarding is not enabled in the plugin settings'}\r\n    sendMessage={(message) => {\r\n      const builtinHandled = tryHandleBuiltinCommand(message)\r\n      if (miscUiState.loadedServerIndex && (message.startsWith('/login') || message.startsWith('/register'))) {\r\n        showNotification('Click here to save your password in browser for auto-login', undefined, false, undefined, () => {\r\n          updateLoadedServerData((server) => {\r\n            server.autoLogin ??= {}\r\n            const password = message.split(' ')[1]\r\n            server.autoLogin[bot.player.username] = password\r\n            return server\r\n          })\r\n          hideNotification()\r\n        })\r\n      }\r\n      if (!builtinHandled) {\r\n        bot.chat(message)\r\n      }\r\n    }}\r\n    onClose={() => {\r\n      hideCurrentModal()\r\n    }}\r\n    fetchCompletionItems={async (triggerKind, completeValue) => {\r\n      if ((triggerKind === 'explicit' || options.autoRequestCompletions)) {\r\n        let items = [] as string[]\r\n        try {\r\n          items = await bot.tabComplete(completeValue, true, true)\r\n        } catch (err) { }\r\n        if (typeof items[0] === 'object') {\r\n          // @ts-expect-error\r\n          if (items[0].match) items = items.map(i => i.match)\r\n        }\r\n        if (completeValue === '/') {\r\n          if (!items[0]?.startsWith('/')) {\r\n            // normalize\r\n            items = items.map(item => `/${item}`)\r\n          }\r\n          if (items.length) {\r\n            items = [...items, ...getBuiltinCommandsList()]\r\n          }\r\n        }\r\n        return items\r\n      }\r\n    }}\r\n  />\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport { proxy, useSnapshot } from 'valtio'\r\nimport { filesize } from 'filesize'\r\nimport Input from './Input'\r\nimport Screen from './Screen'\r\nimport Button from './Button'\r\nimport SelectGameVersion from './SelectGameVersion'\r\nimport styles from './createWorld.module.css'\r\n\r\n// const worldTypes = ['default', 'flat', 'largeBiomes', 'amplified', 'customized', 'buffet', 'debug_all_block_states']\r\nconst worldTypes = ['default', 'flat'/* , 'void' */]\r\nconst gameModes = ['survival', 'creative'/* , 'adventure', 'spectator' */]\r\n\r\nexport const creatingWorldState = proxy({\r\n  title: '',\r\n  type: worldTypes[0],\r\n  gameMode: gameModes[0],\r\n  version: ''\r\n})\r\n\r\nexport default ({ cancelClick, createClick, customizeClick, versions, defaultVersion }) => {\r\n  const [quota, setQuota] = useState('')\r\n\r\n  const { title, type, version, gameMode } = useSnapshot(creatingWorldState)\r\n  useEffect(() => {\r\n    creatingWorldState.version = defaultVersion\r\n    void navigator.storage?.estimate?.().then(({ quota, usage }) => {\r\n      setQuota(`Storage usage: ${usage === undefined ? '?' : filesize(usage)} / ${quota ? filesize(quota) : '?'}`)\r\n    })\r\n  }, [])\r\n\r\n  return <Screen title=\"Create world\" backdrop=\"dirt\">\r\n    <form\r\n      style={{ display: 'flex' }} onSubmit={(e) => {\r\n        e.preventDefault()\r\n        createClick()\r\n      }}\r\n    >\r\n      <Input\r\n        autoFocus\r\n        value={title}\r\n        onChange={({ target: { value } }) => {\r\n          creatingWorldState.title = value\r\n        }}\r\n        placeholder='World name'\r\n      />\r\n      <SelectGameVersion\r\n        versions={versions.map((obj) => { return { value: obj.version, label: obj.version } })}\r\n        selected={{ value: defaultVersion, label: defaultVersion }}\r\n        onChange={(value) => {\r\n          creatingWorldState.version = value ?? defaultVersion\r\n        }}\r\n        containerStyle={{ width: '100px' }}\r\n      />\r\n      <button type='submit' style={{ visibility: 'hidden' }} />\r\n    </form>\r\n    <div style={{ display: 'flex' }}>\r\n      <Button onClick={() => {\r\n        const index = worldTypes.indexOf(type)\r\n        creatingWorldState.type = worldTypes[index === worldTypes.length - 1 ? 0 : index + 1]\r\n      }}\r\n      >World Type: {type}\r\n      </Button>\r\n      {/* <Button onClick={() => customizeClick()} disabled>\r\n        Customize\r\n      </Button> */}\r\n      <Button onClick={() => {\r\n        const index = gameModes.indexOf(gameMode)\r\n        creatingWorldState.gameMode = gameModes[index === gameModes.length - 1 ? 0 : index + 1]\r\n      }}\r\n      >\r\n        Gamemode: {gameMode}\r\n      </Button>\r\n    </div>\r\n    <div className='muted' style={{ fontSize: 8 }}>Default and other world types are WIP</div>\r\n\r\n    <div style={{ display: 'flex' }}>\r\n      <Button onClick={() => {\r\n        cancelClick()\r\n      }}\r\n      >Cancel\r\n      </Button>\r\n      <Button disabled={!title} onClick={createClick}>Create</Button>\r\n    </div>\r\n    <div className='muted' style={{ fontSize: 9 }}>Note: save important worlds in folders on your hard drive!</div>\r\n    <div className='muted' style={{ fontSize: 9 }}>{quota}</div>\r\n  </Screen>\r\n}\r\n\r\nexport const WorldCustomize = ({ backClick }) => {\r\n  const { type } = useSnapshot(creatingWorldState)\r\n\r\n  return <Screen title='Customize world' backdrop='dirt'>\r\n    <div className={styles.world_layers_container}>\r\n      <div className=\"world_layer\" />\r\n    </div>\r\n    <Button onClick={backClick}>Back</Button>\r\n  </Screen>\r\n}\r\n","import { hideCurrentModal, showModal } from '../globalState'\r\nimport defaultLocalServerOptions from '../defaultLocalServerOptions'\r\nimport { mkdirRecursive, uniqueFileNameFromWorldName } from '../browserfs'\r\nimport supportedVersions from '../supportedVersions.mjs'\r\nimport CreateWorld, { WorldCustomize, creatingWorldState } from './CreateWorld'\r\nimport { getWorldsPath } from './SingleplayerProvider'\r\nimport { useIsModalActive } from './utilsApp'\r\n\r\nexport default () => {\r\n  const activeCreate = useIsModalActive('create-world')\r\n  const activeCustomize = useIsModalActive('customize-world')\r\n  if (activeCreate) {\r\n    const versionsPerMinor = Object.fromEntries(supportedVersions.map(x => [x.split('.').slice(0, 2), x]))\r\n    const versions = Object.values(versionsPerMinor).map(x => {\r\n      return {\r\n        version: x,\r\n        label: x === defaultLocalServerOptions.version ? `${x} (available offline)` : x\r\n      }\r\n    })\r\n    return <CreateWorld\r\n      defaultVersion={defaultLocalServerOptions.version}\r\n      cancelClick={() => {\r\n        hideCurrentModal()\r\n      }}\r\n      createClick={async () => {\r\n        // create new world\r\n        const { title, type, version, gameMode } = creatingWorldState\r\n        // todo display path in ui + disable if exist\r\n        const savePath = await uniqueFileNameFromWorldName(title, getWorldsPath())\r\n        await mkdirRecursive(savePath)\r\n        let generation\r\n        if (type === 'flat') {\r\n          generation = {\r\n            name: 'superflat',\r\n          }\r\n        }\r\n        if (type === 'void') {\r\n          generation = {\r\n            name: 'superflat',\r\n            layers: [],\r\n            noDefaults: true\r\n          }\r\n        }\r\n        if (type === 'nether') {\r\n          generation = {\r\n            name: 'nether'\r\n          }\r\n        }\r\n        hideCurrentModal()\r\n        window.dispatchEvent(new CustomEvent('singleplayer', {\r\n          detail: {\r\n            levelName: title,\r\n            version,\r\n            generation,\r\n            'worldFolder': savePath,\r\n            gameMode: gameMode === 'survival' ? 0 : 1,\r\n          },\r\n        }))\r\n      }}\r\n      customizeClick={() => {\r\n        showModal({ reactType: 'customize-world' })\r\n      }}\r\n      versions={versions}\r\n    />\r\n  }\r\n  if (activeCustomize) {\r\n    return <WorldCustomize backClick={() => hideCurrentModal()} />\r\n  }\r\n  return null\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport './Crosshair.css'\r\nimport { proxy, useSnapshot } from 'valtio'\r\nimport SharedHudVars from './SharedHudVars'\r\n\r\n// todo move to mineflayer\r\nexport const itemBeingUsed = proxy({\r\n  name: null as string | null,\r\n  hand: 0 as 0 | 1\r\n})\r\n\r\nexport default () => {\r\n  const { name: usingItem, hand } = useSnapshot(itemBeingUsed)\r\n\r\n  const [displayIndicator, setDisplayIndicator] = useState(false)\r\n  const [indicatorProgress, setIndicatorProgress] = useState(0)\r\n  const [alternativeIndicator, setAlternativeIndicator] = useState(false)\r\n  const boxMaxTimeMs = 1000\r\n  // todo add sword indicator\r\n  const indicatorSize = 20\r\n\r\n  useEffect(() => {\r\n    bot.on('heldItemChanged' as any, () => {\r\n      const displayBar = (item: import('prismarine-item').Item | null) => {\r\n        const itemName = item?.name\r\n        if (!itemName) return\r\n        return loadedData.foodsArray.map((food) => food.name).includes(itemName) || itemName === 'bow' || itemName === 'shield' || itemName === 'crossbow'\r\n      }\r\n      setDisplayIndicator(displayBar(bot.heldItem) || displayBar(bot.inventory.slots[45]) || false)\r\n    })\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    setAlternativeIndicator(usingItem === 'shield')\r\n    if (!usingItem) return\r\n    const startTime = Date.now()\r\n    let maxTime = 0\r\n    if (usingItem === 'bow' || usingItem === 'crossbow') {\r\n      maxTime = 1000\r\n    }\r\n    const isFood = loadedData.foodsArray.some((food) => food.name === usingItem)\r\n    if (isFood) {\r\n      maxTime = 32 * 50\r\n    }\r\n    if (!maxTime) return\r\n\r\n    const id = setInterval(() => {\r\n      const progress = (Date.now() - startTime) / boxMaxTimeMs\r\n      if (progress >= 1) {\r\n        clearInterval(id)\r\n      } else {\r\n        setIndicatorProgress(progress)\r\n      }\r\n    }, 1000 / 60)\r\n    return () => {\r\n      setIndicatorProgress(0)\r\n      clearInterval(id)\r\n    }\r\n  }, [usingItem])\r\n\r\n  return <SharedHudVars>\r\n    <div className='crosshair' />\r\n    {displayIndicator && <div\r\n      className='crosshair-indicator' style={{\r\n      //@ts-expect-error\r\n        '--crosshair-indicator-size': `${indicatorSize}px`,\r\n        borderLeft: `solid ${indicatorSize * indicatorProgress}px white`,\r\n        backgroundColor: alternativeIndicator ? 'dodgerblue' : undefined,\r\n      }}\r\n    />}\r\n  </SharedHudVars>\r\n}\r\n","import './deathScreen.css'\r\nimport type { MessageFormatPart } from '../chatUtils'\r\nimport MessageFormatted from './MessageFormatted'\r\nimport Button from './Button'\r\n\r\ntype Props = {\r\n  dieReasonMessage: MessageFormatPart[]\r\n  respawnCallback: () => void\r\n  disconnectCallback: () => void\r\n}\r\n\r\nexport default ({ dieReasonMessage, respawnCallback, disconnectCallback }: Props) => {\r\n  return (\r\n    <div className='deathScreen-container'>\r\n      <div className=\"deathScreen\">\r\n        <h1 className='deathScreen-title'>You Died!</h1>\r\n        <h5 className='deathScreen-reason'>\r\n          <MessageFormatted parts={dieReasonMessage} />\r\n        </h5>\r\n        <div className='deathScreen-buttons-grouped'>\r\n          <Button\r\n            label=\"Respawn\" onClick={() => {\r\n              respawnCallback()\r\n            }}\r\n          />\r\n          <Button\r\n            label=\"Disconnnect\" onClick={() => {\r\n              disconnectCallback()\r\n            }}\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import { useEffect } from 'react'\r\nimport { proxy, useSnapshot } from 'valtio'\r\nimport { disconnect } from '../flyingSquidUtils'\r\nimport { MessageFormatPart, formatMessage } from '../chatUtils'\r\nimport { showModal, hideModal } from '../globalState'\r\nimport { options } from '../optionsStorage'\r\nimport DeathScreen from './DeathScreen'\r\nimport { useIsModalActive } from './utilsApp'\r\n\r\nconst dieReasonProxy = proxy({ value: null as MessageFormatPart[] | null })\r\n\r\nexport default () => {\r\n  const { value: dieReasonMessage } = useSnapshot(dieReasonProxy)\r\n  const isModalActive = useIsModalActive('death-screen')\r\n\r\n  useEffect(() => {\r\n    bot._client.on('death_combat_event', (data) => {\r\n      try {\r\n        if (data.playerId !== bot.entity.id) return\r\n        const messageParsed = JSON.parse(data.message)\r\n        const parts = formatMessage(messageParsed)\r\n        dieReasonProxy.value = parts\r\n      } catch (err) {\r\n        console.error(err)\r\n      }\r\n    })\r\n    bot.on('health', () => { // bot.isAlive can be already false so can't use death event (respawn packet)\r\n      if (dieReasonProxy.value || bot.health > 0) return\r\n      dieReasonProxy.value = []\r\n    })\r\n\r\n    bot.on('respawn', () => {\r\n      // todo don't close too early, instead wait for health event and make button disabled?\r\n      dieReasonProxy.value = null\r\n    })\r\n\r\n    if (bot.health === 0) {\r\n      dieReasonProxy.value = []\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    if (dieReasonProxy.value) {\r\n      if (!isModalActive) showModal({ reactType: 'death-screen' })\r\n    } else if (isModalActive) {\r\n      hideModal({ reactType: 'death-screen' })\r\n    }\r\n  }, [dieReasonMessage, isModalActive])\r\n\r\n  if (!isModalActive || !dieReasonMessage || options.autoRespawn) return null\r\n\r\n  return <DeathScreen\r\n    dieReasonMessage={dieReasonMessage as MessageFormatPart[]}\r\n    respawnCallback={() => {\r\n      bot._client.write('client_command', bot.supportFeature('respawnIsPayload') ? { payload: 0 } : { actionId: 0 })\r\n    }}\r\n    disconnectCallback={() => {\r\n      void disconnect()\r\n    }}\r\n  />\r\n}\r\n","import { useState } from 'react'\r\nimport { useIsHashActive } from './simpleHooks'\r\n\r\nexport default () => {\r\n  const MODES_COUNT = 5\r\n  const [mode, setMode] = useState(0)\r\n  const isHashActive = useIsHashActive('#edges')\r\n\r\n  if (!isHashActive) return null\r\n\r\n  const styles: React.CSSProperties = {\r\n    display: 'flex',\r\n    fontSize: 18,\r\n    zIndex: 10_000,\r\n    background: 'rgba(0, 0, 255, 0.5)',\r\n    border: '2px solid red',\r\n    whiteSpace: 'pre',\r\n  }\r\n  let text = ''\r\n  if (mode === 0) {\r\n    styles.position = 'fixed'\r\n    styles.inset = 0\r\n    styles.height = '100%'\r\n    text = 'inset 0 fixed 100% height'\r\n  }\r\n  if (mode === 1) {\r\n    styles.position = 'fixed'\r\n    styles.inset = 0\r\n    text = 'inset 0 fixed'\r\n  }\r\n  if (mode === 2) {\r\n    styles.position = 'absolute'\r\n    styles.inset = 0\r\n    text = 'inset 0 absolute'\r\n  }\r\n  if (mode === 3) {\r\n    styles.position = 'fixed'\r\n    styles.top = 0\r\n    styles.left = 0\r\n    styles.right = 0\r\n    styles.height = '100dvh'\r\n    text = 'top 0 fixed 100dvh'\r\n  }\r\n  if (mode === 4) {\r\n    styles.position = 'fixed'\r\n    styles.top = 0\r\n    styles.left = 0\r\n    styles.right = 0\r\n    styles.height = '100dvh'\r\n    text = 'top 0 bottom 0 fixed 100dvh'\r\n  }\r\n\r\n  return <div\r\n    style={styles}\r\n    onClick={() => {\r\n      setMode((mode + 1) % MODES_COUNT)\r\n    }}\r\n  >\r\n    {mode}: {text}{'\\n'}\r\n    inner: {window.innerWidth}x{window.innerHeight}{'\\n'}\r\n    outer: {window.outerWidth}x{window.outerHeight}{'\\n'}\r\n  </div>\r\n}\r\n","import { useEffect, useRef, useMemo, useState } from 'react'\r\nimport * as THREE from 'three'\r\nimport type { Block } from 'prismarine-block'\r\nimport { getFixedFilesize } from '../downloadAndOpenFile'\r\nimport { options } from '../optionsStorage'\r\nimport { getBlockAssetsCacheKey } from '../../renderer/viewer/lib/mesher/shared'\r\nimport styles from './DebugOverlay.module.css'\r\n\r\nexport default () => {\r\n  const received = useRef({ ...defaultPacketsCount })\r\n  const sent = useRef({ ...defaultPacketsCount })\r\n  const customEntries = useRef({} as any)\r\n  const receivedTotal = useRef(0)\r\n  const packetsCountByNamePerSec = useRef({\r\n    received: {} as { [key: string]: number },\r\n    sent: {} as { [key: string]: number }\r\n  })\r\n  window.packetsCountByNamePerSec = packetsCountByNamePerSec\r\n  const packetsCountByNamePer10Sec = useRef({\r\n    received: {} as { [key: string]: number },\r\n    sent: {} as { [key: string]: number }\r\n  })\r\n  window.packetsCountByNamePer10Sec = packetsCountByNamePer10Sec\r\n  const packetsCountByName = useRef({\r\n    received: {} as { [key: string]: number },\r\n    sent: {} as { [key: string]: number }\r\n  })\r\n  window.packetsCountByName = packetsCountByName\r\n  const ignoredPackets = useRef(new Set([] as any[]))\r\n  const [packetsString, setPacketsString] = useState('')\r\n  const [showDebug, setShowDebug] = useState(false)\r\n  const [pos, setPos] = useState<{ x: number, y: number, z: number }>({ x: 0, y: 0, z: 0 })\r\n  const [skyL, setSkyL] = useState(0)\r\n  const [blockL, setBlockL] = useState(0)\r\n  const [biomeId, setBiomeId] = useState(0)\r\n  const [day, setDay] = useState(0)\r\n  const [entitiesCount, setEntitiesCount] = useState('0')\r\n  const [dimension, setDimension] = useState('')\r\n  const [cursorBlock, setCursorBlock] = useState<Block | null>(null)\r\n  const minecraftYaw = useRef(0)\r\n  const minecraftQuad = useRef(0)\r\n  const { rendererDevice } = viewer.world\r\n\r\n  const quadsDescription = [\r\n    'north (towards negative Z)',\r\n    'east (towards positive X)',\r\n    'south (towards positive Z)',\r\n    'west (towards negative X)'\r\n  ]\r\n\r\n  const viewDegToMinecraft = (yaw) => yaw % 360 - 180 * (yaw < 0 ? -1 : 1)\r\n\r\n  const handleF3 = (e) => {\r\n    if (e.code === 'F3') {\r\n      setShowDebug(prev => !prev)\r\n      e.preventDefault()\r\n    }\r\n  }\r\n\r\n  const readPacket = (data, { name }, _buf, fullBuffer) => {\r\n    if (fullBuffer) {\r\n      const size = fullBuffer.byteLength\r\n      receivedTotal.current += size\r\n      received.current.size += size\r\n    }\r\n    received.current.count++\r\n    managePackets('received', name, data)\r\n  }\r\n\r\n  const managePackets = (type, name, data) => {\r\n    packetsCountByName.current[type][name] ??= 0\r\n    packetsCountByName.current[type][name]++\r\n    packetsCountByNamePerSec.current[type][name] ??= 0\r\n    packetsCountByNamePerSec.current[type][name]++\r\n    packetsCountByNamePer10Sec.current[type][name] ??= 0\r\n    packetsCountByNamePer10Sec.current[type][name]++\r\n    if (options.debugLogNotFrequentPackets && !ignoredPackets.current.has(name) && !hardcodedListOfDebugPacketsToIgnore[type].includes(name)) {\r\n      if (packetsCountByNamePerSec.current[type][name] > 5 || packetsCountByName.current[type][name] > 100) { // todo think of tracking the count within 10s\r\n        console.info(`[packet ${name} was ${type} too frequent] Ignoring...`)\r\n        ignoredPackets.current.add(name)\r\n      } else {\r\n        console.info(`[packet ${type}] ${name}`, /* ${JSON.stringify(data, null, 2)}` */ data)\r\n      }\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    document.addEventListener('keydown', handleF3)\r\n    let update = 0\r\n    const packetsUpdateInterval = setInterval(() => {\r\n      setPacketsString(` ${received.current.count} (${(received.current.size / 1024).toFixed(2)} KB/s, ${getFixedFilesize(receivedTotal.current)})  ${sent.current.count}`)\r\n      received.current = { ...defaultPacketsCount }\r\n      sent.current = { ...defaultPacketsCount }\r\n      packetsCountByNamePerSec.current.received = {}\r\n      packetsCountByNamePerSec.current.sent = {}\r\n      if (update++ % 10 === 0) {\r\n        packetsCountByNamePer10Sec.current.received = {}\r\n        packetsCountByNamePer10Sec.current.sent = {}\r\n      }\r\n    }, 1000)\r\n\r\n    const freqUpdateInterval = setInterval(() => {\r\n      setPos({ ...bot.entity.position })\r\n      setSkyL(bot.world.getSkyLight(bot.entity.position))\r\n      setBlockL(bot.world.getBlockLight(bot.entity.position))\r\n      setBiomeId(bot.world.getBiome(bot.entity.position))\r\n      setDimension(bot.game.dimension)\r\n      setDay(bot.time.day)\r\n      setCursorBlock(bot.blockAtCursor(5))\r\n      setEntitiesCount(`${viewer.entities.entitiesRenderingCount} (${Object.values(bot.entities).length})`)\r\n    }, 100)\r\n\r\n    // @ts-expect-error\r\n    bot._client.on('packet', readPacket)\r\n    // @ts-expect-error\r\n    bot._client.on('packet_name' as any, (name, data) => readPacket(data, { name })) // custom client\r\n    bot._client.on('writePacket' as any, (name, data) => {\r\n      sent.current.count++\r\n      managePackets('sent', name, data)\r\n    })\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', handleF3)\r\n      clearInterval(packetsUpdateInterval)\r\n      clearInterval(freqUpdateInterval)\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    minecraftYaw.current = viewDegToMinecraft(bot.entity.yaw * -180 / Math.PI)\r\n    minecraftQuad.current = Math.floor(((minecraftYaw.current + 180) / 90 + 0.5) % 4)\r\n  }, [bot.entity.yaw])\r\n\r\n  if (!showDebug) return null\r\n\r\n  return <>\r\n    <div className={`debug-left-side ${styles['debug-left-side']}`}>\r\n      <p>Prismarine Web Client ({bot.version})</p>\r\n      <p>E: {entitiesCount}</p>\r\n      <p>{dimension}</p>\r\n      <div className={styles.empty} />\r\n      <p>XYZ: {pos.x.toFixed(3)} / {pos.y.toFixed(3)} / {pos.z.toFixed(3)}</p>\r\n      <p>Chunk: {Math.floor(pos.x % 16)} ~ {Math.floor(pos.z % 16)} in {Math.floor(pos.x / 16)} ~ {Math.floor(pos.z / 16)}</p>\r\n      <p>Packets: {packetsString}</p>\r\n      <p>Facing (viewer): {bot.entity.yaw.toFixed(3)} {bot.entity.pitch.toFixed(3)}</p>\r\n      <p>Facing (minecraft): {quadsDescription[minecraftQuad.current]} ({minecraftYaw.current.toFixed(1)} {(bot.entity.pitch * -180 / Math.PI).toFixed(1)})</p>\r\n      <p>Light: {blockL} ({skyL} sky)</p>\r\n\r\n      <p>Biome: minecraft:{loadedData.biomesArray[biomeId]?.name ?? 'unknown biome'}</p>\r\n      <p>Day: {day}</p>\r\n      <div className={styles.empty} />\r\n      {Object.entries(customEntries.current).map(([name, value]) => <p key={name}>{name}: {value}</p>)}\r\n    </div>\r\n\r\n    <div className={`debug-right-side ${styles['debug-right-side']}`}>\r\n      <p>Renderer: {rendererDevice}</p>\r\n      <div className={styles.empty} />\r\n      {cursorBlock ? (<>\r\n        <p>{cursorBlock.name}</p>\r\n        {\r\n          Object.entries(cursorBlock.getProperties()).map(([name, value], idx, arr) => {\r\n            return <p key={name}>\r\n              {name}: {\r\n                typeof value === 'boolean' ? (\r\n                  <span style={{ color: value ? 'lightgreen' : 'red' }}>{String(value)}</span>\r\n                ) : value\r\n              }\r\n            </p>\r\n          })\r\n        }\r\n      </>)\r\n        : ''}\r\n      {cursorBlock ? (\r\n        <p>Looking at: {cursorBlock.position.x} {cursorBlock.position.y} {cursorBlock.position.z}</p>\r\n      ) : ''}\r\n      <div className={styles.empty} />\r\n      {cursorBlock && (() => {\r\n        const chunkKey = `${Math.floor(cursorBlock.position.x / 16) * 16},${Math.floor(cursorBlock.position.z / 16) * 16}`\r\n        const customBlockName = viewer.world.protocolCustomBlocks.get(chunkKey)?.[`${cursorBlock.position.x},${cursorBlock.position.y},${cursorBlock.position.z}`]\r\n        const cacheKey = getBlockAssetsCacheKey(cursorBlock.stateId, customBlockName)\r\n        const modelInfo = viewer.world.blockStateModelInfo.get(cacheKey)\r\n        return modelInfo && (\r\n          <>\r\n            {customBlockName && <p style={{ fontSize: 7, }}>Custom block: {customBlockName}</p>}\r\n            {modelInfo.issues.map((issue, i) => (\r\n              <p key={i} style={{ color: 'yellow', fontSize: 7, }}>{issue}</p>\r\n            ))}\r\n            {/* <p style={{ fontSize: 7, }}>Resolved models chain: {modelInfo.modelNames.join(' -> ')}</p> */}\r\n            <p style={{ fontSize: 7, }}>Resolved model: {modelInfo.modelNames[0] ?? '-'}</p>\r\n            <p style={{ fontSize: 7, whiteSpace: 'nowrap', maxWidth: '100px', overflow: 'hidden', textOverflow: 'ellipsis' }}>\r\n              {modelInfo.conditions.join(', ')}\r\n            </p>\r\n          </>\r\n        )\r\n      })()}\r\n    </div>\r\n  </>\r\n}\r\n\r\nconst hardcodedListOfDebugPacketsToIgnore = {\r\n  received: [\r\n    'entity_velocity',\r\n    'sound_effect',\r\n    'rel_entity_move',\r\n    'entity_head_rotation',\r\n    'entity_metadata',\r\n    'entity_move_look',\r\n    'teams',\r\n    'entity_teleport',\r\n    'entity_look',\r\n    'ping',\r\n    'entity_update_attributes',\r\n    'player_info',\r\n    'update_time',\r\n    'animation',\r\n    'entity_equipment',\r\n    'entity_destroy',\r\n    'named_entity_spawn',\r\n    'update_light',\r\n    'set_slot',\r\n    'block_break_animation',\r\n    'map_chunk',\r\n    'spawn_entity',\r\n    'world_particles',\r\n    'keep_alive',\r\n    'chat',\r\n    'playerlist_header',\r\n    'scoreboard_objective',\r\n    'scoreboard_score',\r\n    'entity_status'\r\n  ],\r\n  sent: [\r\n    'pong',\r\n    'position',\r\n    'look',\r\n    'keep_alive',\r\n    'position_look'\r\n  ]\r\n}\r\n\r\nconst defaultPacketsCount = {\r\n  count: 0,\r\n  size: 0\r\n}\r\n","import { useFloating, arrow, FloatingArrow, offset as offsetMiddleware, Placement, autoPlacement } from '@floating-ui/react'\r\nimport { openURL } from 'renderer/viewer/lib/simpleUtils'\r\nimport { CSSProperties, useState } from 'react'\r\nimport Button from './Button'\r\nimport PixelartIcon, { pixelartIcons } from './PixelartIcon'\r\n\r\nexport const DiscordButton = ({ text, style }: { text?: string, style?: Record<string, any> }) => {\r\n  const links: DropdownButtonItem[] = [\r\n    {\r\n      text: 'Support Official Server (mcraft.fun)',\r\n      clickHandler: () => openURL('https://discord.gg/xzGRhxtRUt')\r\n    },\r\n    {\r\n      text: 'Community Server (PrismarineJS)',\r\n      clickHandler: () => openURL('https://discord.gg/4Ucm684Fq3')\r\n    }\r\n  ]\r\n\r\n  return <DropdownButton text={text ?? 'Discord'} style={style} links={links} />\r\n}\r\n\r\nexport type DropdownButtonItem = {\r\n  text: string,\r\n  clickHandler: () => void\r\n}\r\n\r\nexport const DropdownButton = ({ text, style, links }: { text: string, style?: Record<string, any>, links: DropdownButtonItem[] }) => {\r\n  const [isOpen, setIsOpen] = useState(false)\r\n  const { refs, floatingStyles } = useFloating({\r\n    open: isOpen,\r\n    onOpenChange: setIsOpen,\r\n    middleware: [\r\n      autoPlacement()\r\n    ],\r\n  })\r\n\r\n  const styles: CSSProperties = {\r\n    ...floatingStyles,\r\n    background: 'rgba(0, 0, 0, 0.3)',\r\n    fontSize: 8,\r\n    userSelect: 'text',\r\n    padding: '2px 4px',\r\n    opacity: 1,\r\n    transition: 'opacity 0.3s ease-in-out',\r\n    textShadow: '1px 1px 2px BLACK',\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    zIndex: 11\r\n  }\r\n\r\n  return <>\r\n    <Button\r\n      style={style ?? { position: 'relative', width: '98px' }}\r\n      rootRef={refs.setReference}\r\n      onClick={() => {\r\n        setIsOpen(!isOpen)\r\n      }}\r\n    >{text}<PixelartIcon\r\n        styles={{ position: 'absolute', top: '5px', right: '5px' }}\r\n        iconName={isOpen ? pixelartIcons['chevron-up'] : pixelartIcons['chevron-down']}\r\n      />\r\n    </Button>\r\n    {\r\n      isOpen && <div ref={refs.setFloating} style={styles}>\r\n        {links.map(el => {\r\n          return <Button\r\n            key={el.text}\r\n            style={{ width: '98px', fontSize: '7px' }}\r\n            onClick={el.clickHandler}\r\n          >{el.text}\r\n          </Button>\r\n        })}\r\n      </div>\r\n    }\r\n  </>\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport { Transition } from 'react-transition-group'\r\nimport styles from './DiveTransition.module.css'\r\n\r\n// dive animation from framework7\r\n\r\nconst startStyle = { opacity: 0, transform: 'translateZ(-150px)' }\r\nconst endExitStyle = { opacity: 0, transform: 'translateZ(150px)' }\r\nconst endStyle = { opacity: 1, transform: 'translateZ(0)' }\r\n\r\nconst stateStyles = {\r\n  entering: endStyle,\r\n  entered: endStyle,\r\n  exiting: endExitStyle,\r\n  exited: endExitStyle,\r\n}\r\nconst duration = 300\r\nconst basicStyle = {\r\n  transition: `${duration}ms ease-in-out all`,\r\n}\r\n\r\nexport default ({ children, open }) => {\r\n  const [mounted, setMounted] = useState(false)\r\n\r\n  useEffect(() => {\r\n    if (!mounted && open) {\r\n      setMounted(true)\r\n    }\r\n    let timeout\r\n    if (mounted && !open) {\r\n      timeout = setTimeout(() => {\r\n        setMounted(false)\r\n      }, duration)\r\n    }\r\n    return () => {\r\n      if (timeout) clearTimeout(timeout)\r\n    }\r\n  }, [open])\r\n\r\n  if (!mounted) return null\r\n\r\n  return <Transition\r\n    in={open}\r\n    timeout={duration}\r\n    mountOnEnter\r\n    unmountOnExit\r\n  >\r\n    {(state) => {\r\n      return <div className={styles.container}>\r\n        {/* todo resolve compl */}\r\n        <div style={{ ...basicStyle, ...stateStyles[state] }} className={styles.main}>{children}</div>\r\n      </div>\r\n    }}\r\n  </Transition>\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport { useSnapshot } from 'valtio'\r\nimport { activeModalStack, miscUiState } from '../globalState'\r\nimport Button from './Button'\r\nimport { useUsingTouch } from './utilsApp'\r\nimport { pixelartIcons } from './PixelartIcon'\r\nimport { showNotification } from './NotificationProvider'\r\n\r\nconst hideOnModals = new Set(['chat'])\r\n\r\nexport default () => {\r\n  const [fullScreen, setFullScreen] = useState(false)\r\n  useEffect(() => {\r\n    document.documentElement.addEventListener('fullscreenchange', () => {\r\n      setFullScreen(!!document.fullscreenElement)\r\n    })\r\n  }, [])\r\n  const { gameLoaded } = useSnapshot(miscUiState)\r\n\r\n  const activeStack = useSnapshot(activeModalStack)\r\n\r\n  const inMainMenu = activeStack.length === 0 && !gameLoaded\r\n\r\n  const usingTouch = useUsingTouch()\r\n  const hideButton = activeStack.some(x => hideOnModals.has(x.reactType))\r\n\r\n  if (hideButton || !usingTouch || !document.documentElement.requestFullscreen || fullScreen) return null\r\n\r\n  return <Button\r\n    icon={pixelartIcons.scale}\r\n    style={{\r\n      position: 'fixed',\r\n      top: 5,\r\n      left: inMainMenu ? 35 : 5,\r\n      width: 22,\r\n    }}\r\n    onClick={async () => {\r\n      try {\r\n        await document.documentElement.requestFullscreen()\r\n      } catch (err) {\r\n        showNotification(`${err.message ?? err}`, undefined, true)\r\n      }\r\n    }}\r\n  />\r\n}\r\n","import { useRef, useState, useEffect } from 'react'\r\nimport SharedHudVars from './SharedHudVars'\r\nimport './FoodBar.css'\r\nimport { barEffectAdded, barEffectEnded } from './BarsCommon'\r\n\r\n\r\nexport type FoodBarProps = {\r\n  gameMode?: string,\r\n  food: number,\r\n  effectToAdd?: number | null,\r\n  effectToRemove?: number | null,\r\n  resetEffects?: () => void,\r\n  style?: React.CSSProperties\r\n}\r\n\r\nexport default ({\r\n  gameMode,\r\n  food,\r\n  effectToAdd,\r\n  effectToRemove,\r\n  resetEffects,\r\n  style\r\n}: FoodBarProps) => {\r\n  const foodRef = useRef<HTMLDivElement | null>(null)\r\n\r\n  useEffect(() => {\r\n    if (foodRef.current) {\r\n      foodRef.current.classList.toggle('creative', gameMode === 'creative' || gameMode === 'spectator')\r\n    }\r\n  }, [gameMode])\r\n\r\n  useEffect(() => {\r\n    const foodbar = foodRef.current\r\n    if (foodbar) {\r\n      foodbar.classList.toggle('low', food <= 5)\r\n\r\n      const foods = foodbar.children\r\n\r\n      for (const food of foods) {\r\n        food.classList.remove('full')\r\n        food.classList.remove('half')\r\n      }\r\n\r\n      for (let i = 0; i < Math.ceil(food / 2); i++) {\r\n        if (i >= foods.length) break\r\n\r\n        if (food % 2 !== 0 && Math.ceil(food / 2) === i + 1) {\r\n          foods[i].classList.add('half')\r\n        } else {\r\n          foods[i].classList.add('full')\r\n        }\r\n      }\r\n    }\r\n  }, [food])\r\n\r\n  useEffect(() => {\r\n    if (effectToAdd) {\r\n      barEffectAdded(foodRef.current, effectToAdd)\r\n    }\r\n    if (effectToRemove) {\r\n      barEffectEnded(foodRef.current, effectToRemove)\r\n    }\r\n    resetEffects?.()\r\n  }, [effectToAdd, effectToRemove])\r\n\r\n  return <SharedHudVars>\r\n    <div ref={foodRef} className='foodbar' style={style}>\r\n      {\r\n        Array.from({ length: 10 }, () => 0)\r\n          .map((num, index) => <div\r\n            key={`food-${index}`}\r\n            className='food'\r\n          />)\r\n      }\r\n    </div>\r\n  </SharedHudVars>\r\n}\r\n","import Screen from './Screen'\r\nimport { useIsWidgetActive } from './utilsApp'\r\n\r\nexport default ({ name, title, children }) => {\r\n  const isWidgetActive = useIsWidgetActive(name)\r\n\r\n  if (!isWidgetActive) return null\r\n\r\n  return <Screen backdrop title={title}>{children}</Screen>\r\n}\r\n","import { Vec3 } from 'vec3'\r\nimport { useRef, useEffect, useState, CSSProperties, Dispatch, SetStateAction } from 'react'\r\nimport { WorldWarp } from 'flying-squid/dist/lib/modules/warps'\r\nimport { TransformWrapper, TransformComponent, ReactZoomPanPinchRef } from 'react-zoom-pan-pinch'\r\nimport { DrawerAdapter } from './MinimapDrawer'\r\nimport Button from './Button'\r\nimport Input from './Input'\r\nimport './Fullmap.css'\r\n\r\n\r\ntype FullmapProps = {\r\n  adapter: DrawerAdapter,\r\n  toggleFullMap?: () => void,\r\n}\r\n\r\nexport default ({ adapter, toggleFullMap }: FullmapProps) => {\r\n  const [grid, setGrid] = useState(() => new Set<string>())\r\n  const zoomRef = useRef<ReactZoomPanPinchRef>(null)\r\n  const [redraw, setRedraw] = useState<Set<string> | null>(null)\r\n  const [lastWarpPos, setLastWarpPos] = useState({ x: 0, y: 0, z: 0 })\r\n  const stateRef = useRef({ scale: 1, positionX: 0, positionY: 0 })\r\n  const cells = useRef({ columns: 0, rows: 0 })\r\n  const [isWarpInfoOpened, setIsWarpInfoOpened] = useState(false)\r\n  const [initWarp, setInitWarp] = useState<WorldWarp | undefined>(undefined)\r\n  const [warpPreview, setWarpPreview] = useState<{ name: string, x: number, z: number, clientX: number, clientY: number } | undefined>(undefined)\r\n\r\n  const updateGrid = () => {\r\n    const wrapperRect = zoomRef.current?.instance.wrapperComponent?.getBoundingClientRect()\r\n    if (!wrapperRect) return\r\n    const cellSize = 64\r\n    const columns = Math.ceil(wrapperRect.width / (cellSize * stateRef.current.scale))\r\n    const rows = Math.ceil(wrapperRect.height / (cellSize * stateRef.current.scale))\r\n    cells.current.rows = rows\r\n    cells.current.columns = columns\r\n    const leftBorder = - Math.floor(stateRef.current.positionX / (stateRef.current.scale * cellSize)) * cellSize\r\n    const topBorder = - Math.floor(stateRef.current.positionY / (stateRef.current.scale * cellSize)) * cellSize\r\n    const newGrid = new Set<string>()\r\n    for (let row = -1; row < rows; row += 1) {\r\n      for (let col = -1; col < columns; col += 1) {\r\n        const x = leftBorder + col * cellSize\r\n        const y = topBorder + row * cellSize\r\n        newGrid.add(`${x},${y}`)\r\n      }\r\n    }\r\n    setGrid(newGrid)\r\n  }\r\n\r\n  useEffect(() => {\r\n    adapter.full = true\r\n    console.log('[fullmap] set full property to true')\r\n    updateGrid()\r\n  }, [])\r\n\r\n  return <div\r\n    style={{\r\n      position: 'fixed',\r\n      isolation: 'isolate',\r\n      inset: '0px',\r\n      display: 'flex',\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n      backgroundColor: 'rgba(0, 0, 0, 0.4)',\r\n      zIndex: 100\r\n    }}\r\n  >\r\n    {window.screen.width > 500 ? <div\r\n      style={{\r\n        position: 'absolute',\r\n        width: '100%',\r\n        height: '100%',\r\n        zIndex: '-1'\r\n      }}\r\n      onClick={toggleFullMap}\r\n    > </div>\r\n      : <Button\r\n        icon=\"close-box\"\r\n        onClick={toggleFullMap}\r\n        style={{\r\n          position: 'absolute',\r\n          top: '20px',\r\n          right: '20px',\r\n          zIndex: 1\r\n        }}\r\n      />}\r\n    <TransformWrapper\r\n      limitToBounds={false}\r\n      ref={zoomRef}\r\n      minScale={0.1}\r\n      doubleClick={{\r\n        disabled: false\r\n      }}\r\n      panning={{\r\n        allowLeftClickPan: true,\r\n        allowRightClickPan: false\r\n      }}\r\n      onTransformed={(ref, state) => {\r\n        stateRef.current = { ...state }\r\n      }}\r\n      onPanningStop={() => {\r\n        updateGrid()\r\n      }}\r\n      onZoomStop={() => {\r\n        updateGrid()\r\n      }}\r\n    >\r\n      <TransformComponent\r\n        wrapperClass=\"map\"\r\n        wrapperStyle={{\r\n          willChange: 'transform',\r\n        }}\r\n      >\r\n        {[...grid].map((cellCoords) => {\r\n          const [x, y] = cellCoords.split(',').map(Number)\r\n          const playerChunkLeft = Math.floor(adapter.playerPosition.x / 16) * 16\r\n          const playerChunkTop = Math.floor(adapter.playerPosition.z / 16) * 16\r\n          const wrapperRect = zoomRef.current?.instance.wrapperComponent?.getBoundingClientRect()\r\n          const offsetX = Math.floor((wrapperRect?.width ?? 0) / (8 * 16)) * 16\r\n          const offsetY = Math.floor((wrapperRect?.height ?? 0) / (8 * 16)) * 16\r\n\r\n          return <MapChunk\r\n            key={'mapcell:' + cellCoords}\r\n            x={x}\r\n            y={y}\r\n            scale={stateRef.current.scale}\r\n            adapter={adapter}\r\n            worldX={playerChunkLeft + x / 4 - offsetX}\r\n            worldZ={playerChunkTop + y / 4 - offsetY}\r\n            setIsWarpInfoOpened={setIsWarpInfoOpened}\r\n            setLastWarpPos={setLastWarpPos}\r\n            redraw={redraw}\r\n            setInitWarp={setInitWarp}\r\n            setWarpPreview={setWarpPreview}\r\n          />\r\n        })}\r\n      </TransformComponent>\r\n    </TransformWrapper>\r\n    {warpPreview && <div\r\n      style={{\r\n        position: 'absolute',\r\n        top: warpPreview.clientY - 70,\r\n        left: warpPreview.clientX - 70,\r\n        textAlign: 'center',\r\n        fontSize: '1.5em',\r\n        textShadow: '0.1em 0 black, 0 0.1em black, -0.1em 0 black, 0 -0.1em black, -0.1em -0.1em black, -0.1em 0.1em black, 0.1em -0.1em black, 0.1em 0.1em black'\r\n      } as any}\r\n    >\r\n      {warpPreview.name}\r\n      <div>\r\n        {warpPreview.x} {warpPreview.z}\r\n      </div>\r\n    </div>}\r\n    {\r\n      isWarpInfoOpened && <WarpInfo\r\n        adapter={adapter}\r\n        warpPos={lastWarpPos}\r\n        setIsWarpInfoOpened={setIsWarpInfoOpened}\r\n        setRedraw={setRedraw}\r\n        initWarp={initWarp}\r\n        setInitWarp={setInitWarp}\r\n        toggleFullMap={toggleFullMap}\r\n      />\r\n    }\r\n  </div>\r\n}\r\n\r\n\r\nconst MapChunk = (\r\n  { x, y, scale, adapter, worldX, worldZ, setIsWarpInfoOpened, setLastWarpPos, redraw, setInitWarp, setWarpPreview }:\r\n  {\r\n    x: number,\r\n    y: number,\r\n    scale: number,\r\n    adapter: DrawerAdapter,\r\n    worldX: number,\r\n    worldZ: number,\r\n    setIsWarpInfoOpened: (x: boolean) => void,\r\n    setLastWarpPos: (obj: { x: number, y: number, z: number }) => void,\r\n    redraw?: Set<string> | null\r\n    setInitWarp?: (warp: WorldWarp | undefined) => void\r\n    setWarpPreview?: (warpInfo) => void\r\n  }\r\n) => {\r\n  const containerRef = useRef(null)\r\n  const touchTimer = useRef<ReturnType<typeof setTimeout> | null>(null)\r\n  const canvasRef = useRef<HTMLCanvasElement>(null)\r\n\r\n  const longPress = (e) => {\r\n    touchTimer.current = setTimeout(() => {\r\n      touchTimer.current = null\r\n      handleClick(e)\r\n    }, 500)\r\n  }\r\n\r\n  const cancel = () => {\r\n    if (touchTimer.current) clearTimeout(touchTimer.current)\r\n  }\r\n\r\n  const handleClick = (e: MouseEvent | TouchEvent) => {\r\n    if (!adapter.mapDrawer) return\r\n    console.log('click:', e)\r\n    let clientX: number\r\n    let clientY: number\r\n    if ('buttons' in e && e.button === 2) {\r\n      clientX = e.clientX\r\n      clientY = e.clientY\r\n    } else if ('changedTouches' in e) {\r\n      clientX = (e).changedTouches[0].clientX\r\n      clientY = (e).changedTouches[0].clientY\r\n    } else { return }\r\n    const [x, z] = getXZ(clientX, clientY)\r\n    const mapX = Math.floor(x + worldX)\r\n    const mapZ = Math.floor(z + worldZ)\r\n    const y = adapter.getHighestBlockY(mapX, mapZ)\r\n    adapter.mapDrawer.setWarpPosOnClick(new Vec3(mapX, y, mapZ))\r\n    setLastWarpPos(adapter.mapDrawer.lastWarpPos)\r\n    const { lastWarpPos } = adapter.mapDrawer\r\n    const initWarp = adapter.warps.find(warp => Math.hypot(lastWarpPos.x - warp.x, lastWarpPos.z - warp.z) < 2)\r\n    setInitWarp?.(initWarp)\r\n    setIsWarpInfoOpened(true)\r\n  }\r\n\r\n  const getXZ = (clientX: number, clientY: number) => {\r\n    const rect = canvasRef.current!.getBoundingClientRect()\r\n    const factor = scale * (adapter.mapDrawer.mapPixel ?? 1)\r\n    const x = (clientX - rect.left) / factor\r\n    const y = (clientY - rect.top) / factor\r\n    return [x, y]\r\n  }\r\n\r\n  const handleMouseMove = (e: MouseEvent) => {\r\n    const [x, z] = getXZ(e.clientX, e.clientY)\r\n    const warp = adapter.warps.find(w => Math.hypot(w.x - x - worldX, w.z - z - worldZ) < 2)\r\n    setWarpPreview?.(\r\n      warp ? { name: warp.name, x: warp.x, z: warp.z, clientX: e.clientX, clientY: e.clientY } : undefined\r\n    )\r\n  }\r\n\r\n  const handleRedraw = (key?: string) => {\r\n    if (key !== `${worldX / 16},${worldZ / 16}`) return\r\n    adapter.mapDrawer.canvas = canvasRef.current!\r\n    adapter.mapDrawer.full = true\r\n    console.log('[mapChunk] update', key, `${worldX / 16},${worldZ / 16}`)\r\n    const timeout = setTimeout(() => {\r\n      if (canvasRef.current) void adapter.drawChunkOnCanvas(`${worldX / 16},${worldZ / 16}`, canvasRef.current)\r\n      clearTimeout(timeout)\r\n    }, 100)\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (canvasRef.current) void adapter.drawChunkOnCanvas(`${worldX / 16},${worldZ / 16}`, canvasRef.current)\r\n  }, [canvasRef.current])\r\n\r\n  useEffect(() => {\r\n    canvasRef.current?.addEventListener('contextmenu', handleClick)\r\n    canvasRef.current?.addEventListener('touchstart', longPress)\r\n    canvasRef.current?.addEventListener('touchend', cancel)\r\n    canvasRef.current?.addEventListener('touchmove', cancel)\r\n    canvasRef.current?.addEventListener('mousemove', handleMouseMove)\r\n\r\n    return () => {\r\n      canvasRef.current?.removeEventListener('contextmenu', handleClick)\r\n      canvasRef.current?.removeEventListener('touchstart', longPress)\r\n      canvasRef.current?.removeEventListener('touchend', cancel)\r\n      canvasRef.current?.removeEventListener('touchmove', cancel)\r\n      canvasRef.current?.removeEventListener('mousemove', handleMouseMove)\r\n    }\r\n  }, [canvasRef.current])\r\n\r\n  useEffect(() => {\r\n    if (redraw) {\r\n      for (const key of redraw) {\r\n        handleRedraw(key)\r\n      }\r\n    }\r\n  }, [redraw])\r\n\r\n  return <div\r\n    ref={containerRef}\r\n    style={{\r\n      position: 'absolute',\r\n      width: '64px',\r\n      height: '64px',\r\n      top: `${y}px`,\r\n      left: `${x}px`,\r\n    }}\r\n  >\r\n    <canvas\r\n      ref={canvasRef}\r\n      style={{\r\n        width: '100%',\r\n        height: '100%',\r\n        imageRendering: 'pixelated'\r\n      }}\r\n      width={64}\r\n      height={64}\r\n    />\r\n  </div>\r\n}\r\n\r\nconst WarpInfo = (\r\n  { adapter, warpPos, setIsWarpInfoOpened, afterWarpIsSet, initWarp, toggleFullMap, setRedraw }:\r\n  {\r\n    adapter: DrawerAdapter,\r\n    warpPos: { x: number, y: number, z: number },\r\n    setIsWarpInfoOpened: Dispatch<SetStateAction<boolean>>,\r\n    afterWarpIsSet?: () => void\r\n    initWarp?: WorldWarp,\r\n    setInitWarp?: React.Dispatch<React.SetStateAction<WorldWarp | undefined>>,\r\n    toggleFullMap?: () => void,\r\n    setRedraw?: React.Dispatch<React.SetStateAction<Set<string> | null>>\r\n  }\r\n) => {\r\n  const [warp, setWarp] = useState<WorldWarp>(initWarp ?? {\r\n    name: '',\r\n    x: warpPos?.x ?? 100,\r\n    y: warpPos?.y ?? 100,\r\n    z: warpPos?.z ?? 100,\r\n    color: '',\r\n    disabled: false,\r\n    world: adapter.world\r\n  })\r\n\r\n  const posInputStyle: CSSProperties = {\r\n    flexGrow: '1',\r\n  }\r\n  const fieldCont: CSSProperties = {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '5px'\r\n  }\r\n\r\n  const updateChunk = () => {\r\n    const redraw = new Set<string>()\r\n    for (let i = -1; i < 2; i += 1) {\r\n      for (let j = -1; j < 2; j += 1) {\r\n        redraw.add(`${Math.floor(warp.x / 16) + j},${Math.floor(warp.z / 16) + i}`)\r\n      }\r\n    }\r\n    setRedraw?.(redraw)\r\n    console.log('[warpInfo] update', redraw)\r\n  }\r\n\r\n  const tpNow = () => {\r\n    adapter.off('updateChunk', tpNow)\r\n  }\r\n\r\n  const quickTp = () => {\r\n    toggleFullMap?.()\r\n    adapter.quickTp?.(warp.x, warp.z)\r\n  }\r\n\r\n  return <div\r\n    style={{\r\n      position: 'absolute',\r\n      inset: '0px',\r\n      display: 'flex',\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n      flexDirection: 'column',\r\n      backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n      fontSize: '0.8em',\r\n      transform: 'scale(2)'\r\n    }}\r\n  >\r\n    <form\r\n      style={{\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        gap: '10px',\r\n        width: window.screen.width > 500 ? '100%' : '50%',\r\n        minWidth: '100px',\r\n        maxWidth: '300px',\r\n        padding: '20px',\r\n        backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n        border: '2px solid black'\r\n      }}\r\n    >\r\n      <h2 style={{ alignSelf: 'center' }}>Point on the map</h2>\r\n      <div style={fieldCont}>\r\n        <div>\r\n          Name:\r\n        </div>\r\n        <Input\r\n          defaultValue={warp.name}\r\n          onChange={(e) => {\r\n            if (!e.target) return\r\n            setWarp(prev => { return { ...prev, name: e.target.value } })\r\n          }}\r\n          autoFocus\r\n        />\r\n      </div>\r\n      <div style={fieldCont}>\r\n        <div>\r\n          X:\r\n        </div>\r\n        <Input\r\n          rootStyles={posInputStyle}\r\n          defaultValue={warp.x ?? 100}\r\n          onChange={(e) => {\r\n            if (!e.target) return\r\n            setWarp(prev => { return { ...prev, x: Number(e.target.value) } })\r\n          }}\r\n        />\r\n        <div>\r\n          Z:\r\n        </div>\r\n        <Input\r\n          rootStyles={posInputStyle}\r\n          defaultValue={warp.z ?? 100}\r\n          onChange={(e) => {\r\n            if (!e.target) return\r\n            setWarp(prev => { return { ...prev, z: Number(e.target.value) } })\r\n          }}\r\n        />\r\n      </div>\r\n      <div style={fieldCont}>\r\n        <div>Color:</div>\r\n        <Input\r\n          type='color'\r\n          defaultValue={warp.color === '' ? '#232323' : warp.color}\r\n          onChange={(e) => {\r\n            if (!e.target) return\r\n            setWarp(prev => { return { ...prev, color: e.target.value } })\r\n          }}\r\n          rootStyles={{ width: '30px', }}\r\n          style={{ left: '0px' }}\r\n        />\r\n      </div>\r\n      <div style={fieldCont} >\r\n        <label htmlFor='warp-disabled'>Disabled:</label>\r\n        <input\r\n          id='warp-disabled'\r\n          type=\"checkbox\"\r\n          checked={warp.disabled ?? false}\r\n          onChange={(e) => {\r\n            if (!e.target) return\r\n            setWarp(prev => { return { ...prev, disabled: e.target.checked } })\r\n          }}\r\n        />\r\n      </div>\r\n      <Button\r\n        style={{ alignSelf: 'center' }}\r\n        onClick={() => {\r\n          quickTp()\r\n        }}\r\n      >Quick TP</Button>\r\n      <div style={fieldCont}>\r\n        <Button\r\n          onClick={() => {\r\n            setIsWarpInfoOpened(false)\r\n          }}\r\n        >Cancel</Button>\r\n        <Button\r\n          onClick={(e) => {\r\n            e.preventDefault()\r\n            adapter.setWarp({ ...warp })\r\n            console.log(adapter.warps)\r\n            setIsWarpInfoOpened(false)\r\n            updateChunk()\r\n            afterWarpIsSet?.()\r\n          }}\r\n          type='submit'\r\n        >Add Warp</Button>\r\n        {initWarp && <Button\r\n          onClick={() => {\r\n            const index = adapter.warps.findIndex(thisWarp => thisWarp.name === warp.name)\r\n            if (index !== -1) {\r\n              adapter.setWarp({ name: warp.name, x: 0, y: 0, z: 0, color: '', disabled: false, world: '' }, true)\r\n              setIsWarpInfoOpened(false)\r\n              updateChunk()\r\n              afterWarpIsSet?.()\r\n            }\r\n          }}\r\n        >Delete</Button>}\r\n      </div>\r\n    </form>\r\n  </div>\r\n}\r\n","import { useRef, useEffect } from 'react'\r\nimport { subscribe, useSnapshot } from 'valtio'\r\nimport { useUtilsEffect } from '@zardoy/react-util'\r\nimport { options } from '../optionsStorage'\r\nimport { activeModalStack, isGameActive, miscUiState } from '../globalState'\r\nimport { onCameraMove, CameraMoveEvent } from '../cameraRotationControls'\r\nimport { pointerLock, isInRealGameSession } from '../utils'\r\nimport { handleMovementStickDelta, joystickPointer } from './TouchAreasControls'\r\n\r\n/** after what time of holding the finger start breaking the block */\r\nconst touchStartBreakingBlockMs = 500\r\n\r\nfunction GameInteractionOverlayInner ({\r\n  zIndex,\r\n  setJoystickOrigin,\r\n  updateJoystick\r\n}: {\r\n  zIndex: number,\r\n  setJoystickOrigin: (e: PointerEvent | null) => void\r\n  updateJoystick: (e: PointerEvent) => void\r\n}) {\r\n  const overlayRef = useRef<HTMLDivElement>(null)\r\n\r\n\r\n  useUtilsEffect(({ signal }) => {\r\n    if (!overlayRef.current) return\r\n\r\n    const cameraControlEl = overlayRef.current\r\n    let virtualClickActive = false\r\n    let virtualClickTimeout: NodeJS.Timeout | undefined\r\n    let screenTouches = 0\r\n    const capturedPointer = {\r\n      active: null as {\r\n        id: number;\r\n        x: number;\r\n        y: number;\r\n        sourceX: number;\r\n        sourceY: number;\r\n        activateCameraMove: boolean;\r\n        time: number\r\n      } | null\r\n    }\r\n\r\n    const pointerDownHandler = (e: PointerEvent) => {\r\n      const clickedEl = e.composedPath()[0]\r\n      if (!isGameActive(true) || clickedEl !== cameraControlEl || e.pointerId === undefined) {\r\n        return\r\n      }\r\n      screenTouches++\r\n      if (screenTouches === 3) {\r\n        // todo maybe mouse wheel click?\r\n      }\r\n      const usingModernMovement = options.touchMovementType === 'modern'\r\n      if (usingModernMovement) {\r\n        if (!joystickPointer.pointer && e.clientX < window.innerWidth / 2) {\r\n          cameraControlEl.setPointerCapture(e.pointerId)\r\n          setJoystickOrigin(e)\r\n          return\r\n        }\r\n      }\r\n      if (capturedPointer.active) {\r\n        return\r\n      }\r\n      cameraControlEl.setPointerCapture(e.pointerId)\r\n      capturedPointer.active = {\r\n        id: e.pointerId,\r\n        x: e.clientX,\r\n        y: e.clientY,\r\n        sourceX: e.clientX,\r\n        sourceY: e.clientY,\r\n        activateCameraMove: false,\r\n        time: Date.now()\r\n      }\r\n      if (options.touchInteractionType === 'classic') {\r\n        virtualClickTimeout ??= setTimeout(() => {\r\n          virtualClickActive = true\r\n          document.dispatchEvent(new MouseEvent('mousedown', { button: 0 }))\r\n        }, touchStartBreakingBlockMs)\r\n      }\r\n    }\r\n\r\n    const pointerMoveHandler = (e: PointerEvent) => {\r\n      if (e.pointerId === undefined) return\r\n      const scale = window.visualViewport?.scale || 1\r\n\r\n      const supportsPressure = (e as any).pressure !== undefined &&\r\n        (e as any).pressure !== 0 &&\r\n        (e as any).pressure !== 0.5 &&\r\n        (e as any).pressure !== 1 &&\r\n        (e.pointerType === 'touch' || e.pointerType === 'pen')\r\n\r\n      if (e.pointerId === joystickPointer.pointer?.pointerId) {\r\n        updateJoystick(e)\r\n        if (supportsPressure && (e as any).pressure > 0.5) {\r\n          bot.setControlState('sprint', true)\r\n        }\r\n        return\r\n      }\r\n      if (e.pointerId !== capturedPointer.active?.id) return\r\n      // window.scrollTo(0, 0)\r\n      e.preventDefault()\r\n      e.stopPropagation()\r\n\r\n      const allowedJitter = 1.1\r\n      if (supportsPressure) {\r\n        bot.setControlState('jump', (e as any).pressure > 0.5)\r\n      }\r\n\r\n      // Adjust coordinates for scale\r\n      const currentX = e.clientX / scale\r\n      const currentY = e.clientY / scale\r\n      const sourceX = capturedPointer.active.sourceX / scale\r\n      const sourceY = capturedPointer.active.sourceY / scale\r\n      const lastX = capturedPointer.active.x / scale\r\n      const lastY = capturedPointer.active.y / scale\r\n\r\n      const xDiff = Math.abs(currentX - sourceX) > allowedJitter\r\n      const yDiff = Math.abs(currentY - sourceY) > allowedJitter\r\n\r\n      if (!capturedPointer.active.activateCameraMove && (xDiff || yDiff)) {\r\n        capturedPointer.active.activateCameraMove = true\r\n      }\r\n      if (capturedPointer.active.activateCameraMove) {\r\n        clearTimeout(virtualClickTimeout)\r\n      }\r\n\r\n      onCameraMove({\r\n        movementX: (currentX - lastX),\r\n        movementY: (currentY - lastY),\r\n        type: 'touchmove',\r\n        stopPropagation: () => e.stopPropagation()\r\n      } as CameraMoveEvent)\r\n\r\n      capturedPointer.active.x = e.clientX\r\n      capturedPointer.active.y = e.clientY\r\n    }\r\n\r\n    const pointerUpHandler = (e: PointerEvent) => {\r\n      if (e.pointerId === undefined) return\r\n      if (e.pointerId === joystickPointer.pointer?.pointerId) {\r\n        setJoystickOrigin(null)\r\n        return\r\n      }\r\n      if (e.pointerId !== capturedPointer.active?.id) return\r\n      clearTimeout(virtualClickTimeout)\r\n      virtualClickTimeout = undefined\r\n\r\n      if (virtualClickActive) {\r\n        // button 0 is left click\r\n        document.dispatchEvent(new MouseEvent('mouseup', { button: 0 }))\r\n        virtualClickActive = false\r\n      } else if (!capturedPointer.active.activateCameraMove && (Date.now() - capturedPointer.active.time < touchStartBreakingBlockMs)) {\r\n        // single click action\r\n        const MOUSE_BUTTON_RIGHT = 2\r\n        const MOUSE_BUTTON_LEFT = 0\r\n        const gonnaAttack = !!bot.mouse.getCursorState().entity\r\n        document.dispatchEvent(new MouseEvent('mousedown', { button: gonnaAttack ? MOUSE_BUTTON_LEFT : MOUSE_BUTTON_RIGHT }))\r\n        bot.mouse.update()\r\n        document.dispatchEvent(new MouseEvent('mouseup', { button: gonnaAttack ? MOUSE_BUTTON_LEFT : MOUSE_BUTTON_RIGHT }))\r\n      }\r\n\r\n      if (screenTouches > 0) {\r\n        screenTouches--\r\n      }\r\n      capturedPointer.active = null\r\n    }\r\n\r\n    const contextMenuHandler = (e: Event) => {\r\n      e.preventDefault()\r\n    }\r\n\r\n    const blurHandler = () => {\r\n      bot.clearControlStates()\r\n    }\r\n\r\n    cameraControlEl.addEventListener('pointerdown', pointerDownHandler, { signal })\r\n    cameraControlEl.addEventListener('pointermove', pointerMoveHandler, { signal })\r\n    cameraControlEl.addEventListener('pointerup', pointerUpHandler, { signal })\r\n    cameraControlEl.addEventListener('pointercancel', pointerUpHandler, { signal })\r\n    cameraControlEl.addEventListener('lostpointercapture', pointerUpHandler, { signal })\r\n    cameraControlEl.addEventListener('contextmenu', contextMenuHandler, { signal })\r\n    window.addEventListener('blur', blurHandler, { signal })\r\n\r\n    // Add zoom detection and reset\r\n    const detectAndResetZoom = () => {\r\n      const { visualViewport } = window\r\n      if (!visualViewport) return\r\n\r\n      if (visualViewport.scale !== 1) {\r\n        // Reset zoom by updating viewport meta tag\r\n        const viewport = document.querySelector('meta[name=viewport]')\r\n        if (viewport) {\r\n          viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no')\r\n          // Force re-layout\r\n          setTimeout(() => {\r\n            viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no')\r\n          }, 300)\r\n        }\r\n      }\r\n    }\r\n\r\n    // Listen for zoom changes\r\n    window.visualViewport?.addEventListener('resize', detectAndResetZoom, { signal })\r\n    detectAndResetZoom()\r\n\r\n    // Prevent zoom gestures\r\n    document.addEventListener('gesturestart', (e) => e.preventDefault(), { signal })\r\n    document.addEventListener('gesturechange', (e) => e.preventDefault(), { signal })\r\n    document.addEventListener('gestureend', (e) => e.preventDefault(), { signal })\r\n\r\n\r\n    // Debug method to simulate zoom\r\n    window.debugSimulateZoom = (scale = 1.1, x = 0, y = 0) => {\r\n      const viewport = document.querySelector('meta[name=viewport]')\r\n      if (viewport) {\r\n        viewport.setAttribute('content', `width=device-width, initial-scale=${scale}, user-scalable=no, viewport-fit=cover, transform-origin: ${x}px ${y}px`)\r\n      }\r\n      // This will trigger the visualViewport resize event\r\n      setTimeout(() => {\r\n        window.visualViewport?.dispatchEvent(new Event('resize'))\r\n      }, 100)\r\n    }\r\n\r\n    // Debug method to reset zoom\r\n    window.debugResetZoom = () => {\r\n      const viewport = document.querySelector('meta[name=viewport]')\r\n      if (viewport) {\r\n        viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no')\r\n      }\r\n      setTimeout(() => {\r\n        window.visualViewport?.dispatchEvent(new Event('resize'))\r\n      }, 100)\r\n    }\r\n\r\n    signal.addEventListener('abort', () => {\r\n      setJoystickOrigin(null)\r\n    })\r\n  }, [setJoystickOrigin])\r\n\r\n  return (\r\n    <OverlayElement divRef={overlayRef} zIndex={zIndex} />\r\n  )\r\n\r\n\r\n}\r\n\r\nconst OverlayElement = ({ divRef, zIndex }: { divRef: React.RefObject<HTMLDivElement>, zIndex: number }) => {\r\n  return <div\r\n    className='game-interaction-overlay'\r\n    ref={divRef}\r\n    style={{\r\n      position: 'fixed',\r\n      top: 0,\r\n      left: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      zIndex,\r\n      touchAction: 'none',\r\n      userSelect: 'none'\r\n    }}\r\n  />\r\n}\r\n\r\nexport default function GameInteractionOverlay ({ zIndex }: { zIndex: number }) {\r\n  const modalStack = useSnapshot(activeModalStack)\r\n  const { currentTouch } = useSnapshot(miscUiState)\r\n\r\n  const setJoystickOrigin = useRef((e: PointerEvent | null) => {\r\n    if (!e) {\r\n      handleMovementStickDelta()\r\n      joystickPointer.pointer = null\r\n      return\r\n    }\r\n\r\n    joystickPointer.pointer = {\r\n      pointerId: e.pointerId,\r\n      x: e.clientX,\r\n      y: e.clientY\r\n    }\r\n  }).current\r\n\r\n  const updateJoystick = useRef((e: PointerEvent) => {\r\n    handleMovementStickDelta(e)\r\n  }).current\r\n\r\n  if (modalStack.length > 0 || !currentTouch) return null\r\n  return <GameInteractionOverlayInner\r\n    zIndex={zIndex}\r\n    setJoystickOrigin={setJoystickOrigin}\r\n    updateJoystick={updateJoystick}\r\n  />\r\n\r\n}\r\n\r\nsubscribe(activeModalStack, () => {\r\n  if (activeModalStack.length === 0) {\r\n    if (isInRealGameSession()) {\r\n      void pointerLock.requestPointerLock()\r\n    }\r\n  } else {\r\n    document.exitPointerLock?.()\r\n  }\r\n})\r\n","import { proxy, useSnapshot } from 'valtio'\r\nimport { useEffect } from 'react'\r\nimport { activeModalStack, miscUiState } from '../globalState'\r\nimport SharedHudVars from './SharedHudVars'\r\nimport styles from './GamepadUiCursor.module.css'\r\n\r\nexport const gamepadUiCursorState = proxy({\r\n  x: 50,\r\n  y: 50,\r\n  multiply: 1,\r\n  display: false\r\n})\r\n\r\nexport const moveGamepadCursorByPx = (value: number, isX: boolean) => {\r\n  value *= gamepadUiCursorState.multiply * 3\r\n  const valueToPercentage = value / (isX ? window.innerWidth : window.innerHeight) * 100\r\n  gamepadUiCursorState[isX ? 'x' : 'y'] += valueToPercentage\r\n}\r\n\r\nexport default () => {\r\n  const hasModals = useSnapshot(activeModalStack).length > 0\r\n  const { x, y } = useSnapshot(gamepadUiCursorState)\r\n  const { usingGamepadInput, gameLoaded } = useSnapshot(miscUiState)\r\n\r\n  const doDisplay = usingGamepadInput && (hasModals || !gameLoaded)\r\n\r\n  useEffect(() => {\r\n    document.body.style.cursor = gameLoaded && !hasModals && usingGamepadInput ? 'none' : 'auto'\r\n  }, [usingGamepadInput, hasModals, gameLoaded])\r\n\r\n  useEffect(() => {\r\n    gamepadUiCursorState.display = doDisplay\r\n  }, [doDisplay])\r\n\r\n  if (!doDisplay) return null\r\n\r\n  return <SharedHudVars>\r\n    <div className={styles.crosshair} style={{ left: `${x}%`, top: `${y}%` }} />\r\n  </SharedHudVars>\r\n}\r\n","import { useSnapshot } from 'valtio'\r\nimport { miscUiState } from '../globalState'\r\nimport Input from './Input'\r\n\r\nfunction InnerSearch () {\r\n  const { currentTouch } = useSnapshot(miscUiState)\r\n\r\n  return <div style={{\r\n    position: 'fixed',\r\n    top: 5,\r\n    left: 0,\r\n    right: 0,\r\n    margin: 'auto',\r\n    zIndex: 11,\r\n    width: 'min-content',\r\n    transform: 'scale(1.5)'\r\n  }}\r\n  >\r\n    <Input\r\n      autoFocus={currentTouch === false}\r\n      placeholder='Search...'\r\n      onChange={({ target: { value } }) => {\r\n        customEvents.emit('search', value)\r\n      }}\r\n    />\r\n  </div>\r\n}\r\n\r\n// todo remove component as its not possible to reuse this component atm\r\nexport default () => {\r\n  const { displaySearchInput } = useSnapshot(miscUiState)\r\n\r\n  return displaySearchInput ? <InnerSearch /> : null\r\n}\r\n","import './GoogleButton.css'\r\n\r\nexport default ({ onClick }) => {\r\n  return <button\r\n    className=\"gsi-material-button\" onClick={onClick} style={{\r\n      transform: 'scale(0.55) translate(-20%)',\r\n    }}\r\n  >\r\n    <div className=\"gsi-material-button-state\" />\r\n    <div className=\"gsi-material-button-content-wrapper\">\r\n      <div className=\"gsi-material-button-icon\">\r\n        <svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 48 48\">\r\n          <path fill=\"#EA4335\" d=\"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z\" />\r\n          <path fill=\"#4285F4\" d=\"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z\" />\r\n          <path fill=\"#FBBC05\" d=\"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z\" />\r\n          <path fill=\"#34A853\" d=\"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z\" />\r\n          <path fill=\"none\" d=\"M0 0h48v48H0z\" />\r\n        </svg>\r\n      </div>\r\n      <span className=\"gsi-material-button-contents\">Continue with Google</span>\r\n      <span style={{ display: 'none' }}>Continue with Google</span>\r\n    </div>\r\n  </button>\r\n}\r\n","import { useRef, useEffect } from 'react'\r\nimport SharedHudVars from './SharedHudVars'\r\nimport './HealthBar.css'\r\nimport { barEffectAdded, barEffectEnded } from './BarsCommon'\r\n\r\n\r\nexport type HealthBarProps = {\r\n  gameMode?: string,\r\n  isHardcore: boolean,\r\n  damaged: boolean,\r\n  healthValue: number,\r\n  effectToAdd?: number | null,\r\n  effectToRemove?: number | null,\r\n  resetEffects?: () => void\r\n  style?: React.CSSProperties\r\n}\r\n\r\nexport default ({\r\n  gameMode,\r\n  isHardcore,\r\n  damaged,\r\n  healthValue,\r\n  effectToAdd,\r\n  effectToRemove,\r\n  resetEffects,\r\n  style\r\n}: HealthBarProps) => {\r\n  const healthRef = useRef<HTMLDivElement | null>(null)\r\n\r\n  useEffect(() => {\r\n    if (healthRef.current) {\r\n      healthRef.current.classList.toggle('creative', gameMode === 'creative' || gameMode === 'spectator')\r\n    }\r\n  }, [gameMode])\r\n\r\n  useEffect(() => {\r\n    if (healthRef.current) {\r\n      if (isHardcore) {\r\n        healthRef.current.classList.add('hardcore')\r\n      } else {\r\n        healthRef.current.classList.remove('hardcore')\r\n      }\r\n    }\r\n  }, [isHardcore])\r\n\r\n  useEffect(() => {\r\n    if (healthRef.current) {\r\n      if (damaged) {\r\n        healthRef.current.classList.add('damaged')\r\n        console.log('damage')\r\n      } else {\r\n        healthRef.current.classList.remove('damaged')\r\n      }\r\n    }\r\n  }, [damaged])\r\n\r\n  useEffect(() => {\r\n    if (healthRef.current) {\r\n      if (healthValue <= 4) {\r\n        healthRef.current.classList.add('low')\r\n      } else {\r\n        healthRef.current.classList.remove('low')\r\n      }\r\n\r\n      const healthElement = healthRef.current\r\n      const hearts = healthElement.children\r\n\r\n      for (const heart of hearts) {\r\n        heart.classList.remove('full')\r\n        heart.classList.remove('half')\r\n      }\r\n\r\n      for (let i = 0; i < Math.ceil(healthValue / 2); i++) {\r\n        if (i >= hearts.length) break\r\n\r\n        if (healthValue % 2 !== 0 && Math.ceil(healthValue / 2) === i + 1) {\r\n          hearts[i].classList.add('half')\r\n        } else {\r\n          hearts[i].classList.add('full')\r\n        }\r\n      }\r\n    }\r\n  }, [healthValue])\r\n\r\n  useEffect(() => {\r\n    if (effectToAdd) {\r\n      barEffectAdded(healthRef.current, effectToAdd)\r\n    }\r\n    if (effectToRemove) {\r\n      barEffectEnded(healthRef.current, effectToRemove)\r\n    }\r\n    resetEffects?.()\r\n  }, [effectToAdd, effectToRemove])\r\n\r\n  return <SharedHudVars>\r\n    <div ref={healthRef} className='health' style={style}>\r\n      {\r\n        Array.from({ length: 10 }, () => 0)\r\n          .map((num, index) => <div\r\n            key={`heart-${index}`}\r\n            className='heart'\r\n          />)\r\n      }\r\n    </div>\r\n  </SharedHudVars>\r\n}\r\n","import { useEffect, useState } from 'react'\r\n\r\nexport default () => {\r\n  const [dataUrl, setDataUrl] = useState<string | null | true>(null) // true means loading\r\n\r\n  useEffect(() => {\r\n    // TODO delete maps!\r\n    const updateHeldMap = () => {\r\n      setDataUrl(null)\r\n      const item = bot.heldItem\r\n      if (!item || !['filled_map', 'map'].includes(item.name)) return\r\n      // setDataUrl(true)\r\n      const mapNumber = ((item?.nbt?.value as any)?.map?.value) ?? (item['components']?.find(x => x.type === 'map_id')?.data)\r\n      // if (!mapNumber) return\r\n      setDataUrl(bot.mapDownloader.maps?.[mapNumber] as unknown as string)\r\n    }\r\n\r\n    bot.on('heldItemChanged' as any, () => {\r\n      updateHeldMap()\r\n    })\r\n\r\n    bot.on('new_map', ({ id }) => {\r\n      // total maps: Object.keys(bot.mapDownloader.maps).length\r\n      updateHeldMap()\r\n    })\r\n\r\n    updateHeldMap()\r\n  }, [])\r\n\r\n  return dataUrl && dataUrl !== true ? <div style={{\r\n    position: 'fixed',\r\n    bottom: 20,\r\n    left: 8,\r\n    pointerEvents: 'none',\r\n  }}\r\n  >\r\n    <img\r\n      src={dataUrl} style={{\r\n        width: 92,\r\n        height: 92,\r\n        imageRendering: 'pixelated',\r\n      }}\r\n    />\r\n  </div> : null\r\n}\r\n","import { useEffect, useRef, useState } from 'react'\r\nimport { Transition } from 'react-transition-group'\r\nimport { createPortal } from 'react-dom'\r\nimport { subscribe, useSnapshot } from 'valtio'\r\nimport { allImagesLoadedState, openItemsCanvas, openPlayerInventory, upInventoryItems } from '../inventoryWindows'\r\nimport { activeModalStack, isGameActive, miscUiState } from '../globalState'\r\nimport { currentScaling } from '../scaleInterface'\r\nimport { watchUnloadForCleanup } from '../gameUnload'\r\nimport { getItemNameRaw } from '../mineflayer/items'\r\nimport { isInRealGameSession } from '../utils'\r\nimport MessageFormattedString from './MessageFormattedString'\r\nimport SharedHudVars from './SharedHudVars'\r\nimport { packetsReplayState } from './state/packetsReplayState'\r\n\r\n\r\nconst ItemName = ({ itemKey }: { itemKey: string }) => {\r\n  const nodeRef = useRef(null)\r\n  const [show, setShow] = useState(false)\r\n  const [itemName, setItemName] = useState<Record<string, any> | string>('')\r\n\r\n  const duration = 300\r\n\r\n  const defaultStyle: React.CSSProperties = {\r\n    position: 'fixed',\r\n    bottom: `calc(env(safe-area-inset-bottom) + ${bot ? bot.game.gameMode === 'creative' ? '40px' : '50px' : '50px'})`,\r\n    left: 0,\r\n    right: 0,\r\n    fontSize: 10,\r\n    textAlign: 'center',\r\n    transition: `opacity ${duration}ms ease-in-out`,\r\n    opacity: 0,\r\n    pointerEvents: 'none',\r\n  }\r\n\r\n  const transitionStyles = {\r\n    entering: { opacity: 1 },\r\n    entered: { opacity: 1 },\r\n    exiting: { opacity: 0 },\r\n    exited: { opacity: 0 },\r\n  }\r\n\r\n  useEffect(() => {\r\n    const item = bot.heldItem\r\n    if (item) {\r\n      const customDisplay = getItemNameRaw(item)\r\n      if (customDisplay) {\r\n        setItemName(customDisplay)\r\n      } else {\r\n        setItemName(item.displayName)\r\n      }\r\n    } else {\r\n      setItemName('')\r\n    }\r\n    setShow(true)\r\n    const id = setTimeout(() => {\r\n      setShow(false)\r\n    }, 1500)\r\n    return () => {\r\n      setShow(false)\r\n      clearTimeout(id)\r\n    }\r\n  }, [itemKey])\r\n\r\n  return <Transition nodeRef={nodeRef} in={show} timeout={duration} >\r\n    {state => (\r\n      <SharedHudVars>\r\n        <div ref={nodeRef} style={{ ...defaultStyle, ...transitionStyles[state] }} className='item-display-name'>\r\n          <MessageFormattedString message={itemName} />\r\n        </div>\r\n      </SharedHudVars>\r\n    )}\r\n  </Transition>\r\n}\r\n\r\nconst HotbarInner = () => {\r\n  const container = useRef<HTMLDivElement>(null!)\r\n  const [itemKey, setItemKey] = useState('')\r\n  const hasModals = useSnapshot(activeModalStack).length\r\n\r\n  useEffect(() => {\r\n    const controller = new AbortController()\r\n\r\n    const inv = openItemsCanvas('HotbarWin', {\r\n      clickWindow (slot, mouseButton, mode) {\r\n        if (mouseButton === 1) {\r\n          console.log('right click')\r\n          return\r\n        }\r\n        const hotbarSlot = slot - bot.inventory.hotbarStart\r\n        if (hotbarSlot < 0 || hotbarSlot > 8) return\r\n        bot.setQuickBarSlot(hotbarSlot)\r\n      },\r\n    } as any)\r\n    const { canvasManager } = inv\r\n    inv.inventory.supportsOffhand = !bot.supportFeature('doesntHaveOffHandSlot')\r\n    inv.pwindow.disablePicking = true\r\n\r\n    canvasManager.children[0].disableHighlight = true\r\n    canvasManager.minimizedWindow = true\r\n    canvasManager.minimizedWindow = true\r\n\r\n    function setSize () {\r\n      canvasManager.setScale(currentScaling.scale)\r\n\r\n      canvasManager.windowHeight = 25 * canvasManager.scale\r\n      canvasManager.windowWidth = (210 - (inv.inventory.supportsOffhand ? 0 : 25) + (miscUiState.currentTouch ? 28 : 0)) * canvasManager.scale\r\n    }\r\n    setSize()\r\n    watchUnloadForCleanup(subscribe(currentScaling, setSize))\r\n    inv.canvas.style.pointerEvents = 'auto'\r\n    container.current.appendChild(inv.canvas)\r\n    const upHotbarItems = () => {\r\n      if (!viewer.world.currentTextureImage || !allImagesLoadedState.value) return\r\n      upInventoryItems(true, inv)\r\n    }\r\n\r\n    canvasManager.canvas.onclick = (e) => {\r\n      if (!isGameActive(true)) return\r\n      const pos = inv.canvasManager.getMousePos(inv.canvas, e)\r\n      if (canvasManager.canvas.width - pos.x < 35 * inv.canvasManager.scale) {\r\n        openPlayerInventory()\r\n      }\r\n    }\r\n\r\n    upHotbarItems()\r\n    bot.inventory.on('updateSlot', upHotbarItems)\r\n    viewer.world.renderUpdateEmitter.on('textureDownloaded', upHotbarItems)\r\n    const unsub2 = subscribe(allImagesLoadedState, () => {\r\n      upHotbarItems()\r\n    })\r\n\r\n    const setSelectedSlot = (index: number) => {\r\n      if (index === bot.quickBarSlot) return\r\n      bot.setQuickBarSlot(index)\r\n      if (!bot.inventory.slots?.[bot.quickBarSlot + 36]) setItemKey('')\r\n    }\r\n    const heldItemChanged = () => {\r\n      inv.inventory.activeHotbarSlot = bot.quickBarSlot\r\n\r\n      if (!bot.inventory.slots?.[bot.quickBarSlot + 36]) {\r\n        setItemKey('')\r\n        return\r\n      }\r\n      const item = bot.inventory.slots[bot.quickBarSlot + 36]!\r\n      const itemNbt = item.nbt ? JSON.stringify(item.nbt) : ''\r\n      setItemKey(`${item.name}_split_${item.type}_split_${item.metadata}_split_${itemNbt}_split_${JSON.stringify(item['components'] ?? [])}`)\r\n    }\r\n    heldItemChanged()\r\n    bot.on('heldItemChanged' as any, heldItemChanged)\r\n\r\n    document.addEventListener('wheel', (e) => {\r\n      if (!isInRealGameSession()) return\r\n      e.preventDefault()\r\n      const newSlot = ((bot.quickBarSlot + Math.sign(e.deltaY)) % 9 + 9) % 9\r\n      setSelectedSlot(newSlot)\r\n    }, {\r\n      passive: false,\r\n      signal: controller.signal\r\n    })\r\n\r\n    document.addEventListener('keydown', (e) => {\r\n      if (!isInRealGameSession()) return\r\n      const numPressed = +((/Digit(\\d)/.exec(e.code))?.[1] ?? -1)\r\n      if (numPressed < 1 || numPressed > 9) return\r\n      setSelectedSlot(numPressed - 1)\r\n    }, {\r\n      passive: false,\r\n      signal: controller.signal\r\n    })\r\n\r\n    let touchStart = 0\r\n    document.addEventListener('touchstart', (e) => {\r\n      if ((e.target as HTMLElement).closest('.hotbar')) {\r\n        touchStart = Date.now()\r\n      } else {\r\n        touchStart = 0\r\n      }\r\n    })\r\n    document.addEventListener('touchend', (e) => {\r\n      if (touchStart && (e.target as HTMLElement).closest('.hotbar') && Date.now() - touchStart > 700) {\r\n        // drop item\r\n        bot._client.write('block_dig', {\r\n          'status': 4,\r\n          'location': {\r\n            'x': 0,\r\n            'z': 0,\r\n            'y': 0\r\n          },\r\n          'face': 0,\r\n          sequence: 0\r\n        })\r\n      }\r\n      touchStart = 0\r\n    })\r\n\r\n    return () => {\r\n      inv.destroy()\r\n      controller.abort()\r\n      unsub2()\r\n      viewer.world.renderUpdateEmitter.off('textureDownloaded', upHotbarItems)\r\n    }\r\n  }, [])\r\n\r\n  return <SharedHudVars>\r\n    <ItemName itemKey={itemKey} />\r\n    <Portal>\r\n      <div\r\n        className='hotbar' ref={container} style={{\r\n          position: 'fixed',\r\n          left: 0,\r\n          right: 0,\r\n          display: 'flex',\r\n          justifyContent: 'center',\r\n          zIndex: hasModals ? 1 : 8,\r\n          pointerEvents: 'none',\r\n          bottom: 'var(--hud-bottom-raw)'\r\n        }}\r\n      />\r\n    </Portal>\r\n  </SharedHudVars>\r\n}\r\n\r\nexport default () => {\r\n  const [gameMode, setGameMode] = useState(bot.game?.gameMode ?? 'creative')\r\n  useEffect(() => {\r\n    bot.on('game', () => {\r\n      setGameMode(bot.game.gameMode)\r\n    })\r\n  }, [])\r\n\r\n  return gameMode === 'spectator' ? null : <HotbarInner />\r\n}\r\n\r\nconst Portal = ({ children, to = document.body }) => {\r\n  return createPortal(children, to)\r\n}\r\n","import { useRef, useState, useMemo } from 'react'\r\nimport { GameMode } from 'mineflayer'\r\nimport { armor } from './armorValues'\r\nimport HealthBar from './HealthBar'\r\nimport FoodBar from './FoodBar'\r\nimport ArmorBar from './ArmorBar'\r\nimport BreathBar from './BreathBar'\r\nimport './HealthBar.css'\r\n\r\nexport default () => {\r\n  const [damaged, setDamaged] = useState(false)\r\n  const [healthValue, setHealthValue] = useState(bot.health)\r\n  const [food, setFood] = useState(bot.food)\r\n  const [oxygen, setOxygen] = useState(bot.oxygenLevel)\r\n  const [armorValue, setArmorValue] = useState(0)\r\n  const [gameMode, setGameMode] = useState<GameMode | ''>(bot.game.gameMode)\r\n  const [isHardcore, setIsHardcore] = useState(false)\r\n  const [effectToAdd, setEffectToAdd] = useState<number | null>(null)\r\n  const [effectToRemove, setEffectToRemove] = useState<number | null>(null)\r\n  const hurtTimeout = useRef<ReturnType<typeof setTimeout> | null>(null)\r\n\r\n  const getEffectClass = (effect) => {\r\n    switch (effect) {\r\n      case 19:\r\n        return 'poisoned'\r\n      case 20:\r\n        return 'withered'\r\n      case 22:\r\n        return 'absorption'\r\n      default:\r\n        return ''\r\n    }\r\n  }\r\n\r\n  const onDamage = () => {\r\n    setDamaged(prev => true)\r\n    if (hurtTimeout.current) clearTimeout(hurtTimeout.current)\r\n    hurtTimeout.current = setTimeout(() => {\r\n      setDamaged(prev => false)\r\n    }, 1000)\r\n  }\r\n\r\n  const updateHealth = (hValue) => {\r\n    setHealthValue(prev => hValue)\r\n  }\r\n\r\n  useMemo(() => {\r\n    bot.on('entityHurt', (entity) => {\r\n      if (entity !== bot.entity) return\r\n      onDamage()\r\n    })\r\n\r\n    bot.on('game', () => {\r\n      setGameMode(prev => bot.game.gameMode)\r\n      setIsHardcore(prev => bot.game.hardcore)\r\n    })\r\n\r\n    bot.on('entityEffect', (entity, effect) => {\r\n      if (entity !== bot.entity) return\r\n      setEffectToAdd(prev => effect.id)\r\n    })\r\n\r\n    bot.on('entityEffectEnd', (entity, effect) => {\r\n      if (entity !== bot.entity) return\r\n      setEffectToRemove(prev => effect.id)\r\n    })\r\n\r\n    bot.on('health', () => {\r\n      if (bot.health < healthValue) onDamage()\r\n      updateHealth(bot.health)\r\n      setFood(prev => bot.food)\r\n    })\r\n\r\n    bot.on('breath', () => {\r\n      setOxygen(prev => bot.oxygenLevel)\r\n    })\r\n\r\n    const upArmour = () => {\r\n      const armorSlots = new Set([5, 6, 7, 8])\r\n      let points = 0\r\n      for (const slotIndex of armorSlots) {\r\n        const item = bot.inventory.slots[slotIndex] ?? null\r\n        if (!item) continue\r\n        const armorName = item.name.split('_')\r\n        points += armor[armorName[0]]?.[armorName[1]] ?? 0\r\n      }\r\n      setArmorValue(points)\r\n    }\r\n    bot.inventory.on('updateSlot', upArmour)\r\n    upArmour()\r\n  }, [])\r\n\r\n  return <div className='hud-bars-container'>\r\n    <HealthBar\r\n      gameMode={gameMode}\r\n      isHardcore={isHardcore}\r\n      damaged={damaged}\r\n      healthValue={healthValue}\r\n      effectToAdd={effectToAdd}\r\n      effectToRemove={effectToRemove}\r\n      resetEffects={() => {\r\n        setEffectToAdd(null)\r\n        setEffectToRemove(null)\r\n      }}\r\n    />\r\n    <ArmorBar\r\n      armorValue={armorValue}\r\n      style={gameMode !== 'survival' && gameMode !== 'adventure' ? { display: 'none' } : { display: 'flex' }}\r\n    />\r\n    <FoodBar\r\n      gameMode={gameMode}\r\n      food={food}\r\n      effectToAdd={effectToAdd}\r\n      effectToRemove={effectToRemove}\r\n      resetEffects={() => {\r\n        setEffectToAdd(null)\r\n        setEffectToRemove(null)\r\n      }}\r\n    />\r\n    <BreathBar\r\n      oxygen={gameMode !== 'survival' && gameMode !== 'adventure' ? 0 : oxygen}\r\n    />\r\n  </div>\r\n}\r\n","import { useMemo, useEffect, useRef } from 'react'\r\nimport PixelartIcon, { pixelartIcons } from './PixelartIcon'\r\nimport './IndicatorEffects.css'\r\n\r\n\r\n\r\nfunction formatTime (seconds: number): string {\r\n  if (seconds < 0) return ''\r\n  const minutes = Math.floor(seconds / 60)\r\n  const remainingSeconds = Math.floor(seconds % 60)\r\n  const formattedMinutes = String(minutes).padStart(2, '0')\r\n  const formattedSeconds = String(remainingSeconds)\r\n  return `${formattedMinutes}:${formattedSeconds}`\r\n}\r\n\r\nexport type EffectType = {\r\n  image: string,\r\n  time: number,\r\n  level: number,\r\n  removeEffect: (image: string) => void,\r\n  reduceTime: (image: string) => void\r\n}\r\n\r\nconst EffectBox = ({ image, time, level }: Pick<EffectType, 'image' | 'time' | 'level'>) => {\r\n\r\n  const formattedTime = useMemo(() => formatTime(time), [time])\r\n\r\n  return <div className='effect-box'>\r\n    <img className='effect-box__image' src={image} alt='' />\r\n    <div>\r\n      {formattedTime ? (\r\n        // if time is negative then effect is shown without time.\r\n        // Component should be removed manually with time = 0\r\n        <div className='effect-box__time'>{formattedTime}</div>\r\n      ) : null}\r\n      {level > 0 && level < 256 ? (\r\n        <div className='effect-box__level'>{level + 1}</div>\r\n      ) : null}\r\n    </div>\r\n  </div>\r\n}\r\n\r\nexport const defaultIndicatorsState = {\r\n  chunksLoading: false,\r\n  readingFiles: false,\r\n  readonlyFiles: false,\r\n  writingFiles: false, // saving\r\n  appHasErrors: false,\r\n  connectionIssues: 0\r\n}\r\n\r\nconst indicatorIcons: Record<keyof typeof defaultIndicatorsState, string> = {\r\n  chunksLoading: 'add-grid',\r\n  readingFiles: 'arrow-bar-down',\r\n  writingFiles: 'arrow-bar-up',\r\n  appHasErrors: 'alert',\r\n  readonlyFiles: 'file-off',\r\n  connectionIssues: pixelartIcons['cellular-signal-off'],\r\n}\r\n\r\nconst colorOverrides = {\r\n  connectionIssues: {\r\n    0: false,\r\n    1: 'orange',\r\n    2: 'red'\r\n  }\r\n}\r\n\r\nexport default ({ indicators, effects }: { indicators: typeof defaultIndicatorsState, effects: readonly EffectType[] }) => {\r\n  const effectsRef = useRef(effects)\r\n  useEffect(() => {\r\n    effectsRef.current = effects\r\n  }, [effects])\r\n\r\n  useEffect(() => {\r\n    // todo use more precise timer for each effect\r\n    const interval = setInterval(() => {\r\n      for (const [index, effect] of effectsRef.current.entries()) {\r\n        if (effect.time === 0) {\r\n          // effect.removeEffect(effect.image)\r\n          return\r\n        }\r\n        effect.reduceTime(effect.image)\r\n      }\r\n    }, 1000)\r\n\r\n    return () => {\r\n      clearInterval(interval)\r\n    }\r\n  }, [])\r\n\r\n  const indicatorsMapped = Object.entries(defaultIndicatorsState).map(([key]) => {\r\n    const state = indicators[key]\r\n    return {\r\n      icon: indicatorIcons[key],\r\n      // preserve order\r\n      state,\r\n      key\r\n    }\r\n  })\r\n  return <div className='effectsScreen-container'>\r\n    <div className='indicators-container'>\r\n      {\r\n        indicatorsMapped.map((indicator) => <div\r\n          key={indicator.icon}\r\n          style={{\r\n            opacity: indicator.state ? 1 : 0,\r\n            transition: 'opacity color 0.1s',\r\n            color: colorOverrides[indicator.key]?.[indicator.state]\r\n          }}\r\n        >\r\n          <PixelartIcon iconName={indicator.icon} />\r\n        </div>)\r\n      }\r\n    </div>\r\n    <div className='effects-container'>\r\n      {\r\n        effects.map((effect) => <EffectBox\r\n          key={`effectBox-${effect.image}`}\r\n          image={effect.image}\r\n          time={effect.time}\r\n          level={effect.level}\r\n        />)\r\n      }\r\n    </div>\r\n  </div>\r\n}\r\n","import { proxy, useSnapshot } from 'valtio'\r\nimport { useEffect, useMemo } from 'react'\r\nimport { inGameError } from '../utils'\r\nimport { fsState } from '../loadSave'\r\nimport { gameAdditionalState, miscUiState } from '../globalState'\r\nimport { options } from '../optionsStorage'\r\nimport IndicatorEffects, { EffectType, defaultIndicatorsState } from './IndicatorEffects'\r\nimport { images } from './effectsImages'\r\n\r\nexport const state = proxy({\r\n  indicators: {\r\n    chunksLoading: false\r\n  },\r\n  effects: [] as EffectType[]\r\n})\r\n\r\nexport const addEffect = (newEffect: Omit<EffectType, 'reduceTime' | 'removeEffect'>) => {\r\n  const effectIndex = getEffectIndex(newEffect as EffectType)\r\n  if (typeof effectIndex === 'number') {\r\n    state.effects[effectIndex].time = newEffect.time\r\n    state.effects[effectIndex].level = newEffect.level\r\n  } else {\r\n    const effect = { ...newEffect, reduceTime, removeEffect }\r\n    state.effects.push(effect)\r\n  }\r\n}\r\n\r\nconst removeEffect = (image: string) => {\r\n  for (const [index, effect] of (state.effects).entries()) {\r\n    if (effect.image === image) {\r\n      state.effects.splice(index, 1)\r\n    }\r\n  }\r\n}\r\n\r\nconst reduceTime = (image: string) => {\r\n  for (const [index, effect] of (state.effects).entries()) {\r\n    if (effect.image === image) {\r\n      effect.time -= 1\r\n    }\r\n  }\r\n}\r\n\r\nconst getEffectIndex = (newEffect: EffectType) => {\r\n  for (const [index, effect] of (state.effects).entries()) {\r\n    if (effect.image === newEffect.image) {\r\n      return index\r\n    }\r\n  }\r\n  return null\r\n}\r\n\r\nexport default () => {\r\n  const stateIndicators = useSnapshot(state.indicators)\r\n  const { hasErrors } = useSnapshot(miscUiState)\r\n  const { disabledUiParts } = useSnapshot(options)\r\n  const { isReadonly, openReadOperations, openWriteOperations } = useSnapshot(fsState)\r\n  const { noConnection, poorConnection } = useSnapshot(gameAdditionalState)\r\n  const allIndicators: typeof defaultIndicatorsState = {\r\n    readonlyFiles: isReadonly,\r\n    writingFiles: openWriteOperations > 0,\r\n    readingFiles: openReadOperations > 0,\r\n    appHasErrors: hasErrors,\r\n    connectionIssues: poorConnection ? 1 : noConnection ? 2 : 0,\r\n    ...stateIndicators,\r\n  }\r\n\r\n  useEffect(() => {\r\n    let alreadyWaiting = false\r\n    const listener = () => {\r\n      if (alreadyWaiting) return\r\n      state.indicators.chunksLoading = true\r\n      alreadyWaiting = true\r\n      void viewer.waitForChunksToRender().then(() => {\r\n        state.indicators.chunksLoading = false\r\n        alreadyWaiting = false\r\n      })\r\n    }\r\n    viewer.world.renderUpdateEmitter.on('dirty', listener)\r\n\r\n    return () => {\r\n      viewer.world.renderUpdateEmitter.off('dirty', listener)\r\n    }\r\n  }, [])\r\n\r\n  const effects = useSnapshot(state.effects)\r\n\r\n  useMemo(() => {\r\n    const effectsImages = Object.fromEntries(loadedData.effectsArray.map((effect) => {\r\n      const nameKebab = effect.name.replaceAll(/[A-Z]/g, (letter) => `_${letter.toLowerCase()}`).slice(1)\r\n      return [effect.id, images[nameKebab]]\r\n    }))\r\n    bot.on('entityEffect', (entity, effect) => {\r\n      if (entity.id !== bot.entity.id) return\r\n      const image = effectsImages[effect.id] ?? null\r\n      if (!image) {\r\n        inGameError(`received unknown effect id ${effect.id}}`)\r\n        return\r\n      }\r\n      const newEffect = {\r\n        image,\r\n        time: effect.duration / 20, // duration received in ticks\r\n        level: effect.amplifier,\r\n      }\r\n      addEffect(newEffect)\r\n    })\r\n    bot.on('entityEffectEnd', (entity, effect) => {\r\n      if (entity.id !== bot.entity.id) return\r\n      const image = effectsImages[effect.id] ?? null\r\n      if (!image) {\r\n        inGameError(`received unknown effect id ${effect.id}}}`)\r\n        return\r\n      }\r\n      removeEffect(image)\r\n    })\r\n  }, [])\r\n\r\n  return <IndicatorEffects\r\n    indicators={allIndicators}\r\n    effects={effects}\r\n  />\r\n}\r\n","import React, { CSSProperties, useEffect, useMemo, useRef, useState } from 'react'\r\nimport { isMobile } from 'renderer/viewer/lib/simpleUtils'\r\nimport styles from './input.module.css'\r\n\r\ninterface Props extends Omit<React.ComponentProps<'input'>, 'width'> {\r\n  rootStyles?: React.CSSProperties\r\n  autoFocus?: boolean\r\n  inputRef?: React.RefObject<HTMLInputElement>\r\n  validateInput?: (value: string) => CSSProperties | undefined\r\n  width?: number\r\n}\r\n\r\nconst Input = ({ autoFocus, rootStyles, inputRef, validateInput, defaultValue, width, ...inputProps }: Props) => {\r\n  if (width) rootStyles = { ...rootStyles, width }\r\n\r\n  const ref = useRef<HTMLInputElement>(null!)\r\n  const [validationStyle, setValidationStyle] = useState<CSSProperties>({})\r\n  const [value, setValue] = useState(defaultValue ?? '')\r\n\r\n  useEffect(() => {\r\n    setValue(inputProps.value === '' || inputProps.value ? inputProps.value : value)\r\n  }, [inputProps.value])\r\n\r\n  useEffect(() => {\r\n    if (inputRef) (inputRef as any).current = ref.current\r\n    if (!autoFocus || isMobile()) return // Don't make screen keyboard popup on mobile\r\n    ref.current.focus()\r\n  }, [])\r\n\r\n\r\n  useEffect(() => {\r\n    setValidationStyle(validateInput?.(value as any) ?? {})\r\n  }, [value, validateInput])\r\n\r\n  return <div id='input-container' className={styles.container} style={rootStyles}>\r\n    <input\r\n      ref={ref}\r\n      className={styles.input}\r\n      autoComplete='off'\r\n      autoCapitalize='off'\r\n      autoCorrect='off'\r\n      autoSave='off'\r\n      spellCheck='false'\r\n      style={{ ...validationStyle }}\r\n      {...inputProps}\r\n      value={value}\r\n      onChange={(e) => {\r\n        setValue(e.target.value)\r\n        inputProps.onChange?.(e)\r\n      }}\r\n    />\r\n  </div>\r\n}\r\n\r\nexport default Input\r\n\r\nexport const INPUT_LABEL_WIDTH = 190\r\n\r\nexport const InputWithLabel = ({ label, span, ...props }: React.ComponentProps<typeof Input> & { label, span? }) => {\r\n  return <div style={{\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    gridRow: span ? 'span 2 / span 2' : undefined,\r\n  }}\r\n  >\r\n    <label style={{ fontSize: 12, marginBottom: 1, color: 'lightgray' }}>{label}</label>\r\n    <Input rootStyles={{ width: INPUT_LABEL_WIDTH }} {...props} />\r\n  </div>\r\n}\r\n","import { AllKeyCodes } from 'contro-max'\r\nimport { useState, useEffect } from 'react'\r\nimport triangle from './ps_icons/playstation_triangle_console_controller_gamepad_icon.svg'\r\nimport square from './ps_icons/playstation_square_console_controller_gamepad_icon.svg'\r\nimport circle from './ps_icons/circle_playstation_console_controller_gamepad_icon.svg'\r\nimport cross from './ps_icons/cross_playstation_console_controller_gamepad_icon.svg'\r\nimport { parseBindingName } from './parseKeybindingName'\r\n\r\n\r\ntype Props = {\r\n  type: 'keyboard' | 'gamepad',\r\n  val: AllKeyCodes,\r\n  isPS?: boolean\r\n}\r\n\r\nexport default ({ type, val, isPS }: Props) => {\r\n  const [bindName, setBindName] = useState('')\r\n\r\n  async function setBind () {\r\n    setBindName(val)\r\n    const bind = type === 'keyboard' ? await parseBindingName(val) : isPS && buttonsMap[val] ? buttonsMap[val] : val\r\n    setBindName(bind)\r\n  }\r\n\r\n  useEffect(() => {\r\n    void setBind()\r\n  }, [type, val, isPS])\r\n\r\n  return <>\r\n    {bindName}\r\n  </>\r\n}\r\n\r\nconst buttonsMap = {\r\n  'A': cross,\r\n  'B': circle,\r\n  'X': square,\r\n  'Y': triangle\r\n}\r\n","import { useEffect, useState, useContext } from 'react'\r\nimport { customCommandsConfig } from '../customCommands'\r\nimport { ButtonWithMatchesAlert, Context } from './KeybindingsScreen'\r\nimport Button from './Button'\r\nimport styles from './KeybindingsScreen.module.css'\r\nimport Input from './Input'\r\n\r\n\r\nexport type CustomCommand = {\r\n  keys: undefined | string[]\r\n  gamepad: undefined | string[]\r\n  type: string\r\n  inputs: any[]\r\n}\r\n\r\nexport type CustomCommandsMap = Record<string, CustomCommand>\r\n\r\nexport default ({\r\n  customCommands,\r\n  updateCurrBind,\r\n  resetBinding,\r\n}: {\r\n  customCommands: CustomCommandsMap,\r\n  updateCurrBind: (group: string, action: string) => void,\r\n  resetBinding: (group: string, action: string, inputType: string) => void,\r\n}) => {\r\n  const { userConfig, setUserConfig } = useContext(Context)\r\n  const [customConfig, setCustomConfig] = useState<any>({ ...customCommands })\r\n\r\n  useEffect(() => {\r\n    setUserConfig({ ...userConfig, custom: { ...customConfig } })\r\n  }, [customConfig])\r\n\r\n  const addNewCommand = (type: string) => {\r\n    // max key + 1\r\n    const newKey = String(Math.max(...Object.keys(customConfig).map(Number).filter(key => !isNaN(key)), 0) + 1)\r\n    setCustomConfig(prev => {\r\n      const newCustomConf = { ...prev }\r\n      newCustomConf[newKey] = {\r\n        keys: undefined as string[] | undefined,\r\n        gamepad: undefined as string[] | undefined,\r\n        type,\r\n        inputs: [] as any[]\r\n      }\r\n      return newCustomConf\r\n    })\r\n  }\r\n\r\n  return <>\r\n    <div className={styles.group}>\r\n      {Object.entries(customCommandsConfig).map(([group, { input }]) => (\r\n        <div key={`group-container-${group}`} className={styles.group}>\r\n          <div key={`category-${group}`} className={styles['group-category']}>{group}</div>\r\n          {Object.entries(customConfig).filter(([key, data]) => data.type === group).map((commandData, indexOption) => {\r\n            return <CustomCommandContainer\r\n              key={indexOption}\r\n              indexOption={indexOption}\r\n              commandData={commandData}\r\n              updateCurrBind={updateCurrBind}\r\n              groupData={[group, { input }]}\r\n              setCustomConfig={setCustomConfig}\r\n              resetBinding={resetBinding}\r\n            />\r\n          })}\r\n          <Button\r\n            onClick={() => addNewCommand(group)}\r\n            icon=\"pixelarticons:add-box\"\r\n            style={{\r\n              alignSelf: 'center'\r\n            }}\r\n          />\r\n        </div>\r\n      ))}\r\n    </div>\r\n  </>\r\n}\r\n\r\nconst CustomCommandContainer = ({\r\n  indexOption,\r\n  commandData,\r\n  updateCurrBind,\r\n  setCustomConfig,\r\n  resetBinding,\r\n  groupData\r\n}) => {\r\n  const { userConfig } = useContext(Context)\r\n\r\n  const [commandKey, { keys, gamepad, inputs }] = commandData\r\n  const [group, { input }] = groupData\r\n\r\n  const setInputValue = (optionKey, indexInput, value) => {\r\n    setCustomConfig(prev => {\r\n      const newConfig = { ...prev }\r\n      newConfig[optionKey].inputs = [...prev[optionKey].inputs]\r\n      newConfig[optionKey].inputs[indexInput] = value\r\n      return newConfig\r\n    })\r\n  }\r\n\r\n  return <div style={{ padding: '10px' }}>\r\n    {input.map((obj, indexInput) => {\r\n      const config = typeof obj === 'function' ? obj(inputs) : obj\r\n      if (!config) return null\r\n\r\n      return config.type === 'select'\r\n        ? <select\r\n          key={indexInput} onChange={(e) => {\r\n            setInputValue(commandKey, indexInput, e.target.value)\r\n          }}\r\n        >{config.options.map((option) => <option key={option} value={option}>{option}</option>)}\r\n        </select>\r\n        : <Input key={indexInput} rootStyles={{ width: '99%' }} placeholder={config.placeholder} value={inputs[indexInput] ?? ''} onChange={(e) => setInputValue(commandKey, indexInput, e.target.value)} />\r\n    })}\r\n    <div className={styles.actionBinds}>\r\n      {\r\n        userConfig?.['custom']?.[commandKey]?.keys ? <Button\r\n          onClick={() => {\r\n            updateCurrBind(group, commandKey)\r\n            resetBinding('custom', commandKey, 'keyboard')\r\n          }}\r\n          className={styles['undo-keyboard']}\r\n          icon=\"pixelarticons:undo\"\r\n        />\r\n          : null\r\n      }\r\n\r\n      {[0, 1].map((key, index) => <ButtonWithMatchesAlert\r\n        key={`custom-keyboard-${group}-${commandKey}-${index}`}\r\n        group=\"custom\"\r\n        action={commandKey}\r\n        index={index}\r\n        inputType=\"keyboard\"\r\n        keys={keys}\r\n        gamepad={gamepad}\r\n      />)}\r\n\r\n      <div style={{ marginRight: 'auto' }} />\r\n\r\n      {\r\n        userConfig?.['custom']?.[commandKey]?.gamepad ? <Button\r\n          onClick={() => {\r\n            updateCurrBind(group, commandKey)\r\n            resetBinding('custom', commandKey, 'gamepad')\r\n          }}\r\n          className={styles['undo-keyboard']}\r\n          icon=\"pixelarticons:undo\"\r\n        />\r\n          : null\r\n      }\r\n      <ButtonWithMatchesAlert\r\n        group=\"custom\"\r\n        action={commandKey}\r\n        index={0}\r\n        inputType=\"gamepad\"\r\n        keys={keys}\r\n        gamepad={gamepad}\r\n      />\r\n      <Button\r\n        onClick={() => {\r\n          setCustomConfig(prev => {\r\n            const { [commandKey]: commandToRemove, ...newConfig } = prev\r\n            return newConfig\r\n          })\r\n        }}\r\n        style={{ color: 'red' }}\r\n        icon=\"pixelarticons:delete\"\r\n      />\r\n    </div>\r\n  </div>\r\n}\r\n","import { useState, useEffect, useRef, createContext, useContext } from 'react'\r\nimport { UserOverridesConfig } from 'contro-max/build/types/store'\r\nimport { AllKeyCodes } from 'contro-max/build/types/keyCodes'\r\nimport { contro as controEx } from '../controls'\r\nimport { hideModal } from '../globalState'\r\nimport PixelartIcon, { pixelartIcons } from './PixelartIcon'\r\nimport KeybindingsCustom, { CustomCommandsMap } from './KeybindingsCustom'\r\nimport { BindingActionsContext } from './KeybindingsScreenProvider'\r\nimport Button from './Button'\r\nimport Screen from './Screen'\r\nimport Keybinding from './Keybinding'\r\nimport styles from './KeybindingsScreen.module.css'\r\n\r\n\r\ntype HandleClick = (group: string, action: string, index: number, type: string | null) => void\r\n\r\ntype setBinding = (data: any, group: string, command: string, buttonIndex: number) => void\r\n\r\nexport const Context = createContext({\r\n  isPS: false as boolean | undefined,\r\n  userConfig: controEx?.userConfig ?? {} as UserOverridesConfig | undefined,\r\n  setUserConfig (config) { },\r\n  handleClick: (() => { }) as HandleClick,\r\n  bindsMap: { keyboard: {} as any, gamepad: {} as any }\r\n})\r\n\r\nexport default ({\r\n  contro,\r\n  isPS,\r\n}: {\r\n  contro: typeof controEx,\r\n  isPS?: boolean\r\n}) => {\r\n  const containerRef = useRef<HTMLDivElement | null>(null)\r\n  const bindsMap = useRef({ keyboard: {} as any, gamepad: {} as any })\r\n  const { commands } = contro.inputSchema\r\n  const [userConfig, setUserConfig] = useState(contro.userConfig ?? {})\r\n  const [awaitingInputType, setAwaitingInputType] = useState(null as null | 'keyboard' | 'gamepad')\r\n  const [groupName, setGroupName] = useState('')\r\n  const [actionName, setActionName] = useState('')\r\n  const [buttonNum, setButtonNum] = useState(0)\r\n  const { updateBinds } = useContext(BindingActionsContext)\r\n  const [customCommands, setCustomCommands] = useState<CustomCommandsMap>(userConfig.custom as CustomCommandsMap ?? {})\r\n\r\n  const updateCurrBind = (group: string, action: string) => {\r\n    setGroupName(prev => group)\r\n    setActionName(prev => action)\r\n  }\r\n\r\n  const handleClick: HandleClick = (group, action, index, type) => {\r\n    (document.activeElement as HTMLElement)?.blur()\r\n    setAwaitingInputType(type as any)\r\n    updateCurrBind(group, action)\r\n    setButtonNum(prev => index)\r\n  }\r\n\r\n  const setBinding: setBinding = (data, group, command, buttonIndex) => {\r\n    setUserConfig(prev => {\r\n      const newConfig = { ...prev }\r\n      newConfig[group] ??= {}\r\n      newConfig[group][command] ??= {}\r\n\r\n      // keys and buttons should always exist in commands\r\n      const type = 'code' in data ? 'keys' : 'button' in data ? 'gamepad' : null\r\n      if (type) {\r\n        newConfig[group][command][type] ??= group === 'custom' ? [] : [...contro.inputSchema.commands[group][command][type]]\r\n        newConfig[group][command][type]![buttonIndex] = data.code ?? data.button\r\n      }\r\n\r\n      return newConfig\r\n    })\r\n  }\r\n\r\n  const resetBinding = (group: string, command: string, inputType: string) => {\r\n    if (!userConfig?.[group]?.[command]) return\r\n\r\n    setUserConfig(prev => {\r\n      const newConfig = { ...prev }\r\n      const prop = inputType === 'keyboard' ? 'keys' : 'gamepad'\r\n      newConfig[group][command][prop] = undefined\r\n      return newConfig\r\n    })\r\n  }\r\n\r\n  useEffect(() => {\r\n    updateBinds(userConfig)\r\n    setCustomCommands({ ...userConfig.custom as CustomCommandsMap })\r\n\r\n    updateBindMap()\r\n  }, [userConfig])\r\n\r\n  const updateBinding = (data: any) => {\r\n    if ((!data.state && awaitingInputType) || !awaitingInputType) {\r\n      setAwaitingInputType(null)\r\n      return\r\n    }\r\n\r\n\r\n    if ('code' in data) {\r\n      if (data.state && [...contro.pressedKeys].includes(data.code)) return\r\n\r\n      if (data.code === 'Escape' || ['Mouse0', 'Mouse1', 'Mouse2'].includes(data.code)) {\r\n        setAwaitingInputType(null)\r\n        return\r\n      }\r\n      const pressedModifiers = [...contro.pressedKeys].filter(key => /^(Meta|Control|Alt|Shift)?$/.test(key))\r\n      setBinding(\r\n        { code: pressedModifiers.length ? `${pressedModifiers[0]}+${data.code}` : data.code, state: true },\r\n        groupName,\r\n        actionName,\r\n        buttonNum\r\n      )\r\n    }\r\n    if ('button' in data) {\r\n      contro.enabled = false\r\n      void Promise.resolve().then(() => { contro.enabled = true })\r\n      setBinding(data, groupName, actionName, buttonNum)\r\n    }\r\n  }\r\n\r\n  const updateBindMap = () => {\r\n    bindsMap.current = { keyboard: {} as any, gamepad: {} as any }\r\n    if (commands) {\r\n      for (const [group, actions] of Object.entries(commands)) {\r\n        for (const [action, { keys, gamepad }] of Object.entries(actions)) {\r\n          if (keys) {\r\n            let currKeys\r\n            if (userConfig?.[group]?.[action]?.keys) {\r\n              currKeys = userConfig[group][action].keys\r\n            } else {\r\n              currKeys = keys\r\n            }\r\n            for (const [index, key] of currKeys.entries()) {\r\n              bindsMap.current.keyboard[key] ??= []\r\n              if (!bindsMap.current.keyboard[key].some(obj => obj.group === group && obj.action === action && obj.index === index)) {\r\n                bindsMap.current.keyboard[key].push({ group, action, index })\r\n              }\r\n            }\r\n          }\r\n          if (gamepad) {\r\n            let currButtons\r\n            if (userConfig?.[group]?.[action]?.gamepad) {\r\n              currButtons = userConfig[group][action].gamepad\r\n            } else {\r\n              currButtons = gamepad\r\n            }\r\n            if (currButtons.length > 0) {\r\n              bindsMap.current.gamepad[currButtons[0]] ??= []\r\n              bindsMap.current.gamepad[currButtons[0]].push({ group, action, index: 0 })\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // fill binds map\r\n  useEffect(() => {\r\n    updateBindMap()\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    if (!awaitingInputType) return\r\n    contro.on('pressedKeyOrButtonChanged', updateBinding)\r\n    const preventDefault = (e) => e.preventDefault()\r\n    document.addEventListener('keydown', preventDefault, { passive: false })\r\n\r\n    return () => {\r\n      contro.off('pressedKeyOrButtonChanged', updateBinding)\r\n      document.removeEventListener('keydown', preventDefault)\r\n    }\r\n  }, [groupName, actionName, awaitingInputType])\r\n\r\n\r\n  return <Context.Provider value={{\r\n    isPS,\r\n    userConfig,\r\n    setUserConfig,\r\n    handleClick,\r\n    bindsMap: bindsMap.current\r\n  }}\r\n  >\r\n    <Screen title=\"Keybindings\" backdrop>\r\n      {awaitingInputType && <AwaitingInputOverlay isGamepad={awaitingInputType === 'gamepad'} />}\r\n      <div\r\n        className={styles.container}\r\n        ref={containerRef}\r\n      >\r\n        <Button\r\n          onClick={() => { hideModal() }}\r\n          style={{ alignSelf: 'center' }}\r\n        >Back\r\n        </Button>\r\n\r\n        {Object.entries(commands).map(([group, actions], index) => {\r\n          if (group === 'custom') return null\r\n          return <div key={`group-container-${group}-${index}`} className={styles.group}>\r\n            <div className={styles['group-category']}>{group}</div>\r\n            {group === 'general' ? (\r\n              <div style={{\r\n                color: 'rgba(255, 255, 255, 0.7)',\r\n                fontSize: '6px',\r\n                textAlign: 'center'\r\n              }}\r\n              >\r\n                Note: Left, right and middle click keybindings are hardcoded and cannot be changed currently.\r\n              </div>\r\n            ) : null}\r\n            {Object.entries(actions).map(([action, { keys, gamepad }]) => {\r\n              return <div key={`action-container-${action}`} className={styles.actionBinds}>\r\n                <div className={styles.actionName}>{parseActionName(action)}</div>\r\n\r\n                <Button\r\n                  onClick={() => {\r\n                    updateCurrBind(group, action)\r\n                    resetBinding(group, action, 'keyboard')\r\n                  }}\r\n                  style={{ opacity: userConfig?.[group]?.[action]?.keys?.length ? 1 : 0 }}\r\n                  className={styles['undo-keyboard']}\r\n                  icon={pixelartIcons.undo}\r\n                />\r\n\r\n                {[0, 1].map((key, index) => <ButtonWithMatchesAlert\r\n                  key={`keyboard-${group}-${action}-${index}`}\r\n                  group={group}\r\n                  action={action}\r\n                  index={index}\r\n                  inputType=\"keyboard\"\r\n                  keys={keys}\r\n                  gamepad={gamepad}\r\n                />)}\r\n\r\n                <Button\r\n                  key={`keyboard-${group}-${action}`}\r\n                  onClick={() => {\r\n                    updateCurrBind(group, action)\r\n                    resetBinding(group, action, 'gamepad')\r\n                  }}\r\n                  style={{\r\n                    opacity: userConfig?.[group]?.[action]?.gamepad?.length ? 1 : 0,\r\n                    width: '0px'\r\n                  }}\r\n                  className={`${styles['undo-gamepad']} ${styles['margin-left']}`}\r\n                  icon={pixelartIcons.undo}\r\n                />\r\n                <ButtonWithMatchesAlert\r\n                  key={`gamepad-${group}-${action}`}\r\n                  group={group}\r\n                  action={action}\r\n                  index={0}\r\n                  inputType=\"gamepad\"\r\n                  keys={keys}\r\n                  gamepad={gamepad}\r\n                />\r\n              </div>\r\n            })}\r\n          </div>\r\n        })}\r\n\r\n        <KeybindingsCustom\r\n          customCommands={customCommands}\r\n          updateCurrBind={updateCurrBind}\r\n          resetBinding={resetBinding}\r\n        />\r\n      </div>\r\n    </Screen>\r\n  </Context.Provider>\r\n}\r\n\r\nexport const ButtonWithMatchesAlert = ({\r\n  group,\r\n  action,\r\n  index,\r\n  inputType,\r\n  keys,\r\n  gamepad,\r\n}) => {\r\n  const { isPS, userConfig, handleClick, bindsMap } = useContext(Context)\r\n  const [buttonSign, setButtonSign] = useState('')\r\n\r\n  useEffect(() => {\r\n    const type = inputType === 'keyboard' ? 'keys' : 'gamepad'\r\n\r\n    const customValue = userConfig?.[group]?.[action]?.[type]?.[index]\r\n    if (customValue) {\r\n      setButtonSign(customValue)\r\n    } else if (type === 'keys') {\r\n      setButtonSign(keys?.length ? keys[index] : '')\r\n    } else {\r\n      setButtonSign(gamepad?.[0] ?? '')\r\n    }\r\n  }, [userConfig, isPS])\r\n\r\n  return <div\r\n    key={`warning-container-${inputType}-${action}`}\r\n    className={`${styles['warning-container']}`}\r\n  >\r\n    <Button\r\n      key={`${inputType}-${group}-${action}-${index}`}\r\n      onClick={() => handleClick(group, action, index, inputType)}\r\n      className={`${styles.button}`}\r\n    >\r\n      <Keybinding type={inputType} val={buttonSign as AllKeyCodes} />\r\n    </Button>\r\n    {userConfig?.[group]?.[action]?.[inputType === 'keyboard' ? 'keys' : 'gamepad']?.some(key => Object.keys(bindsMap[inputType]).includes(key)\r\n    && bindsMap[inputType][key].length > 1\r\n    && bindsMap[inputType][key].some(prop => prop.index === index\r\n    && prop.group === group\r\n    && prop.action === action)) ? (\r\n      //@ts-format-ignore-region\r\n        <div id={`bind-warning-${group}-${action}-${inputType}-${index}`} className={styles['matched-bind-warning']}>\r\n          <PixelartIcon\r\n            iconName=\"alert\"\r\n            width={5}\r\n            styles={{\r\n              display: 'flex',\r\n              justifyContent: 'center',\r\n              alignItems: 'center',\r\n              marginRight: '2px'\r\n            }}\r\n          />\r\n          <div>\r\n            This bind is already in use. <span />\r\n          </div>\r\n        </div>\r\n      )\r\n      //@ts-format-ignore-endregion\r\n      : null}\r\n  </div>\r\n}\r\n\r\nexport const AwaitingInputOverlay = ({ isGamepad }) => {\r\n  return <div\r\n    style={{\r\n      position: 'fixed',\r\n      inset: 0,\r\n      display: 'flex',\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n      flexDirection: 'column',\r\n      backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n      color: 'white',\r\n      fontSize: 20,\r\n      zIndex: 10,\r\n      textAlign: 'center',\r\n    }}\r\n    onContextMenu={e => e.preventDefault()}\r\n  >\r\n    <div>\r\n      {isGamepad ? 'Press the button on the gamepad ' : 'Press the key, side mouse button '}\r\n      or ESC to cancel.\r\n    </div>\r\n    <Button\r\n      onClick={() => {\r\n        document.dispatchEvent(new KeyboardEvent('keydown', { key: 'Escape' }))\r\n      }}\r\n    >\r\n      Cancel\r\n    </Button>\r\n  </div>\r\n}\r\n\r\nconst parseActionName = (action: string) => {\r\n  const parts = action.split(/(?=[A-Z])/)\r\n  parts[0] = parts[0].charAt(0).toUpperCase() + parts[0].slice(1)\r\n  return parts.join(' ')\r\n}\r\n","import { createContext, useState } from 'react'\r\nimport { contro, updateBinds } from '../controls'\r\nimport KeybindingsScreen from './KeybindingsScreen'\r\nimport { useIsModalActive } from './utilsApp'\r\n\r\nconst bindingActions = {\r\n  updateBinds\r\n}\r\n\r\nexport const BindingActionsContext = createContext(bindingActions)\r\n\r\nexport default () => {\r\n  const [bindActions, setBindActions] = useState(bindingActions)\r\n  const isModalActive = useIsModalActive('keybindings')\r\n\r\n  if (!isModalActive) return null\r\n\r\n  const hasPsGamepad = [...(navigator.getGamepads?.() ?? [])].some(gp => gp?.id.match(/playstation|dualsense|dualshock/i)) // todo: use last used gamepad detection\r\n  return <BindingActionsContext.Provider value={bindActions}>\r\n    <KeybindingsScreen isPS={hasPsGamepad} contro={contro} />\r\n  </BindingActionsContext.Provider>\r\n}\r\n","import { useEffect, useRef } from 'react'\r\nimport './LoadingChunks.css'\r\n\r\nexport default ({ regionFiles = [] as string[], stateMap = {} as Record<string, string>, displayText = false, playerChunk = null as null | { x: number, z: number } }) => {\r\n  // visualize downloading chunks\r\n  const regionNumbers = regionFiles.map(x => x.split('.').slice(1, 3).map(Number))\r\n  const minX = Math.min(...regionNumbers.map(([x]) => x))\r\n  const maxX = Math.max(...regionNumbers.map(([x]) => x))\r\n  const minZ = Math.min(...regionNumbers.map(([, z]) => z))\r\n  const maxZ = Math.max(...regionNumbers.map(([, z]) => z))\r\n  const xChunks = maxX - minX + 1\r\n  const zChunks = maxZ - minZ + 1\r\n\r\n  return <div style={{\r\n    // maxWidth: '80%',\r\n    // maxHeight: '80%',\r\n    // aspectRatio: '1',\r\n    display: 'grid',\r\n    gridTemplateColumns: `repeat(${xChunks}, 1fr)`,\r\n    gridTemplateRows: `repeat(${zChunks}, 1fr)`,\r\n    gap: 1,\r\n    width: '110px',\r\n    height: '110px',\r\n  }}>\r\n    {Array.from({ length: xChunks * zChunks }).map((_, i) => {\r\n      const x = minX + i % xChunks\r\n      const z = minZ + Math.floor(i / xChunks)\r\n      const file = `r.${x}.${z}.mca`\r\n      const state = stateMap[file]\r\n      if (!regionFiles.includes(file)) return <div key={i} style={{ background: 'gray' }} />\r\n      return <Chunk key={i} x={x} z={z} state={state} displayText={displayText} currentPlayer={playerChunk?.x === x && playerChunk?.z === z} />\r\n    })}\r\n  </div>\r\n}\r\n\r\nconst Chunk = ({ x, z, state, displayText, currentPlayer }) => {\r\n  const text = displayText ? `${x},${z}` : undefined\r\n\r\n  return <div style={{\r\n    display: 'flex',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    background: state === 'errored' ? 'red' : state === 'loading' ? 'white' : 'limegreen',\r\n    animation: state === 'loading' ? `loading-chunks-loading-animation 4s infinite cubic-bezier(0.4, 0, 0.2, 1)` : undefined,\r\n    transition: 'background 1s',\r\n    color: state === 'loading' ? 'black' : 'white',\r\n    position: 'relative',\r\n    zIndex: 1,\r\n  }}>\r\n    {/* green dot */}\r\n    {currentPlayer && <div style={{\r\n      position: 'absolute',\r\n      background: 'red',\r\n      borderRadius: '50%',\r\n      width: '5px',\r\n      height: '5px',\r\n      zIndex: -1,\r\n    }} />}\r\n    {text}</div>\r\n}\r\n","import React from 'react'\r\nimport { openURL } from 'renderer/viewer/lib/simpleUtils'\r\nimport { haveDirectoryPicker } from '../utils'\r\nimport { ConnectOptions } from '../connect'\r\nimport styles from './mainMenu.module.css'\r\nimport Button from './Button'\r\nimport ButtonWithTooltip from './ButtonWithTooltip'\r\nimport { pixelartIcons } from './PixelartIcon'\r\nimport useLongPress from './useLongPress'\r\nimport PauseLinkButtons from './PauseLinkButtons'\r\n\r\ntype Action = (e: React.MouseEvent<HTMLButtonElement>) => void\r\n\r\ninterface Props {\r\n  connectToServerAction?: Action\r\n  singleplayerAction?: Action\r\n  optionsAction?: Action\r\n  githubAction?: Action\r\n  openFileAction?: Action\r\n  mapsProvider?: string\r\n  versionStatus?: string\r\n  versionTitle?: string\r\n  onVersionStatusClick?: () => void\r\n  bottomRightLinks?: string\r\n  versionText?: string\r\n  onVersionTextClick?: () => void\r\n  singleplayerAvailable?: boolean\r\n}\r\n\r\nconst httpsRegex = /^https?:\\/\\//\r\n\r\nexport default ({\r\n  connectToServerAction,\r\n  mapsProvider,\r\n  singleplayerAction,\r\n  optionsAction,\r\n  githubAction,\r\n  openFileAction,\r\n  versionText,\r\n  onVersionTextClick,\r\n  versionStatus,\r\n  versionTitle,\r\n  onVersionStatusClick,\r\n  bottomRightLinks,\r\n  singleplayerAvailable = true\r\n}: Props) => {\r\n  if (!bottomRightLinks?.trim()) bottomRightLinks = undefined\r\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\r\n  const linksParsed = bottomRightLinks?.split(/;|\\n/g).map(l => {\r\n    const parts = l.split(':')\r\n    return [parts[0], parts.slice(1).join(':')]\r\n  }) as Array<[string, string]> | undefined\r\n\r\n  const singleplayerLongPress = useLongPress(\r\n    () => {\r\n      window.location.href = window.location.pathname + '?sp=1'\r\n    },\r\n    () => singleplayerAction?.(null as any),\r\n    { delay: 500 }\r\n  )\r\n\r\n  const versionLongPress = useLongPress(\r\n    () => {\r\n      const buildDate = process.env.BUILD_VERSION ? new Date(process.env.BUILD_VERSION + ':00:00.000Z') : null\r\n      const hoursAgo = buildDate ? Math.round((Date.now() - buildDate.getTime()) / (1000 * 60 * 60)) : null\r\n      alert(`BUILD DATE:\\n${buildDate?.toLocaleString() || 'Development build'}${hoursAgo ? `\\nBuilt ${hoursAgo} hours ago` : ''}`)\r\n    },\r\n    () => onVersionTextClick?.(),\r\n  )\r\n\r\n  const connectToServerLongPress = useLongPress(\r\n    () => {\r\n      if (process.env.NODE_ENV === 'development') {\r\n      // Connect to <origin>:25565\r\n        const origin = window.location.hostname\r\n        const connectOptions: ConnectOptions = {\r\n          server: `${origin}:25565`,\r\n          username: 'test',\r\n        }\r\n        dispatchEvent(new CustomEvent('connect', { detail: connectOptions }))\r\n      }\r\n    },\r\n    () => connectToServerAction?.(null as any),\r\n    { delay: 500 }\r\n  )\r\n\r\n  return (\r\n    <div className={styles.root}>\r\n      <div className={styles['game-title']}>\r\n        <div className={styles.minecraft}>\r\n          <div className={styles.edition} />\r\n          <span className={styles.splash}>Prismarine is a beautiful block</span>\r\n        </div>\r\n      </div>\r\n\r\n      <div className={styles.menu}>\r\n        <ButtonWithTooltip\r\n          initialTooltip={{\r\n            content: 'Connect to Java servers!',\r\n            placement: 'top',\r\n          }}\r\n          {...connectToServerLongPress}\r\n          data-test-id='servers-screen-button'\r\n        >\r\n          Connect to server\r\n        </ButtonWithTooltip>\r\n        <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n          <ButtonWithTooltip\r\n            style={{ width: 150 }}\r\n            {...singleplayerLongPress}\r\n            data-test-id='singleplayer-button'\r\n            disabled={!singleplayerAvailable}\r\n            initialTooltip={{\r\n              content: 'Create worlds and play offline',\r\n              placement: 'left',\r\n              offset: -40\r\n            }}\r\n          >\r\n            Singleplayer\r\n          </ButtonWithTooltip>\r\n\r\n          <ButtonWithTooltip\r\n            disabled={!mapsProvider}\r\n            // className={styles['maps-provider']}\r\n            icon={pixelartIcons.map}\r\n            initialTooltip={{ content: 'Explore maps to play from provider!', placement: 'top-start' }}\r\n            onClick={() => mapsProvider && openURL(httpsRegex.test(mapsProvider) ? mapsProvider : 'https://' + mapsProvider, false)}\r\n          />\r\n\r\n          <ButtonWithTooltip\r\n            data-test-id='select-file-folder'\r\n            icon={pixelartIcons.folder}\r\n            onClick={openFileAction}\r\n            initialTooltip={{\r\n              content: 'Load any Java world save' + (haveDirectoryPicker() ? '' : ' (zip)!'),\r\n              placement: 'bottom-start',\r\n            }}\r\n          />\r\n        </div>\r\n        <Button\r\n          onClick={optionsAction}\r\n        >\r\n          Options\r\n        </Button>\r\n        <div className={styles['menu-row']}>\r\n          <PauseLinkButtons />\r\n        </div>\r\n      </div>\r\n\r\n      <div className={styles['bottom-info']}>\r\n        <div style={{ display: 'flex', flexDirection: 'column', gap: 2 }}>\r\n          <span style={{ fontSize: 10, color: 'gray' }} {...versionLongPress}>{versionText}</span>\r\n          <span\r\n            title={`${versionTitle} (click to reload)`}\r\n            onClick={onVersionStatusClick}\r\n            className={styles['product-info']}\r\n          >\r\n            Prismarine Web Client {versionStatus}\r\n          </span>\r\n        </div>\r\n        <span className={styles['product-description']}>\r\n          <div className={styles['product-link']}>\r\n            {linksParsed?.map(([name, link], i, arr) => {\r\n              if (!link.startsWith('http')) link = `https://${link}`\r\n              return <div style={{\r\n                color: 'lightgray',\r\n                fontSize: 8,\r\n              }}>\r\n                <a\r\n                  key={name}\r\n                  style={{\r\n                    whiteSpace: 'nowrap',\r\n                  }} href={link}\r\n                >{name}\r\n                </a>\r\n                {i < arr.length - 1 && <span style={{ marginLeft: 2 }}></span>}\r\n              </div>\r\n            })}\r\n          </div>\r\n          <span>A Minecraft client clone in the browser!</span>\r\n        </span>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import fs from 'fs'\r\nimport { Transition } from 'react-transition-group'\r\nimport { proxy, subscribe, useSnapshot } from 'valtio'\r\nimport { useEffect, useState } from 'react'\r\nimport { activeModalStack, miscUiState, openOptionsMenu, showModal } from '../globalState'\r\nimport { openGithub } from '../utils'\r\nimport { setLoadingScreenStatus } from '../appStatus'\r\nimport { openFilePicker, copyFilesAsync, mkdirRecursive, openWorldDirectory, removeFileRecursiveAsync } from '../browserfs'\r\n\r\nimport MainMenu from './MainMenu'\r\n\r\nconst isMainMenu = () => {\r\n  return activeModalStack.length === 0 && !miscUiState.gameLoaded\r\n}\r\n\r\nconst refreshApp = async (failedUpdate = false) => {\r\n  try {\r\n    const registration = await navigator.serviceWorker.getRegistration()\r\n    if (registration) {\r\n      // First, disconnect all clients\r\n      const clients = await window.clients?.matchAll() || []\r\n      await Promise.all(clients.map(client => client.postMessage('SKIP_WAITING')))\r\n\r\n      // Force the waiting service worker to become active\r\n      if (registration.waiting) {\r\n        registration.waiting.postMessage('SKIP_WAITING')\r\n      }\r\n\r\n      // Add timeout to prevent infinite waiting\r\n      const unregisterPromise = registration.unregister()\r\n      const timeoutPromise = new Promise((_, reject) => {\r\n        setTimeout(() => reject(new Error('SW unregister timeout')), 3000)\r\n      })\r\n\r\n      await Promise.race([unregisterPromise, timeoutPromise])\r\n        .catch(err => {\r\n          console.warn('SW unregister error:', err)\r\n          if (isMainMenu()) {\r\n            alert('Failed to unregister SW: ' + err)\r\n          }\r\n        })\r\n    }\r\n\r\n    if (failedUpdate) {\r\n      await new Promise(resolve => { setTimeout(resolve, 2000) })\r\n    }\r\n\r\n    if (!isMainMenu()) return\r\n\r\n    if (failedUpdate) {\r\n      sessionStorage.justReloaded = false\r\n      // try to force bypass cache\r\n      location.search = '?update=true'\r\n    } else {\r\n      window.justReloaded = true\r\n      sessionStorage.justReloaded = true\r\n      window.location.reload()\r\n    }\r\n  } catch (err) {\r\n    console.error('Failed to refresh app:', err)\r\n    if (!isMainMenu()) {\r\n      alert('Critical error on refreshApp: ' + err)\r\n      // Fallback to force reload if something goes wrong\r\n      window.location.reload()\r\n    }\r\n  }\r\n}\r\n\r\nexport const mainMenuState = proxy({\r\n  serviceWorkerLoaded: false,\r\n})\r\n\r\n// todo clean\r\nlet disableAnimation = false\r\nexport default () => {\r\n  const haveModals = useSnapshot(activeModalStack).length\r\n  const { gameLoaded, fsReady, appConfig, singleplayerAvailable } = useSnapshot(miscUiState)\r\n\r\n  const noDisplay = haveModals || gameLoaded || !fsReady\r\n\r\n  useEffect(() => {\r\n    if (noDisplay && fsReady) disableAnimation = true\r\n  }, [noDisplay])\r\n\r\n  const [versionStatus, setVersionStatus] = useState('')\r\n  const [versionTitle, setVersionTitle] = useState('')\r\n\r\n  useEffect(() => {\r\n    if (process.env.SINGLE_FILE_BUILD_MODE) {\r\n      setVersionStatus('(single file build)')\r\n    } else if (process.env.NODE_ENV === 'development') {\r\n      setVersionStatus('(dev)')\r\n    } else {\r\n      fetch('./version.txt').then(async (f) => {\r\n        if (f.status === 404) return\r\n        const contents = await f.text()\r\n        const isLatest = contents === process.env.BUILD_VERSION\r\n        if (!isLatest && sessionStorage.justReloaded) {\r\n          setVersionStatus('(force reloading, wait)')\r\n          void refreshApp(true)\r\n          return\r\n        }\r\n        const upStatus = () => {\r\n          setVersionStatus(`(${isLatest ? 'latest' : 'new version available'}${mainMenuState.serviceWorkerLoaded ? ', Downloaded' : ''})`)\r\n        }\r\n        subscribe(mainMenuState, upStatus)\r\n        upStatus()\r\n        setVersionTitle(`Loaded: ${process.env.BUILD_VERSION}. Remote: ${contents}`)\r\n      }, () => {\r\n        setVersionStatus('(offline)')\r\n      })\r\n    }\r\n  }, [])\r\n\r\n  let mapsProviderUrl = appConfig?.mapsProvider\r\n  if (mapsProviderUrl && location.origin !== 'https://mcraft.fun') mapsProviderUrl = mapsProviderUrl + '?to=' + encodeURIComponent(location.href)\r\n\r\n  // todo clean, use custom csstransition\r\n  return <Transition in={!noDisplay} timeout={disableAnimation ? 0 : 100} mountOnEnter unmountOnExit>\r\n    {(state) => <div style={{ transition: state === 'exiting' || disableAnimation ? '' : '100ms opacity ease-in', ...state === 'entered' ? { opacity: 1 } : { opacity: 0 } }}>\r\n      <MainMenu\r\n        singleplayerAvailable={singleplayerAvailable}\r\n        connectToServerAction={() => showModal({ reactType: 'serversList' })}\r\n        singleplayerAction={async () => {\r\n          showModal({ reactType: 'singleplayer' })\r\n        }}\r\n        githubAction={() => openGithub()}\r\n        optionsAction={() => openOptionsMenu('main')}\r\n        bottomRightLinks={process.env.MAIN_MENU_LINKS}\r\n        openFileAction={e => {\r\n          if (!!window.showDirectoryPicker && !e.shiftKey) {\r\n            void openWorldDirectory()\r\n          } else {\r\n            openFilePicker()\r\n          }\r\n        }}\r\n        mapsProvider={mapsProviderUrl}\r\n        versionStatus={versionStatus}\r\n        versionTitle={versionTitle}\r\n        onVersionStatusClick={async () => {\r\n          setVersionStatus('(reloading)')\r\n          await refreshApp()\r\n        }}\r\n        onVersionTextClick={async () => {\r\n          openGithub(process.env.RELEASE_LINK)\r\n        }}\r\n        versionText={process.env.RELEASE_TAG}\r\n      />\r\n    </div>}\r\n  </Transition>\r\n}\r\n","import { ComponentProps } from 'react'\r\nimport { render } from '@xmcl/text-component'\r\nimport { noCase } from 'change-case'\r\nimport mojangson from 'mojangson'\r\nimport { openURL } from 'renderer/viewer/lib/simpleUtils'\r\nimport { MessageFormatPart } from '../chatUtils'\r\nimport { chatInputValueGlobal } from './Chat'\r\nimport './MessageFormatted.css'\r\nimport { showOptionsModal } from './SelectOption'\r\n\r\nconst hoverItemToText = (hoverEvent: MessageFormatPart['hoverEvent']) => {\r\n  try {\r\n    if (!hoverEvent) return undefined\r\n    const contents = hoverEvent['contents'] ?? hoverEvent.value\r\n    if (typeof contents.text === 'string' && contents.text.startsWith('{')) {\r\n      Object.assign(contents, mojangson.simplify(mojangson.parse(contents.text)))\r\n    }\r\n    if (typeof contents === 'string') return contents\r\n    // if (hoverEvent.action === 'show_text') {\r\n    //   return contents\r\n    // }\r\n    if (hoverEvent.action === 'show_item') {\r\n      return contents.id\r\n    }\r\n    if (hoverEvent.action === 'show_entity') {\r\n      let str = noCase(contents.type.replace('minecraft:', ''))\r\n      if (contents.name) str += `: ${contents.name.text}`\r\n      return str\r\n    }\r\n  } catch (err) {\r\n    // todo report critical error\r\n    reportError?.('Failed to parse message hover' + err.message)\r\n    return undefined\r\n  }\r\n}\r\n\r\nconst clickEventToProps = (clickEvent: MessageFormatPart['clickEvent']) => {\r\n  if (!clickEvent) return\r\n  if (clickEvent.action === 'run_command' || clickEvent.action === 'suggest_command') {\r\n    return {\r\n      onClick () {\r\n        chatInputValueGlobal.value = clickEvent.value\r\n      }\r\n    }\r\n  }\r\n  if (clickEvent.action === 'open_url' || clickEvent.action === 'open_file') {\r\n    return {\r\n      async onClick () {\r\n        const promptMessageText = `Open \"${clickEvent.value}\"?`\r\n        const confirm = await showOptionsModal(promptMessageText, ['Open', 'Copy'], {\r\n          cancel: true\r\n        })\r\n        if (confirm === 'Open') {\r\n          openURL(clickEvent.value)\r\n        } else if (confirm === 'Copy') {\r\n          void navigator.clipboard.writeText(clickEvent.value)\r\n        }\r\n      }\r\n    }\r\n  }\r\n  if (clickEvent.action === 'copy_to_clipboard') {\r\n    return {\r\n      onClick () {\r\n        void navigator.clipboard.writeText(clickEvent.value)\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport const MessagePart = ({ part, ...props }: { part: MessageFormatPart } & ComponentProps<'span'>) => {\r\n\r\n  const { color, italic, bold, underlined, strikethrough, text, clickEvent, hoverEvent, obfuscated } = part\r\n\r\n  const clickProps = clickEventToProps(clickEvent)\r\n  const hoverMessageRaw = hoverItemToText(hoverEvent)\r\n  const hoverItemText = hoverMessageRaw && typeof hoverMessageRaw !== 'string' ? render(hoverMessageRaw).children.map(child => child.component.text).join('') : hoverMessageRaw\r\n\r\n  const applyStyles = [\r\n    clickProps && messageFormatStylesMap.clickEvent,\r\n    color ? colorF(color.toLowerCase()) + `; text-shadow: 1px 1px 0px ${getColorShadow(colorF(color.toLowerCase()).replace('color:', ''))}` : messageFormatStylesMap.white,\r\n    italic && messageFormatStylesMap.italic,\r\n    bold && messageFormatStylesMap.bold,\r\n    italic && messageFormatStylesMap.italic,\r\n    underlined && messageFormatStylesMap.underlined,\r\n    strikethrough && messageFormatStylesMap.strikethrough,\r\n    obfuscated && messageFormatStylesMap.obfuscated\r\n  ].filter(a => a !== false && a !== undefined).filter(Boolean)\r\n\r\n  return <span title={hoverItemText} style={parseInlineStyle(applyStyles.join(';'))} {...clickProps} {...props}>{text}</span>\r\n}\r\n\r\nexport default ({ parts, className }: { parts: readonly MessageFormatPart[], className?: string }) => {\r\n  return (\r\n    <span className={`formatted-message ${className ?? ''}`}>\r\n      {parts.map((part, i) => <MessagePart key={i} part={part} />)}\r\n    </span>\r\n  )\r\n}\r\n\r\nconst colorF = (color) => {\r\n  return color.trim().startsWith('#') ? `color:${color}` : messageFormatStylesMap[color] ?? undefined\r\n}\r\n\r\nexport function getColorShadow (hex, dim = 0.25) {\r\n  const color = parseInt(hex.replace('#', ''), 16)\r\n\r\n  const r = Math.trunc((color >> 16 & 0xFF) * dim)\r\n  const g = Math.trunc((color >> 8 & 0xFF) * dim)\r\n  const b = Math.trunc((color & 0xFF) * dim)\r\n\r\n  const f = (c) => ('00' + c.toString(16)).slice(-2)\r\n  return `#${f(r)}${f(g)}${f(b)}`\r\n}\r\n\r\nexport function parseInlineStyle (style: string): Record<string, any> {\r\n  const obj: Record<string, any> = {}\r\n  for (const rule of style.split(';')) {\r\n    const [prop, value] = rule.split(':')\r\n    const cssInJsProp = prop.trim().replaceAll(/-./g, (x) => x.toUpperCase()[1])\r\n    obj[cssInJsProp] = value.trim()\r\n  }\r\n  return obj\r\n}\r\n\r\nexport const messageFormatStylesMap = {\r\n  black: 'color:#000000',\r\n  dark_blue: 'color:#0000AA',\r\n  dark_green: 'color:#00AA00',\r\n  dark_aqua: 'color:#00AAAA',\r\n  dark_red: 'color:#AA0000',\r\n  dark_purple: 'color:#AA00AA',\r\n  gold: 'color:#FFAA00',\r\n  gray: 'color:#AAAAAA',\r\n  dark_gray: 'color:#555555',\r\n  blue: 'color:#5555FF',\r\n  green: 'color:#55FF55',\r\n  aqua: 'color:#55FFFF',\r\n  red: 'color:#FF5555',\r\n  light_purple: 'color:#FF55FF',\r\n  yellow: 'color:#FFFF55',\r\n  white: 'color:#FFFFFF',\r\n  bold: 'font-weight:900',\r\n  strikethrough: 'text-decoration:line-through',\r\n  underlined: 'text-decoration:underline',\r\n  italic: 'font-style:italic',\r\n  obfuscated: 'filter:blur(2px)',\r\n  clickEvent: 'cursor:pointer',\r\n}\r\n","import { useMemo } from 'react'\r\nimport { fromFormattedString } from '@xmcl/text-component'\r\nimport { ErrorBoundary } from '@zardoy/react-util'\r\nimport { formatMessage } from '../chatUtils'\r\nimport MessageFormatted from './MessageFormatted'\r\n\r\n/** like MessageFormatted, but receives raw string or json instead, uses window.loadedData */\r\nexport default ({ message, fallbackColor, className }: {\r\n  message: string | Record<string, any> | null,\r\n  fallbackColor?: string,\r\n  className?: string\r\n}) => {\r\n  const messageJson = useMemo(() => {\r\n    if (!message) return null\r\n    try {\r\n      const texts = formatMessage(typeof message === 'string' ? fromFormattedString(message) : message)\r\n      return texts.map(text => {\r\n        return {\r\n          ...text,\r\n          color: text.color ?? fallbackColor,\r\n        }\r\n      })\r\n    } catch (err) {\r\n      console.error(err) // todo ensure its being logged\r\n      return null\r\n    }\r\n  }, [message])\r\n\r\n  return messageJson ? <ErrorBoundary renderError={(error) => {\r\n    console.error(error)\r\n    return <div>[text component crashed]</div>\r\n  }}>\r\n    <MessageFormatted parts={messageJson} className={className} />\r\n  </ErrorBoundary> : null\r\n}\r\n","import { proxy, subscribe, useSnapshot } from 'valtio'\r\nimport { useEffect, useRef, useState } from 'react'\r\nimport './MineflayerPluginConsole.css'\r\nimport { miscUiState } from '../globalState'\r\nimport { useIsModalActive } from './utilsApp'\r\nimport { useScrollBehavior } from './hooks/useScrollBehavior'\r\n\r\nexport type ConsoleMessage = {\r\n  text: string\r\n  isRepl?: boolean\r\n  level?: 'log' | 'warn' | 'error'\r\n  id: number\r\n}\r\n\r\nexport const mineflayerConsoleState = proxy({\r\n  onExecute: null as ((code: string) => void) | null,\r\n  messages: [] as ConsoleMessage[],\r\n  replEnabled: false,\r\n  consoleEnabled: false,\r\n})\r\n\r\nconst MessageLine = ({ message }: { message: ConsoleMessage }) => {\r\n  const messageClass = message.isRepl ? 'console-message-repl' : message.level ? `console-message-${message.level}` : ''\r\n  return (\r\n    <li className={`console-message ${messageClass}`}>\r\n      <span className=\"console-message-prefix\">&gt;</span>\r\n      {message.text}\r\n    </li>\r\n  )\r\n}\r\n\r\nexport default () => {\r\n  const opened = useIsModalActive('console')\r\n  const usingTouch = useSnapshot(miscUiState).currentTouch\r\n  const { messages, replEnabled, consoleEnabled, onExecute } = useSnapshot(mineflayerConsoleState)\r\n\r\n  const consoleInput = useRef<HTMLInputElement>(null!)\r\n  const consoleMessages = useRef<HTMLDivElement>(null)\r\n\r\n  const { scrollToBottom } = useScrollBehavior(consoleMessages, { messages, opened })\r\n\r\n  // Add useEffect to focus input when opened\r\n  useEffect(() => {\r\n    if (opened && replEnabled) {\r\n      consoleInput.current?.focus()\r\n    }\r\n  }, [opened, replEnabled])\r\n\r\n  const updateInputValue = (newValue: string) => {\r\n    consoleInput.current.value = newValue\r\n    setTimeout(() => {\r\n      consoleInput.current.setSelectionRange(newValue.length, newValue.length)\r\n    }, 0)\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className={`console-wrapper console-messages-wrapper ${usingTouch ? 'display-mobile' : ''}`}>\r\n        <div ref={consoleMessages} className={`console ${opened ? 'opened' : ''}`} id=\"console-messages\">\r\n          {!consoleEnabled && (\r\n            <MessageLine\r\n              key=\"console-disabled\"\r\n              message={{\r\n                id: -1,\r\n                text: 'Console is not enabled. Enable it in the plugin initialization settings.',\r\n                level: 'error'\r\n              }}\r\n            />\r\n          )}\r\n          {messages.map((m) => (\r\n            <MessageLine key={m.id} message={m} />\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      <div className={`console-wrapper console-input-wrapper ${usingTouch ? 'input-mobile' : ''}`} hidden={!opened}>\r\n        <form\r\n          className='console-input'\r\n          onSubmit={(e) => {\r\n            e.preventDefault()\r\n            const code = consoleInput.current.value\r\n            if (code) {\r\n              onExecute?.(code)\r\n              updateInputValue('')\r\n              // Scroll to bottom after sending command\r\n              scrollToBottom()\r\n            }\r\n          }}\r\n        >\r\n          <div className=\"console-input-container\">\r\n            <span className=\"console-input-prefix\">&gt;</span>\r\n            <input\r\n              defaultValue=''\r\n              ref={consoleInput}\r\n              type=\"text\"\r\n              className=\"console-input-field\"\r\n              id=\"consoleinput\"\r\n              spellCheck={false}\r\n              autoComplete=\"off\"\r\n              disabled={!replEnabled}\r\n              placeholder={replEnabled ? 'Enter JavaScript code (bot variable is available)' : 'REPL is not enabled'}\r\n            />\r\n          </div>\r\n          <button type='submit' style={{ visibility: 'hidden', position: 'absolute' }} />\r\n        </form>\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n","import { proxy, useSnapshot } from 'valtio'\r\nimport { useEffect, useRef, Fragment } from 'react'\r\nimport type { UIDefinition } from 'mcraft-fun-mineflayer/build/customChannel'\r\nimport MessageFormattedString from './MessageFormattedString'\r\nimport { useUiMotion } from './uiMotion'\r\nimport PixelartIcon from './PixelartIcon'\r\n\r\nexport const mineflayerPluginHudState = proxy({\r\n  ui: [] as Array<UIDefinition & { id: string }>,\r\n})\r\n\r\ntype TextPart = { type: 'text'; content: string } | { type: 'icon'; iconName: string }\r\n\r\nconst parseTextWithIcons = (text: string): TextPart[] => {\r\n  const parts: TextPart[] = []\r\n  let currentText = ''\r\n  let i = 0\r\n\r\n  while (i < text.length) {\r\n    if (text[i] === '{' && text.slice(i, i + 6) === '{icon:') {\r\n      // If we have accumulated text before the icon, add it\r\n      if (currentText) {\r\n        parts.push({ type: 'text', content: currentText })\r\n        currentText = ''\r\n      }\r\n\r\n      // Find the end of the icon placeholder\r\n      const endBrace = text.indexOf('}', i)\r\n      if (endBrace !== -1) {\r\n        const iconName = text.slice(i + 6, endBrace)\r\n        parts.push({ type: 'icon', iconName })\r\n        i = endBrace + 1\r\n        continue\r\n      }\r\n    }\r\n    currentText += text[i]\r\n    i++\r\n  }\r\n\r\n  // Add any remaining text\r\n  if (currentText) {\r\n    parts.push({ type: 'text', content: currentText })\r\n  }\r\n\r\n  return parts\r\n}\r\n\r\nconst TextElement = ({ text, x, y, motion = true, formatted = true, css = '', onTab = false }: UIDefinition & { type: 'text' }) => {\r\n  const motionRef = useRef<HTMLDivElement>(null)\r\n  const innerRef = useRef<HTMLDivElement>(null)\r\n\r\n  useUiMotion(motionRef, motion)\r\n\r\n  useEffect(() => {\r\n    if (!css) return\r\n    innerRef.current!.style.cssText = css\r\n  }, [css])\r\n\r\n  if (onTab && !document.hidden) return null\r\n\r\n  const parts = parseTextWithIcons(text)\r\n\r\n  return (\r\n    <div\r\n      ref={motionRef}\r\n      style={{\r\n        position: 'absolute',\r\n        left: x,\r\n        top: y,\r\n        transition: motion ? 'transform 0.1s ease-out' : 'none',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        gap: '2px'\r\n      }}\r\n    >\r\n      <div ref={innerRef}>\r\n        {parts.map((part, index) => (\r\n          <Fragment key={index}>\r\n            {part.type === 'text' ? (\r\n              formatted ? <MessageFormattedString message={part.content} /> : part.content\r\n            ) : (\r\n              <PixelartIcon iconName={part.iconName} width={12} styles={{ display: 'inline-block' }} />\r\n            )}\r\n          </Fragment>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst ImageElement = ({ url, x, y, width, height }: UIDefinition & { type: 'image' }) => {\r\n  return (\r\n    <img\r\n      src={url}\r\n      style={{\r\n        position: 'absolute',\r\n        left: x,\r\n        top: y,\r\n        width,\r\n        height\r\n      }}\r\n      alt=\"\"\r\n    />\r\n  )\r\n}\r\n\r\nexport default () => {\r\n  const { ui } = useSnapshot(mineflayerPluginHudState)\r\n\r\n  return (\r\n    <div style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', pointerEvents: 'none' }} className='mineflayer-plugin-hud'>\r\n      {ui.map((element, index) => {\r\n        if (element.type === 'lil') return null // Handled elsewhere\r\n        if (element.type === 'text') return <TextElement key={index} {...element} />\r\n        if (element.type === 'image') return <ImageElement key={index} {...element} />\r\n        return null\r\n      })}\r\n    </div>\r\n  )\r\n}\r\n","import { useRef, useEffect, useState } from 'react'\r\nimport { miscUiState } from '../globalState'\r\nimport { DrawerAdapter } from './MinimapDrawer'\r\nimport Fullmap from './Fullmap'\r\n\r\n\r\nexport type DisplayMode = 'fullmapOnly' | 'minimapOnly'\r\n\r\nexport default (\r\n  { adapter, showMinimap, showFullmap, singleplayer, fullMap, toggleFullMap, displayMode }:\r\n  {\r\n    adapter: DrawerAdapter,\r\n    showMinimap: string,\r\n    showFullmap: string,\r\n    singleplayer: boolean,\r\n    fullMap?: boolean,\r\n    toggleFullMap?: () => void\r\n    displayMode?: DisplayMode\r\n  }\r\n) => {\r\n  const full = useRef(false)\r\n  const canvasTick = useRef(0)\r\n  const canvasRef = useRef<HTMLCanvasElement>(null)\r\n  const [position, setPosition] = useState({ x: 0, y: 0, z: 0 })\r\n\r\n  const updateMap = () => {\r\n    setPosition({ x: adapter.playerPosition.x, y: adapter.playerPosition.y, z: adapter.playerPosition.z })\r\n    if (adapter.mapDrawer) {\r\n      if (!full.current) {\r\n        rotateMap()\r\n        adapter.mapDrawer.draw(adapter.playerPosition)\r\n        adapter.mapDrawer.drawPlayerPos()\r\n        adapter.mapDrawer.drawWarps()\r\n      }\r\n      if (canvasTick.current % 300 === 0 && !fullMap) {\r\n        if ('requestIdleCallback' in window) {\r\n          requestIdleCallback(() => {\r\n            adapter.mapDrawer?.clearChunksStore()\r\n          })\r\n        } else {\r\n          adapter.mapDrawer.clearChunksStore()\r\n        }\r\n        canvasTick.current = 0\r\n      }\r\n    }\r\n    canvasTick.current += 1\r\n  }\r\n\r\n  const updateWarps = () => { }\r\n\r\n  const rotateMap = () => {\r\n    if (!adapter.mapDrawer) return\r\n    adapter.mapDrawer.canvas.style.transform = `rotate(${adapter.yaw}rad)`\r\n    adapter.mapDrawer.yaw = adapter.yaw\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (canvasRef.current && adapter.mapDrawer && !miscUiState.displayFullmap) {\r\n      adapter.mapDrawer.canvas = canvasRef.current\r\n      adapter.mapDrawer.full = false\r\n    }\r\n  }, [canvasRef.current, miscUiState.displayFullmap])\r\n\r\n  useEffect(() => {\r\n    adapter.on('updateMap', updateMap)\r\n    adapter.on('updateWaprs', updateWarps)\r\n\r\n    return () => {\r\n      adapter.off('updateMap', updateMap)\r\n      adapter.off('updateWaprs', updateWarps)\r\n    }\r\n  }, [adapter])\r\n\r\n  return fullMap && displayMode !== 'minimapOnly' && (showFullmap === 'singleplayer' && singleplayer || showFullmap === 'always')\r\n    ? <Fullmap\r\n      toggleFullMap={toggleFullMap}\r\n      adapter={adapter}\r\n    />\r\n    : displayMode !== 'fullmapOnly' && (showMinimap === 'singleplayer' && singleplayer || showMinimap === 'always')\r\n      ? <div\r\n        className='minimap'\r\n        style={{\r\n          position: 'absolute',\r\n          right: '0px',\r\n          top: '0px',\r\n          padding: '5px 5px 0px 0px',\r\n          textAlign: 'center',\r\n        }}\r\n        onClick={() => {\r\n          toggleFullMap?.()\r\n        }}\r\n      >\r\n        <canvas\r\n          style={{\r\n            transition: '0.5s',\r\n            transitionTimingFunction: 'ease-out',\r\n            borderRadius: '1000px'\r\n          }}\r\n          width={80}\r\n          height={80}\r\n          ref={canvasRef}\r\n        />\r\n        <div\r\n          style={{\r\n            fontSize: '0.5em',\r\n            textShadow: '0.1em 0 black, 0 0.1em black, -0.1em 0 black, 0 -0.1em black, -0.1em -0.1em black, -0.1em 0.1em black, 0.1em -0.1em black, 0.1em 0.1em black'\r\n          }}\r\n        >\r\n          {position.x.toFixed(2)} {position.y.toFixed(2)} {position.z.toFixed(2)}\r\n        </div>\r\n      </div> : null\r\n}\r\n","import { Vec3 } from 'vec3'\r\nimport { TypedEventEmitter } from 'contro-max/build/typedEventEmitter'\r\nimport { WorldWarp } from 'flying-squid/dist/lib/modules/warps'\r\nimport { Chunk } from 'prismarine-world/types/world'\r\n\r\nexport type MapUpdates = {\r\n  updateBlockColor: (pos: Vec3) => void\r\n  updatePlayerPosition: () => void\r\n  updateWarps: () => void\r\n}\r\n\r\nexport interface DrawerAdapter extends TypedEventEmitter<MapUpdates> {\r\n  getHighestBlockY: (x: number, z: number, chunk?: Chunk) => number\r\n  clearChunksStore: (x: number, z: number) => void\r\n  chunksStore: Map<string, undefined | null | 'requested' | ChunkInfo >\r\n  playerPosition: Vec3\r\n  warps: WorldWarp[]\r\n  loadingChunksQueue: Set<string>\r\n  mapDrawer: MinimapDrawer\r\n  yaw: number\r\n  full: boolean\r\n  world: string\r\n  setWarp: (warp: WorldWarp, remove?: boolean) => void\r\n  quickTp?: (x: number, z: number) => void\r\n  loadChunk: (key: string) => Promise<void>\r\n  drawChunkOnCanvas: (key: string, canvas: HTMLCanvasElement) => Promise<void>\r\n}\r\n\r\nexport type ChunkInfo = {\r\n  heightmap: Uint8Array,\r\n  colors: string[],\r\n}\r\n\r\nexport class MinimapDrawer {\r\n  canvasWidthCenterX: number\r\n  canvasWidthCenterY: number\r\n  _mapSize: number\r\n  radius: number\r\n  ctx: CanvasRenderingContext2D\r\n  _canvas: HTMLCanvasElement\r\n  chunksInView = new Set<string>()\r\n  lastBotPos: Vec3\r\n  lastWarpPos: Vec3\r\n  mapPixel: number\r\n  yaw: number\r\n  _full = false\r\n\r\n  constructor (\r\n    public loadChunk: undefined | ((key: string) => Promise<void>),\r\n    public warps: WorldWarp[],\r\n    public loadingChunksQueue: undefined | Set<string>,\r\n    public chunksStore: Map<string, undefined | null | 'requested' | ChunkInfo >\r\n  ) {\r\n    this.loadChunk = loadChunk\r\n    this.warps = warps\r\n    this.loadingChunksQueue = loadingChunksQueue\r\n    this.chunksStore = chunksStore\r\n  }\r\n\r\n  setMapPixel () {\r\n    if (this.full) {\r\n      this.radius = Math.floor(Math.min(this.canvas.width, this.canvas.height) / 2)\r\n      this._mapSize = 16\r\n    } else {\r\n      this.radius = Math.floor(Math.min(this.canvas.width, this.canvas.height) / 2.2)\r\n      this._mapSize = this.radius * 2\r\n    }\r\n    this.mapPixel = Math.floor(this.radius * 2 / this.mapSize)\r\n  }\r\n\r\n  get full () {\r\n    return this._full\r\n  }\r\n\r\n  set full (full: boolean) {\r\n    this._full = full\r\n    this.setMapPixel()\r\n  }\r\n\r\n  get canvas () {\r\n    return this._canvas\r\n  }\r\n\r\n  set canvas (canvas: HTMLCanvasElement) {\r\n    this.ctx = canvas.getContext('2d', { willReadFrequently: true })!\r\n    this.ctx.imageSmoothingEnabled = false\r\n    this.canvasWidthCenterX = canvas.width / 2\r\n    this.canvasWidthCenterY = canvas.height / 2\r\n    this._canvas = canvas\r\n    this.setMapPixel()\r\n  }\r\n\r\n  get mapSize () {\r\n    return this._mapSize\r\n  }\r\n\r\n  set mapSize (mapSize: number) {\r\n    this._mapSize = mapSize\r\n    this.mapPixel = Math.floor(this.radius * 2 / this.mapSize)\r\n    this.draw(this.lastBotPos)\r\n  }\r\n\r\n  draw (botPos: Vec3,) {\r\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height)\r\n\r\n    this.lastBotPos = botPos\r\n    this.updateChunksInView()\r\n    for (const key of this.chunksInView) {\r\n      if (!this.chunksStore.has(key) && !this.loadingChunksQueue?.has(key)) {\r\n        void this.loadChunk?.(key)\r\n      }\r\n      // case when chunk is not present is handled in drawChunk\r\n      this.drawChunk(key)\r\n    }\r\n    if (!this.full) this.drawPartsOfWorld()\r\n  }\r\n\r\n  updateChunksInView (viewX?: number, viewZ?: number) {\r\n    const worldCenterX = viewX ?? this.lastBotPos.x\r\n    const worldCenterZ = viewZ ?? this.lastBotPos.z\r\n\r\n    const radius = this.mapSize / 2\r\n    const leftViewBorder = Math.floor((worldCenterX - radius) / 16) - 1\r\n    const rightViewBorder = Math.ceil((worldCenterX + radius) / 16)\r\n    const topViewBorder = Math.floor((worldCenterZ - radius) / 16) - 1\r\n    const bottomViewBorder = Math.ceil((worldCenterZ + radius) / 16)\r\n\r\n    this.chunksInView.clear()\r\n    for (let i = topViewBorder; i <= bottomViewBorder; i += 1) {\r\n      for (let j = leftViewBorder; j <= rightViewBorder; j += 1) {\r\n        this.chunksInView.add(`${j},${i}`)\r\n      }\r\n    }\r\n  }\r\n\r\n  drawChunk (key: string, chunkInfo?: ChunkInfo | null) {\r\n    const [chunkX, chunkZ] = key.split(',').map(Number)\r\n    const chunkWorldX = chunkX * 16\r\n    const chunkWorldZ = chunkZ * 16\r\n    const chunkCanvasX = Math.floor((chunkWorldX - this.lastBotPos.x) * this.mapPixel + this.canvasWidthCenterX)\r\n    const chunkCanvasY = Math.floor((chunkWorldZ - this.lastBotPos.z) * this.mapPixel + this.canvasWidthCenterY)\r\n    const chunk = chunkInfo ?? this.chunksStore.get(key)\r\n    // if chunk is not ready then draw waiting color (grey) or none (half transparent black)\r\n    if (typeof chunk !== 'object') {\r\n      const chunkSize = this.mapPixel * 16\r\n      this.ctx.fillStyle = chunk === 'requested' ? 'rgb(200, 200, 200)' : 'rgba(0, 0, 0, 0.5)'\r\n      this.ctx.fillRect(chunkCanvasX, chunkCanvasY, chunkSize, chunkSize)\r\n      return\r\n    }\r\n    for (let row = 0; row < 16; row += 1) {\r\n      for (let col = 0; col < 16; col += 1) {\r\n        const index = row * 16 + col\r\n        const color = chunk?.colors[index] ?? 'rgb(255, 0, 0)'\r\n        const pixelX = chunkCanvasX + this.mapPixel * col\r\n        const pixelY = chunkCanvasY + this.mapPixel * row\r\n        this.drawPixel(pixelX, pixelY, color)\r\n      }\r\n    }\r\n  }\r\n\r\n  drawPixel (pixelX: number, pixelY: number, color: string) {\r\n    if (!this.full && Math.hypot(pixelX - this.canvasWidthCenterX, pixelY - this.canvasWidthCenterY) > this.radius) {\r\n      this.ctx.clearRect(pixelX, pixelY, this.mapPixel, this.mapPixel)\r\n      return\r\n    }\r\n    this.ctx.fillStyle = color\r\n    this.ctx.fillRect(\r\n      pixelX,\r\n      pixelY,\r\n      this.mapPixel,\r\n      this.mapPixel\r\n    )\r\n  }\r\n\r\n  clearChunksStore () {\r\n    for (const key of this.chunksStore.keys()) {\r\n      const [x, z] = key.split(',').map(x => Number(x) * 16)\r\n      if (Math.hypot((this.lastBotPos.x - x), (this.lastBotPos.z - z)) > this.radius * 5) {\r\n        this.chunksStore.delete(key)\r\n      }\r\n    }\r\n  }\r\n\r\n  setWarpPosOnClick (mousePos: Vec3) {\r\n    this.lastWarpPos = new Vec3(mousePos.x, mousePos.y, mousePos.z)\r\n  }\r\n\r\n  drawWarps (centerPos?: Vec3) {\r\n    for (const warp of this.warps) {\r\n      if (!this.full) {\r\n        const distance = Math.hypot(\r\n          centerPos?.x ?? this.lastBotPos.x - warp.x,\r\n          centerPos?.z ?? this.lastBotPos.z - warp.z\r\n        )\r\n        if (distance > this.mapSize) continue\r\n      }\r\n      const offset = this.full ? 0 : this.radius * 0.1\r\n      const z = Math.floor(\r\n        (this.mapSize / 2 - (centerPos?.z ?? this.lastBotPos.z) + warp.z) * this.mapPixel\r\n      ) + offset\r\n      const x = Math.floor(\r\n        (this.mapSize / 2 - (centerPos?.x ?? this.lastBotPos.x) + warp.x) * this.mapPixel\r\n      ) + offset\r\n      const dz = z - this.canvasWidthCenterX\r\n      const dx = x - this.canvasWidthCenterY\r\n      const circleDist = Math.hypot(dx, dz)\r\n\r\n      const angle = Math.atan2(dz, dx)\r\n      const circleZ = circleDist > this.mapSize / 2 && !this.full ?\r\n        this.canvasWidthCenterX + this.mapSize / 2 * Math.sin(angle)\r\n        : z\r\n      const circleX = circleDist > this.mapSize / 2 && !this.full ?\r\n        this.canvasWidthCenterY + this.mapSize / 2 * Math.cos(angle)\r\n        : x\r\n      this.ctx.beginPath()\r\n      this.ctx.arc(\r\n        circleX,\r\n        circleZ,\r\n        circleDist > this.mapSize / 2 && !this.full\r\n          ? this.mapPixel * 1.5\r\n          : this.full ? this.mapPixel : this.mapPixel * 2,\r\n        0,\r\n        Math.PI * 2,\r\n        false\r\n      )\r\n      this.ctx.strokeStyle = 'black'\r\n      this.ctx.lineWidth = this.mapPixel\r\n      this.ctx.stroke()\r\n      this.ctx.fillStyle = warp.disabled ? 'rgba(255, 255, 255, 0.4)' : warp.color ?? '#d3d3d3'\r\n      this.ctx.fill()\r\n      this.ctx.closePath()\r\n    }\r\n  }\r\n\r\n  drawPartsOfWorld () {\r\n    this.ctx.fillStyle = 'white'\r\n    this.ctx.shadowOffsetX = 1\r\n    this.ctx.shadowOffsetY = 1\r\n    this.ctx.shadowColor = 'black'\r\n    this.ctx.font = `${this.radius / 4}px serif`\r\n    this.ctx.textAlign = 'center'\r\n    this.ctx.textBaseline = 'middle'\r\n    this.ctx.strokeStyle = 'black'\r\n    this.ctx.lineWidth = 1\r\n\r\n    const angle = - Math.PI / 2\r\n    const angleS = angle + Math.PI\r\n    const angleW = angle + Math.PI * 3 / 2\r\n    const angleE = angle + Math.PI / 2\r\n\r\n    this.ctx.strokeText(\r\n      'N',\r\n      this.canvasWidthCenterX + this.radius * Math.cos(angle),\r\n      this.canvasWidthCenterY + this.radius * Math.sin(angle)\r\n    )\r\n    this.ctx.strokeText(\r\n      'S',\r\n      this.canvasWidthCenterX + this.radius * Math.cos(angleS),\r\n      this.canvasWidthCenterY + this.radius * Math.sin(angleS)\r\n    )\r\n    this.ctx.strokeText(\r\n      'W',\r\n      this.canvasWidthCenterX + this.radius * Math.cos(angleW),\r\n      this.canvasWidthCenterY + this.radius * Math.sin(angleW)\r\n    )\r\n    this.ctx.strokeText(\r\n      'E',\r\n      this.canvasWidthCenterX + this.radius * Math.cos(angleE),\r\n      this.canvasWidthCenterY + this.radius * Math.sin(angleE)\r\n    )\r\n    this.ctx.fillText(\r\n      'N',\r\n      this.canvasWidthCenterX + this.radius * Math.cos(angle),\r\n      this.canvasWidthCenterY + this.radius * Math.sin(angle)\r\n    )\r\n    this.ctx.fillText(\r\n      'S',\r\n      this.canvasWidthCenterX + this.radius * Math.cos(angleS),\r\n      this.canvasWidthCenterY + this.radius * Math.sin(angleS)\r\n    )\r\n    this.ctx.fillText(\r\n      'W',\r\n      this.canvasWidthCenterX + this.radius * Math.cos(angleW),\r\n      this.canvasWidthCenterY + this.radius * Math.sin(angleW)\r\n    )\r\n    this.ctx.fillText(\r\n      'E',\r\n      this.canvasWidthCenterX + this.radius * Math.cos(angleE),\r\n      this.canvasWidthCenterY + this.radius * Math.sin(angleE)\r\n    )\r\n\r\n    this.ctx.shadowOffsetX = 0\r\n    this.ctx.shadowOffsetY = 0\r\n  }\r\n\r\n  drawPlayerPos (canvasWorldCenterX?: number, canvasWorldCenterZ?: number, disableTurn?: boolean) {\r\n    this.ctx.setTransform(1, 0, 0, 1, 0, 0)\r\n\r\n    const x = (this.lastBotPos.x - (canvasWorldCenterX ?? this.lastBotPos.x)) * this.mapPixel - (this.full ? 30 : 0)\r\n    const z = (this.lastBotPos.z - (canvasWorldCenterZ ?? this.lastBotPos.z)) * this.mapPixel - (this.full ? 30 : 0)\r\n    const center = this.mapSize / 2 * this.mapPixel + (this.full ? 0 : this.radius * 0.1)\r\n    this.ctx.translate(center + x, center + z)\r\n    if (!disableTurn) this.ctx.rotate(-this.yaw)\r\n\r\n    const size = 3\r\n    const factor = this.full ? 2 : 1\r\n    const width = size * factor\r\n    const height = size * factor\r\n\r\n    this.ctx.beginPath()\r\n    this.ctx.moveTo(0, -height)\r\n    this.ctx.lineTo(-width, height)\r\n    this.ctx.lineTo(width, height)\r\n    this.ctx.closePath()\r\n\r\n    this.ctx.strokeStyle = '#000000'\r\n    this.ctx.lineWidth = this.full ? 2 : 1\r\n    this.ctx.stroke()\r\n    this.ctx.fillStyle = '#FFFFFF'\r\n    this.ctx.fill()\r\n\r\n    // Reset transformations\r\n    this.ctx.setTransform(1, 0, 0, 1, 0, 0)\r\n  }\r\n\r\n  rotateMap (angle: number) {\r\n    this.ctx.setTransform(1, 0, 0, 1, 0, 0)\r\n    this.ctx.translate(this.canvasWidthCenterX, this.canvasWidthCenterY)\r\n    this.ctx.rotate(angle)\r\n    this.ctx.translate(-this.canvasWidthCenterX, -this.canvasWidthCenterY)\r\n  }\r\n}\r\n","import { useEffect } from 'react'\r\nimport { simplify } from 'prismarine-nbt'\r\nimport RegionFile from 'prismarine-provider-anvil/src/region'\r\nimport { Vec3 } from 'vec3'\r\nimport { versionToNumber } from 'renderer/viewer/prepare/utils'\r\nimport { WorldWarp } from 'flying-squid/dist/lib/modules/warps'\r\nimport { TypedEventEmitter } from 'contro-max/build/typedEventEmitter'\r\nimport { PCChunk } from 'prismarine-chunk'\r\nimport { Chunk } from 'prismarine-world/types/world'\r\nimport { Block } from 'prismarine-block'\r\nimport { INVISIBLE_BLOCKS } from 'renderer/viewer/lib/mesher/worldConstants'\r\nimport { getRenamedData } from 'flying-squid/dist/blockRenames'\r\nimport { useSnapshot } from 'valtio'\r\nimport BlockData from '../../renderer/viewer/lib/moreBlockDataGenerated.json'\r\nimport preflatMap from '../preflatMap.json'\r\nimport { contro } from '../controls'\r\nimport { gameAdditionalState, miscUiState } from '../globalState'\r\nimport { options } from '../optionsStorage'\r\nimport Minimap, { DisplayMode } from './Minimap'\r\nimport { ChunkInfo, DrawerAdapter, MapUpdates, MinimapDrawer } from './MinimapDrawer'\r\nimport { useIsModalActive } from './utilsApp'\r\nimport { lastConnectOptions } from './AppStatusProvider'\r\n\r\nconst findHeightMap = (obj: PCChunk): number[] | undefined => {\r\n  function search (obj: any): any | undefined {\r\n    for (const key in obj) {\r\n      if (['heightmap', 'heightmaps'].includes(key.toLowerCase())) {\r\n        return obj[key]\r\n      } else if (typeof obj[key] === 'object' && obj[key] !== null) {\r\n        const result = search(obj[key])\r\n        return result\r\n      }\r\n    }\r\n  }\r\n  return search(obj)\r\n}\r\n\r\nexport class DrawerAdapterImpl extends TypedEventEmitter<MapUpdates> implements DrawerAdapter {\r\n  playerPosition: Vec3\r\n  yaw: number\r\n  world: string\r\n  warps: WorldWarp[] = gameAdditionalState.warps\r\n  chunksStore = new Map<string, undefined | null | 'requested' | ChunkInfo >()\r\n  loadingChunksQueue = new Set<string>()\r\n  loadChunk: (key: string) => Promise<void> = this.loadChunkMinimap\r\n  mapDrawer = new MinimapDrawer(this.loadChunk, this.warps, this.loadingChunksQueue, this.chunksStore)\r\n  currChunk: PCChunk | undefined\r\n  currChunkPos: { x: number, z: number } = { x: 0, z: 0 }\r\n  isOldVersion: boolean\r\n  blockData: Map<string | string[], string>\r\n  heightMap: Record<string, number> = {}\r\n  regions = new Map<string, RegionFile>()\r\n  chunksHeightmaps: Record<string, any> = {}\r\n  loadChunkFullmap: (key: string) => Promise<ChunkInfo | null | undefined>\r\n  _full = false\r\n  isBuiltinHeightmapAvailable = false\r\n\r\n  constructor (pos?: Vec3) {\r\n    super()\r\n    this.playerPosition = pos ?? new Vec3(0, 0, 0)\r\n\r\n    // check if should use heightmap.\r\n    // As there is no simple way to check if heightmap is present in region file, making an attempt to load one\r\n    if (localServer) {\r\n      const chunkX = Math.floor(this.playerPosition.x / 16)\r\n      const chunkZ = Math.floor(this.playerPosition.z / 16)\r\n      const regionX = Math.floor(chunkX / 32)\r\n      const regionZ = Math.floor(chunkZ / 32)\r\n      const regionKey = `${regionX},${regionZ}`\r\n      const { worldFolder } = localServer.options\r\n      if (worldFolder) {\r\n        const path = `${worldFolder}/region/r.${regionX}.${regionZ}.mca`\r\n        const region = new RegionFile(path)\r\n        void region.initialize()\r\n        this.regions.set(regionKey, region)\r\n        const readX = chunkX % 32 < 0 ? 32 + chunkX % 32 : chunkX % 32\r\n        const readZ = chunkZ % 32 < 0 ? 32 + chunkZ % 32 : chunkZ % 32\r\n        console.log('heightmap check begun', readX, readZ)\r\n        void this.regions.get(regionKey)?.read(readX, readZ)?.then((rawChunk) => {\r\n          const chunk = simplify(rawChunk as any)\r\n          const heightmap = findHeightMap(chunk)\r\n          if (heightmap) {\r\n            this.isBuiltinHeightmapAvailable = true\r\n            this.loadChunkFullmap = this.loadChunkFromRegion\r\n            console.log('using heightmap')\r\n          } else {\r\n            this.isBuiltinHeightmapAvailable = false\r\n            this.loadChunkFullmap = this.loadChunkNoRegion\r\n            console.log('dont use heightmap')\r\n          }\r\n        })\r\n      } else {\r\n        this.isBuiltinHeightmapAvailable = false\r\n        this.loadChunkFullmap = this.loadChunkNoRegion\r\n        console.log('dont use heightmap')\r\n      }\r\n    } else {\r\n      this.isBuiltinHeightmapAvailable = false\r\n      this.loadChunkFullmap = this.loadChunkFromViewer\r\n    }\r\n    if (localServer) {\r\n      this.overwriteWarps(localServer.warps)\r\n    } else {\r\n      const storageWarps = localStorage.getItem(`warps: ${lastConnectOptions.value?.server ?? 'server'} ${lastConnectOptions.value?.username ?? 'username'}`)\r\n      this.overwriteWarps(JSON.parse(storageWarps ?? '[]'))\r\n    }\r\n    this.isOldVersion = versionToNumber(bot.version) < versionToNumber('1.13')\r\n    this.blockData = new Map<string, string>()\r\n    for (const blockKey of Object.keys(BlockData.colors)) {\r\n      const renamedKey = getRenamedData('blocks', blockKey, '1.20.2', bot.version)\r\n      this.blockData.set(renamedKey, BlockData.colors[blockKey])\r\n    }\r\n\r\n    viewer.world?.renderUpdateEmitter.on('chunkFinished', (key) => {\r\n      if (!this.loadingChunksQueue.has(key)) return\r\n      this.loadingChunksQueue.delete(key)\r\n      void this.loadChunk(key)\r\n    })\r\n  }\r\n\r\n  get full () {\r\n    return this._full\r\n  }\r\n\r\n  set full (full: boolean) {\r\n    if (!full) {\r\n      console.log('this is minimap')\r\n      this.loadChunk = this.loadChunkMinimap\r\n      this.mapDrawer.loadChunk = this.loadChunk\r\n    }\r\n    this._full = full\r\n  }\r\n\r\n  overwriteWarps (newWarps: WorldWarp[]) {\r\n    this.warps.splice(0, this.warps.length)\r\n    for (const warp of newWarps) {\r\n      this.warps.push({ ...warp })\r\n    }\r\n  }\r\n\r\n  setWarp (warp: WorldWarp, remove?: boolean): void {\r\n    this.world = bot.game.dimension\r\n    const index = this.warps.findIndex(w => w.name === warp.name)\r\n    if (!remove && index === -1) {\r\n      this.warps.push(warp)\r\n    } else if (remove && index !== -1) {\r\n      this.warps.splice(index, 1)\r\n    } else {\r\n      this.warps[index] = warp\r\n    }\r\n    if (localServer) {\r\n      // type suppressed until server is updated. It works fine\r\n      void (localServer as any).setWarp(warp, remove)\r\n    } else if (remove) {\r\n      localStorage.removeItem(`warps: ${bot.player.username} ${lastConnectOptions.value!.server}`)\r\n    } else {\r\n      localStorage.setItem(`warps: ${bot.player.username} ${lastConnectOptions.value!.server}`, JSON.stringify(this.warps))\r\n    }\r\n    this.emit('updateWarps')\r\n  }\r\n\r\n  getHighestBlockY (x: number, z: number, chunk?: Chunk) {\r\n    const chunkX = Math.floor(x / 16) * 16\r\n    const chunkZ = Math.floor(z / 16) * 16\r\n    if (this.chunksHeightmaps[`${chunkX},${chunkZ}`]) {\r\n      return this.chunksHeightmaps[`${chunkX},${chunkZ}`][x - chunkX + (z - chunkZ) * 16] - 1\r\n    }\r\n    const source = chunk ?? bot.world\r\n    const { height, minY } = (bot.game as any)\r\n    for (let i = height; i > 0; i -= 1) {\r\n      const block = source.getBlock(new Vec3(x & 15, minY + i, z & 15))\r\n      if (block && !INVISIBLE_BLOCKS.has(block.name)) {\r\n        return minY + i\r\n      }\r\n    }\r\n    return minY\r\n  }\r\n\r\n  async getChunkSingleplayer (chunkX: number, chunkZ: number) {\r\n    // absolute coords\r\n    const region = (localServer!.overworld.storageProvider as any).getRegion(chunkX * 16, chunkZ * 16)\r\n    if (!region) return 'unavailable'\r\n    const chunk = await localServer!.players[0]!.world.getColumn(chunkX, chunkZ)\r\n    return chunk\r\n  }\r\n\r\n  async loadChunkMinimap (key: string) {\r\n    const [chunkX, chunkZ] = key.split(',').map(Number)\r\n    const chunkWorldX = chunkX * 16\r\n    const chunkWorldZ = chunkZ * 16\r\n    if (viewer.world.finishedChunks[`${chunkWorldX},${chunkWorldZ}`]) {\r\n      const heightmap = new Uint8Array(256)\r\n      const colors = Array.from({ length: 256 }).fill('') as string[]\r\n      // avoid creating new object every time\r\n      const blockPos = new Vec3(0, 0, 0)\r\n      // filling up colors and heightmap\r\n      for (let z = 0; z < 16; z += 1) {\r\n        for (let x = 0; x < 16; x += 1) {\r\n          const blockX = chunkWorldX + x\r\n          const blockZ = chunkWorldZ + z\r\n          const hBlock = viewer.world.highestBlocks.get(`${blockX},${blockZ}`)\r\n          blockPos.x = blockX; blockPos.z = blockZ; blockPos.y = hBlock?.y ?? 0\r\n          let block = bot.world.getBlock(blockPos)\r\n          while (block?.name.includes('air')) {\r\n            blockPos.y -= 1\r\n            block = bot.world.getBlock(blockPos)\r\n          }\r\n          const index = z * 16 + x\r\n          // blocks which are not set are shown as half transparent\r\n          if (!block || !hBlock) {\r\n            heightmap[index] = 0\r\n            colors[index] = 'rgba(0, 0, 0, 0.5)'\r\n            continue\r\n          }\r\n          heightmap[index] = block.position.y\r\n          colors[index] = this.setColor(block)\r\n        }\r\n      }\r\n      const chunk = { heightmap, colors }\r\n      this.applyShadows(chunk)\r\n      this.chunksStore.set(key, chunk)\r\n      this.emit(`chunkReady`, `${chunkX},${chunkZ}`)\r\n    } else {\r\n      this.loadingChunksQueue.add(`${chunkX},${chunkZ}`)\r\n      this.chunksStore.set(key, 'requested')\r\n    }\r\n  }\r\n\r\n  async loadChunkNoRegion (key: string) {\r\n    const [chunkX, chunkZ] = key.split(',').map(Number)\r\n    const chunkWorldX = chunkX * 16\r\n    const chunkWorldZ = chunkZ * 16\r\n    const chunkInfo = await this.getChunkSingleplayer(chunkX, chunkZ)\r\n    if (chunkInfo === 'unavailable') return null\r\n    const heightmap = new Uint8Array(256)\r\n    const colors = Array.from({ length: 256 }).fill('') as string[]\r\n    for (let z = 0; z < 16; z += 1) {\r\n      for (let x = 0; x < 16; x += 1) {\r\n        const blockX = chunkWorldX + x\r\n        const blockZ = chunkWorldZ + z\r\n        const blockY = this.getHighestBlockY(blockX, blockZ, chunkInfo)\r\n        const blockPos = new Vec3(blockX & 15, blockY, blockZ & 15)\r\n        let block = chunkInfo.getBlock(blockPos)\r\n        while (block?.name.includes('air')) {\r\n          blockPos.y -= 1\r\n          block = chunkInfo.getBlock(blockPos)\r\n        }\r\n        if (!block) {\r\n          console.warn(`[cannot get the block] ${chunkX}, ${chunkZ}, ${chunkWorldX + x}, ${chunkWorldZ + z}`)\r\n          return null\r\n        }\r\n        const index = z * 16 + x\r\n        heightmap[index] = blockPos.y\r\n        colors[index] = this.setColor(block)\r\n      }\r\n    }\r\n    const chunk: ChunkInfo = { heightmap, colors }\r\n    this.applyShadows(chunk)\r\n    return chunk\r\n  }\r\n\r\n  async loadChunkFromRegion (key: string): Promise<ChunkInfo | null | undefined> {\r\n    const [chunkX, chunkZ] = key.split(',').map(Number)\r\n    const chunkWorldX = chunkX * 16\r\n    const chunkWorldZ = chunkZ * 16\r\n    const heightmap = await this.getChunkHeightMapFromRegion(chunkX, chunkZ) as unknown as Uint8Array\r\n    if (!heightmap) return null\r\n    const chunkInfo = await this.getChunkSingleplayer(chunkX, chunkZ)\r\n    if (chunkInfo === 'unavailable') return null\r\n    const colors = Array.from({ length: 256 }).fill('') as string[]\r\n    for (let z = 0; z < 16; z += 1) {\r\n      for (let x = 0; x < 16; x += 1) {\r\n        const blockX = chunkWorldX + x\r\n        const blockZ = chunkWorldZ + z\r\n        const index = z * 16 + x\r\n        heightmap[index] -= 1\r\n        if (heightmap[index] < 0) heightmap[index] = 0\r\n        const blockY = heightmap[index]\r\n        const blockPos = new Vec3(blockX & 15, blockY, blockZ & 15)\r\n        let block = chunkInfo.getBlock(blockPos)\r\n        while (block?.name.includes('air')) {\r\n          blockPos.y -= 1\r\n          block = chunkInfo.getBlock(blockPos)\r\n        }\r\n        if (!block) {\r\n          console.warn(`[cannot get the block] ${chunkX}, ${chunkZ}, ${chunkWorldX + x}, ${chunkWorldZ + z}`)\r\n          return null\r\n        }\r\n        colors[index] = this.setColor(block)\r\n      }\r\n    }\r\n    const chunk: ChunkInfo = { heightmap, colors }\r\n    this.applyShadows(chunk)\r\n    return chunk\r\n  }\r\n\r\n  async getChunkHeightMapFromRegion (chunkX: number, chunkZ: number, cb?: (hm: number[]) => void) {\r\n    const regionX = Math.floor(chunkX / 32)\r\n    const regionZ = Math.floor(chunkZ / 32)\r\n    const regionKey = `${regionX},${regionZ}`\r\n    if (!this.regions.has(regionKey)) {\r\n      const { worldFolder } = localServer!.options\r\n      const path = `${worldFolder}/region/r.${regionX}.${regionZ}.mca`\r\n      const region = new RegionFile(path)\r\n      await region.initialize()\r\n      this.regions.set(regionKey, region)\r\n    }\r\n    const rawChunk = await this.regions.get(regionKey)!.read(chunkX % 32, chunkZ % 32)\r\n    const chunk = simplify(rawChunk as any)\r\n    console.log(`chunk ${chunkX}, ${chunkZ}:`, chunk)\r\n    const heightmap = findHeightMap(chunk)\r\n    console.log(`heightmap ${chunkX}, ${chunkZ}:`, heightmap)\r\n    cb?.(heightmap!)\r\n    return heightmap\r\n    // this.chunksHeightmaps[`${chunkX},${chunkZ}`] = heightmap\r\n  }\r\n\r\n  async loadChunkFromViewer (key: string) {\r\n    const [chunkX, chunkZ] = key.split(',').map(Number)\r\n    const chunkWorldX = chunkX * 16\r\n    const chunkWorldZ = chunkZ * 16\r\n    if (viewer.world.finishedChunks[`${chunkWorldX},${chunkWorldZ}`]) {\r\n      const heightmap = new Uint8Array(256)\r\n      const colors = Array.from({ length: 256 }).fill('') as string[]\r\n      for (let z = 0; z < 16; z += 1) {\r\n        for (let x = 0; x < 16; x += 1) {\r\n          const blockX = chunkWorldX + x\r\n          const blockZ = chunkWorldZ + z\r\n          const hBlock = viewer.world.highestBlocks.get(`${blockX},${blockZ}`)\r\n          const block = bot.world.getBlock(new Vec3(blockX, hBlock?.y ?? 0, blockZ))\r\n          // const block = Block.fromStateId(hBlock?.stateId ?? -1, hBlock?.biomeId ?? -1)\r\n          const index = z * 16 + x\r\n          if (!block || !hBlock) {\r\n            console.warn(`[loadChunk] ${chunkX}, ${chunkZ}, ${chunkWorldX + x}, ${chunkWorldZ + z}`)\r\n            heightmap[index] = 0\r\n            colors[index] = 'rgba(0, 0, 0, 0.5)'\r\n            continue\r\n          }\r\n          heightmap[index] = hBlock.y\r\n          colors[index] = this.setColor(block)\r\n        }\r\n      }\r\n      const chunk = { heightmap, colors }\r\n      this.applyShadows(chunk)\r\n      return chunk\r\n    } else {\r\n      return null\r\n    }\r\n  }\r\n\r\n  applyShadows (chunk: ChunkInfo) {\r\n    for (let j = 0; j < 16; j += 1) {\r\n      for (let i = 0; i < 16; i += 1) {\r\n        const index = j * 16 + i\r\n        const color = chunk.colors[index]\r\n        // if (i === 0 || j === 0 || i === 15 || j === 16) {\r\n        //   const r = Math.floor(Math.random() * 2)\r\n        //   chunk.colors[index] = r===0 ? this.makeDarker(color) : this.makeLighter(color)\r\n        //   continue\r\n        // }\r\n\r\n        const h = chunk.heightmap[index]\r\n        let isLighterOrDarker = 0\r\n\r\n        const r = chunk.heightmap[index + 1] ?? 0\r\n        const u = chunk.heightmap[index - 16] ?? 0\r\n        const ur = chunk.heightmap[index - 15] ?? 0\r\n        if (r > h || u > h || ur > h) {\r\n          chunk.colors[index] = this.makeDarker(color)\r\n          isLighterOrDarker -= 1\r\n        }\r\n\r\n        const l = chunk.heightmap[index - 1] ?? 0\r\n        const d = chunk.heightmap[index + 16] ?? 0\r\n        const dl = chunk.heightmap[index + 15] ?? 0\r\n        if (l > h || d > h || dl > h) {\r\n          chunk.colors[index] = this.makeLighter(color)\r\n          isLighterOrDarker += 1\r\n        }\r\n\r\n        let linkedIndex: number | undefined\r\n        if (i === 1) {\r\n          linkedIndex = index - 1\r\n        } else if (i === 14) {\r\n          linkedIndex = index + 1\r\n        } else if (j === 1) {\r\n          linkedIndex = index - 16\r\n        } else if (j === 14) {\r\n          linkedIndex = index + 16\r\n        }\r\n        if (linkedIndex !== undefined) {\r\n          const linkedColor = chunk.colors[linkedIndex]\r\n          switch (isLighterOrDarker) {\r\n            case 1:\r\n              chunk.colors[linkedIndex] = this.makeLighter(linkedColor)\r\n              break\r\n            case -1:\r\n              chunk.colors[linkedIndex] = this.makeDarker(linkedColor)\r\n              break\r\n            default:\r\n              break\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  makeDarker (color: string) {\r\n    let rgbArray = color.match(/\\d+/g)?.map(Number) ?? []\r\n    if (rgbArray.length !== 3) return color\r\n    rgbArray = rgbArray.map(element => {\r\n      let newColor = element - 20\r\n      if (newColor < 0) newColor = 0\r\n      return newColor\r\n    })\r\n    return `rgb(${rgbArray.join(',')})`\r\n  }\r\n\r\n  makeLighter (color: string) {\r\n    let rgbArray = color.match(/\\d+/g)?.map(Number) ?? []\r\n    if (rgbArray.length !== 3) return color\r\n    rgbArray = rgbArray.map(element => {\r\n      let newColor = element + 20\r\n      if (newColor > 255) newColor = 255\r\n      return newColor\r\n    })\r\n    return `rgb(${rgbArray.join(',')})`\r\n  }\r\n\r\n  clearChunksStore (x: number, z: number) {\r\n    for (const key of Object.keys(this.chunksStore)) {\r\n      const [chunkX, chunkZ] = key.split(',').map(Number)\r\n      if (Math.hypot((chunkX - x), (chunkZ - z)) > 300) {\r\n        delete this.chunksStore[key]\r\n        delete this.chunksHeightmaps[key]\r\n        for (let i = 0; i < 16; i += 1) {\r\n          for (let j = 0; j < 16; j += 1) {\r\n            delete this.heightMap[`${chunkX + i},${chunkZ + j}`]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  setColor (block: Block) {\r\n    let color: string\r\n    if (this.isOldVersion) {\r\n      color = BlockData.colors[preflatMap.blocks[`${block.type}:${block.metadata}`]?.replaceAll(/\\[.*?]/g, '')]\r\n      ?? 'rgb(0, 0, 255)'\r\n    } else {\r\n      color = this.blockData.get(block.name) ?? 'rgb(0, 255, 0)'\r\n    }\r\n    if (color === 'rgb(0, 255, 0)' || color === 'rgb(0, 0, 255)') {\r\n      // this should never happen\r\n      // console.warn('[MinimapProvider] did not find block name,', block.name)\r\n      // hack to find close color. Problem with colors should be fixed differently in the future\r\n      const blockNamePieces = block.name.split('_')\r\n      const keys = [...this.blockData.keys()]\r\n      for (const piece of blockNamePieces) {\r\n        const match = keys.find(x => x.includes(piece))\r\n        if (match) {\r\n          color = this.blockData.get(match) ?? 'rgb(255, 0, 0)'\r\n          break\r\n        }\r\n      }\r\n    }\r\n\r\n    return color\r\n  }\r\n\r\n  quickTp (x: number, z: number) {\r\n    const y = this.getHighestBlockY(x, z)\r\n    bot.chat(`/tp ${x} ${y + 20} ${z}`)\r\n    const timeout = setTimeout(() => {\r\n      const y = this.getHighestBlockY(x, z)\r\n      bot.chat(`/tp ${x} ${y + 20} ${z}`)\r\n      clearTimeout(timeout)\r\n    }, 500)\r\n  }\r\n\r\n  async drawChunkOnCanvas (key: string, canvas: HTMLCanvasElement) {\r\n    const chunk = await this.loadChunkFullmap(key)\r\n    const [worldX, worldZ] = key.split(',').map(x => Number(x) * 16)\r\n    const center = new Vec3(worldX + 8, 0, worldZ + 8)\r\n    this.mapDrawer.lastBotPos = center\r\n    this.mapDrawer.canvas = canvas\r\n    this.mapDrawer.full = true\r\n    this.mapDrawer.drawChunk(key, chunk)\r\n    this.mapDrawer.drawWarps(center)\r\n    this.mapDrawer.lastBotPos = this.playerPosition\r\n    this.mapDrawer.yaw = this.yaw\r\n    this.mapDrawer.drawPlayerPos(worldX, worldZ)\r\n  }\r\n}\r\n\r\nconst Inner = (\r\n  { adapter, displayMode, toggleFullMap }:\r\n  {\r\n    adapter: DrawerAdapterImpl\r\n    displayMode?: DisplayMode,\r\n    toggleFullMap?: () => void\r\n  }\r\n) => {\r\n\r\n  const updateWarps = (newWarps: WorldWarp[] | Error) => {\r\n    if (newWarps instanceof Error) {\r\n      console.error('An error occurred:', newWarps.message)\r\n      return\r\n    }\r\n\r\n    adapter.overwriteWarps(newWarps)\r\n  }\r\n\r\n  const updateMap = () => {\r\n    if (!adapter || miscUiState.displayFullmap) return\r\n    adapter.playerPosition = bot.entity.position\r\n    adapter.yaw = bot.entity.yaw\r\n    adapter.emit('updateMap')\r\n  }\r\n\r\n  useEffect(() => {\r\n    bot.on('move', updateMap)\r\n    localServer?.on('warpsUpdated' as keyof ServerEvents, updateWarps)\r\n\r\n    return () => {\r\n      bot?.off('move', updateMap)\r\n      localServer?.off('warpsUpdated' as keyof ServerEvents, updateWarps)\r\n    }\r\n  }, [])\r\n\r\n  return <div>\r\n    <Minimap\r\n      adapter={adapter}\r\n      showMinimap={options.showMinimap}\r\n      showFullmap='always'\r\n      singleplayer={miscUiState.singleplayer}\r\n      fullMap={displayMode === 'fullmapOnly'}\r\n      toggleFullMap={toggleFullMap}\r\n      displayMode={displayMode}\r\n    />\r\n  </div>\r\n}\r\n\r\nexport default ({ adapter, displayMode }: { adapter: DrawerAdapterImpl, displayMode?: DisplayMode }) => {\r\n\r\n  const { showMinimap } = useSnapshot(options)\r\n  const fullMapOpened = useIsModalActive('full-map')\r\n\r\n  const toggleFullMap = () => {\r\n    void contro.emit('trigger', { command: 'ui.toggleMap', schema: null as any })\r\n  }\r\n\r\n  if (\r\n    displayMode === 'minimapOnly'\r\n      ? showMinimap === 'never' || (showMinimap === 'singleplayer' && !miscUiState.singleplayer)\r\n      : !fullMapOpened\r\n  ) {\r\n    return null\r\n  }\r\n\r\n  return <Inner adapter={adapter} displayMode={displayMode} toggleFullMap={toggleFullMap} />\r\n}\r\n","import { useEffect, useRef } from 'react'\r\nimport { f3Keybinds } from '../controls'\r\nimport { watchValue } from '../optionsStorage'\r\nimport { showModal, miscUiState, activeModalStack, hideCurrentModal } from '../globalState'\r\nimport { showOptionsModal } from './SelectOption'\r\nimport useLongPress from './useLongPress'\r\nimport styles from './MobileTopButtons.module.css'\r\n\r\n\r\nexport default () => {\r\n  const elRef = useRef<HTMLDivElement | null>(null)\r\n\r\n  const showMobileControls = (bl) => {\r\n    if (elRef.current) elRef.current.style.display = bl ? 'flex' : 'none'\r\n  }\r\n\r\n  useEffect(() => {\r\n    watchValue(miscUiState, o => {\r\n      showMobileControls(o.currentTouch)\r\n    })\r\n  }, [])\r\n\r\n  const onLongPress = async () => {\r\n    const select = await showOptionsModal('', f3Keybinds.filter(f3Keybind => f3Keybind.mobileTitle && (f3Keybind.enabled?.() ?? true)).map(f3Keybind => f3Keybind.mobileTitle))\r\n    if (!select) return\r\n    const f3Keybind = f3Keybinds.find(f3Keybind => f3Keybind.mobileTitle === select)\r\n    if (f3Keybind) f3Keybind.action()\r\n  }\r\n\r\n  const defaultOptions = {\r\n    shouldPreventDefault: true,\r\n    delay: 500,\r\n  }\r\n  const longPressEvent = useLongPress(onLongPress, () => {}, defaultOptions)\r\n\r\n\r\n  const onChatLongPress = () => {\r\n    document.dispatchEvent(new KeyboardEvent('keydown', { key: 'Tab' }))\r\n  }\r\n\r\n  const onChatClick = () => {\r\n    if (activeModalStack.at(-1)?.reactType === 'chat') {\r\n      hideCurrentModal()\r\n    } else {\r\n      showModal({ reactType: 'chat' })\r\n    }\r\n  }\r\n\r\n  const chatLongPressEvent = useLongPress(\r\n    onChatLongPress,\r\n    onChatClick,\r\n    {\r\n      shouldPreventDefault: true,\r\n      delay: 300,\r\n    }\r\n  )\r\n\r\n  // ios note: just don't use <button>\r\n  return <div ref={elRef} className={styles['mobile-top-btns']} id=\"mobile-top\">\r\n    <div\r\n      className={styles['debug-btn']} onPointerDown={(e) => {\r\n        window.dispatchEvent(new MouseEvent('mousedown', { button: 1 }))\r\n      }}\r\n    >S\r\n    </div>\r\n    <div\r\n      className={styles['debug-btn']} onPointerDown={(e) => {\r\n        document.dispatchEvent(new KeyboardEvent('keydown', { code: 'F3' }))\r\n        document.dispatchEvent(new KeyboardEvent('keyup', { code: 'F3' }))\r\n      }} {...longPressEvent}\r\n    >F3\r\n    </div>\r\n    <div\r\n      className={styles['chat-btn']}\r\n      {...chatLongPressEvent}\r\n      onPointerUp={(e) => {\r\n        document.dispatchEvent(new KeyboardEvent('keyup', { key: 'Tab' }))\r\n      }}\r\n    />\r\n    <div\r\n      className={styles['pause-btn']} onPointerDown={(e) => {\r\n        e.stopPropagation()\r\n        showModal({ reactType: 'pause-screen' })\r\n      }}\r\n    />\r\n  </div>\r\n}\r\n","import { useEffect, useRef, useState } from 'react'\r\nimport { WorldRendererThree } from 'renderer/viewer/lib/worldrendererThree'\r\nimport FullScreenWidget from './FullScreenWidget'\r\n\r\nexport const name = 'loaded world signs'\r\n\r\nexport default () => {\r\n  const [selected, setSelected] = useState([] as string[])\r\n  const allSignsPos = [] as string[]\r\n  const signs = viewer.world instanceof WorldRendererThree ? [...viewer.world.chunkTextures.values()].flatMap(textures => {\r\n    return Object.entries(textures).map(([signPosKey, texture]) => {\r\n      allSignsPos.push(signPosKey)\r\n      const pos = signPosKey.split(',').map(Number)\r\n      const isSelected = selected.includes(signPosKey)\r\n      return <div key={signPosKey}>\r\n        <div style={{ color: 'white', userSelect: 'text', fontSize: 8, }}>{pos.join(', ')}</div>\r\n        <div\r\n          style={{ background: isSelected ? 'rgba(255, 255, 255, 0.8)' : 'rgba(255, 255, 255, 0.5)', padding: 5, borderRadius: 5, cursor: 'pointer' }}\r\n          onClick={() => setSelected(selected.includes(signPosKey) ? selected.filter(x => x !== signPosKey) : [...selected, signPosKey])}>\r\n          <AddElem elem={texture.image} />\r\n        </div>\r\n      </div>\r\n    })\r\n  }) : []\r\n\r\n  return <FullScreenWidget name={name} title='Loaded Signs'>\r\n    <div>\r\n      {signs.length} signs currently in the scene:\r\n    </div>\r\n    <div\r\n      style={{ cursor: 'pointer', }} onClick={() => {\r\n        // toggle all\r\n        if (selected.length === allSignsPos.length) {\r\n          setSelected([])\r\n          return\r\n        }\r\n        setSelected([...allSignsPos])\r\n      }}>Select All</div>\r\n    {selected.length && <div\r\n      style={{ cursor: 'pointer', }} onClick={() => {\r\n        void navigator.clipboard.writeText(selected.join('\\n'))\r\n      }}>Copy Selected Signs</div>}\r\n    {signs}\r\n  </FullScreenWidget>\r\n}\r\n\r\nconst AddElem = ({ elem }) => {\r\n  const ref = useRef<HTMLDivElement>(null)\r\n  useEffect(() => {\r\n    elem.style.width = '100%'\r\n    elem.style.height = '100%'\r\n    ref.current!.appendChild(elem)\r\n    return () => {\r\n      elem.remove()\r\n    }\r\n  }, [])\r\n\r\n  return <div\r\n    ref={ref} style={{\r\n      height: '35px',\r\n    }} />\r\n}\r\n\r\n// for (const key of Object.keys(viewer.world.sectionObjects)) {\r\n//   const section = viewer.world.sectionObjects[key]\r\n//   for (const child of section.children) {\r\n//     if (child.name === 'mesh') child.visible = false\r\n//   }\r\n// }\r\n","import { useEffect, useMemo, useState, useRef } from 'react'\r\nimport { parseServerAddress } from '../parseServerAddress'\r\nimport { lastConnectOptions } from './AppStatusProvider'\r\nimport PixelartIcon, { pixelartIcons } from './PixelartIcon'\r\nimport styles from './NetworkStatus.module.css'\r\n\r\nexport default () => {\r\n  const [proxyPing, setProxyPing] = useState<number | null>(null)\r\n  const [serverPing, setServerPing] = useState<number | null>(null)\r\n  const [isProxyStale, setIsProxyStale] = useState(false)\r\n  const [isServerStale, setIsServerStale] = useState(false)\r\n\r\n  const proxyTimeoutRef = useRef<NodeJS.Timeout>()\r\n  const serverTimeoutRef = useRef<NodeJS.Timeout>()\r\n\r\n  const isWebSocket = useMemo(() => parseServerAddress(lastConnectOptions.value?.server).isWebSocket, [lastConnectOptions.value?.server])\r\n  const serverIp = useMemo(() => lastConnectOptions.value?.server, [])\r\n\r\n  const setProxyPingWithTimeout = (ping: number | null) => {\r\n    setProxyPing(ping)\r\n    setIsProxyStale(false)\r\n    if (proxyTimeoutRef.current) clearTimeout(proxyTimeoutRef.current)\r\n    proxyTimeoutRef.current = setTimeout(() => setIsProxyStale(true), 1000)\r\n  }\r\n\r\n  const setServerPingWithTimeout = (ping: number | null) => {\r\n    setServerPing(ping)\r\n    setIsServerStale(false)\r\n    if (serverTimeoutRef.current) clearTimeout(serverTimeoutRef.current)\r\n    serverTimeoutRef.current = setTimeout(() => setIsServerStale(true), 1000)\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (!serverIp) return\r\n\r\n    const updatePing = async () => {\r\n      const updateServerPing = async () => {\r\n        const ping = await bot.pingServer()\r\n        if (ping) {\r\n          setServerPingWithTimeout(ping)\r\n        }\r\n      }\r\n\r\n      const updateProxyPing = async () => {\r\n        if (!isWebSocket) {\r\n          const ping = await bot.pingProxy()\r\n          setProxyPingWithTimeout(ping)\r\n        }\r\n      }\r\n\r\n      try {\r\n        await Promise.all([updateServerPing(), updateProxyPing()])\r\n      } catch (err) {\r\n        console.error('Failed to ping:', err)\r\n      }\r\n    }\r\n\r\n    void updatePing()\r\n    const interval = setInterval(updatePing, 1000)\r\n    return () => {\r\n      clearInterval(interval)\r\n      if (proxyTimeoutRef.current) clearTimeout(proxyTimeoutRef.current)\r\n      if (serverTimeoutRef.current) clearTimeout(serverTimeoutRef.current)\r\n    }\r\n  }, [])\r\n\r\n  if (!serverIp) return null\r\n\r\n  const { username } = bot.player\r\n  const { proxy: proxyUrl } = lastConnectOptions.value!\r\n  const pingTotal = serverPing\r\n\r\n  const ICON_SIZE = 18\r\n\r\n  return (\r\n    <div className={`${styles.container} ${isWebSocket ? styles.websocket : ''}`}>\r\n      <PixelartIcon className={styles.iconRow} iconName={pixelartIcons.user} width={ICON_SIZE} />\r\n      {!isWebSocket && (\r\n        <>\r\n          <PixelartIcon className={`${styles.iconRow} ${styles.arrowRow}`} iconName={pixelartIcons['arrow-right']} width={16} />\r\n          <PixelartIcon className={styles.iconRow} iconName={pixelartIcons.server} width={ICON_SIZE} />\r\n        </>\r\n      )}\r\n      <PixelartIcon className={`${styles.iconRow} ${styles.arrowRow}`} iconName={pixelartIcons['arrow-right']} width={16} />\r\n      <PixelartIcon className={styles.iconRow} iconName={pixelartIcons['list-box']} width={ICON_SIZE} />\r\n\r\n      <span className={styles.dataRow}>{username}</span>\r\n      {!isWebSocket && (\r\n        <>\r\n          <span className={`${styles.dataRow} ${styles.ping} ${isProxyStale ? styles.stale : ''}`}>{proxyPing}ms</span>\r\n          <span className={styles.dataRow}>{proxyUrl}</span>\r\n        </>\r\n      )}\r\n      <span className={`${styles.dataRow} ${styles.ping} ${isServerStale ? styles.stale : ''}`}>\r\n        {isWebSocket ? (pingTotal || '?') : (pingTotal ? pingTotal - (proxyPing ?? 0) : '...')}ms\r\n      </span>\r\n      <span className={styles.dataRow}>{serverIp}</span>\r\n\r\n      <span className={styles.totalRow}>Ping: {pingTotal || '?'}ms</span>\r\n    </div>\r\n  )\r\n}\r\n","import { proxy, subscribe, useSnapshot } from 'valtio'\r\nimport { activeModalStack, hideCurrentModal } from '../globalState'\r\nimport Screen from './Screen'\r\nimport Button from './Button'\r\nimport { hardcodedKnownModals, watchedModalsFromHooks } from './utilsApp'\r\n\r\nconst componentActive = proxy({\r\n  enabled: false\r\n})\r\n\r\nconst checkModalAvailability = () => {\r\n  const last = activeModalStack.at(-1)\r\n  let withWildCardModal = false\r\n  for (const modal of watchedModalsFromHooks.value) {\r\n    if (modal.endsWith('*') && last?.reactType.startsWith(modal.slice(0, -1))) {\r\n      withWildCardModal = true\r\n      break\r\n    }\r\n  }\r\n\r\n  componentActive.enabled = !!last && !hardcodedKnownModals.some(x => last.reactType.startsWith(x)) && !watchedModalsFromHooks.value.has(last.reactType) && !withWildCardModal\r\n}\r\n\r\nsubscribe(activeModalStack, () => {\r\n  checkModalAvailability()\r\n})\r\nsubscribe(watchedModalsFromHooks, () => {\r\n  checkModalAvailability()\r\n})\r\n\r\nexport default () => {\r\n  const { enabled } = useSnapshot(componentActive)\r\n  const lastModal = useSnapshot(activeModalStack).at(-1)?.reactType\r\n\r\n  if (!enabled) return null\r\n  return <Screen\r\n    title={`Error: Modal (route) ${lastModal} is is unavailable or doesn't exist`}\r\n    style={{\r\n      zIndex: -1,\r\n    }}\r\n    backdrop={false}\r\n  >\r\n    <Button\r\n      style={{ marginTop: 30 }} onClick={() => {\r\n        hideCurrentModal()\r\n      }}\r\n    >Back\r\n    </Button>\r\n  </Screen>\r\n}\r\n","import { Transition } from 'react-transition-group'\r\nimport PixelartIcon from './PixelartIcon'\r\n\r\n// slide up\r\nconst startStyle = { opacity: 0, transform: 'translateY(100%)' }\r\nconst endExitStyle = { opacity: 0, transform: 'translateY(-100%)' }\r\nconst endStyle = { opacity: 1, transform: 'translateY(0)' }\r\n\r\nconst stateStyles = {\r\n  entering: startStyle,\r\n  entered: endStyle,\r\n  exiting: endExitStyle,\r\n  exited: endExitStyle,\r\n}\r\nconst duration = 200\r\nconst basicStyle = {\r\n  transition: `${duration}ms ease-in-out all`,\r\n}\r\n\r\n// save pass: login\r\n\r\nexport default ({ type = 'message', message, subMessage = '', open, icon = '', action = undefined as (() => void) | undefined }) => {\r\n  const isError = type === 'error'\r\n  icon ||= isError ? 'alert' : 'message'\r\n\r\n  return <Transition\r\n    in={open}\r\n    timeout={duration}\r\n    mountOnEnter\r\n    unmountOnExit\r\n  >\r\n    {state => {\r\n      const addStyles = { ...basicStyle, ...stateStyles[state] }\r\n\r\n      return <div\r\n        className={`app-notification ${isError ? 'error-notification' : ''}`} onClick={action} style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          right: 0,\r\n          width: '180px',\r\n          whiteSpace: 'nowrap',\r\n          fontSize: '9px',\r\n          display: 'flex',\r\n          gap: 4,\r\n          alignItems: 'center',\r\n          padding: '3px 5px',\r\n          background: isError ? 'rgba(255, 0, 0, 0.7)' : 'rgba(0, 0, 0, 0.7)',\r\n          borderRadius: '0 0 0 5px',\r\n          pointerEvents: action ? '' : 'none',\r\n          zIndex: 1200, // even above stats\r\n          ...addStyles\r\n        }}\r\n      >\r\n        <PixelartIcon iconName={icon} styles={{ fontSize: 12 }} />\r\n        <div style={{\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n          gap: 2,\r\n        }}\r\n        >\r\n          <div style={{\r\n            whiteSpace: 'normal',\r\n          }}>\r\n            {message}\r\n          </div>\r\n          <div style={{\r\n            fontSize: '7px',\r\n            whiteSpace: 'nowrap',\r\n            color: 'lightgray',\r\n          }}\r\n          >{subMessage}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    }}\r\n  </Transition>\r\n\r\n}\r\n","import React, { useEffect } from 'react'\r\nimport { proxy, useSnapshot } from 'valtio'\r\nimport { useAppScale } from '../scaleInterface'\r\nimport Notification from './Notification'\r\n\r\ntype NotificationType = React.ComponentProps<typeof Notification> & {\r\n  autoHide: boolean\r\n  id: string\r\n}\r\n\r\n// todo stacking\r\nexport const notificationProxy = proxy({\r\n  message: '',\r\n  open: false,\r\n  type: 'message',\r\n  subMessage: '',\r\n  icon: '',\r\n  autoHide: true,\r\n  id: '',\r\n} satisfies NotificationType as NotificationType)\r\n\r\nexport const showNotification = (\r\n  message: string,\r\n  subMessage = '',\r\n  isError = false,\r\n  icon = '',\r\n  action = undefined as (() => void) | undefined,\r\n  autoHide = true\r\n) => {\r\n  notificationProxy.message = message\r\n  notificationProxy.subMessage = subMessage\r\n  notificationProxy.type = isError ? 'error' : 'message'\r\n  notificationProxy.icon = icon\r\n  notificationProxy.open = true\r\n  notificationProxy.autoHide = autoHide\r\n  notificationProxy.action = action\r\n}\r\nglobalThis.showNotification = showNotification\r\nexport const hideNotification = () => {\r\n  // openNotification('') // reset\r\n  notificationProxy.open = false\r\n}\r\n\r\nexport default () => {\r\n  const { autoHide, message, open, icon, type, subMessage, action } = useSnapshot(notificationProxy)\r\n\r\n  useEffect(() => {\r\n    if (autoHide && open) {\r\n      setTimeout(() => {\r\n        hideNotification()\r\n      }, 7000)\r\n    }\r\n  }, [autoHide, open])\r\n\r\n  // test\r\n  // useEffect(() => {\r\n  //   setTimeout(() => {\r\n  //     openNotification('test', 'test', false, 'message')\r\n  //   }, 1000)\r\n  // }, [])\r\n  const scale = useAppScale()\r\n\r\n  return <div\r\n    className='notification-container'\r\n    style={{\r\n      // transform: `scale(${scale})`,\r\n      // transformOrigin: 'top right',\r\n    }}\r\n  >\r\n    <Notification\r\n      action={action}\r\n      type={type}\r\n      message={message}\r\n      subMessage={subMessage}\r\n      open={open}\r\n      icon={icon}\r\n    />\r\n  </div>\r\n}\r\n","import { titleCase } from 'title-case'\r\nimport { options } from '../optionsStorage'\r\nimport { OptionsGroupType, guiOptionsScheme } from '../optionsGuiScheme'\r\nimport OptionsItems, { OptionMeta } from './OptionsItems'\r\n\r\nexport const optionValueToType = (optionValue: any, item: OptionMeta) => {\r\n  if (typeof optionValue === 'boolean' || item.values) return 'toggle'\r\n  if (typeof optionValue === 'number') return 'slider'\r\n  if (typeof optionValue === 'string') return 'element'\r\n}\r\n\r\nconst finalItemsScheme: Record<keyof typeof guiOptionsScheme, OptionMeta[]> = Object.fromEntries(Object.entries(guiOptionsScheme).map(([groupName, optionsArr]) => {\r\n  return [groupName, optionsArr.flatMap((optionsObj) => {\r\n    return Object.entries(optionsObj).map(([optionKey, metaMerge]) => {\r\n      const optionValue = options[optionKey]\r\n\r\n      const type = optionValueToType(optionValue, metaMerge)\r\n      const meta: OptionMeta = {\r\n        id: optionKey === 'custom' ? undefined : optionKey,\r\n        type,\r\n        // todo I don't like the whole idea of custom. Why it is even here?\r\n        ...optionKey === 'custom' ? {\r\n          type: 'element',\r\n          render: metaMerge\r\n        } : {\r\n          ...metaMerge,\r\n        }\r\n      }\r\n      return meta\r\n    })\r\n  })]\r\n}))\r\n\r\nexport default ({ group, backButtonAction }: { group: OptionsGroupType, backButtonAction? }) => {\r\n  const items = finalItemsScheme[group]\r\n\r\n  const title = group === 'main' ? 'Settings' : `${titleCase(group)} Settings`\r\n  return <OptionsItems items={items} title={title} backButtonAction={backButtonAction} />\r\n}\r\n","import { useSnapshot } from 'valtio'\r\nimport { noCase } from 'change-case'\r\nimport { titleCase } from 'title-case'\r\nimport { useMemo } from 'react'\r\nimport { disabledSettings, options, qsOptions } from '../optionsStorage'\r\nimport { hideAllModals, miscUiState } from '../globalState'\r\nimport Button from './Button'\r\nimport Slider from './Slider'\r\nimport Screen from './Screen'\r\nimport { showOptionsModal } from './SelectOption'\r\nimport PixelartIcon, { pixelartIcons } from './PixelartIcon'\r\n\r\ntype GeneralItem<T extends string | number | boolean> = {\r\n  id?: string\r\n  text?: string,\r\n  disabledReason?: string,\r\n  disabledDuringGame?: boolean\r\n  tooltip?: string\r\n  // description?: string\r\n  enableWarning?: string\r\n  willHaveNoEffect?: boolean\r\n  values?: Array<T | [T, string]>\r\n  disableIf?: [option: keyof typeof options, value: any]\r\n}\r\n\r\nexport type OptionMeta<T = any> = GeneralItem<T & string> & ({\r\n  type: 'toggle',\r\n} | {\r\n  type: 'slider'\r\n  min?: number,\r\n  max?: number,\r\n  valueText?: (value: number) => string,\r\n  unit?: string,\r\n  delayApply?: boolean,\r\n} | {\r\n  type: 'element'\r\n  render: () => React.ReactNode,\r\n})\r\n\r\n// todo not reactive\r\nconst isLocked = (item: GeneralItem<any>) => {\r\n  return disabledSettings.value.has(item.id!)\r\n}\r\n\r\nconst useCommonComponentsProps = (item: OptionMeta) => {\r\n  let disabledBecauseOfSetting = false\r\n\r\n  if (item.disableIf) {\r\n    // okay to use hook conditionally as disableIf must be a constant\r\n    const disableIfSetting = useSnapshot(options)[item.disableIf[0]]\r\n    disabledBecauseOfSetting = disableIfSetting === item.disableIf[1]\r\n  }\r\n\r\n  return {\r\n    disabledBecauseOfSetting\r\n  }\r\n}\r\n\r\nexport const OptionButton = ({ item }: { item: Extract<OptionMeta, { type: 'toggle' }> }) => {\r\n  const { disabledBecauseOfSetting } = useCommonComponentsProps(item)\r\n\r\n  const optionValue = useSnapshot(options)[item.id!]\r\n\r\n  const valuesTitlesMap = useMemo(() => {\r\n    if (!item.values) {\r\n      return {\r\n        // true: <span style={{ color: 'lime' }}>ON</span>,\r\n        // false: <span style={{ color: 'red' }}>OFF</span>,\r\n        true: 'ON',\r\n        false: 'OFF',\r\n      }\r\n    }\r\n    return Object.fromEntries(item.values.map((value) => {\r\n      if (typeof value === 'string') {\r\n        return [value, titleCase(noCase(value))]\r\n      } else {\r\n        return [value[0], value[1]]\r\n      }\r\n    }))\r\n  }, [item.values])\r\n\r\n  let { disabledReason } = item\r\n  if (disabledBecauseOfSetting) disabledReason = `Disabled because ${item.disableIf![0]} is ${item.disableIf![1]}`\r\n\r\n  return <Button\r\n    data-setting={item.id}\r\n    label={`${item.text}: ${valuesTitlesMap[optionValue]}`}\r\n    // label={`${item.text}:`}\r\n    // postLabel={valuesTitlesMap[optionValue]}\r\n    onClick={async (event) => {\r\n      if (disabledReason) {\r\n        await showOptionsModal(`The option is unavailable. ${disabledReason}`, [])\r\n        return\r\n      }\r\n      if (item.enableWarning && !options[item.id!]) {\r\n        const result = await showOptionsModal(item.enableWarning, ['Enable'])\r\n        if (!result) return\r\n      }\r\n      const { values } = item\r\n      if (values) {\r\n        const getOptionValue = (arrItem) => {\r\n          if (typeof arrItem === 'string') {\r\n            return arrItem\r\n          } else {\r\n            return arrItem[0]\r\n          }\r\n        }\r\n        const currentIndex = values.findIndex((value) => {\r\n          return getOptionValue(value) === optionValue\r\n        })\r\n        if (currentIndex === -1) {\r\n          options[item.id!] = getOptionValue(values[0])\r\n        } else {\r\n          const nextIndex = event.shiftKey\r\n            ? (currentIndex - 1 + values.length) % values.length\r\n            : (currentIndex + 1) % values.length\r\n          options[item.id!] = getOptionValue(values[nextIndex])\r\n        }\r\n      } else {\r\n        options[item.id!] = !options[item.id!]\r\n      }\r\n    }}\r\n    title={disabledReason ? `${disabledReason} | ${item.tooltip}` : item.tooltip}\r\n    disabled={disabledBecauseOfSetting || !!item.disabledReason || isLocked(item)}\r\n    style={{\r\n      width: 150,\r\n    }}\r\n  />\r\n}\r\n\r\nexport const OptionSlider = ({ item }: { item: Extract<OptionMeta, { type: 'slider' }> }) => {\r\n  const { disabledBecauseOfSetting } = useCommonComponentsProps(item)\r\n\r\n  const optionValue = useSnapshot(options)[item.id!]\r\n\r\n  const valueDisplay = useMemo(() => {\r\n    if (item.valueText) return item.valueText(optionValue)\r\n    return undefined // default display\r\n  }, [optionValue])\r\n\r\n  return (\r\n    <Slider\r\n      label={item.text!}\r\n      value={options[item.id!]}\r\n      data-setting={item.id}\r\n      disabledReason={isLocked(item) ? 'qs' : disabledBecauseOfSetting ? `Disabled because ${item.disableIf![0]} is ${item.disableIf![1]}` : item.disabledReason}\r\n      min={item.min}\r\n      max={item.max}\r\n      unit={item.unit}\r\n      valueDisplay={valueDisplay}\r\n      updateOnDragEnd={item.delayApply}\r\n      updateValue={(value) => {\r\n        options[item.id!] = value\r\n      }}\r\n    />\r\n  )\r\n}\r\n\r\nconst OptionElement = ({ item }: { item: Extract<OptionMeta, { type: 'element' }> }) => {\r\n  return item.render()\r\n}\r\n\r\nconst RenderOption = ({ item }: { item: OptionMeta }) => {\r\n  const { gameLoaded } = useSnapshot(miscUiState)\r\n  if (item.id) {\r\n    item.text ??= titleCase(noCase(item.id))\r\n  }\r\n  if (item.disabledDuringGame && gameLoaded) {\r\n    item.disabledReason = 'Cannot be changed during game'\r\n  }\r\n\r\n  let baseElement = null as React.ReactNode | null\r\n  if (item.type === 'toggle') baseElement = <OptionButton item={item} />\r\n  if (item.type === 'slider') baseElement = <OptionSlider item={item} />\r\n  if (item.type === 'element') baseElement = <OptionElement item={item} />\r\n  return baseElement\r\n  // if (!item.description && item.type === 'element') return baseElement\r\n\r\n  // return <div>\r\n  //   {baseElement}\r\n  //   {item.description && <div style={{ fontSize: 9, color: 'gray' }}>{item.description}</div>}\r\n  // </div>\r\n}\r\n\r\ninterface Props {\r\n  readonly items: OptionMeta[]\r\n  title: string\r\n  backButtonAction?: () => void\r\n}\r\n\r\nexport default ({ items, title, backButtonAction }: Props) => {\r\n  const { currentTouch } = useSnapshot(miscUiState)\r\n\r\n  return <Screen\r\n    title={title}\r\n  >\r\n    <div className='screen-items'>\r\n      {currentTouch && (\r\n        <div style={{ position: 'fixed', marginLeft: '-30px', display: 'flex', flexDirection: 'column', gap: 1, }}>\r\n          <Button icon={pixelartIcons['close']} onClick={hideAllModals} style={{ color: '#ff5d5d', }} />\r\n          <Button icon={pixelartIcons['chevron-left']} onClick={backButtonAction} style={{ color: 'yellow', }} />\r\n        </div>\r\n      )}\r\n      {items.map((element, i) => {\r\n        // make sure its unique!\r\n        return <RenderOption key={element.id ?? `${title}-${i}`} item={element} />\r\n      })}\r\n    </div>\r\n    {backButtonAction && <Button onClick={() => backButtonAction()}>Back</Button>}\r\n  </Screen>\r\n}\r\n","import { useSnapshot } from 'valtio'\r\nimport { activeModalStack, hideCurrentModal } from '../globalState'\r\nimport { OptionsGroupType } from '../optionsGuiScheme'\r\nimport OptionsGroup from './OptionsGroup'\r\nimport { useIsModalActive } from './utilsApp'\r\n\r\nexport default () => {\r\n  useIsModalActive('options-*')\r\n  const { reactType } = useSnapshot(activeModalStack).at(-1) ?? {}\r\n  if (!reactType?.startsWith('options-')) return\r\n  const settingsGroup = reactType.slice('options-'.length) as OptionsGroupType\r\n\r\n  return <OptionsGroup group={settingsGroup} backButtonAction={hideCurrentModal} />\r\n}\r\n","import { useSnapshot } from 'valtio'\r\nimport { useMemo } from 'react'\r\nimport { appQueryParams, updateQsParam } from '../appParams'\r\nimport { miscUiState } from '../globalState'\r\nimport { onChangeButtonState, packetsReplayState } from './state/packetsReplayState'\r\nimport ReplayPanel from './ReplayPanel'\r\n\r\nexport default function PacketsReplayProvider () {\r\n  const state = useSnapshot(packetsReplayState)\r\n  const { gameLoaded } = useSnapshot(miscUiState)\r\n\r\n  const autocomplete = useMemo(() => {\r\n    if (!loadedData) return\r\n    return {\r\n      client: Object.keys(loadedData.protocol.play.toClient.types).filter(a => a.startsWith('packet_')).map(a => a.slice('packet_'.length)),\r\n      server: Object.keys(loadedData.protocol.play.toServer.types).filter(a => a.startsWith('packet_')).map(a => a.slice('packet_'.length))\r\n    }\r\n  }, [gameLoaded])\r\n\r\n  if (!state.isOpen) return null\r\n\r\n  return (\r\n    <ReplayPanel\r\n      style={{\r\n        transform: 'scale(0.4)',\r\n        transformOrigin: 'top right'\r\n      }}\r\n      replayName={state.replayName}\r\n      packets={state.packetsPlayback}\r\n      isPlaying={state.isPlaying}\r\n      progress={state.progress}\r\n      speed={state.speed}\r\n      defaultFilter={appQueryParams.replayFilter ?? ''}\r\n      clientPacketsAutocomplete={autocomplete?.client ?? []}\r\n      serverPacketsAutocomplete={autocomplete?.server ?? []}\r\n      customButtons={state.customButtons}\r\n      onPlayPause={(isPlaying) => {\r\n        packetsReplayState.isPlaying = isPlaying\r\n      }}\r\n      onRestart={() => {\r\n        window.location.reload()\r\n      }}\r\n      onSpeedChange={(speed) => {\r\n        packetsReplayState.speed = speed\r\n        updateQsParam('replaySpeed', speed === 1 ? undefined : speed.toString())\r\n      }}\r\n      onFilterChange={(filter) => {\r\n        updateQsParam('replayFilter', filter)\r\n      }}\r\n      onCustomButtonToggle={(button) => {\r\n        onChangeButtonState(button as keyof typeof packetsReplayState.customButtons, !state.customButtons[button].state)\r\n      }}\r\n    />\r\n  )\r\n}\r\n","import { useSnapshot } from 'valtio'\r\nimport { openURL } from 'renderer/viewer/lib/simpleUtils'\r\nimport { ErrorBoundary } from '@zardoy/react-util'\r\nimport { miscUiState } from '../globalState'\r\nimport { openGithub } from '../utils'\r\nimport Button from './Button'\r\nimport { DiscordButton } from './DiscordButton'\r\nimport styles from './PauseScreen.module.css'\r\n\r\nfunction PauseLinkButtonsInner () {\r\n  const { appConfig } = useSnapshot(miscUiState)\r\n  const pauseLinksConfig = appConfig?.pauseLinks\r\n\r\n  if (!pauseLinksConfig) return null\r\n\r\n  const renderButton = (button: Record<string, any>, style: React.CSSProperties, key: number) => {\r\n    if (button.type === 'discord') {\r\n      return <DiscordButton key={key} style={style} text={button.text}/>\r\n    }\r\n    if (button.type === 'github') {\r\n      return <Button key={key} className=\"button\" style={style} onClick={() => openGithub()}>{button.text ?? 'GitHub'}</Button>\r\n    }\r\n    if (button.type === 'url' && button.text) {\r\n      return <Button key={key} className=\"button\" style={style} onClick={() => openURL(button.url)}>{button.text}</Button>\r\n    }\r\n    return null\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {pauseLinksConfig.map((row, i) => {\r\n        const style = { width: (204 / row.length - (row.length > 1 ? 4 : 0)) + 'px' }\r\n        return (\r\n          <div key={i} className={styles.row}>\r\n            {row.map((button, k) => renderButton(button, style, k))}\r\n          </div>\r\n        )\r\n      })}\r\n    </>\r\n  )\r\n}\r\n\r\nexport default () => {\r\n  return <ErrorBoundary renderError={(error) => {\r\n    console.error(error)\r\n    return null\r\n  }}>\r\n    <PauseLinkButtonsInner />\r\n  </ErrorBoundary>\r\n}\r\n","import { join } from 'path'\r\nimport fs from 'fs'\r\nimport { useEffect } from 'react'\r\nimport { subscribe, useSnapshot } from 'valtio'\r\nimport { usedServerPathsV1 } from 'flying-squid/dist/lib/modules/world'\r\nimport { openURL } from 'renderer/viewer/lib/simpleUtils'\r\nimport { Vec3 } from 'vec3'\r\nimport { generateSpiralMatrix } from 'flying-squid/dist/utils'\r\nimport { subscribeKey } from 'valtio/utils'\r\nimport { ErrorBoundary } from '@zardoy/react-util'\r\nimport {\r\n  activeModalStack,\r\n  showModal,\r\n  hideModal,\r\n  miscUiState,\r\n  openOptionsMenu,\r\n  gameAdditionalState\r\n} from '../globalState'\r\nimport { fsState } from '../loadSave'\r\nimport { disconnect } from '../flyingSquidUtils'\r\nimport { openGithub, pointerLock } from '../utils'\r\nimport { setLoadingScreenStatus } from '../appStatus'\r\nimport { closeWan, openToWanAndCopyJoinLink, getJoinLink } from '../localServerMultiplayer'\r\nimport { collectFilesToCopy, fileExistsAsyncOptimized, mkdirRecursive, uniqueFileNameFromWorldName } from '../browserfs'\r\nimport { appQueryParams } from '../appParams'\r\nimport { downloadPacketsReplay, packetsRecordingState } from '../packetsReplay/packetsReplayLegacy'\r\nimport { options } from '../optionsStorage'\r\nimport { useIsModalActive } from './utilsApp'\r\nimport { showOptionsModal } from './SelectOption'\r\nimport Button from './Button'\r\nimport Screen from './Screen'\r\nimport styles from './PauseScreen.module.css'\r\nimport { DiscordButton } from './DiscordButton'\r\nimport { showNotification } from './NotificationProvider'\r\nimport { appStatusState, reconnectReload } from './AppStatusProvider'\r\nimport NetworkStatus from './NetworkStatus'\r\nimport PauseLinkButtons from './PauseLinkButtons'\r\nimport { pixelartIcons } from './PixelartIcon'\r\n\r\nconst waitForPotentialRender = async () => {\r\n  return new Promise<void>(resolve => {\r\n    requestAnimationFrame(() => requestAnimationFrame(resolve as any))\r\n  })\r\n}\r\n\r\nexport const saveToBrowserMemory = async () => {\r\n  setLoadingScreenStatus('Saving world')\r\n  try {\r\n    await new Promise<void>(resolve => {\r\n      subscribeKey(appStatusState, 'isDisplaying', () => {\r\n        if (appStatusState.isDisplaying) {\r\n          resolve()\r\n        }\r\n      })\r\n    })\r\n    //@ts-expect-error\r\n    const { worldFolder } = localServer.options\r\n    const saveRootPath = await uniqueFileNameFromWorldName(worldFolder.split('/').pop(), `/data/worlds`)\r\n    await mkdirRecursive(saveRootPath)\r\n    console.log('made world folder', saveRootPath)\r\n    const allRootPaths = [...usedServerPathsV1]\r\n    const allFilesToCopy = [] as string[]\r\n    for (const dirBase of allRootPaths) {\r\n      // eslint-disable-next-line no-await-in-loop\r\n      if (dirBase.includes('.') && await fileExistsAsyncOptimized(join(worldFolder, dirBase))) {\r\n        allFilesToCopy.push(dirBase)\r\n        continue\r\n      }\r\n      // eslint-disable-next-line no-await-in-loop\r\n      let res = await collectFilesToCopy(join(worldFolder, dirBase), true)\r\n      if (dirBase === 'region') {\r\n        res = res.filter(x => x.endsWith('.mca'))\r\n      }\r\n      allFilesToCopy.push(...res.map(x => join(dirBase, x)))\r\n    }\r\n    console.log('paths collected')\r\n    const pathsSplitBasic = allFilesToCopy.filter(path => {\r\n      if (!path.startsWith('region/')) return true\r\n      const [x, z] = path.split('/').at(-1)!.split('.').slice(1, 3).map(Number)\r\n      return Math.abs(x) > 50 || Math.abs(z) > 50 // HACK: otherwise it's too big and we can't handle it in visual display\r\n    })\r\n    let copied = 0\r\n    let isRegionFiles = false\r\n    const upProgress = (totalSize: number) => {\r\n      copied++\r\n      let action = fsState.remoteBackend ? 'Downloading & copying' : 'Copying'\r\n      action += isRegionFiles ? ' region files (world chunks)' : ' basic save files'\r\n      setLoadingScreenStatus(`${action} files (${copied}/${totalSize})`)\r\n    }\r\n    const copyFiles = async (copyPaths: string[][]) => {\r\n      const totalSIze = copyPaths.flat().length\r\n      for (const copyFileGroup of copyPaths) {\r\n        // eslint-disable-next-line no-await-in-loop, @typescript-eslint/no-loop-func\r\n        await Promise.all(copyFileGroup.map(async (copyPath) => {\r\n          const srcPath = join(worldFolder, copyPath)\r\n          const savePath = join(saveRootPath, copyPath)\r\n          await mkdirRecursive(savePath)\r\n          await fs.promises.writeFile(savePath, await fs.promises.readFile(srcPath) as any)\r\n          upProgress(totalSIze)\r\n          if (isRegionFiles) {\r\n            const regionFile = copyPath.split('/').at(-1)!\r\n            appStatusState.loadingChunksData![regionFile] = 'done'\r\n          }\r\n        }))\r\n        // eslint-disable-next-line no-await-in-loop\r\n        await waitForPotentialRender()\r\n      }\r\n    }\r\n    // basic save files\r\n    await copyFiles(splitByCopySize(pathsSplitBasic))\r\n    setLoadingScreenStatus('Preparing world chunks copying')\r\n    await waitForPotentialRender()\r\n\r\n    // region files\r\n    isRegionFiles = true\r\n    copied = 0\r\n    const regionFiles = allFilesToCopy.filter(x => !pathsSplitBasic.includes(x))\r\n    const regionFilesNumbers = regionFiles.map(x => x.split('/').at(-1)!.split('.').slice(1, 3).map(Number))\r\n    const xMin = Math.min(...regionFilesNumbers.flatMap(x => x[0]))\r\n    const zMin = Math.min(...regionFilesNumbers.flatMap(x => x[1]))\r\n    const xMax = Math.max(...regionFilesNumbers.flatMap(x => x[0]))\r\n    const zMax = Math.max(...regionFilesNumbers.flatMap(x => x[1]))\r\n    const playerPosRegion = bot.entity.position.divide(new Vec3(32 * 16, 32 * 16, 32 * 16)).floored()\r\n    const maxDistantRegion = Math.max(\r\n      Math.abs(playerPosRegion.x - xMin),\r\n      Math.abs(playerPosRegion.z - zMin),\r\n      Math.abs(playerPosRegion.x - xMax),\r\n      Math.abs(playerPosRegion.z - zMax)\r\n    )\r\n    const spiral = generateSpiralMatrix(maxDistantRegion)\r\n    const filesWithSpiral = spiral.filter(x => allFilesToCopy.includes(`region/r.${x[0]}.${x[1]}.mca`)).map(x => `region/r.${x[0]}.${x[1]}.mca`)\r\n    if (filesWithSpiral.length !== regionFiles.length) throw new Error('Something went wrong with region files')\r\n\r\n    appStatusState.loadingChunksData = Object.fromEntries(regionFiles.map(x => [x.split('/').at(-1)!, 'loading']))\r\n    appStatusState.loadingChunksDataPlayerChunk = { x: playerPosRegion.x, z: playerPosRegion.z }\r\n    await copyFiles(splitByCopySize(filesWithSpiral, 10))\r\n\r\n    return saveRootPath\r\n  } catch (err) {\r\n    console.error(err)\r\n    void showOptionsModal(`Error while saving the world: ${err.message}`, [])\r\n  } finally {\r\n    setLoadingScreenStatus(undefined)\r\n  }\r\n}\r\n\r\nconst splitByCopySize = (files: string[], copySize = 15) => {\r\n  return files.reduce<string[][]>((acc, cur, i) => {\r\n    if (i % copySize === 0) {\r\n      acc.push([])\r\n    }\r\n    acc.at(-1)!.push(cur)\r\n    return acc\r\n  }, [])\r\n}\r\n\r\nexport default () => {\r\n  const lockConnect = appQueryParams.lockConnect === 'true'\r\n  const isModalActive = useIsModalActive('pause-screen')\r\n  const fsStateSnap = useSnapshot(fsState)\r\n  const activeModalStackSnap = useSnapshot(activeModalStack)\r\n  const { singleplayer, wanOpened, wanOpening } = useSnapshot(miscUiState)\r\n  const { noConnection } = useSnapshot(gameAdditionalState)\r\n  const { active: packetsReplaceActive, hasRecordedPackets: packetsReplaceHasRecordedPackets } = useSnapshot(packetsRecordingState)\r\n  const { displayRecordButton: displayPacketsButtons } = useSnapshot(options)\r\n\r\n  const handlePointerLockChange = () => {\r\n    if (!pointerLock.hasPointerLock && activeModalStack.length === 0) {\r\n      showModal({ reactType: 'pause-screen' })\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    document.addEventListener('pointerlockchange', handlePointerLockChange)\r\n\r\n    return () => {\r\n      document.removeEventListener('pointerlockchange', handlePointerLockChange)\r\n    }\r\n  }, [])\r\n\r\n  const onReturnPress = () => {\r\n    hideModal({ reactType: 'pause-screen' })\r\n  }\r\n\r\n  const clickWebShareButton = async () => {\r\n    if (!wanOpened) return\r\n    try {\r\n      const url = getJoinLink()\r\n      const shareData = { url }\r\n      await navigator.share?.(shareData)\r\n    } catch (err) {\r\n      console.log(`Error: ${err}`)\r\n    }\r\n  }\r\n\r\n  const clickJoinLinkButton = async (qr = false) => {\r\n    if (!qr && wanOpened) {\r\n      closeWan()\r\n      return\r\n    }\r\n    if (!wanOpened || !qr) {\r\n      await openToWanAndCopyJoinLink((err) => {\r\n        if (!miscUiState.wanOpening) return\r\n        alert(`Something went wrong: ${err}`)\r\n      }, !qr)\r\n    }\r\n    if (qr) {\r\n      const joinLink = getJoinLink()\r\n      miscUiState.currentDisplayQr = joinLink ?? null\r\n    }\r\n  }\r\n\r\n  const openWorldActions = async () => {\r\n    if (fsStateSnap.inMemorySave || !singleplayer) {\r\n      return showOptionsModal('World actions...', [])\r\n    }\r\n    const action = await showOptionsModal('World actions...', ['Save to browser memory'])\r\n    if (action === 'Save to browser memory') {\r\n      const path = await saveToBrowserMemory()\r\n      if (!path) return\r\n      const saveName = path.split('/').at(-1)\r\n      showNotification(`World saved to ${saveName}`, 'Load it to keep your progress!')\r\n      // fsState.inMemorySave = true\r\n      // fsState.syncFs = false\r\n      // fsState.isReadonly = false\r\n      // fsState.remoteBackend = false\r\n    }\r\n  }\r\n\r\n  if (!isModalActive) return null\r\n\r\n  return <Screen title='Game Menu'>\r\n    <div style={{ position: 'fixed', top: '5px', left: 'calc(env(safe-area-inset-left) + 5px)', display: 'flex', flexDirection: 'column', gap: '5px' }}>\r\n      <Button\r\n        icon=\"pixelarticons:folder\"\r\n        onClick={async () => openWorldActions()}\r\n      />\r\n      {displayPacketsButtons && (\r\n        <>\r\n          <Button\r\n            icon={packetsReplaceActive ? 'pixelarticons:debug-stop' : 'pixelarticons:circle'}\r\n            onClick={() => {\r\n              packetsRecordingState.active = !packetsRecordingState.active\r\n            }}\r\n          />\r\n          {packetsReplaceHasRecordedPackets && (\r\n            <Button\r\n              icon={pixelartIcons['briefcase-download']}\r\n              onClick={async () => downloadPacketsReplay()}\r\n            />\r\n          )}\r\n          <Button\r\n            icon={pixelartIcons['download']}\r\n            onClick={async () => bot.downloadCurrentWorldState()}\r\n          />\r\n        </>\r\n      )}\r\n    </div>\r\n    <ErrorBoundary renderError={() => <div>error</div>}>\r\n      <div style={{ position: 'fixed', top: '5px', left: 'calc(env(safe-area-inset-left) + 35px)' }}>\r\n        <NetworkStatus />\r\n      </div>\r\n    </ErrorBoundary>\r\n    <div className={styles.pause_container}>\r\n      <Button className=\"button\" style={{ width: '204px' }} onClick={onReturnPress}>Back to Game</Button>\r\n      <PauseLinkButtons />\r\n      <Button className=\"button\" style={{ width: '204px' }} onClick={() => openOptionsMenu('main')}>Options</Button>\r\n      {singleplayer ? (\r\n        <div className={styles.row}>\r\n          <Button className=\"button\" style={{ width: '170px' }} onClick={async () => clickJoinLinkButton()}>\r\n            {wanOpening ? 'Opening, wait...' : wanOpened ? 'Close Wan' : 'Copy Join Link'}\r\n          </Button>\r\n          {(navigator.share as typeof navigator.share | undefined) ? (\r\n            <Button\r\n              title=\"Share Join Link\"\r\n              className=\"button\"\r\n              icon=\"pixelarticons:arrow-up\"\r\n              style={{ width: '20px' }}\r\n              onClick={async () => clickWebShareButton()}\r\n            />\r\n          ) : null}\r\n          <Button\r\n            title='Display QR for the Join Link'\r\n            className=\"button\"\r\n            icon=\"pixelarticons:dice\"\r\n            style={{ width: '20px' }}\r\n            onClick={async () => clickJoinLinkButton(true)}\r\n          />\r\n        </div>\r\n      ) : null}\r\n      {!lockConnect && <>\r\n        <Button className=\"button\" style={{ width: '204px' }} onClick={disconnect}>\r\n          {localServer && !fsState.syncFs && !fsState.isReadonly ? 'Save & Quit' : 'Disconnect & Reset'}\r\n        </Button>\r\n      </>}\r\n      {noConnection && (\r\n        <Button className=\"button\" style={{ width: '204px' }} onClick={reconnectReload}>\r\n          Reconnect\r\n        </Button>\r\n      )}\r\n    </div>\r\n  </Screen>\r\n}\r\n","import { CSSProperties } from 'react'\r\nimport { PixelartIconsGenerated } from './pixelartIcons.generated'\r\n\r\nexport default ({\r\n  iconName,\r\n  width = undefined as undefined | number,\r\n  styles = {} as CSSProperties,\r\n  className = undefined as undefined | string,\r\n  onClick = () => { }\r\n}) => {\r\n  if (width !== undefined) styles = { width, height: width, fontSize: width, ...styles }\r\n  iconName = iconName.replace('pixelarticons:', '')\r\n\r\n  return <div\r\n    style={{\r\n      ...styles\r\n    }} onClick={onClick} className={`${`pixelart-icons-font-${iconName}`} ${className ?? ''}`}\r\n  />\r\n}\r\n\r\nexport const pixelartIcons = new Proxy({} as PixelartIconsGenerated, {\r\n  get (target, prop) {\r\n    return prop as string\r\n  }\r\n})\r\n","import MessageFormattedString from './MessageFormattedString'\r\nimport './PlayerListOverlay.css'\r\n\r\n\r\ntype PlayersLists = Array<Array<Pick<import('mineflayer').Player, 'uuid' | 'username' | 'ping'>>>\r\n\r\ntype PlayerListOverlayProps = {\r\n  playersLists: PlayersLists,\r\n  clientId: string,\r\n  tablistHeader: string | Record<string, any> | null,\r\n  tablistFooter: string | Record<string, any> | null,\r\n  serverIP: string\r\n  style?: React.CSSProperties\r\n}\r\n\r\nexport default ({ playersLists, clientId, tablistHeader, tablistFooter, serverIP, style }: PlayerListOverlayProps) => {\r\n\r\n  return <div className=\"playerlist-container\" id=\"playerlist-container\" style={style}>\r\n    <span className=\"playerlist-title\">Server IP: {serverIP}</span>\r\n    <div className='playerlist-header'>\r\n      <MessageFormattedString message={tablistHeader} />\r\n    </div>\r\n    <div className=\"player-lists\">\r\n      {playersLists.map((list, index) => (\r\n        <div key={index} className=\"player-list\">\r\n          {list.map(player => (\r\n            <div key={player.uuid ?? player.username} className={`playerlist-entry${clientId === player.uuid ? ' active-player' : ''}`} id={`plist-player-${player.uuid}`}>\r\n              <MessageFormattedString message={player.username} />\r\n              <div className=\"playerlist-ping\">\r\n                <p className=\"playerlist-ping-value\">{player.ping}</p>\r\n                <p className=\"playerlist-ping-label\">ms</p>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      ))}\r\n    </div>\r\n    <div className='playerlist-footer'>\r\n      <MessageFormattedString message={tablistFooter} />\r\n    </div>\r\n  </div>\r\n}\r\n","import { useSnapshot } from 'valtio'\r\nimport { useState, useEffect, useMemo } from 'react'\r\nimport { isGameActive } from '../globalState'\r\nimport PlayerListOverlay from './PlayerListOverlay'\r\nimport './PlayerListOverlay.css'\r\nimport { lastConnectOptions } from './AppStatusProvider'\r\n\r\nconst MAX_ROWS_PER_COL = 10\r\n\r\ntype Players = typeof bot.players\r\n\r\nexport default () => {\r\n  const serverIp = lastConnectOptions.value?.server\r\n  const [clientId, setClientId] = useState('')\r\n  const [players, setPlayers] = useState<Players>({})\r\n  const [isOpen, setIsOpen] = useState(false)\r\n\r\n  const handleKeyDown = (e) => {\r\n    if (!isGameActive(true)) return\r\n    if (e.key === 'Tab') {\r\n      setIsOpen(prev => true)\r\n      e.preventDefault()\r\n    }\r\n  }\r\n\r\n  const handleKeyUp = (e) => {\r\n    if (e.key === 'Tab') {\r\n      setIsOpen(prev => false)\r\n      e.preventDefault()\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    function requestUpdate () {\r\n      setPlayers(bot?.players ?? {})\r\n    }\r\n\r\n    bot.on('playerUpdated', () => requestUpdate())\r\n    bot.on('playerJoined', () => requestUpdate())\r\n    bot.on('playerLeft', () => requestUpdate())\r\n    requestUpdate()\r\n    const interval = setInterval(() => {\r\n      requestUpdate()\r\n    }, 1000)\r\n    return () => clearInterval(interval)\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    setPlayers(bot.players)\r\n    if (bot.player) {\r\n      setClientId(bot.player.uuid)\r\n    } else {\r\n      bot._client.on('player_info', () => {\r\n        setClientId(bot.player?.uuid)\r\n      })\r\n    }\r\n\r\n    document.addEventListener('keydown', handleKeyDown)\r\n    document.addEventListener('keyup', handleKeyUp)\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', handleKeyDown)\r\n      document.removeEventListener('keyup', handleKeyUp)\r\n    }\r\n  }, [serverIp])\r\n\r\n\r\n  const playersArray = Object.values(players).sort((a, b) => {\r\n    if (a.username > b.username) return 1\r\n    if (a.username < b.username) return -1\r\n    return 0\r\n  })\r\n  const lists = [] as Array<typeof playersArray>\r\n\r\n  let tempList = [] as typeof playersArray\r\n  for (let i = 0; i < playersArray.length; i++) {\r\n    tempList.push(playersArray[i])\r\n\r\n    if ((i + 1) % MAX_ROWS_PER_COL === 0 || i + 1 === playersArray.length) {\r\n      lists.push([...tempList])\r\n      tempList = []\r\n    }\r\n  }\r\n\r\n  if (!isOpen) return null\r\n\r\n  return <PlayerListOverlay\r\n    playersLists={lists}\r\n    clientId={clientId}\r\n    tablistHeader={bot.tablist.header}\r\n    tablistFooter={bot.tablist.footer}\r\n    serverIP={serverIp ?? ''}\r\n  />\r\n}\r\n","import { useState, useEffect } from 'react'\r\nimport { useSnapshot } from 'valtio'\r\nimport { filterPackets } from './packetsFilter'\r\nimport { DARK_COLORS } from './components/replay/constants'\r\nimport FilterInput from './components/replay/FilterInput'\r\nimport PacketList from './components/replay/PacketList'\r\nimport ProgressBar from './components/replay/ProgressBar'\r\nimport { packetsReplayState } from './state/packetsReplayState'\r\n\r\ninterface Props {\r\n  replayName: string\r\n  packets: readonly PacketData[]\r\n  isPlaying: boolean\r\n  progress: { current: number; total: number }\r\n  speed: number\r\n  defaultFilter?: string\r\n  customButtons: Readonly<Record<string, { state: boolean; label: string; tooltip?: string }>>\r\n  onPlayPause?: (isPlaying: boolean) => void\r\n  onRestart?: () => void\r\n  onSpeedChange?: (speed: number) => void\r\n  onFilterChange: (filter: string) => void\r\n  onCustomButtonToggle: (buttonId: string) => void\r\n  clientPacketsAutocomplete: string[]\r\n  serverPacketsAutocomplete: string[]\r\n  style?: React.CSSProperties\r\n}\r\n\r\nexport default function ReplayPanel ({\r\n  replayName,\r\n  packets,\r\n  isPlaying,\r\n  progress,\r\n  speed,\r\n  defaultFilter = '',\r\n  customButtons,\r\n  onPlayPause,\r\n  onRestart,\r\n  onSpeedChange,\r\n  onFilterChange,\r\n  onCustomButtonToggle,\r\n  clientPacketsAutocomplete,\r\n  serverPacketsAutocomplete,\r\n  style\r\n}: Props) {\r\n  const [filter, setFilter] = useState(defaultFilter)\r\n  const { isMinimized } = useSnapshot(packetsReplayState)\r\n  const { filtered: filteredPackets, hiddenCount } = filterPackets(packets.slice(-500), filter)\r\n\r\n  useEffect(() => {\r\n    onFilterChange(filter)\r\n  }, [filter, onFilterChange])\r\n\r\n  const handlePlayPauseClick = () => {\r\n    if (isMinimized) {\r\n      packetsReplayState.isMinimized = false\r\n    } else {\r\n      onPlayPause?.(!isPlaying)\r\n    }\r\n  }\r\n\r\n  const playPauseButton = (\r\n    <button\r\n      onClick={handlePlayPauseClick}\r\n      style={{\r\n        background: 'none',\r\n        border: 'none',\r\n        cursor: 'pointer',\r\n        padding: '4px',\r\n        color: DARK_COLORS.text\r\n      }}\r\n    >\r\n      <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n        {isPlaying ? (\r\n          <path d=\"M6 19h4V5H6v14zm8-14v14h4V5h-4z\"/>\r\n        ) : (\r\n          <path d=\"M8 5v14l11-7z\"/>\r\n        )}\r\n      </svg>\r\n    </button>\r\n  )\r\n\r\n  const baseContainerStyle = {\r\n    position: 'fixed',\r\n    top: 18,\r\n    right: 0,\r\n    zIndex: 1000,\r\n    background: DARK_COLORS.bg,\r\n    padding: '16px',\r\n    borderRadius: '0 0 8px 0',\r\n    boxShadow: '0 2px 8px rgba(0,0,0,0.3)',\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    gap: '12px',\r\n    color: DARK_COLORS.text,\r\n    ...style\r\n  } as const\r\n\r\n  if (isMinimized) {\r\n    return (\r\n      <div style={{\r\n        ...baseContainerStyle,\r\n        width: 'auto'\r\n      }}>\r\n        {playPauseButton}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div style={{\r\n      ...baseContainerStyle,\r\n      width: '400px',\r\n      maxHeight: '80vh'\r\n    }}>\r\n      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n        <div style={{ fontSize: '12px', fontWeight: 'bold' }}>{replayName || 'Unnamed Replay'}</div>\r\n        <button\r\n          onClick={() => { packetsReplayState.isMinimized = true }}\r\n          style={{\r\n            background: 'none',\r\n            border: 'none',\r\n            color: DARK_COLORS.text,\r\n            cursor: 'pointer',\r\n            padding: '4px',\r\n            fontSize: '14px',\r\n            opacity: 0.7,\r\n            transition: 'opacity 0.2s'\r\n          }}\r\n          onMouseEnter={e => {\r\n            e.currentTarget.style.opacity = '1'\r\n          }}\r\n          onMouseLeave={e => {\r\n            e.currentTarget.style.opacity = '0.7'\r\n          }}\r\n        >\r\n          \r\n        </button>\r\n      </div>\r\n\r\n      <div style={{ fontSize: '8px', color: '#888888', marginTop: '-8px' }}>Integrated server emulation. Testing client...</div>\r\n\r\n      <FilterInput\r\n        value={filter}\r\n        onChange={setFilter}\r\n        hiddenCount={hiddenCount}\r\n        shownCount={filteredPackets.length}\r\n        onClearFilter={() => setFilter('')}\r\n        clientPacketsAutocomplete={clientPacketsAutocomplete}\r\n        serverPacketsAutocomplete={serverPacketsAutocomplete}\r\n      />\r\n\r\n      <PacketList\r\n        packets={filteredPackets}\r\n        filter={filter}\r\n        maxHeight={300}\r\n      />\r\n\r\n      <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n        {playPauseButton}\r\n        <ProgressBar current={progress.current} total={progress.total} />\r\n      </div>\r\n\r\n      <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n        <button\r\n          onClick={onRestart}\r\n          style={{\r\n            padding: '4px 8px',\r\n            borderRadius: '4px',\r\n            border: `1px solid ${DARK_COLORS.border}`,\r\n            background: DARK_COLORS.input,\r\n            color: DARK_COLORS.text,\r\n            cursor: 'pointer'\r\n          }}\r\n        >\r\n          Restart\r\n        </button>\r\n\r\n        <input\r\n          type=\"number\"\r\n          value={speed}\r\n          onChange={e => onSpeedChange?.(Number(e.target.value))}\r\n          onContextMenu={e => {\r\n            e.preventDefault()\r\n            onSpeedChange?.(1)\r\n          }}\r\n          step={0.1}\r\n          min={0.1}\r\n          style={{\r\n            width: '60px',\r\n            padding: '4px',\r\n            border: `1px solid ${DARK_COLORS.border}`,\r\n            borderRadius: '4px',\r\n            background: DARK_COLORS.input,\r\n            color: DARK_COLORS.text\r\n          }}\r\n        />\r\n\r\n        {Object.entries(customButtons).map(([buttonId, { state, label, tooltip }]) => (\r\n          <button\r\n            key={buttonId}\r\n            onClick={() => onCustomButtonToggle(buttonId)}\r\n            title={tooltip}\r\n            style={{\r\n              padding: '4px 8px',\r\n              borderRadius: '4px',\r\n              border: `1px solid ${DARK_COLORS.border}`,\r\n              background: state\r\n                ? DARK_COLORS.client\r\n                : DARK_COLORS.input,\r\n              color: DARK_COLORS.text,\r\n              cursor: 'pointer',\r\n              minWidth: '32px'\r\n            }}\r\n          >\r\n            {label}\r\n          </button>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport interface PacketData {\r\n  name: string\r\n  data: any\r\n  isFromClient: boolean\r\n  isUpcoming: boolean\r\n  actualVersion?: any\r\n  position: number\r\n  timestamp: number\r\n}\r\n","import './Scoreboard.css'\r\nimport MessageFormattedString from './MessageFormattedString'\r\nimport { reactKeyForMessage } from './utils'\r\n\r\n\r\nexport type ScoreboardItems = Array<{ name: string, value: number, displayName?: any }>\r\n\r\ntype ScoreboardProps = {\r\n  title: string,\r\n  items: ScoreboardItems,\r\n  open: boolean\r\n  style?: React.CSSProperties\r\n}\r\n\r\nexport default function Scoreboard ({ title, items, open, style }: ScoreboardProps) {\r\n\r\n  if (!open) return null\r\n  return (\r\n    <div className='scoreboard-container' style={style}>\r\n      <div className='scoreboard-title'>\r\n        <MessageFormattedString message={title} />\r\n      </div>\r\n      {\r\n        items.map((item) => {\r\n          const message = item.displayName ?? item.name\r\n          return <div key={reactKeyForMessage(message) + '_' + item.value} className='item-container'>\r\n            <div className='item-name'>\r\n              <MessageFormattedString message={message} />\r\n            </div>\r\n            <div className='item-value'>\r\n              {item.value}\r\n            </div>\r\n          </div>\r\n        })\r\n      }\r\n    </div>\r\n  )\r\n}\r\n","import { useMemo, useState } from 'react'\r\nimport Scoreboard from './Scoreboard'\r\nimport type { ScoreboardItems } from './Scoreboard'\r\n\r\n\r\nexport default function ScoreboardProvider () {\r\n  const [title, setTitle] = useState('Scoreboard')\r\n  const [items, setItems] = useState<ScoreboardItems>([])\r\n  const [open, setOpen] = useState(false)\r\n\r\n  useMemo(() => { // useMemo instead of useEffect to register them asap and not after the initial dom render\r\n    const updateSidebarScoreboard = () => {\r\n      addStatPerSec('scoreboard')\r\n      if (bot.scoreboard.sidebar) {\r\n        setTitle(bot.scoreboard.sidebar.title)\r\n        setItems([...bot.scoreboard.sidebar.items])\r\n        setOpen(true)\r\n      } else {\r\n        setOpen(false)\r\n      }\r\n    }\r\n\r\n    bot.on('scoreboardCreated', updateSidebarScoreboard) // not used atm but still good to have\r\n    bot.on('scoreboardTitleChanged', updateSidebarScoreboard)\r\n    bot.on('scoreUpdated', updateSidebarScoreboard)\r\n    bot.on('scoreRemoved', updateSidebarScoreboard)\r\n    bot.on('scoreboardDeleted', updateSidebarScoreboard)\r\n    bot.on('scoreboardPosition', () => {\r\n      void Promise.resolve().then(() => {\r\n        updateSidebarScoreboard()\r\n      }) // mineflayer bug: wait for the next tick to get the correct scoreboard position\r\n    })\r\n  }, [])\r\n\r\n  return (\r\n    <Scoreboard\r\n      title={title}\r\n      items={items}\r\n      open={open}\r\n    />\r\n  )\r\n}\r\n","interface Props {\r\n  title: JSX.Element | string\r\n  children: React.ReactNode\r\n  backdrop?: boolean | 'dirt'\r\n  style?: React.CSSProperties\r\n  className?: string\r\n  titleSelectable?: boolean\r\n  titleMarginTop?: number\r\n}\r\n\r\nexport default ({ title, children, backdrop = true, style, className = '', titleSelectable, titleMarginTop }: Props) => {\r\n  return (\r\n    <>\r\n      {backdrop === 'dirt' ? <div className='dirt-bg' /> : backdrop ? <div className=\"backdrop\" /> : null}\r\n      <div className={`fullscreen ${className}`} style={{ overflow: 'auto', ...style }}>\r\n        <div className=\"screen-content\" style={titleMarginTop === undefined ? {} : { marginTop: titleMarginTop }}>\r\n          <div className={`screen-title ${titleSelectable ? 'text-select' : ''}`}>{title}</div>\r\n          {children}\r\n        </div>\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n","import { useState, CSSProperties } from 'react'\r\nimport Creatable from 'react-select/creatable'\r\nimport Input from './Input'\r\nimport './Select.css'\r\nimport styles from './select.module.css'\r\n\r\n\r\nexport interface OptionStorage {\r\n  value: string,\r\n  label: string\r\n}\r\n\r\ninterface Props {\r\n  initialOptions: OptionStorage[]\r\n  updateOptions: (options: string) => void\r\n  getCssOnInput?: (input: string) => CSSProperties | undefined\r\n  onValueChange?: (newVal: string) => void\r\n  defaultValue?: { value: string, label: string }\r\n  placeholder?: string\r\n  containerStyle?: CSSProperties\r\n  disabled?: boolean\r\n}\r\n\r\nexport default ({\r\n  initialOptions,\r\n  updateOptions,\r\n  getCssOnInput,\r\n  onValueChange,\r\n  defaultValue,\r\n  containerStyle,\r\n  placeholder,\r\n  disabled\r\n}: Props) => {\r\n  const [inputValue, setInputValue] = useState<string | undefined>(defaultValue?.label ?? '')\r\n  const [currValue, setCurrValue] = useState<string | undefined>(defaultValue?.label ?? '')\r\n  const [inputStyle, setInputStyle] = useState<CSSProperties>({})\r\n  const [isFirstClick, setIsFirstClick] = useState(true)\r\n\r\n  return <Creatable\r\n    options={initialOptions}\r\n    defaultValue={defaultValue}\r\n    blurInputOnSelect={true}\r\n    hideSelectedOptions={false}\r\n    maxMenuHeight={100}\r\n    isClearable={true}\r\n    formatCreateLabel={(value) => {\r\n      return 'Use \"' + value + '\"'\r\n    }}\r\n    isDisabled={disabled}\r\n    placeholder={placeholder ?? ''}\r\n    onChange={(e, action) => {\r\n      console.log('value:', e?.value)\r\n      setCurrValue(e?.label)\r\n      setInputValue(e?.label)\r\n      onValueChange?.(e?.value ?? '')\r\n      updateOptions?.(e?.value ?? '')\r\n      setInputStyle(getCssOnInput?.(e?.value ?? '') ?? {})\r\n    }}\r\n    onInputChange={(e) => {\r\n      setIsFirstClick(false)\r\n      setInputValue(e)\r\n    }}\r\n    inputValue={inputValue}\r\n    onFocus={(state) => {\r\n      setInputValue(currValue)\r\n    }}\r\n    filterOption={(option, value) => {\r\n      return isFirstClick || option.label.includes(value)\r\n    }}\r\n    onMenuOpen={() => {\r\n      setIsFirstClick(true)\r\n    }}\r\n    menuPortalTarget={document.body}\r\n    classNames={{\r\n      control (state) {\r\n        return styles.container\r\n      },\r\n      input (state) {\r\n        return styles.input\r\n      },\r\n      option (state) {\r\n        return styles.container\r\n      }\r\n    }}\r\n    styles={{\r\n      menuPortal (base, state) { return { ...base, zIndex: 10, transform: 'scale(var(--guiScale))', transformOrigin: 'top left' } },\r\n      container (base, state) { return { ...base, position: 'relative', zIndex: 10 } },\r\n      control (base, state) { return { ...containerStyle, ...inputStyle } },\r\n      menu (base, state) { return { position: 'absolute', zIndex: 10 } },\r\n      option (base, state) {\r\n        return {\r\n          boxSizing: 'border-box',\r\n          padding: '3px',\r\n          backgroundColor: 'black',\r\n          border: state.isFocused ? '1px solid white' : '1px solid grey',\r\n          height: 'fit-content',\r\n          ...containerStyle\r\n        }\r\n      },\r\n      input (base, state) { return {} },\r\n      indicatorsContainer (base, state) { return { display: 'none' } },\r\n      placeholder (base, state) { return { ...base, padding: '3px', position: 'absolute' } },\r\n      singleValue (base, state) { return { ...base, margin: '0px', position: 'absolute', color: 'white' } },\r\n      valueContainer (base, state) { return { ...base, padding: '3px' } },\r\n      noOptionsMessage (base, state) { return { display: 'none' } }\r\n    }}\r\n  />\r\n}\r\n","import React, { CSSProperties } from 'react'\r\nimport Select from './Select'\r\n\r\ntype Version = { value: string, label: string }\r\n\r\nexport default (\r\n  { versions, selected, onChange, updateOptions, containerStyle }:\r\n    {\r\n      versions: Version[],\r\n      selected?: Version,\r\n      onChange?: (newValue: string) => void,\r\n      updateOptions?: (newSel: string) => void,\r\n    } & Pick<React.ComponentProps<typeof Select>, 'containerStyle' | 'placeholder' | 'disabled'>\r\n) => {\r\n  return <Select\r\n    initialOptions={versions}\r\n    defaultValue={selected}\r\n    updateOptions={(newSel) => {\r\n      updateOptions?.(newSel)\r\n    }}\r\n    onValueChange={onChange}\r\n    containerStyle={containerStyle ?? { width: '190px' }}\r\n    getCssOnInput={(value) => {\r\n      if (!versions || !value) return {}\r\n      const parsedsupportedVersions = versions.map(x => x.value.split('.').map(Number))\r\n      const parsedValue = value.split('.').map(Number)\r\n\r\n      const compareVersions = (v1, v2) => {\r\n        for (let i = 0; i < Math.max(v1.length, v2.length); i++) {\r\n          const num1 = v1[i] || 0\r\n          const num2 = v2[i] || 0\r\n          if (num1 > num2) return 1\r\n          if (num1 < num2) return -1\r\n        }\r\n        return 0\r\n      }\r\n\r\n      parsedsupportedVersions.sort(compareVersions)\r\n      const minVersion = parsedsupportedVersions[0]\r\n      const maxVersion = parsedsupportedVersions.at(-1)\r\n\r\n      const isWithinRange = compareVersions(parsedValue, minVersion) >= 0 && compareVersions(parsedValue, maxVersion) <= 0\r\n      if (!isWithinRange) return { border: '1px solid red' }\r\n      if (!versions.some(x => x.value === value)) return { border: '1px solid yellow' }\r\n    }}\r\n  />\r\n\r\n}\r\n","import { proxy, useSnapshot } from 'valtio'\r\nimport { useEffect, useRef } from 'react'\r\nimport { noCase } from 'change-case'\r\nimport { titleCase } from 'title-case'\r\nimport { hideCurrentModal, showModal } from '../globalState'\r\nimport { parseFormattedMessagePacket } from '../botUtils'\r\nimport Screen from './Screen'\r\nimport { useIsModalActive } from './utilsApp'\r\nimport Button from './Button'\r\nimport MessageFormattedString from './MessageFormattedString'\r\nimport Input, { InputWithLabel } from './Input'\r\n\r\nconst state = proxy({\r\n  title: '',\r\n  options: [] as string[],\r\n  showCancel: true,\r\n  minecraftJsonMessage: null as null | Record<string, any>,\r\n  behavior: 'resolve-close' as 'resolve-close' | 'close-resolve',\r\n  inputs: {} as Record<string, InputOption>,\r\n  inputsConfirmButton: ''\r\n})\r\n\r\nlet resolve\r\nexport const showOptionsModal = async <T extends string> (\r\n  title: string,\r\n  options: T[],\r\n  { cancel = true, minecraftJsonMessage }: { cancel?: boolean, minecraftJsonMessage? } = {}\r\n): Promise<T | undefined> => {\r\n  showModal({ reactType: 'general-select' })\r\n  let minecraftJsonMessageParsed\r\n  if (minecraftJsonMessage) {\r\n    const parseResult = parseFormattedMessagePacket(minecraftJsonMessage)\r\n    minecraftJsonMessageParsed = parseResult.formatted\r\n    if (parseResult.plain) {\r\n      title += ` (${parseResult.plain})`\r\n    }\r\n  }\r\n  return new Promise((_resolve) => {\r\n    resolve = _resolve\r\n    Object.assign(state, {\r\n      title,\r\n      options,\r\n      showCancel: cancel,\r\n      minecraftJsonMessage: minecraftJsonMessageParsed,\r\n      inputs: {},\r\n      inputsConfirmButton: ''\r\n    })\r\n  })\r\n}\r\n\r\ntype InputOption = {\r\n  type: 'text' | 'checkbox'\r\n  defaultValue?: string | boolean\r\n  label?: string\r\n}\r\nexport const showInputsModal = async <T extends Record<string, InputOption>>(\r\n  title: string,\r\n  inputs: T,\r\n  { cancel = true, minecraftJsonMessage }: { cancel?: boolean, minecraftJsonMessage? } = {}\r\n): Promise<{\r\n  [K in keyof T]: T[K] extends { type: 'text' }\r\n    ? string\r\n    : T[K] extends { type: 'checkbox' }\r\n      ? boolean\r\n      : never\r\n}> => {\r\n  showModal({ reactType: 'general-select' })\r\n  let minecraftJsonMessageParsed\r\n  if (minecraftJsonMessage) {\r\n    const parseResult = parseFormattedMessagePacket(minecraftJsonMessage)\r\n    minecraftJsonMessageParsed = parseResult.formatted\r\n    if (parseResult.plain) {\r\n      title += ` (${parseResult.plain})`\r\n    }\r\n  }\r\n  return new Promise((_resolve) => {\r\n    resolve = _resolve\r\n    Object.assign(state, {\r\n      title,\r\n      inputs,\r\n      showCancel: cancel,\r\n      minecraftJsonMessage: minecraftJsonMessageParsed,\r\n      options: [],\r\n      inputsConfirmButton: 'Confirm'\r\n    })\r\n  })\r\n}\r\n\r\nexport default () => {\r\n  const { title, options, showCancel, minecraftJsonMessage, inputs, inputsConfirmButton } = useSnapshot(state)\r\n  const isModalActive = useIsModalActive('general-select')\r\n  const inputValues = useRef({})\r\n\r\n  useEffect(() => {\r\n    inputValues.current = Object.fromEntries(Object.entries(inputs).map(([key, input]) => [key, input.defaultValue ?? (input.type === 'checkbox' ? false : '')]))\r\n  }, [inputs])\r\n\r\n  if (!isModalActive) return\r\n\r\n  const resolveClose = (value: any) => {\r\n    if (state.behavior === 'resolve-close') {\r\n      resolve(value)\r\n      hideCurrentModal()\r\n    } else {\r\n      hideCurrentModal()\r\n      resolve(value)\r\n    }\r\n  }\r\n\r\n  return <Screen title={title} backdrop>\r\n    {minecraftJsonMessage && <div style={{ textAlign: 'center', }}>\r\n      <MessageFormattedString message={minecraftJsonMessage} />\r\n    </div>}\r\n    <div style={{ display: 'flex', flexDirection: 'column', gap: 9 }}>\r\n      {options.length > 0 && <div style={{ display: 'flex', flexDirection: 'column', gap: 5 }}>\r\n        {options.map(option => <Button\r\n          key={option} onClick={() => {\r\n            resolveClose(option)\r\n          }}\r\n        >{option}\r\n        </Button>)}\r\n      </div>}\r\n      <div style={{ display: 'flex', flexDirection: 'column', gap: 3 }}>\r\n        {Object.entries(inputs).map(([key, input]) => {\r\n          const label = input.label ?? titleCase(noCase(key))\r\n          return <div key={key}>\r\n            {input.type === 'text' && (\r\n              <InputWithLabel\r\n                label={label}\r\n                autoFocus\r\n                type='text'\r\n                defaultValue={input.defaultValue as string}\r\n                onChange={(e) => {\r\n                  inputValues.current[key] = e.target.value\r\n                }}\r\n              />\r\n            )}\r\n            {input.type === 'checkbox' && (\r\n              <label style={{ display: 'flex', alignItems: 'center', gap: 4, fontSize: 12 }}>\r\n                <input\r\n                  type='checkbox'\r\n                  style={{ marginBottom: -1, }}\r\n                  defaultChecked={input.defaultValue as boolean}\r\n                  onChange={(e) => {\r\n                    inputValues.current[key] = e.target.checked\r\n                  }}\r\n                />\r\n                {label}\r\n              </label>\r\n            )}\r\n          </div>\r\n        })}\r\n      </div>\r\n      {inputs && inputsConfirmButton && (\r\n        <Button\r\n          // style={{ marginTop: 30 }}\r\n          onClick={() => {\r\n            resolveClose(inputValues.current)\r\n          }}\r\n        >\r\n          {inputsConfirmButton}\r\n        </Button>\r\n      )}\r\n      {showCancel && (\r\n        <Button\r\n          // style={{ marginTop: 30 }}\r\n          onClick={() => {\r\n            resolveClose(undefined)\r\n          }}\r\n        >\r\n          Cancel\r\n        </Button>\r\n      )}\r\n    </div>\r\n  </Screen>\r\n}\r\n","import React, { useMemo } from 'react'\r\nimport { useSnapshot } from 'valtio'\r\nimport { miscUiState } from '../globalState'\r\nimport { appQueryParams } from '../appParams'\r\nimport Singleplayer from './Singleplayer'\r\nimport Input from './Input'\r\nimport Button from './Button'\r\nimport PixelartIcon, { pixelartIcons } from './PixelartIcon'\r\nimport Select from './Select'\r\nimport { BaseServerInfo } from './AddServerOrConnect'\r\nimport { useIsSmallWidth } from './simpleHooks'\r\nimport { appStorage, SavedProxiesData, ServerHistoryEntry } from './appStorageProvider'\r\n\r\nconst getInitialProxies = () => {\r\n  const proxies = [] as string[]\r\n  if (miscUiState.appConfig?.defaultProxy) {\r\n    proxies.push(miscUiState.appConfig.defaultProxy)\r\n  }\r\n  return proxies\r\n}\r\n\r\nexport const getCurrentProxy = (): string | undefined => {\r\n  return appQueryParams.proxy ?? appStorage.proxiesData?.selected ?? getInitialProxies()[0]\r\n}\r\n\r\nexport const getCurrentUsername = () => {\r\n  return appQueryParams.username ?? appStorage.username\r\n}\r\n\r\ninterface Props extends React.ComponentProps<typeof Singleplayer> {\r\n  joinServer: (info: BaseServerInfo | string, additional: {\r\n    shouldSave?: boolean\r\n    index?: number\r\n  }) => void\r\n  onProfileClick?: () => void\r\n  setQuickConnectIp?: (ip: string) => void\r\n}\r\n\r\nexport default ({\r\n  joinServer,\r\n  onProfileClick,\r\n  setQuickConnectIp,\r\n  ...props\r\n}: Props) => {\r\n  const snap = useSnapshot(appStorage)\r\n  const username = useMemo(() => getCurrentUsername(), [appQueryParams.username, appStorage.username])\r\n  const [serverIp, setServerIp] = React.useState('')\r\n  const [save, setSave] = React.useState(true)\r\n  const [activeHighlight, setActiveHighlight] = React.useState(undefined as 'quick-connect' | 'server-list' | undefined)\r\n\r\n  const updateProxies = (newData: SavedProxiesData) => {\r\n    appStorage.proxiesData = newData\r\n  }\r\n\r\n  const setUsername = (username: string) => {\r\n    appStorage.username = username\r\n  }\r\n\r\n  const getActiveHighlightStyles = (type: typeof activeHighlight) => {\r\n    const styles: React.CSSProperties = {\r\n      transition: 'filter 0.2s',\r\n    }\r\n    if (activeHighlight && activeHighlight !== type) {\r\n      styles.filter = 'brightness(0.7)'\r\n    }\r\n    return styles\r\n  }\r\n\r\n  const isSmallWidth = useIsSmallWidth()\r\n\r\n  const initialProxies = getInitialProxies()\r\n  const proxiesData = snap.proxiesData ?? { proxies: initialProxies, selected: initialProxies[0] }\r\n  return <Singleplayer\r\n    {...props}\r\n    firstRowChildrenOverride={<form\r\n      style={{ width: '100%', display: 'flex', justifyContent: 'center' }} onSubmit={(e) => {\r\n        e.preventDefault()\r\n        joinServer(serverIp, { shouldSave: save })\r\n      }}\r\n    >\r\n      <div\r\n        style={{ display: 'flex', gap: 5, alignItems: 'center', ...getActiveHighlightStyles('quick-connect') }}\r\n        className='quick-connect-row'\r\n        onMouseEnter={() => setActiveHighlight('quick-connect')}\r\n        onMouseLeave={() => setActiveHighlight(undefined)}\r\n      >\r\n        <Input\r\n          required\r\n          placeholder='Quick Connect IP (:version)'\r\n          value={serverIp}\r\n          onChange={({ target: { value } }) => {\r\n            setQuickConnectIp?.(value)\r\n            setServerIp(value)\r\n          }}\r\n          width={isSmallWidth ? 120 : 180}\r\n          list=\"server-history\"\r\n          autoComplete=\"on\"\r\n          autoCorrect=\"off\"\r\n          autoCapitalize=\"off\"\r\n          spellCheck=\"false\"\r\n        />\r\n        <datalist id=\"server-history\">\r\n          {[...(snap.serversHistory ?? [])].sort((a, b) => b.numConnects - a.numConnects).map((server) => (\r\n            <option key={server.ip} value={`${server.ip}${server.version ? `:${server.version}` : ''}`} />\r\n          ))}\r\n        </datalist>\r\n        <label style={{ fontSize: 10, display: 'flex', alignItems: 'center', gap: 5, height: '100%', marginTop: '-1px' }}>\r\n          <input\r\n            type='checkbox' checked={save}\r\n            style={{ borderRadius: 0 }}\r\n            onChange={({ target: { checked } }) => setSave(checked)}\r\n          /> Save\r\n        </label>\r\n        <Button style={{ width: 90 }} type='submit'>Connect</Button>\r\n      </div>\r\n    </form>}\r\n    searchRowChildrenOverride={\r\n      <div style={{\r\n        // marginTop: 12,\r\n      }}\r\n      >\r\n        <div style={{ display: 'flex', gap: 3, alignItems: 'center' }}>\r\n          {isSmallWidth\r\n            ? <PixelartIcon iconName={pixelartIcons.server} styles={{ fontSize: 14, color: 'lightgray', marginLeft: 2 }} onClick={onProfileClick} />\r\n            : <span style={{ color: 'lightgray', fontSize: 14 }}>Proxy:</span>}\r\n          <Select\r\n            initialOptions={proxiesData.proxies.map(p => { return { value: p, label: p } })}\r\n            defaultValue={{ value: proxiesData.selected, label: proxiesData.selected }}\r\n            updateOptions={(newSel) => {\r\n              updateProxies({ proxies: [...proxiesData.proxies], selected: newSel })\r\n            }}\r\n            containerStyle={{\r\n              width: isSmallWidth ? 140 : 180,\r\n            }}\r\n          />\r\n          <PixelartIcon iconName='user' styles={{ fontSize: 14, color: 'lightgray', marginLeft: 2 }} onClick={onProfileClick} />\r\n          <Input\r\n            rootStyles={{ width: 80 }}\r\n            value={username}\r\n            disabled={appQueryParams.username !== undefined}\r\n            onChange={({ target: { value } }) => setUsername(value)}\r\n            autoCorrect=\"off\"\r\n            autoCapitalize=\"off\"\r\n            spellCheck=\"false\"\r\n          />\r\n        </div>\r\n      </div>\r\n    }\r\n    serversLayout\r\n    onWorldAction={(action, serverName) => {\r\n      if (action === 'load') {\r\n        joinServer({\r\n          ip: serverName,\r\n        }, {})\r\n      }\r\n      props.onWorldAction?.(action, serverName)\r\n    }}\r\n    setListHovered={(hovered) => {\r\n      setActiveHighlight(hovered ? 'server-list' : undefined)\r\n    }}\r\n    listStyle={getActiveHighlightStyles('server-list')}\r\n    secondRowStyles={getActiveHighlightStyles('server-list')}\r\n  />\r\n}\r\n","import { useEffect, useMemo, useState } from 'react'\r\nimport { useUtilsEffect } from '@zardoy/react-util'\r\nimport { useSnapshot } from 'valtio'\r\nimport { ConnectOptions } from '../connect'\r\nimport { activeModalStack, hideCurrentModal, miscUiState, notHideableModalsWithoutForce, showModal } from '../globalState'\r\nimport supportedVersions from '../supportedVersions.mjs'\r\nimport { appQueryParams } from '../appParams'\r\nimport { fetchServerStatus, isServerValid } from '../api/mcStatusApi'\r\nimport { getServerInfo } from '../mineflayer/mc-protocol'\r\nimport { parseServerAddress } from '../parseServerAddress'\r\nimport ServersList, { getCurrentProxy, getCurrentUsername } from './ServersList'\r\nimport AddServerOrConnect, { BaseServerInfo } from './AddServerOrConnect'\r\nimport { useDidUpdateEffect } from './utils'\r\nimport { useIsModalActive } from './utilsApp'\r\nimport { showOptionsModal } from './SelectOption'\r\nimport { useCopyKeybinding } from './simpleHooks'\r\nimport { AuthenticatedAccount, getInitialServersList, getServerConnectionHistory, setNewServersList } from './serversStorage'\r\nimport { appStorage, StoreServerItem } from './appStorageProvider'\r\n\r\nif (appQueryParams.lockConnect) {\r\n  notHideableModalsWithoutForce.add('editServer')\r\n}\r\n\r\ntype AdditionalDisplayData = {\r\n  textNameRightGrayed: string\r\n  formattedText: string\r\n  textNameRight: string\r\n  icon?: string\r\n  offline?: boolean\r\n}\r\n\r\n// todo move to base\r\nconst normalizeIp = (ip: string) => ip.replace(/https?:\\/\\//, '').replace(/\\/(:|$)/, '')\r\n\r\nconst FETCH_DELAY = 100 // ms between each request\r\nconst MAX_CONCURRENT_REQUESTS = 10\r\n\r\nconst Inner = ({ hidden, customServersList }: { hidden?: boolean, customServersList?: string[] }) => {\r\n  const [serverEditScreen, setServerEditScreen] = useState<StoreServerItem | true | null>(null) // true for add\r\n  const { authenticatedAccounts } = useSnapshot(appStorage)\r\n  const [quickConnectIp, setQuickConnectIp] = useState('')\r\n  const [selectedIndex, setSelectedIndex] = useState(0)\r\n\r\n  const { serversList: savedServersList } = useSnapshot(appStorage)\r\n\r\n  const serversListDisplay = useMemo(() => {\r\n    return (\r\n      customServersList\r\n        ? customServersList.map((row): StoreServerItem => {\r\n          const [ip, name] = row.split(' ')\r\n          const [_ip, _port, version] = ip.split(':')\r\n          return {\r\n            ip,\r\n            versionOverride: version,\r\n            name,\r\n          }\r\n        })\r\n        : [...getInitialServersList()]\r\n    )\r\n  }, [customServersList, savedServersList])\r\n\r\n  const [additionalServerData, setAdditionalServerData] = useState<Record<string, AdditionalDisplayData>>({})\r\n\r\n  // Add keyboard handler for moving servers\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (['input', 'textarea', 'select'].includes((e.target as HTMLElement)?.tagName?.toLowerCase())) return\r\n      if (!e.shiftKey || selectedIndex === undefined) return\r\n      if (e.key !== 'ArrowUp' && e.key !== 'ArrowDown') return\r\n      if (customServersList) return\r\n      e.preventDefault()\r\n      e.stopImmediatePropagation()\r\n\r\n      const newIndex = e.key === 'ArrowUp'\r\n        ? Math.max(0, selectedIndex - 1)\r\n        : Math.min(serversListDisplay.length - 1, selectedIndex + 1)\r\n\r\n      if (newIndex === selectedIndex) return\r\n\r\n      // Move server in the list\r\n      const newList = [...serversListDisplay]\r\n      const oldItem = newList[selectedIndex]\r\n      newList[selectedIndex] = newList[newIndex]\r\n      newList[newIndex] = oldItem\r\n\r\n      appStorage.serversList = newList\r\n      setSelectedIndex(newIndex)\r\n    }\r\n\r\n    document.addEventListener('keydown', handleKeyDown)\r\n    return () => document.removeEventListener('keydown', handleKeyDown)\r\n  }, [selectedIndex, serversListDisplay])\r\n\r\n  const serversListSorted = useMemo(() => serversListDisplay.map((server, index) => ({ ...server, index })), [serversListDisplay])\r\n  // by lastJoined\r\n  // const serversListSorted = useMemo(() => {\r\n  //   return serversList.map((server, index) => ({ ...server, index })).sort((a, b) => (b.lastJoined ?? 0) - (a.lastJoined ?? 0))\r\n  // }, [serversList])\r\n\r\n  const isEditScreenModal = useIsModalActive('editServer')\r\n\r\n  useUtilsEffect(({ signal }) => {\r\n    if (isEditScreenModal) return\r\n    const update = async () => {\r\n      const queue = serversListSorted\r\n        .map(server => {\r\n          if (!isServerValid(server.ip) || signal.aborted) return null\r\n\r\n          return server\r\n        })\r\n        .filter(x => x !== null)\r\n\r\n      const activeRequests = new Set<Promise<void>>()\r\n\r\n      let lastRequestStart = 0\r\n      for (const server of queue) {\r\n        // Wait if at concurrency limit\r\n        if (activeRequests.size >= MAX_CONCURRENT_REQUESTS) {\r\n          // eslint-disable-next-line no-await-in-loop\r\n          await Promise.race(activeRequests)\r\n        }\r\n\r\n        // Create and track new request\r\n        // eslint-disable-next-line @typescript-eslint/no-loop-func\r\n        const request = new Promise<void>(resolve => {\r\n          setTimeout(async () => {\r\n            try {\r\n              lastRequestStart = Date.now()\r\n              if (signal.aborted) return\r\n              const isWebSocket = server.ip.startsWith('ws://') || server.ip.startsWith('wss://')\r\n              let data\r\n              if (isWebSocket) {\r\n                const pingResult = await getServerInfo(server.ip, undefined, undefined, true)\r\n                console.log('pingResult.fullInfo.description', pingResult.fullInfo.description)\r\n                data = {\r\n                  formattedText: pingResult.fullInfo.description,\r\n                  textNameRight: `ws ${pingResult.latency}ms`,\r\n                  textNameRightGrayed: `${pingResult.fullInfo.players?.online ?? '??'}/${pingResult.fullInfo.players?.max ?? '??'}`,\r\n                  offline: false\r\n                }\r\n              } else {\r\n                data = await fetchServerStatus(server.ip, /* signal */undefined, server.versionOverride) // DONT ADD SIGNAL IT WILL CRUSH JS RUNTIME\r\n              }\r\n              if (data) {\r\n                setAdditionalServerData(old => ({\r\n                  ...old,\r\n                  [server.ip]: data\r\n                }))\r\n              }\r\n            } catch (err) {\r\n              console.warn('Failed to fetch server status', err)\r\n            } finally {\r\n              activeRequests.delete(request)\r\n              resolve()\r\n            }\r\n          }, lastRequestStart ? Math.max(0, FETCH_DELAY - (Date.now() - lastRequestStart)) : 0)\r\n        })\r\n\r\n        activeRequests.add(request)\r\n      }\r\n\r\n      await Promise.all(activeRequests)\r\n    }\r\n\r\n    void update()\r\n  }, [serversListSorted, isEditScreenModal])\r\n\r\n  useDidUpdateEffect(() => {\r\n    if (serverEditScreen && !isEditScreenModal) {\r\n      showModal({ reactType: 'editServer' })\r\n    }\r\n    if (!serverEditScreen && isEditScreenModal) {\r\n      hideCurrentModal()\r\n    }\r\n  }, [serverEditScreen])\r\n\r\n  useDidUpdateEffect(() => {\r\n    if (!isEditScreenModal) {\r\n      setServerEditScreen(null)\r\n    }\r\n  }, [isEditScreenModal])\r\n\r\n  useCopyKeybinding(() => {\r\n    const item = serversListDisplay[selectedIndex]\r\n    if (!item) return\r\n    let str = `${item.ip}`\r\n    if (item.versionOverride) {\r\n      str += `:${item.versionOverride}`\r\n    }\r\n    return str\r\n  })\r\n\r\n  const editModalJsx = isEditScreenModal ? <AddServerOrConnect\r\n    allowAutoConnect={miscUiState.appConfig?.allowAutoConnect}\r\n    placeholders={{\r\n      proxyOverride: getCurrentProxy(),\r\n      usernameOverride: getCurrentUsername(),\r\n    }}\r\n    parseQs={!serverEditScreen}\r\n    onBack={() => {\r\n      hideCurrentModal()\r\n    }}\r\n    onConfirm={(info) => {\r\n      if (!serverEditScreen) return\r\n      if (serverEditScreen === true) {\r\n        const server: StoreServerItem = { ...info, lastJoined: Date.now() } // so it appears first\r\n        appStorage.serversList = [server, ...(appStorage.serversList ?? serversListDisplay)]\r\n      } else {\r\n        const index = appStorage.serversList?.indexOf(serverEditScreen)\r\n        if (index !== undefined) {\r\n          const { lastJoined } = appStorage.serversList![index]\r\n          appStorage.serversList![index] = { ...info, lastJoined }\r\n        }\r\n      }\r\n      setServerEditScreen(null)\r\n    }}\r\n    accounts={authenticatedAccounts.map(a => a.username)}\r\n    initialData={!serverEditScreen || serverEditScreen === true ? {\r\n      ip: quickConnectIp\r\n    } : serverEditScreen}\r\n    onQsConnect={(info) => {\r\n      const connectOptions: ConnectOptions = {\r\n        username: info.usernameOverride || getCurrentUsername() || '',\r\n        server: normalizeIp(info.ip),\r\n        proxy: info.proxyOverride || getCurrentProxy(),\r\n        botVersion: info.versionOverride,\r\n        ignoreQs: true,\r\n      }\r\n      dispatchEvent(new CustomEvent('connect', { detail: connectOptions }))\r\n    }}\r\n    versions={supportedVersions}\r\n  /> : null\r\n\r\n  const serversListJsx = <ServersList\r\n    joinServer={(overridesOrIp, { shouldSave }) => {\r\n      let overrides: BaseServerInfo\r\n      if (typeof overridesOrIp === 'string') {\r\n        let msAuth = false\r\n        const parts = overridesOrIp.split(':')\r\n        if (parts.at(-1) === 'ms') {\r\n          msAuth = true\r\n          parts.pop()\r\n        }\r\n        const parsed = parseServerAddress(parts.join(':'))\r\n        overrides = {\r\n          ip: parsed.serverIpFull,\r\n          versionOverride: parsed.version,\r\n          authenticatedAccountOverride: msAuth ? true : undefined, // todo popup selector\r\n        }\r\n      } else {\r\n        overrides = overridesOrIp\r\n      }\r\n\r\n      const indexOrIp = overrides.ip\r\n      let ip = indexOrIp\r\n      let server: StoreServerItem | undefined\r\n      if (shouldSave === undefined) {\r\n        // hack: inner component doesn't know of overrides for existing servers\r\n        server = serversListSorted.find(s => s.index.toString() === indexOrIp)!\r\n        ip = server.ip\r\n        overrides = server\r\n      }\r\n\r\n      const lastJoinedUsername = serversListSorted.find(s => s.usernameOverride)?.usernameOverride\r\n      let username = overrides.usernameOverride || getCurrentUsername() || ''\r\n      if (!username) {\r\n        const promptUsername = prompt('Enter username', lastJoinedUsername || '')\r\n        if (!promptUsername) return\r\n        username = promptUsername\r\n      }\r\n      let authenticatedAccount: AuthenticatedAccount | true | undefined\r\n      if (overrides.authenticatedAccountOverride) {\r\n        if (overrides.authenticatedAccountOverride === true) {\r\n          authenticatedAccount = true\r\n        } else {\r\n          authenticatedAccount = authenticatedAccounts.find(a => a.username === overrides.authenticatedAccountOverride) ?? true\r\n        }\r\n      }\r\n      const options = {\r\n        username,\r\n        server: normalizeIp(ip),\r\n        proxy: overrides.proxyOverride || getCurrentProxy(),\r\n        botVersion: overrides.versionOverride ?? /* legacy */ overrides['version'],\r\n        ignoreQs: true,\r\n        autoLoginPassword: server?.autoLogin?.[username],\r\n        authenticatedAccount,\r\n        saveServerToHistory: shouldSave,\r\n        onSuccessfulPlay () {\r\n          if (shouldSave && !serversListDisplay.some(s => s.ip === ip)) {\r\n            const newServersList: StoreServerItem[] = [...serversListDisplay, {\r\n              ip,\r\n              lastJoined: Date.now(),\r\n              versionOverride: overrides.versionOverride,\r\n              numConnects: 1\r\n            }]\r\n            setNewServersList(newServersList)\r\n            miscUiState.loadedServerIndex = (newServersList.length - 1).toString()\r\n          }\r\n\r\n          if (shouldSave === undefined) { // loading saved\r\n            // find and update\r\n            const server = serversListDisplay.find(s => s.ip === ip)\r\n            if (server) {\r\n              // move to top\r\n              const newList = [...serversListDisplay]\r\n              const index = newList.indexOf(server)\r\n              const thisItem = newList[index]\r\n              newList.splice(index, 1)\r\n              newList.unshift(thisItem)\r\n\r\n              server.lastJoined = Date.now()\r\n              server.numConnects = (server.numConnects || 0) + 1\r\n              setNewServersList(newList)\r\n            }\r\n          }\r\n        },\r\n        serverIndex: shouldSave ? serversListDisplay.length.toString() : indexOrIp // assume last\r\n      } satisfies ConnectOptions\r\n      dispatchEvent(new CustomEvent('connect', { detail: options }))\r\n      // qsOptions\r\n    }}\r\n    lockedEditing={!!customServersList}\r\n    setQuickConnectIp={setQuickConnectIp}\r\n    onProfileClick={async () => {\r\n      const username = await showOptionsModal('Select authenticated account to remove', authenticatedAccounts.map(a => a.username))\r\n      if (!username) return\r\n      appStorage.authenticatedAccounts = authenticatedAccounts.filter(a => a.username !== username)\r\n    }}\r\n    onWorldAction={(action, index) => {\r\n      const server = serversListDisplay[index]\r\n      if (!server) return\r\n\r\n      if (action === 'edit') {\r\n        setServerEditScreen(server)\r\n      }\r\n      if (action === 'delete') {\r\n        appStorage.serversList = appStorage.serversList!.filter(s => s !== server)\r\n      }\r\n    }}\r\n    onGeneralAction={(action) => {\r\n      if (action === 'create') {\r\n        setServerEditScreen(true)\r\n      }\r\n      if (action === 'cancel') {\r\n        hideCurrentModal()\r\n      }\r\n    }}\r\n    worldData={serversListSorted.map(server => {\r\n      const additional = additionalServerData[server.ip]\r\n      return {\r\n        name: server.index.toString(),\r\n        title: server.name || server.ip,\r\n        detail: (server.versionOverride ?? '') + ' ' + (server.usernameOverride ?? ''),\r\n        formattedTextOverride: additional?.formattedText,\r\n        worldNameRight: additional?.textNameRight ?? '',\r\n        worldNameRightGrayed: additional?.textNameRightGrayed ?? '',\r\n        iconSrc: additional?.icon,\r\n        offline: additional?.offline,\r\n        group: customServersList ? 'Provided Servers' : 'Saved Servers'\r\n      }\r\n    })}\r\n    hidden={hidden}\r\n    onRowSelect={(_, i) => {\r\n      setSelectedIndex(i)\r\n    }}\r\n    selectedRow={selectedIndex}\r\n  />\r\n  return <>\r\n    {serversListJsx}\r\n    {editModalJsx}\r\n  </>\r\n}\r\n\r\nexport default () => {\r\n  const serversListQs = appQueryParams.serversList\r\n  const [customServersList, setCustomServersList] = useState<string[] | undefined>(serversListQs ? [] : undefined)\r\n\r\n  useEffect(() => {\r\n    if (serversListQs) {\r\n      if (serversListQs.startsWith('http')) {\r\n        void fetch(serversListQs).then(async r => r.text()).then((text) => {\r\n          const isJson = serversListQs.endsWith('.json') ? true : serversListQs.endsWith('.txt') ? false : text.startsWith('[')\r\n          setCustomServersList(isJson ? JSON.parse(text) : text.split('\\n').map(x => x.trim()).filter(x => x.trim().length > 0))\r\n        }).catch((err) => {\r\n          console.error(err)\r\n          alert(`Failed to get servers list file: ${err}`)\r\n        })\r\n      } else {\r\n        setCustomServersList(serversListQs.split(','))\r\n      }\r\n    }\r\n  }, [serversListQs])\r\n\r\n  const modalStack = useSnapshot(activeModalStack)\r\n  const hasServersListModal = modalStack.some(x => x.reactType === 'serversList')\r\n  const editServerModalActive = useIsModalActive('editServer')\r\n  const isServersListModalActive = useIsModalActive('serversList')\r\n\r\n  const eitherModal = isServersListModalActive || editServerModalActive\r\n  const render = eitherModal || hasServersListModal\r\n  return render ? <Inner hidden={!isServersListModalActive} customServersList={customServersList} /> : null\r\n}\r\n","import { useEffect } from 'react'\r\n\r\n// appReplacableResources\r\nimport { appReplacableResources } from '../generated/resources'\r\n\r\nexport default ({ children }): React.ReactElement => {\r\n  useEffect(() => {\r\n    if (document.getElementById('hud-vars-style')) return\r\n    // 1. Don't inline long data URLs for better DX in elements tab\r\n    // 2. Easier application to globally override icons with custom image (eg from resourcepacks)\r\n    const css = /* css */`\r\n      html {\r\n        ${Object.values(appReplacableResources).filter(r => r.cssVar).map(r => {\r\n      const repeat = r.cssVarRepeat ?? 1\r\n      return `${r.cssVar}: ${repeatArr(`url('${r.content}')`, repeat).join(', ')};`\r\n    }).join('\\n')}\r\n\r\n        --hud-bottom-max: 0px;\r\n        --hud-bottom-raw: max(env(safe-area-inset-bottom), var(--hud-bottom-max));\r\n        --safe-area-inset-bottom: calc(var(--hud-bottom-raw) / 2);\r\n      }\r\n    `\r\n    const style = document.createElement('style')\r\n    style.id = 'hud-vars-style'\r\n    style.textContent = css\r\n    document.head.appendChild(style)\r\n  }, [])\r\n\r\n  return children\r\n}\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-unnecessary-type-constraint\r\nconst repeatArr = <T extends any> (item: T, times: number): T[] => {\r\n  return Array.from({ length: times }, () => item)\r\n}\r\n","import { useEffect, useRef } from 'react'\r\nimport { focusable } from 'tabbable'\r\nimport markdownToFormattedText from '../markdownToFormattedText'\r\nimport type { ProseMirrorView } from './prosemirror-markdown'\r\nimport Button from './Button'\r\nimport 'prosemirror-view/style/prosemirror.css'\r\nimport 'prosemirror-menu/style/menu.css'\r\nimport './SignEditor.css'\r\n\r\n\r\nconst imageSource = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAMCAYAAAB4MH11AAABbElEQVR4AY3BQY6cMBBA0Q+yQZZVi+ndcJVcKGfMgegdvShKVtuokzGSWwwiUd7rfv388Vst0UgMXCobmgsSA5VaQmKgUks0EgNHji8SA9W8GJCQwVNpLhzJ4KFs4B1HEgPVvBiQkMFTaS44tYTEQDXdIkfiHbuyobmguaDPFzIWGrWExEA13SJH4h1uzS/WbPyvroM1v6jWbFRrNv7GfX5EdmXjzTvUEjJ4zjQXjiQGdmXjzTvUEjJ4HF/UEt/kQqW5UEkMzIshY08jg6dRS3yTC5XmgpsXY7pFztQSEgPNJCNv3lGpJVSfTLfImVpCYsB1HdwfxpU1G9eeNF0H94dxZc2G+/yI7MoG3vEv82LI2NNIDLyVDbzjzFE2mnkxZOy5IoNnkpFGc2FXNpp5MWTsOXJ4h1qikrGnkhjYlY1m1icy9lQSA+TCzjvUEpWMPZXEwK5suPvDOFuzcdZ1sOYX1ZqNas3GlTUbzR+jQbEAcs8ZQAAAAABJRU5ErkJggg=='\r\n\r\ntype Props = {\r\n  handleInput: (target: HTMLInputElement) => void,\r\n  ProseMirrorView: typeof ProseMirrorView,\r\n  handleClick?: (view: ResultType) => void\r\n}\r\n\r\nexport type ResultType = {\r\n  plainText: string[]\r\n} | {\r\n  dataText: string[]\r\n}\r\n\r\nexport default ({ handleInput, ProseMirrorView, handleClick }: Props) => {\r\n  const isWysiwyg = !!ProseMirrorView\r\n  const prosemirrorContainer = useRef(null)\r\n  const editorView = useRef<ProseMirrorView | null>(null)\r\n\r\n  useEffect(() => {\r\n    if (isWysiwyg) {\r\n      editorView.current = new ProseMirrorView(prosemirrorContainer.current, '')\r\n    }\r\n  }, [isWysiwyg])\r\n\r\n  return <div\r\n    className='signs-editor-container'\r\n    onKeyDown={(e) => {\r\n      // arrow down/up, Enter to navigate between lines\r\n      if (isWysiwyg) return // todo\r\n      let { code } = e\r\n      if ((e.target as HTMLElement).matches('input') && e.key === 'Enter') code = 'ArrowDown'\r\n      if (code === 'ArrowDown' || code === 'ArrowUp') {\r\n        e.preventDefault()\r\n        const dir = code === 'ArrowDown' ? 1 : -1\r\n        const elements = focusable(e.currentTarget)\r\n        const focusedElemIndex = elements.indexOf(document.activeElement as HTMLElement)\r\n        if (focusedElemIndex === -1) return\r\n        const nextElem = elements[focusedElemIndex + dir]\r\n        nextElem?.focus()\r\n      }\r\n    }}\r\n  >\r\n    <div className='signs-editor-inner-container'>\r\n      <img className='signs-editor-bg-image' src={imageSource} alt='' />\r\n      {isWysiwyg ? (\r\n        <p ref={prosemirrorContainer} className='wysiwyg-editor' />\r\n      ) : [1, 2, 3, 4].map((value, index) => {\r\n        return <input\r\n          className='sign-editor'\r\n          key={index}\r\n          data-key={index}\r\n          maxLength={15} // overriden by handleInput\r\n          onChange={(e) => {\r\n            handleInput(e.currentTarget)\r\n          }}\r\n        />\r\n      })}\r\n      <Button\r\n        onClick={async () => {\r\n          if (handleClick) {\r\n            if (isWysiwyg) {\r\n              const text = markdownToFormattedText(editorView.current!.content)\r\n              handleClick({ dataText: text })\r\n            } else {\r\n              const text = [] as string[]\r\n              for (const input of document.getElementsByClassName('sign-editor')) {\r\n                text.push((input as HTMLInputElement).value)\r\n              }\r\n              handleClick({ plainText: text })\r\n            }\r\n          }\r\n        }} className='sign-editor-button' label=\"Done\"\r\n      />\r\n    </div>\r\n  </div>\r\n}\r\n","import { useMemo, useEffect, useState, useRef } from 'react'\r\nimport { showModal, hideModal } from '../globalState'\r\nimport { options } from '../optionsStorage'\r\nimport { useIsModalActive } from './utilsApp'\r\nimport SignEditor, { ResultType } from './SignEditor'\r\n\r\n\r\nconst isWysiwyg = async () => {\r\n  const items = await bot.tabComplete('/data ', true, true)\r\n  const commands = new Set<string>(['merge'])\r\n  for (const item of items) {\r\n    if (commands.has((item.match ?? item) as unknown as string)) {\r\n      return true\r\n    }\r\n  }\r\n  return false\r\n}\r\n\r\nexport default () => {\r\n  const [location, setLocation] = useState<{ x: number, y: number, z: number } | null>(null)\r\n  const [isFrontText, setIsFrontText] = useState(true)\r\n  const text = useRef<string[]>(['', '', '', ''])\r\n  const [enableWysiwyg, setEnableWysiwyg] = useState(false)\r\n  const isModalActive = useIsModalActive('signs-editor-screen')\r\n  const [proseMirrorView, setProseMirrorView] = useState(null as any)\r\n\r\n  const handleClick = (result: ResultType) => {\r\n    hideModal({ reactType: 'signs-editor-screen' })\r\n    if ('plainText' in result) {\r\n      bot._client.write('update_sign', {\r\n        location,\r\n        isFrontText,\r\n        text1: result.plainText[0],\r\n        text2: result.plainText[1],\r\n        text3: result.plainText[2],\r\n        text4: result.plainText[3]\r\n      })\r\n    } else {\r\n      if (!location) return\r\n      const command = `/data merge block ${location.x} ${location.y} ${location.z} {Text1:'` + JSON.stringify(result.dataText[0]) + '\\',Text2: \\'' + JSON.stringify(result.dataText[1]) + '\\',Text3:\\'' + JSON.stringify(result.dataText[2]) + '\\',Text4:\\'' + JSON.stringify(result.dataText[3]) + '\\'}' // mojangson\r\n      bot.chat(command)\r\n    }\r\n  }\r\n\r\n  const handleInput = (target: HTMLInputElement) => {\r\n    const smallSymbols = /[()[\\]{} ]/\r\n    const largeSymbols = /[;|',.]/\r\n    let addLength = 0\r\n    for (const letter of target.value) {\r\n      if (smallSymbols.test(letter)) {\r\n        addLength += 1 - 1 / 1.46\r\n      } else if (largeSymbols.test(letter)) {\r\n        addLength += 1 - 1 / 3\r\n      }\r\n    }\r\n    text.current[Number(target.dataset.key)] = target.value\r\n    target.setAttribute('maxlength', `${15 + Math.ceil(addLength)}`)\r\n  }\r\n\r\n  useMemo(() => {\r\n    bot._client.on('open_sign_entity', (packet) => {\r\n      if (!options.autoSignEditor) return\r\n      setIsFrontText((packet as any).isFrontText ?? true)\r\n      setLocation(prev => packet.location)\r\n      showModal({ reactType: 'signs-editor-screen' })\r\n      if (options.wysiwygSignEditor === 'auto') {\r\n        void isWysiwyg().then((value) => {\r\n          setEnableWysiwyg(value)\r\n        })\r\n      } else if (options.wysiwygSignEditor === 'always') {\r\n        setEnableWysiwyg(true)\r\n      } else {\r\n        setEnableWysiwyg(false)\r\n      }\r\n    })\r\n\r\n    if (!process.env.SINGLE_FILE_BUILD) {\r\n      void import('./prosemirror-markdown').then(({ ProseMirrorView }) => {\r\n        setProseMirrorView(() => ProseMirrorView)\r\n      })\r\n    }\r\n  }, [])\r\n\r\n  if (!isModalActive) return null\r\n  return <SignEditor ProseMirrorView={enableWysiwyg ? proseMirrorView : undefined} handleInput={handleInput} handleClick={handleClick} />\r\n}\r\n","import { useState } from 'react'\r\nimport { useUtilsEffect } from '@zardoy/react-util'\r\nimport { QRCodeSVG } from 'qrcode.react'\r\nimport PixelartIcon, { pixelartIcons } from './PixelartIcon'\r\nimport Screen from './Screen'\r\nimport Button from './Button'\r\n\r\nexport default ({\r\n  code = 'ABCD-EFGH-IJKL-MNOP',\r\n  loginLink = 'https://aka.ms/devicelogin',\r\n  connectingServer = 'mc.example.comsdlfjsklfjsfjdskfjsj',\r\n  expiresEnd = Date.now() + 1000 * 60 * 5,\r\n  setSaveToken = (() => { }) as ((state: boolean) => void) | undefined,\r\n  defaultSaveToken = true,\r\n  onCancel = () => { },\r\n  directLink = 'https://aka.ms/devicelogin'\r\n}) => {\r\n  if (connectingServer.length > 30) connectingServer = connectingServer.slice(0, 30) + '...'\r\n  const [timeLeft, setTimeLeft] = useState(``)\r\n\r\n  useUtilsEffect(({ interval }) => {\r\n    interval(1000, () => {\r\n      const timeLeft = Math.max(0, Math.ceil((expiresEnd - Date.now()) / 1000))\r\n      const minutes = Math.floor(timeLeft / 60)\r\n      const seconds = timeLeft % 60\r\n      setTimeLeft(`${minutes}:${seconds.toString().padStart(2, '0')}`)\r\n      if (timeLeft <= 0) setTimeLeft('Code expired!')\r\n    })\r\n  }, [])\r\n\r\n  return <Screen title='Microsoft Account Authentication' titleMarginTop={5}>\r\n    <div style={{\r\n      background: 'white',\r\n      padding: '20px 18px',\r\n      width: 300,\r\n      maxHeight: 240,\r\n      color: 'black',\r\n      // borderRadius: 8,\r\n    }}\r\n    >\r\n      <div style={{\r\n        // fontFamily: 'monospace',\r\n        fontSize: 18,\r\n        padding: '5px 10px',\r\n        paddingBottom: 1,\r\n        backgroundColor: 'lightgray',\r\n        textAlign: 'center',\r\n        marginTop: -5,\r\n        userSelect: 'all',\r\n      }}\r\n      >{code}\r\n      </div>\r\n      <div style={{\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        fontSize: 12,\r\n      }}\r\n      >\r\n        Waiting... <PixelartIcon iconName='clock' /> {timeLeft}\r\n      </div>\r\n      <div style={{\r\n        fontSize: 12,\r\n        marginTop: 10,\r\n      }}\r\n      >\r\n        To join a Minecraft server {connectingServer} using your Microsoft account, you need to visit{' '}\r\n        <a\r\n          href={directLink}\r\n          style={{\r\n            color: 'black',\r\n            textDecoration: 'underline',\r\n            fontWeight: 600,\r\n          }}\r\n          target='_blank'\r\n        >Direct Link\r\n        </a>\r\n        {' '} or {' '}\r\n        <a\r\n          href={loginLink}\r\n          style={{\r\n            color: 'black',\r\n            textDecoration: 'underline',\r\n            fontWeight: 600,\r\n          }}\r\n          target='_blank'\r\n        >{loginLink.replace(/(https?:\\/\\/)?(www\\.)?/, '')}\r\n        </a>\r\n        {' '}\r\n        and enter the code above.\r\n      </div>\r\n      <div style={{\r\n        fontSize: 11,\r\n        marginTop: 5,\r\n        color: 'gray',\r\n        display: 'flex',\r\n        gap: 2\r\n      }}\r\n      >\r\n        <div>\r\n          <PixelartIcon iconName={pixelartIcons.alert} styles={{ display: 'inline-block', }} />\r\n          Join only <b>vanilla servers</b>! This client is detectable and may result in a ban by anti-cheat plugins.\r\n        </div>\r\n        <QRCodeSVG size={40} value={directLink} style={{ display: 'block', flexShrink: 0 }} color='gray' />\r\n      </div>\r\n      {setSaveToken && <label style={{\r\n        fontSize: 12,\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        gap: 5,\r\n        marginTop: 4,\r\n      }}\r\n      >\r\n        <input type='checkbox' defaultChecked={defaultSaveToken} onChange={e => setSaveToken(e.target.checked)} />{' '}\r\n        Save account token in this browser\r\n      </label>}\r\n    </div>\r\n    <Button\r\n      style={{\r\n        marginTop: -5,\r\n      }}\r\n      onClick={onCancel}\r\n    >Cancel\r\n    </Button>\r\n  </Screen>\r\n}\r\n","import { proxy, ref, useSnapshot } from 'valtio'\r\nimport SignInMessage from './SignInMessage'\r\nimport { lastConnectOptions } from './AppStatusProvider'\r\nimport { useIsModalActive } from './utilsApp'\r\n\r\nexport const signInMessageState = proxy({\r\n  code: '',\r\n  link: '',\r\n  expiresOn: 0,\r\n  shouldSaveToken: true,\r\n  abortController: ref(new AbortController()),\r\n})\r\n\r\nexport default () => {\r\n  const { code, expiresOn, link, shouldSaveToken } = useSnapshot(signInMessageState)\r\n  const signInTestModal = useIsModalActive('sign-in-test')\r\n\r\n  if (!code && !signInTestModal) return null\r\n\r\n  return <SignInMessage\r\n    code={code}\r\n    expiresEnd={expiresOn}\r\n    loginLink={link}\r\n    defaultSaveToken={shouldSaveToken}\r\n    setSaveToken={(state) => {\r\n      signInMessageState.shouldSaveToken = state\r\n    }}\r\n    connectingServer={lastConnectOptions.value?.server ?? ''}\r\n    onCancel={() => {\r\n      signInMessageState.abortController.abort()\r\n    }}\r\n    directLink={`http://microsoft.com/link?otc=${code}`}\r\n  />\r\n}\r\n","import classNames from 'classnames'\r\nimport React, { Fragment, useEffect, useMemo, useRef, useState } from 'react'\r\n\r\n// todo optimize size\r\nimport missingWorldPreview from 'mc-assets/dist/other-textures/latest/gui/presets/isles.png'\r\nimport { filesize } from 'filesize'\r\nimport useTypedEventListener from 'use-typed-event-listener'\r\nimport { focusable } from 'tabbable'\r\nimport styles from './singleplayer.module.css'\r\nimport Input from './Input'\r\nimport Button from './Button'\r\nimport Tabs from './Tabs'\r\nimport MessageFormattedString from './MessageFormattedString'\r\nimport { useIsSmallWidth } from './simpleHooks'\r\nimport PixelartIcon from './PixelartIcon'\r\n\r\nexport interface WorldProps {\r\n  name: string\r\n  title: string\r\n  size?: number\r\n  lastPlayed?: number\r\n  isFocused?: boolean\r\n  iconSrc?: string\r\n  detail?: string\r\n  formattedTextOverride?: string\r\n  worldNameRight?: string\r\n  worldNameRightGrayed?: string\r\n  onFocus?: (name: string) => void\r\n  onInteraction?(interaction: 'enter' | 'space')\r\n  elemRef?: React.Ref<HTMLDivElement>\r\n  offline?: boolean\r\n  group?: string\r\n}\r\n\r\nconst GroupHeader = ({ name, count, expanded, onToggle }: { name: string, count: number, expanded: boolean, onToggle: () => void }) => {\r\n  return <div\r\n    className={styles.world_root}\r\n    style={{ background: 'none', cursor: 'pointer', height: 'auto', fontSize: '8px' }}\r\n    onClick={onToggle}\r\n  >\r\n    <div style={{ display: 'flex', alignItems: 'center', gap: '4px', color: '#bcbcbc' }}>\r\n      <span>{expanded ? '' : ''}</span>\r\n      <span>{name}</span>\r\n      <span>({count})</span>\r\n    </div>\r\n  </div>\r\n}\r\n\r\nconst World = ({ name, isFocused, title, lastPlayed, size, detail = '', onFocus, onInteraction, iconSrc, formattedTextOverride, worldNameRight, worldNameRightGrayed, elemRef, offline }: WorldProps & { ref?: React.Ref<HTMLDivElement> }) => {\r\n  const timeRelativeFormatted = useMemo(() => {\r\n    if (!lastPlayed) return ''\r\n    const formatter = new Intl.RelativeTimeFormat('en', { numeric: 'auto' })\r\n    const diff = Date.now() - lastPlayed\r\n    const minutes = Math.floor(diff / 1000 / 60)\r\n    const hours = Math.floor(minutes / 60)\r\n    const days = Math.floor(hours / 24)\r\n    // const weeks = Math.floor(days / 7)\r\n    // const months = Math.floor(days / 30)\r\n    if (days > 0) return formatter.format(-days, 'day')\r\n    if (hours > 0) return formatter.format(-hours, 'hour')\r\n    return formatter.format(-minutes, 'minute')\r\n  }, [lastPlayed])\r\n  const sizeFormatted = useMemo(() => {\r\n    if (!size) return ''\r\n    return filesize(size)\r\n  }, [size])\r\n\r\n  return <div\r\n    ref={elemRef}\r\n    className={classNames(styles.world_root, isFocused ? styles.world_focused : undefined)} tabIndex={0} onFocus={() => onFocus?.(name)} onKeyDown={(e) => {\r\n      if (e.code === 'Enter' || e.code === 'Space') {\r\n        e.preventDefault()\r\n        onInteraction?.(e.code === 'Enter' ? 'enter' : 'space')\r\n      }\r\n    }} onDoubleClick={() => onInteraction?.('enter')}\r\n  >\r\n    <img className={`${styles.world_image} ${iconSrc ? '' : styles.image_missing}`} src={iconSrc ?? missingWorldPreview} alt='world preview' />\r\n    <div className={styles.world_info}>\r\n      <div className={styles.world_title}>\r\n        <div>{title}</div>\r\n        <div className={styles.world_title_right}>\r\n          {worldNameRightGrayed && <span style={{ color: '#878787', fontSize: 8 }}>{worldNameRightGrayed}</span>}\r\n          {offline ? (\r\n            <span style={{ color: 'red', display: 'flex', alignItems: 'center', gap: 4 }}>\r\n              <PixelartIcon iconName=\"signal-off\" width={12} />\r\n              Offline\r\n            </span>\r\n          ) : worldNameRight?.startsWith('ws') ? (\r\n            <span style={{ display: 'flex', alignItems: 'center', gap: 4 }}>\r\n              <PixelartIcon iconName=\"cellular-signal-3\" width={12} />\r\n              {worldNameRight.slice(3)}\r\n            </span>\r\n          ) : worldNameRight}\r\n        </div>\r\n      </div>\r\n      {formattedTextOverride ? <div className={styles.world_info_formatted}>\r\n        <MessageFormattedString message={formattedTextOverride} />\r\n      </div> :\r\n        <>\r\n          <div className={styles.world_info_description_line}>{timeRelativeFormatted} {detail.slice(-30)}</div>\r\n          <div className={styles.world_info_description_line}>{sizeFormatted}</div>\r\n        </>}\r\n    </div>\r\n  </div>\r\n}\r\n\r\ninterface Props {\r\n  worldData: WorldProps[] | null // null means loading\r\n  serversLayout?: boolean\r\n  firstRowChildrenOverride?: React.ReactNode\r\n  searchRowChildrenOverride?: React.ReactNode\r\n  providers?: Record<string, string>\r\n  activeProvider?: string\r\n  setActiveProvider?: (provider: string) => void\r\n  providerActions?: Record<string, (() => void) | undefined | JSX.Element>\r\n  disabledProviders?: string[]\r\n  isReadonly?: boolean\r\n  error?: string\r\n  warning?: string\r\n  warningAction?: () => void\r\n  warningActionLabel?: string\r\n  hidden?: boolean\r\n\r\n  onWorldAction (action: 'load' | 'export' | 'delete' | 'edit', worldName: string): void\r\n  onGeneralAction (action: 'cancel' | 'create'): void\r\n  onRowSelect? (name: string, index: number): void\r\n  defaultSelectedRow?: number\r\n  selectedRow?: number\r\n  listStyle?: React.CSSProperties\r\n  setListHovered?: (hovered: boolean) => void\r\n  secondRowStyles?: React.CSSProperties\r\n  lockedEditing?: boolean\r\n}\r\n\r\nexport default ({\r\n  worldData,\r\n  onGeneralAction,\r\n  onWorldAction,\r\n  firstRowChildrenOverride,\r\n  serversLayout,\r\n  searchRowChildrenOverride,\r\n  activeProvider,\r\n  setActiveProvider,\r\n  providerActions,\r\n  providers = {},\r\n  disabledProviders,\r\n  error,\r\n  isReadonly,\r\n  warning, warningAction, warningActionLabel,\r\n  hidden,\r\n  onRowSelect,\r\n  defaultSelectedRow,\r\n  selectedRow,\r\n  listStyle,\r\n  setListHovered,\r\n  secondRowStyles,\r\n  lockedEditing\r\n}: Props) => {\r\n  const containerRef = useRef<any>()\r\n  const firstButton = useRef<HTMLButtonElement>(null)\r\n  const worldRefs = useRef<Record<string, HTMLDivElement | null>>({})\r\n\r\n  useTypedEventListener(window, 'keydown', (e) => {\r\n    if ((e.code === 'ArrowDown' || e.code === 'ArrowUp')) {\r\n      e.preventDefault()\r\n      const dir = e.code === 'ArrowDown' ? 1 : -1\r\n      const elements = focusable(containerRef.current)\r\n      const focusedElemIndex = elements.indexOf(document.activeElement as HTMLElement)\r\n      if (focusedElemIndex === -1) return\r\n      const nextElem = elements[focusedElemIndex + dir]\r\n      nextElem?.focus()\r\n    }\r\n  })\r\n\r\n  const [search, setSearch] = useState('')\r\n  const [focusedWorld, setFocusedWorld] = useState(defaultSelectedRow === undefined ? '' : worldData?.[defaultSelectedRow]?.name ?? '')\r\n  const [expandedGroups, setExpandedGroups] = useState<Record<string, boolean>>({})\r\n\r\n  useEffect(() => {\r\n    setFocusedWorld('')\r\n  }, [activeProvider])\r\n\r\n  useEffect(() => {\r\n    if (selectedRow === undefined) return\r\n    const worldName = worldData?.[selectedRow]?.name\r\n    setFocusedWorld(worldName ?? '')\r\n    if (worldName) {\r\n      worldRefs.current[worldName]?.focus()\r\n    }\r\n  }, [selectedRow, worldData?.[selectedRow as any]?.name])\r\n\r\n  const onRowSelectHandler = (name: string, index: number) => {\r\n    onRowSelect?.(name, index)\r\n    setFocusedWorld(name)\r\n  }\r\n  const isSmallWidth = useIsSmallWidth()\r\n\r\n  const toggleGroup = (groupName: string) => {\r\n    setExpandedGroups(prev => ({\r\n      ...prev,\r\n      [groupName]: prev[groupName] === undefined ? false : !prev[groupName]\r\n    }))\r\n  }\r\n\r\n  return <div ref={containerRef} hidden={hidden}>\r\n    <div className=\"dirt-bg\" />\r\n    <div className={classNames('fullscreen', styles.root)}>\r\n      <span className={classNames('screen-title', styles.title)}>{serversLayout ? 'Join Java Servers' : 'Select Saved World'}</span>\r\n      {searchRowChildrenOverride || <div style={{ display: 'flex', flexDirection: 'column' }}>\r\n        <Input autoFocus value={search} onChange={({ target: { value } }) => setSearch(value)} />\r\n      </div>}\r\n      <div className={classNames(styles.content, !worldData && styles.content_loading)}>\r\n        <Tabs\r\n          tabs={Object.keys(providers)} disabledTabs={disabledProviders} activeTab={activeProvider ?? ''} labels={providers} onTabChange={(tab) => {\r\n            setActiveProvider?.(tab as any)\r\n          }} fullSize\r\n        />\r\n        <div\r\n          style={{\r\n            marginTop: 3,\r\n            ...listStyle\r\n          }}\r\n          onMouseEnter={() => setListHovered?.(true)}\r\n          onMouseLeave={() => setListHovered?.(false)}\r\n        >\r\n          {\r\n            providerActions && <div style={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              // overflow: 'auto',\r\n            }}\r\n            >\r\n              <span style={{ fontSize: 9, marginRight: 3 }}>Actions: </span> {Object.entries(providerActions).map(([label, action]) => (\r\n                typeof action === 'function' ? <Button key={label} onClick={action} style={{ width: 100 }}>{label}</Button> : <Fragment key={label}>{action}</Fragment>\r\n              ))}\r\n            </div>\r\n          }\r\n          {\r\n            worldData\r\n              ? (() => {\r\n                const filtered = worldData.filter(data => data.title.toLowerCase().includes(search.toLowerCase()))\r\n                const groups = filtered.reduce<Record<string, WorldProps[]>>((acc, world) => {\r\n                  const group = world.group || ''\r\n                  if (!acc[group]) acc[group] = []\r\n                  acc[group].push(world)\r\n                  return acc\r\n                }, {})\r\n\r\n                return Object.entries(groups).map(([groupName, worlds]) => (\r\n                  <React.Fragment key={groupName}>\r\n                    <GroupHeader\r\n                      name={groupName}\r\n                      count={worlds.length}\r\n                      expanded={expandedGroups[groupName] ?? true}\r\n                      onToggle={() => toggleGroup(groupName)}\r\n                    />\r\n                    {(expandedGroups[groupName] ?? true) && worlds.map(({ name, size, detail, ...rest }, index) => (\r\n                      <World\r\n                        {...rest}\r\n                        size={size}\r\n                        name={name}\r\n                        elemRef={el => { worldRefs.current[name] = el }}\r\n                        onFocus={row => onRowSelectHandler(row, index)}\r\n                        isFocused={focusedWorld === name}\r\n                        key={name}\r\n                        onInteraction={(interaction) => {\r\n                          if (interaction === 'enter') onWorldAction('load', name)\r\n                          else if (interaction === 'space') firstButton.current?.focus()\r\n                        }}\r\n                        detail={detail}\r\n                      />\r\n                    ))}\r\n                  </React.Fragment>\r\n                ))\r\n              })()\r\n              : <div style={{\r\n                fontSize: 10,\r\n                color: error ? 'red' : 'lightgray',\r\n              }}>{error || 'Loading (check #dev console if loading too long)...'}\r\n              </div>\r\n          }\r\n          {\r\n            warning && <div style={{\r\n              fontSize: 8,\r\n              color: '#ffa500ba',\r\n              marginTop: 5,\r\n              textAlign: 'center',\r\n            }}\r\n            >\r\n              {warning} {warningAction && <a onClick={warningAction}>{warningActionLabel}</a>}\r\n            </div>\r\n          }\r\n        </div>\r\n      </div>\r\n      <div style={{ display: 'flex', flexDirection: 'column', minWidth: 400, paddingBottom: 3, alignItems: 'center', }}>\r\n        {firstRowChildrenOverride || <div>\r\n          <Button rootRef={firstButton} disabled={!focusedWorld} onClick={() => onWorldAction('load', focusedWorld)}>Load World</Button>\r\n          <Button onClick={() => onGeneralAction('create')} disabled={isReadonly}>Create New World</Button>\r\n        </div>}\r\n        <div style={{\r\n          ...secondRowStyles,\r\n          ...isSmallWidth ? { display: 'grid', gridTemplateColumns: '1fr 1fr' } : {}\r\n        }}>\r\n          {serversLayout ? <Button style={{ width: 100 }} disabled={!focusedWorld || lockedEditing} onClick={() => onWorldAction('edit', focusedWorld)}>Edit</Button> : <Button style={{ width: 100 }} disabled={!focusedWorld} onClick={() => onWorldAction('export', focusedWorld)}>Export</Button>}\r\n          <Button style={{ width: 100 }} disabled={!focusedWorld || lockedEditing} onClick={() => onWorldAction('delete', focusedWorld)}>Delete</Button>\r\n          {serversLayout ?\r\n            <Button style={{ width: 100 }} onClick={() => onGeneralAction('create')} disabled={lockedEditing}>Add</Button> :\r\n            <Button style={{ width: 100 }} onClick={() => onWorldAction('edit', focusedWorld)} disabled>Edit</Button>}\r\n          <Button style={{ width: 100 }} onClick={() => onGeneralAction('cancel')}>Cancel</Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n}\r\n","import fs from 'fs'\r\nimport { proxy, subscribe, useSnapshot } from 'valtio'\r\nimport { useEffect, useRef, useState } from 'react'\r\nimport { loadScript } from 'renderer/viewer/lib/utils'\r\nimport { fsState, loadSave, longArrayToNumber, readLevelDat } from '../loadSave'\r\nimport { googleDriveGetFileIdFromPath, mountExportFolder, mountGoogleDriveFolder, removeFileRecursiveAsync } from '../browserfs'\r\nimport { hideCurrentModal, showModal } from '../globalState'\r\nimport { haveDirectoryPicker } from '../utils'\r\nimport { setLoadingScreenStatus } from '../appStatus'\r\nimport { exportWorld } from '../builtinCommands'\r\nimport { googleProviderState, useGoogleLogIn, GoogleDriveProvider, isGoogleDriveAvailable, APP_ID } from '../googledrive'\r\nimport Singleplayer, { WorldProps } from './Singleplayer'\r\nimport { useIsModalActive } from './utilsApp'\r\nimport { showOptionsModal } from './SelectOption'\r\nimport Input from './Input'\r\nimport GoogleButton from './GoogleButton'\r\n\r\nconst worldsProxy = proxy({\r\n  value: null as null | WorldProps[],\r\n  brokenWorlds: [] as string[],\r\n  selectedProvider: 'local' as 'local' | 'google',\r\n  selectedGoogleId: '',\r\n  error: '',\r\n})\r\n\r\nexport const getWorldsPath = () => {\r\n  return worldsProxy.selectedProvider === 'local' ? `/data/worlds` : worldsProxy.selectedProvider === 'google' ? `/google/${'/'.replace(/\\/$/, '')}` : ''\r\n}\r\n\r\nconst providersEnableFeatures = {\r\n  local: {\r\n    calculateSize: true,\r\n    delete: true,\r\n    export: true,\r\n    icon: true\r\n  },\r\n  google: {\r\n    calculateSize: false,\r\n    // TODO\r\n    delete: false,\r\n    export: false,\r\n    icon: true\r\n  }\r\n}\r\n\r\nexport const readWorlds = (abortController: AbortController) => {\r\n  if (abortController.signal.aborted) return\r\n  worldsProxy.error = ''\r\n  worldsProxy.brokenWorlds = [];\r\n  (async () => {\r\n    const brokenWorlds = [] as string[]\r\n    try {\r\n      const loggedIn = !!googleProviderState.accessToken\r\n      worldsProxy.value = null\r\n      if (worldsProxy.selectedProvider === 'google' && !loggedIn) {\r\n        worldsProxy.value = []\r\n        return\r\n      }\r\n      const worldsPath = getWorldsPath()\r\n      const provider = worldsProxy.selectedProvider\r\n\r\n      const worlds = await fs.promises.readdir(worldsPath)\r\n\r\n      const newMappedWorlds = (await Promise.allSettled(worlds.map(async (folder) => {\r\n        const { levelDat } = (await readLevelDat(`${worldsPath}/${folder}`))!\r\n        const levelDatStat = await fs.promises.stat(`${worldsPath}/${folder}/level.dat`)\r\n        let size = 0\r\n        if (providersEnableFeatures[provider].calculateSize) {\r\n          // todo use whole dir size\r\n          for (const region of await fs.promises.readdir(`${worldsPath}/${folder}/region`)) {\r\n            // eslint-disable-next-line no-await-in-loop -- it's still fast enough, nobody complains about it\r\n            const stat = await fs.promises.stat(`${worldsPath}/${folder}/region/${region}`)\r\n            size += stat.size\r\n          }\r\n        }\r\n        let iconBase64 = ''\r\n        if (providersEnableFeatures[provider].icon) {\r\n          const iconPath = `${worldsPath}/${folder}/icon.png`\r\n          try {\r\n            iconBase64 = await fs.promises.readFile(iconPath, 'base64')\r\n          } catch {\r\n            // ignore\r\n          }\r\n        }\r\n        const levelName = levelDat.LevelName as string | undefined\r\n        return {\r\n          name: folder,\r\n          title: levelName ?? folder,\r\n          lastPlayed: levelDat.LastPlayed && longArrayToNumber(levelDat.LastPlayed),\r\n          detail: `${levelDat.Version?.Name ?? 'unknown version'}, ${folder}`,\r\n          iconSrc: iconBase64 ? `data:image/png;base64,${iconBase64}` : undefined,\r\n          size,\r\n          lastModified: levelDatStat.mtimeMs,\r\n          group: 'IndexedDB Memory Worlds'\r\n        } satisfies WorldProps & { lastModified?: number }\r\n      }))).filter((x, i) => {\r\n        if (x.status === 'rejected') {\r\n          console.warn(x.reason)\r\n          brokenWorlds.push(worlds[i])\r\n          return false\r\n        }\r\n        return true\r\n      }).map(x => (x as Extract<typeof x, { value }>).value).sort((a, b) => {\r\n        const getScore = (x: typeof a) => {\r\n          return x.lastModified ?? 0\r\n        }\r\n        return getScore(b) - getScore(a)\r\n      })\r\n      if (abortController.signal.aborted) return\r\n      worldsProxy.value = newMappedWorlds\r\n    } catch (err) {\r\n      if (err.name === 'AbortError') return\r\n      console.warn(err)\r\n      worldsProxy.value = null\r\n      worldsProxy.error = err.message\r\n    }\r\n    worldsProxy.brokenWorlds = brokenWorlds\r\n  })().catch((err) => {\r\n    // todo it still doesn't work for some reason!\r\n    worldsProxy.error = err.message\r\n  })\r\n}\r\n\r\nexport const loadInMemorySave = async (worldPath: string) => {\r\n  fsState.saveLoaded = false\r\n  fsState.isReadonly = false\r\n  fsState.syncFs = false\r\n  fsState.inMemorySave = true\r\n  await loadSave(worldPath)\r\n}\r\n\r\nexport default () => {\r\n  const active = useIsModalActive('singleplayer')\r\n\r\n  if (!active) return null\r\n\r\n  return <GoogleDriveProvider>\r\n    <Inner />\r\n  </GoogleDriveProvider>\r\n}\r\n\r\nexport const loadGoogleDriveApi = async () => {\r\n  const scriptEl = await loadScript('https://apis.google.com/js/api.js')\r\n  if (!scriptEl) return // already loaded\r\n  return new Promise<void>((resolve) => {\r\n    gapi.load('client', () => {\r\n      gapi.load('client:picker', () => {\r\n        void gapi.client.load('https://www.googleapis.com/discovery/v1/apis/drive/v3/rest').then(() => {\r\n          googleProviderState.isReady = true\r\n          resolve()\r\n        })\r\n      })\r\n    })\r\n  })\r\n}\r\n\r\nconst Inner = () => {\r\n  const worlds = useSnapshot(worldsProxy).value as WorldProps[] | null\r\n  const { selectedProvider, error, brokenWorlds, selectedGoogleId } = useSnapshot(worldsProxy)\r\n  const readWorldsAbortController = useRef(new AbortController())\r\n\r\n  // 3rd party providers\r\n  useEffect(() => {\r\n    if (selectedProvider !== 'google') return\r\n    void loadGoogleDriveApi()\r\n  }, [selectedProvider])\r\n\r\n  const loggedIn = !!useSnapshot(googleProviderState).accessToken\r\n  const googleDriveReadonly = useSnapshot(googleProviderState).readonlyMode\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      if (selectedProvider === 'google') {\r\n        if (!selectedGoogleId) {\r\n          worldsProxy.value = []\r\n          return\r\n        }\r\n        await mountGoogleDriveFolder(googleProviderState.readonlyMode, selectedGoogleId)\r\n        const exists = async (path) => {\r\n          try {\r\n            await fs.promises.stat(path)\r\n            return true\r\n          } catch {\r\n            return false\r\n          }\r\n        }\r\n        if (await exists(`${getWorldsPath()}/level.dat`)) {\r\n          await loadInMemorySave(getWorldsPath())\r\n          return\r\n        }\r\n      }\r\n      if (selectedProvider === 'local' && !(await fs.promises.stat('/data/worlds').catch(() => false))) {\r\n        await fs.promises.mkdir('/data/worlds')\r\n      }\r\n      readWorlds(readWorldsAbortController.current)\r\n    })()\r\n\r\n    return () => {\r\n      readWorldsAbortController.current.abort()\r\n      readWorldsAbortController.current = new AbortController()\r\n    }\r\n  }, [selectedProvider, loggedIn, googleDriveReadonly, selectedGoogleId])\r\n\r\n  const googleLogIn = useGoogleLogIn()\r\n\r\n  const googlePicker = useRef/* <google.picker.Picker | null> */(null as any)\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      googlePicker.current?.dispose()\r\n    }\r\n  })\r\n\r\n  const selectGoogleFolder = async () => {\r\n    if (googleProviderState.lastSelectedFolder) {\r\n      // ask to use saved previous fodler\r\n      const choice = await showOptionsModal(`Use previously selected folder \"${googleProviderState.lastSelectedFolder.name}\"?`, ['Yes', 'No'])\r\n      if (!choice) return\r\n      if (choice === 'Yes') {\r\n        worldsProxy.selectedGoogleId = googleProviderState.lastSelectedFolder.id\r\n        return\r\n      }\r\n    }\r\n\r\n    const { google } = window\r\n\r\n    const view = new google.picker.DocsView(google.picker.ViewId.FOLDERS)\r\n      .setIncludeFolders(true)\r\n      .setMimeTypes('application/vnd.google-apps.folder')\r\n      .setSelectFolderEnabled(true)\r\n      .setParent('root')\r\n\r\n\r\n    googlePicker.current = new google.picker.PickerBuilder()\r\n      .enableFeature(google.picker.Feature.NAV_HIDDEN)\r\n      .enableFeature(google.picker.Feature.MULTISELECT_ENABLED)\r\n      .setDeveloperKey('AIzaSyBTiHpEqaLL7mEcrsnSS4M-z8cpRH5UwY0')\r\n      .setAppId(APP_ID)\r\n      .setOAuthToken(googleProviderState.accessToken)\r\n      .addView(view)\r\n      .addView(new google.picker.DocsUploadView())\r\n      .setTitle('Select a folder with your worlds')\r\n      .setCallback((data) => {\r\n        if (data.action === google.picker.Action.PICKED) {\r\n          googleProviderState.lastSelectedFolder = {\r\n            id: data.docs[0].id,\r\n            name: data.docs[0].name,\r\n          }\r\n          worldsProxy.selectedGoogleId = data.docs[0].id\r\n        }\r\n      })\r\n      .build()\r\n    googlePicker.current.setVisible(true)\r\n  }\r\n\r\n  const isGoogleProviderReady = useSnapshot(googleProviderState).isReady\r\n  const providerActions = loggedIn && selectedProvider === 'google' && isGoogleProviderReady && !selectedGoogleId ? {\r\n    'Select Folder': selectGoogleFolder\r\n  } : selectedProvider === 'google' ? isGoogleProviderReady ? loggedIn ? {\r\n    'Log Out' () {\r\n      googleProviderState.hasEverLoggedIn = false\r\n      googleProviderState.accessToken = null\r\n      googleProviderState.lastSelectedFolder = null\r\n      window.google.accounts.oauth2.revoke(googleProviderState.accessToken)\r\n    },\r\n    async [`Read Only: ${googleDriveReadonly ? 'ON' : 'OFF'}`] () {\r\n      if (googleProviderState.readonlyMode) {\r\n        const choice = await showOptionsModal('[Unstable Feature] Enabling world save might corrupt your worlds, eg remove entities (note: you can always restore previous version of files in Drive)', ['Continue'])\r\n        if (choice !== 'Continue') return\r\n      }\r\n      googleProviderState.readonlyMode = !googleProviderState.readonlyMode\r\n    },\r\n    'Select Folder': selectGoogleFolder,\r\n    // 'Worlds Path': <Input rootStyles={{ width: 100 }} placeholder='Worlds path' defaultValue={worldsPath} onBlur={(e) => {\r\n    //   googleProviderData.worldsPath = e.target.value\r\n    // }} />\r\n  } : {\r\n    'Log In': <GoogleButton onClick={googleLogIn} />\r\n  } : {\r\n    'Loading...' () { }\r\n  } : undefined\r\n  // end\r\n\r\n  return <Singleplayer\r\n    error={error}\r\n    isReadonly={selectedProvider === 'google' && (googleDriveReadonly || !isGoogleProviderReady || !selectedGoogleId)}\r\n    // providers={{\r\n    //   local: 'Local',\r\n    //   google: 'Google Drive',\r\n    // }}\r\n    disabledProviders={[...isGoogleDriveAvailable() ? [] : ['google']]}\r\n    worldData={worlds}\r\n    providerActions={providerActions}\r\n    activeProvider={selectedProvider}\r\n    setActiveProvider={(provider) => {\r\n      worldsProxy.selectedProvider = provider as any\r\n    }}\r\n    warning={brokenWorlds.length ? `Some worlds are broken: ${brokenWorlds.join(', ')}` : undefined}\r\n    warningAction={async () => {\r\n      for (const brokenWorld of worldsProxy.brokenWorlds) {\r\n        setLoadingScreenStatus(`Removing broken world ${brokenWorld}`)\r\n        // eslint-disable-next-line no-await-in-loop\r\n        await removeFileRecursiveAsync(`${getWorldsPath()}/${brokenWorld}`)\r\n      }\r\n      setLoadingScreenStatus(undefined)\r\n    }}\r\n    warningActionLabel='Remove broken worlds'\r\n    onWorldAction={async (action, worldName) => {\r\n      const worldPath = `${getWorldsPath()}/${worldName}`\r\n      const openInGoogleDrive = () => {\r\n        const fileId = googleDriveGetFileIdFromPath(worldPath.replace('/google/', ''))\r\n        if (!fileId) return alert('File not found')\r\n        window.open(`https://drive.google.com/drive/folders/${fileId}`)\r\n      }\r\n\r\n      if (action === 'load') {\r\n        setLoadingScreenStatus(`Starting loading world ${worldName}`)\r\n        await loadInMemorySave(worldPath)\r\n        return\r\n      }\r\n      if (action === 'delete') {\r\n        if (selectedProvider === 'google') {\r\n          openInGoogleDrive()\r\n          return\r\n        }\r\n\r\n        if (!confirm('Are you sure you want to delete current world')) return\r\n        setLoadingScreenStatus(`Removing world ${worldName}`)\r\n        await removeFileRecursiveAsync(worldPath)\r\n        setLoadingScreenStatus(undefined)\r\n        readWorlds(readWorldsAbortController.current)\r\n      }\r\n      if (action === 'export') {\r\n        if (selectedProvider === 'google') {\r\n          openInGoogleDrive()\r\n          return\r\n        }\r\n\r\n        const selectedVariant =\r\n          haveDirectoryPicker()\r\n            ? await showOptionsModal('Select export type', ['Select folder (recommended)', 'Download ZIP file'])\r\n            : await showOptionsModal('Select export type', ['Download ZIP file'])\r\n        if (!selectedVariant) return\r\n        if (selectedVariant === 'Select folder (recommended)') {\r\n          const success = await mountExportFolder()\r\n          if (!success) return\r\n        }\r\n        await exportWorld(worldPath, selectedVariant === 'Select folder (recommended)' ? 'folder' : 'zip', worldName)\r\n      }\r\n    }}\r\n    onGeneralAction={(action) => {\r\n      if (action === 'cancel') {\r\n        hideCurrentModal()\r\n      }\r\n      if (action === 'create') {\r\n        showModal({ reactType: 'create-world' })\r\n      }\r\n    }}\r\n  />\r\n}\r\n","// Slider.tsx\r\nimport React, { useState, useEffect } from 'react'\r\nimport styles from './slider.module.css'\r\nimport SharedHudVars from './SharedHudVars'\r\n\r\ninterface Props extends React.ComponentProps<'div'> {\r\n  label: string;\r\n  value: number;\r\n  unit?: string;\r\n  width?: number;\r\n  valueDisplay?: string | number;\r\n  min?: number;\r\n  max?: number;\r\n  disabledReason?: string;\r\n\r\n  updateValue?: (value: number) => void;\r\n  updateOnDragEnd?: boolean;\r\n}\r\n\r\nconst Slider: React.FC<Props> = ({\r\n  label,\r\n  unit = '%',\r\n  width,\r\n  value: valueProp,\r\n  valueDisplay,\r\n  min = 0,\r\n  max = 100,\r\n  disabledReason,\r\n\r\n  updateOnDragEnd = false,\r\n  updateValue,\r\n  ...divProps\r\n}) => {\r\n  const [value, setValue] = useState(valueProp)\r\n  const getRatio = (v = value) => Math.max(Math.min((v - min) / (max - min), 1), 0)\r\n  const [ratio, setRatio] = useState(getRatio())\r\n\r\n  useEffect(() => {\r\n    setValue(valueProp)\r\n  }, [valueProp])\r\n  useEffect(() => {\r\n    setRatio(getRatio())\r\n  }, [value, min, max])\r\n\r\n  const fireValueUpdate = (dragEnd: boolean, v = value) => {\r\n    if (updateOnDragEnd !== dragEnd) return\r\n    updateValue?.(v)\r\n  }\r\n\r\n  return (\r\n    <SharedHudVars>\r\n      <div className={styles['slider-container']} style={{ width }} {...divProps}>\r\n        <input\r\n          type=\"range\"\r\n          className={styles.slider}\r\n          min={min}\r\n          max={max}\r\n          value={value}\r\n          disabled={!!disabledReason}\r\n          onChange={(e) => {\r\n            const newValue = Number(e.target.value)\r\n            setValue(newValue)\r\n            fireValueUpdate(false, newValue)\r\n          }}\r\n          // todo improve correct handling of drag end\r\n          onLostPointerCapture={() => {\r\n            fireValueUpdate(true)\r\n          }}\r\n          onPointerUp={() => {\r\n            fireValueUpdate(true)\r\n          }}\r\n          onKeyUp={() => {\r\n            fireValueUpdate(true)\r\n          }}\r\n        />\r\n        <div className={styles.disabled} title={disabledReason} />\r\n        <div className={styles['slider-thumb']} style={{ left: `calc((100% * ${ratio}) - (8px * ${ratio}))` }} />\r\n        <label className={styles.label}>\r\n          {label}: {valueDisplay ?? value} {unit}\r\n        </label>\r\n      </div>\r\n    </SharedHudVars>\r\n  )\r\n}\r\n\r\nexport default Slider\r\n","import { useState } from 'react'\r\nimport { useSnapshot } from 'valtio'\r\nimport { hideCurrentModal } from '../globalState'\r\nimport { lastPlayedSounds } from '../sounds/botSoundSystem'\r\nimport { options } from '../optionsStorage'\r\nimport Button from './Button'\r\nimport Screen from './Screen'\r\nimport { useIsModalActive } from './utilsApp'\r\n\r\nconst SoundRow = ({ sound, children }) => {\r\n  const { mutedSounds } = useSnapshot(options)\r\n\r\n  const isMuted = mutedSounds.includes(sound)\r\n\r\n  return <div style={{ display: 'flex', justifyContent: 'space-between', gap: 15 }}>\r\n    <div>\r\n      <span style={{ fontSize: 12, marginRight: 2, ...isMuted ? { color: '#af1c1c' } : {} }}>{sound}</span>\r\n      {children}\r\n    </div>\r\n    <Button\r\n      icon={isMuted ? 'pixelarticons:music' : 'pixelarticons:close'} onClick={() => {\r\n        if (isMuted) {\r\n          options.mutedSounds.splice(options.mutedSounds.indexOf(sound), 1)\r\n        } else {\r\n          options.mutedSounds.push(sound)\r\n        }\r\n      }}\r\n    />\r\n  </div>\r\n}\r\n\r\nexport default () => {\r\n  const isModalActive = useIsModalActive('sound-muffler')\r\n\r\n  const [showMuted, setShowMuted] = useState(true)\r\n  const [i, setI] = useState(0)\r\n  const { mutedSounds } = useSnapshot(options)\r\n\r\n  if (!isModalActive) return null\r\n\r\n  return <Screen title='Sound Muffler' backdrop>\r\n    <div style={{ display: 'flex', gap: 5, flexDirection: 'column' }}>\r\n      <Button onClick={() => setI(i => i + 1)}>Refresh</Button>\r\n      <Button onClick={() => setShowMuted(s => !s)}>Show Muted: {showMuted ? 'ON' : 'OFF'}</Button>\r\n      <span style={{ padding: '3px 0' }}>Last World Played</span>\r\n      {Object.entries(lastPlayedSounds.lastServerPlayed).map(([key, value]) => {\r\n        if (!showMuted && mutedSounds.includes(key)) return null\r\n        return [key, value.count] as const\r\n      }).filter(a => !!a).sort((a, b) => b[1] - a[1]).slice(0, 20).map(([key, count]) => {\r\n        return <SoundRow key={key} sound={key}>\r\n          <span style={{ fontSize: 12, fontWeight: 'bold' }}>{count}</span>\r\n        </SoundRow>\r\n      })}\r\n      <span style={{ padding: '3px 0' }}>Last Client Played</span>\r\n      {lastPlayedSounds.lastClientPlayed.map((key) => {\r\n        if (!showMuted && mutedSounds.includes(key)) return null\r\n        return <SoundRow key={key} sound={key} children={undefined} />\r\n      })}\r\n      <Button onClick={() => hideCurrentModal()}>Back</Button>\r\n    </div>\r\n  </Screen>\r\n}\r\n","import Button from './Button'\r\n\r\ninterface Props {\r\n  tabs: string[]\r\n  activeTab: string\r\n  onTabChange: (tab: string) => void\r\n\r\n  disabledTabs?: string[]\r\n  labels?: Record<string, string>\r\n  fullSize?: boolean\r\n  style?: React.CSSProperties\r\n}\r\n\r\nexport default ({ tabs, activeTab, labels, onTabChange, fullSize, style, disabledTabs }: Props) => {\r\n  return <div style={{\r\n    width: fullSize ? '100%' : undefined,\r\n    display: fullSize ? 'flex' : undefined,\r\n    ...style,\r\n  }}\r\n  >\r\n    {tabs.map(tab => {\r\n      const active = tab === activeTab\r\n      return <div\r\n        key={tab} style={{\r\n          position: 'relative',\r\n          width: fullSize ? '100%' : 150,\r\n        }}\r\n      >\r\n        <Button\r\n          disabled={active || disabledTabs?.includes(tab)} style={{\r\n            width: '100%',\r\n            height: '100%',\r\n            // background: active ? 'rgb(77, 77, 77)' : 'rgb(114, 114, 114)',\r\n            color: 'white',\r\n            cursor: 'pointer',\r\n            fontSize: 9,\r\n            padding: '2px 0px',\r\n          }} onClick={() => {\r\n            onTabChange(tab)\r\n          }}\r\n        >{labels?.[tab] ?? tab}\r\n        </Button>\r\n        {active && <div style={{\r\n          position: 'absolute',\r\n          bottom: 0,\r\n          left: 0,\r\n          right: 0,\r\n          height: 1,\r\n          background: 'white',\r\n          width: '50%',\r\n          margin: 'auto',\r\n        }}\r\n        />}\r\n      </div>\r\n    })}\r\n  </div>\r\n}\r\n","import { useState, useEffect } from 'react'\r\nimport { Transition } from 'react-transition-group'\r\nimport MessageFormattedString from './MessageFormattedString'\r\nimport './Title.css'\r\n\r\nexport type AnimationTimes = {\r\n  fadeIn: number,\r\n  stay: number,\r\n  fadeOut: number\r\n}\r\n\r\ntype TitleProps = {\r\n  title: string | Record<string, any>,\r\n  subtitle: string | Record<string, any>,\r\n  actionBar: string | Record<string, any>,\r\n  transitionTimes: AnimationTimes,\r\n  openTitle: boolean,\r\n  openActionBar: boolean\r\n}\r\n\r\nconst Title = ({\r\n  title,\r\n  subtitle,\r\n  actionBar,\r\n  transitionTimes,\r\n  openTitle = false,\r\n  openActionBar = false\r\n}: TitleProps) => {\r\n  const [mounted, setMounted] = useState(false)\r\n  const [useEnterTransition, setUseEnterTransition] = useState(true)\r\n\r\n  const defaultFadeIn = 500\r\n  const defaultFadeOut = 1000\r\n  const startStyle = {\r\n    opacity: 1,\r\n    transition: `${transitionTimes.fadeIn}ms ease-in-out all` }\r\n  const endExitStyle = {\r\n    opacity: 0,\r\n    transition: `${transitionTimes.fadeOut}ms ease-in-out all` }\r\n\r\n  const stateStyles = {\r\n    entering: startStyle,\r\n    entered: { opacity: 1 },\r\n    exiting: endExitStyle,\r\n    exited: { opacity: 0 },\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (!mounted && (openTitle || openActionBar)) {\r\n      setMounted(true)\r\n    }\r\n  }, [openTitle, openActionBar])\r\n\r\n  return (\r\n    <div className='title-container'>\r\n      <Transition\r\n        in={openTitle}\r\n        timeout={{\r\n          enter: transitionTimes?.fadeIn ?? defaultFadeIn,\r\n          exit: transitionTimes?.fadeOut ?? defaultFadeOut,\r\n        }}\r\n        mountOnEnter\r\n        unmountOnExit\r\n        enter={useEnterTransition}\r\n        onExiting={() => {\r\n          setUseEnterTransition(prev => false)\r\n        }}\r\n        onExited={() => {\r\n          setUseEnterTransition(prev => true)\r\n        }}\r\n      >\r\n        {(state) => {\r\n          return (\r\n            <div style={{ ...stateStyles[state] }}>\r\n              <h1 className='message-title'>\r\n                <MessageFormattedString message={title} />\r\n              </h1>\r\n              <h4 className='message-subtitle'>\r\n                <MessageFormattedString message={subtitle} />\r\n              </h4>\r\n            </div>\r\n          )\r\n        }}\r\n      </Transition>\r\n      <Transition\r\n        in={openActionBar}\r\n        timeout={{\r\n          enter: transitionTimes?.fadeIn ?? defaultFadeIn,\r\n          exit: transitionTimes?.fadeOut ?? defaultFadeOut,\r\n        }}\r\n        mountOnEnter\r\n        unmountOnExit\r\n        // enter={useEnterTransition}\r\n        // onExiting={() => {\r\n        //   setUseEnterTransition(prev => false)\r\n        // }}\r\n        // onExited={() => {\r\n        //   setUseEnterTransition(prev => true)\r\n        // }}\r\n      >\r\n        {(state) => {\r\n          return (\r\n            <div style={{ ...stateStyles[state] }}>\r\n              <div className='action-bar'>\r\n                <MessageFormattedString message={actionBar} />\r\n              </div>\r\n            </div>\r\n          )\r\n        }}\r\n      </Transition>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Title\r\n","import { useEffect, useMemo, useState } from 'react'\r\nimport mojangson from 'mojangson'\r\nimport nbt from 'prismarine-nbt'\r\nimport type { ClientOnMap } from '../generatedServerPackets'\r\nimport Title from './Title'\r\nimport type { AnimationTimes } from './Title'\r\n\r\n\r\nconst defaultText: Record<string, any> = { 'text': '' }\r\nconst defaultTimings: AnimationTimes = { fadeIn: 500, stay: 3500, fadeOut: 1000 }\r\n\r\nconst ticksToMs = (ticks: AnimationTimes) => {\r\n  ticks.fadeIn *= 50\r\n  ticks.stay *= 50\r\n  ticks.fadeOut *= 50\r\n  return ticks\r\n}\r\n\r\nconst getComponent = (input: string | any) => {\r\n  if (typeof input === 'string') {\r\n    // raw json is sent\r\n    return mojangson.simplify(mojangson.parse(input))\r\n  } else if (input.type === 'string') {\r\n    // this is used for simple chat components without any special properties\r\n    return { 'text': input.value }\r\n  } else if (input.type === 'compound') {\r\n    // this is used for complex chat components with special properties\r\n    return nbt.simplify(input)\r\n  }\r\n  return input\r\n}\r\n\r\nexport default () => {\r\n  const [title, setTitle] = useState<string | Record<string, any>>(defaultText)\r\n  const [subtitle, setSubtitle] = useState<string | Record<string, any>>(defaultText)\r\n  const [actionBar, setActionBar] = useState<string | Record<string, any>>(defaultText)\r\n  const [animTimes, setAnimTimes] = useState<AnimationTimes>(defaultTimings)\r\n  const [openTitle, setOpenTitle] = useState(false)\r\n  const [openActionBar, setOpenActionBar] = useState(false)\r\n\r\n  useMemo(() => {\r\n    // todo move to mineflayer\r\n    bot._client.on('set_title_text', (packet) => {\r\n      setTitle(getComponent(packet.text))\r\n      setOpenTitle(true)\r\n    })\r\n    bot._client.on('set_title_subtitle', (packet) => {\r\n      setSubtitle(getComponent(packet.text))\r\n    })\r\n    bot._client.on('action_bar', (packet) => {\r\n      setActionBar(getComponent(packet.text))\r\n      setOpenActionBar(true)\r\n    })\r\n    bot._client.on('set_title_time', (packet) => {\r\n      setAnimTimes(ticksToMs(packet))\r\n    })\r\n    bot._client.on('clear_titles', (mes) => {\r\n      setOpenTitle(false)\r\n      setOpenActionBar(false)\r\n      if (mes.reset) {\r\n        setTitle(defaultText)\r\n        setSubtitle(defaultText)\r\n        setActionBar(defaultText)\r\n        setAnimTimes(defaultTimings)\r\n      }\r\n    })\r\n\r\n\r\n    bot.on('actionBar', (packet) => {\r\n      setAnimTimes({ fadeIn: 0, stay: 2000, fadeOut: 1000 })\r\n      setActionBar(packet)\r\n      setOpenActionBar(true)\r\n    })\r\n\r\n    // before 1.17\r\n    bot._client.on('title', (packet: ClientOnMap['title'] | string) => {\r\n      let mes: ClientOnMap['title']\r\n      if (typeof packet === 'string') {\r\n        mes = JSON.parse(packet)\r\n      } else {\r\n        mes = packet\r\n      }\r\n      switch (mes.action) {\r\n        case 0:\r\n          setTitle(JSON.parse(mes.text))\r\n          setOpenTitle(true)\r\n          break\r\n        case 1:\r\n          setSubtitle(JSON.parse(mes.text))\r\n          break\r\n        case 2:\r\n          setActionBar(JSON.parse(mes.text))\r\n          setOpenActionBar(true)\r\n          break\r\n        case 3:\r\n          setAnimTimes(ticksToMs({ fadeIn: mes.fadeIn, stay: mes.stay, fadeOut: mes.fadeOut }))\r\n          break\r\n        case 4:\r\n          setOpenTitle(false)\r\n          setOpenActionBar(false)\r\n          break\r\n        case 5:\r\n          setOpenTitle(false)\r\n          setOpenActionBar(false)\r\n          setTitle(defaultText)\r\n          setSubtitle(defaultText)\r\n          setActionBar(defaultText)\r\n          setAnimTimes(defaultTimings)\r\n          break\r\n      }\r\n    })\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    const id = setTimeout(() => {\r\n      setOpenTitle(false)\r\n    }, animTimes.stay) // only initial stay time is used for title\r\n\r\n    return () => {\r\n      clearTimeout(id)\r\n    }\r\n  }, [title, subtitle])\r\n\r\n  useEffect(() => {\r\n    let id: any = null\r\n    if (!openTitle) {\r\n      id = setTimeout(() => {\r\n        setSubtitle(defaultText)\r\n      }, animTimes.fadeOut)\r\n    }\r\n\r\n    return () => {\r\n      if (id) {\r\n        clearTimeout(id)\r\n      }\r\n    }\r\n  }, [openTitle])\r\n\r\n  useEffect(() => {\r\n    const id = setTimeout(() => {\r\n      setOpenActionBar(false)\r\n    }, animTimes.stay)\r\n\r\n    return () => {\r\n      clearTimeout(id)\r\n    }\r\n  }, [actionBar])\r\n\r\n  return <Title\r\n    title={title}\r\n    subtitle={subtitle}\r\n    actionBar={actionBar}\r\n    transitionTimes={animTimes}\r\n    openTitle={openTitle}\r\n    openActionBar={openActionBar}\r\n  />\r\n}\r\n","import { CSSProperties, PointerEvent, useEffect, useRef } from 'react'\r\nimport { proxy, ref, useSnapshot } from 'valtio'\r\nimport { contro } from '../controls'\r\nimport { options } from '../optionsStorage'\r\nimport PixelartIcon from './PixelartIcon'\r\nimport Button from './Button'\r\n\r\nexport type ButtonName = 'action' | 'sneak' | 'break' | 'jump'\r\n\r\ntype ButtonsPositions = Record<ButtonName, [number, number]>\r\n\r\nconst getCurrentAppScaling = () => {\r\n  // body has css property --guiScale\r\n  const guiScale = getComputedStyle(document.body).getPropertyValue('--guiScale')\r\n  return parseFloat(guiScale)\r\n}\r\n\r\nexport const joystickPointer = proxy({\r\n  pointer: null as { x: number, y: number, pointerId: number } | null,\r\n  joystickInner: null as HTMLDivElement | null,\r\n})\r\n\r\nexport const handleMovementStickDelta = (e?: { clientX, clientY }) => {\r\n  const max = 32\r\n  let x = 0\r\n  let y = 0\r\n  if (e) {\r\n    const scale = getCurrentAppScaling()\r\n    x = e.clientX - joystickPointer.pointer!.x\r\n    y = e.clientY - joystickPointer.pointer!.y\r\n    x = Math.min(Math.max(x, -max), max) / scale\r\n    y = Math.min(Math.max(y, -max), max) / scale\r\n  }\r\n\r\n  joystickPointer.joystickInner!.style.transform = `translate(${x}px, ${y}px)`\r\n  const vector = {\r\n    x: x / max,\r\n    y: 0,\r\n    z: y / max,\r\n  }\r\n  void contro.emit('movementUpdate', {\r\n    vector,\r\n    soleVector: vector\r\n  })\r\n}\r\n\r\ntype Props = {\r\n  setupActive: boolean\r\n  closeButtonsSetup: (newPositions?: ButtonsPositions) => void\r\n  foregroundGameActive: boolean\r\n}\r\n\r\nconst Z_INDEX_INTERACTIBLE = 8\r\n\r\nexport default ({ setupActive, closeButtonsSetup, foregroundGameActive }: Props) => {\r\n  const bot = window.bot as typeof __type_bot | undefined\r\n  const { touchControlsPositions, touchMovementType, touchInteractionType } = useSnapshot(options)\r\n  const buttonsPositions = touchControlsPositions as ButtonsPositions\r\n\r\n  const joystickOuter = useRef<HTMLDivElement>(null)\r\n  const joystickInner = useRef<HTMLDivElement>(null)\r\n\r\n  const { pointer } = useSnapshot(joystickPointer)\r\n  const newButtonPositions = { ...buttonsPositions }\r\n\r\n  const buttonProps = (name: ButtonName) => {\r\n    let active = {\r\n      action: false,\r\n      sneak: bot?.getControlState('sneak'),\r\n      break: false,\r\n      jump: bot?.getControlState('jump'),\r\n    }[name]\r\n    const holdDown = {\r\n      action () {\r\n        if (!bot) return\r\n        document.dispatchEvent(new MouseEvent('mousedown', { button: 2 }))\r\n        bot.mouse.update()\r\n      },\r\n      sneak () {\r\n        void contro.emit('trigger', {\r\n          command: 'general.toggleSneakOrDown',\r\n          schema: null as any,\r\n        })\r\n        active = bot?.getControlState('sneak')\r\n      },\r\n      break () {\r\n        if (!bot) return\r\n        document.dispatchEvent(new MouseEvent('mousedown', { button: 0 }))\r\n        bot.mouse.update()\r\n        active = true\r\n      },\r\n      jump () {\r\n        void contro.emit('trigger', {\r\n          command: 'general.jump',\r\n          schema: null as any,\r\n        })\r\n        active = bot?.controlState.jump\r\n      }\r\n    }\r\n    const holdUp = {\r\n      action () {\r\n        document.dispatchEvent(new MouseEvent('mouseup', { button: 2 }))\r\n      },\r\n      sneak () {\r\n        void contro.emit('release', {\r\n          command: 'general.toggleSneakOrDown',\r\n          schema: null as any,\r\n        })\r\n        active = bot?.getControlState('sneak')\r\n      },\r\n      break () {\r\n        if (!bot) return\r\n        document.dispatchEvent(new MouseEvent('mouseup', { button: 0 }))\r\n        bot.mouse.update()\r\n        active = false\r\n      },\r\n      jump () {\r\n        void contro.emit('release', {\r\n          command: 'general.jump',\r\n          schema: null as any,\r\n        })\r\n        active = bot?.controlState.jump\r\n      }\r\n    }\r\n\r\n    type PType = PointerEvent<HTMLDivElement>\r\n    const pointerup = (e: PType) => {\r\n      const elem = e.currentTarget as HTMLElement\r\n      console.log(e.type, elem.hasPointerCapture(e.pointerId))\r\n      elem.releasePointerCapture(e.pointerId)\r\n      if (!setupActive) {\r\n        holdUp[name]()\r\n        pointerToggledUpdate(e)\r\n      }\r\n    }\r\n    const pointerToggledUpdate = (e) => {\r\n      e.currentTarget.style.background = active ? 'rgba(0, 0, 0, 0.8)' : 'rgba(0, 0, 0, 0.5)'\r\n    }\r\n    let setupPointer = null as { x, y } | null\r\n    return {\r\n      style: {\r\n        position: 'fixed',\r\n        left: `${buttonsPositions[name][0]}%`,\r\n        top: `${buttonsPositions[name][1]}%`,\r\n        borderRadius: '50%',\r\n        width: '32px',\r\n        height: '32px',\r\n        background: active ? 'rgba(0, 0, 0, 0.8)' : 'rgba(0, 0, 0, 0.5)',\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        transition: 'background 0.1s',\r\n        zIndex: Z_INDEX_INTERACTIBLE,\r\n      } satisfies CSSProperties,\r\n      onPointerDown (e: PType) {\r\n        const elem = e.currentTarget as HTMLElement\r\n        elem.setPointerCapture(e.pointerId)\r\n        if (setupActive) {\r\n          setupPointer = { x: e.clientX, y: e.clientY }\r\n        } else {\r\n          holdDown[name]()\r\n          pointerToggledUpdate(e)\r\n        }\r\n      },\r\n      onPointerMove (e: PType) {\r\n        if (setupPointer) {\r\n          const elem = e.currentTarget as HTMLElement\r\n          const size = 32\r\n          const scale = getCurrentAppScaling()\r\n          const xPerc = (e.clientX - (size * scale) / 2) / window.innerWidth * 100\r\n          const yPerc = (e.clientY - (size * scale) / 2) / window.innerHeight * 100\r\n          elem.style.left = `${xPerc}%`\r\n          elem.style.top = `${yPerc}%`\r\n          newButtonPositions[name] = [xPerc, yPerc]\r\n        }\r\n      },\r\n      onPointerUp: pointerup,\r\n      // onPointerCancel: pointerup,\r\n      onLostPointerCapture: pointerup,\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    joystickPointer.joystickInner = joystickInner.current && ref(joystickInner.current)\r\n    // todo antipattern\r\n  }, [foregroundGameActive])\r\n\r\n  if (!foregroundGameActive && !setupActive) return null\r\n\r\n  return <div>\r\n    {touchMovementType === 'modern' && (\r\n      <div\r\n        className='movement_joystick_outer'\r\n        ref={joystickOuter}\r\n        style={{\r\n          display: pointer ? 'flex' : 'none',\r\n          borderRadius: '50%',\r\n          width: 50,\r\n          height: 50,\r\n          border: '2px solid rgba(0, 0, 0, 0.5)',\r\n          backgroundColor: 'rgba(255, 255, div, 0.5)',\r\n          position: 'fixed',\r\n          justifyContent: 'center',\r\n          alignItems: 'center',\r\n          translate: '-50% -50%',\r\n          ...pointer ? {\r\n            left: `${pointer.x / window.innerWidth * 100}%`,\r\n            top: `${pointer.y / window.innerHeight * 100}%`\r\n          } : {}\r\n        }}\r\n      >\r\n        <div\r\n          className='movement_joystick_inner'\r\n          style={{\r\n            borderRadius: '50%',\r\n            width: 20,\r\n            height: 20,\r\n            backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n            position: 'absolute',\r\n          }}\r\n          ref={joystickInner}\r\n        />\r\n      </div>\r\n    )}\r\n    {touchMovementType === 'modern' && (\r\n      <>\r\n        <div {...buttonProps('sneak')}>\r\n          <PixelartIcon iconName='arrow-down' />\r\n        </div>\r\n        <div {...buttonProps('jump')}>\r\n          <PixelartIcon iconName='arrow-up' />\r\n        </div>\r\n      </>\r\n    )}\r\n    {touchInteractionType === 'buttons' && (\r\n      <>\r\n        <div {...buttonProps('action')}>\r\n          <PixelartIcon iconName='circle' />\r\n        </div>\r\n        <div {...buttonProps('break')}>\r\n          <MineIcon />\r\n        </div>\r\n      </>\r\n    )}\r\n    {setupActive && <div style={{\r\n      position: 'fixed',\r\n      bottom: 0,\r\n      display: 'flex',\r\n      justifyContent: 'center',\r\n      gap: 3\r\n    }}\r\n    >\r\n      <Button onClick={() => {\r\n        closeButtonsSetup()\r\n      }}\r\n      >Cancel\r\n      </Button>\r\n      <Button onClick={() => {\r\n        closeButtonsSetup(newButtonPositions)\r\n      }}\r\n      >Apply\r\n      </Button>\r\n    </div>}\r\n  </div>\r\n}\r\n\r\nconst MineIcon = () => {\r\n  return <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 26 26\" width={22} height={22}>\r\n    <path d=\"M 8 0 L 8 2 L 18 2 L 18 0 L 8 0 z M 18 2 L 18 4 L 20 4 L 20 6 L 22 6 L 22 8 L 24 8 L 24 2 L 22 2 L 18 2 z M 24 8 L 24 18 L 26 18 L 26 8 L 24 8 z M 24 18 L 22 18 L 22 20 L 24 20 L 24 18 z M 22 18 L 22 10 L 20 10 L 20 18 L 22 18 z M 20 10 L 20 8 L 18 8 L 18 10 L 20 10 z M 18 10 L 16 10 L 16 12 L 18 12 L 18 10 z M 16 12 L 14 12 L 14 14 L 16 14 L 16 12 z M 14 14 L 12 14 L 12 16 L 14 16 L 14 14 z M 12 16 L 10 16 L 10 18 L 12 18 L 12 16 z M 10 18 L 8 18 L 8 20 L 10 20 L 10 18 z M 8 20 L 6 20 L 6 22 L 8 22 L 8 20 z M 6 22 L 4 22 L 4 24 L 6 24 L 6 22 z M 4 24 L 2 24 L 2 22 L 0 22 L 0 24 L 0 26 L 2 26 L 4 26 L 4 24 z M 2 22 L 4 22 L 4 20 L 2 20 L 2 22 z M 4 20 L 6 20 L 6 18 L 4 18 L 4 20 z M 6 18 L 8 18 L 8 16 L 6 16 L 6 18 z M 8 16 L 10 16 L 10 14 L 8 14 L 8 16 z M 10 14 L 12 14 L 12 12 L 10 12 L 10 14 z M 12 12 L 14 12 L 14 10 L 12 10 L 12 12 z M 14 10 L 16 10 L 16 8 L 14 8 L 14 10 z M 16 8 L 18 8 L 18 6 L 16 6 L 16 8 z M 16 6 L 16 4 L 8 4 L 8 6 L 16 6 z M 8 4 L 8 2 L 6 2 L 6 4 L 8 4 z\" stroke='white' />\r\n  </svg>\r\n}\r\n","import { useSnapshot } from 'valtio'\r\nimport { activeModalStack, hideModal } from '../globalState'\r\nimport { options } from '../optionsStorage'\r\nimport TouchAreasControls from './TouchAreasControls'\r\nimport { useIsModalActive, useUsingTouch } from './utilsApp'\r\n\r\nexport default () => {\r\n  const usingTouch = useUsingTouch()\r\n  const hasModals = useSnapshot(activeModalStack).length !== 0\r\n  const setupActive = useIsModalActive('touch-buttons-setup')\r\n\r\n  return <TouchAreasControls\r\n    foregroundGameActive={!!bot && !!usingTouch && !hasModals}\r\n    setupActive={setupActive}\r\n    closeButtonsSetup={(newPositions) => {\r\n      if (newPositions) {\r\n        options.touchControlsPositions = newPositions\r\n      }\r\n      hideModal()\r\n    }}\r\n  />\r\n}\r\n","import { LeftTouchArea, RightTouchArea, useInterfaceState } from '@dimaka/interface'\r\nimport { css } from '@emotion/css'\r\nimport { useSnapshot } from 'valtio'\r\nimport { contro } from '../controls'\r\nimport { miscUiState, activeModalStack } from '../globalState'\r\nimport { watchValue, options } from '../optionsStorage'\r\nimport { useUsingTouch } from './utilsApp'\r\n\r\n// todo\r\nuseInterfaceState.setState({\r\n  isFlying: false,\r\n  uiCustomization: {\r\n    touchButtonSize: 40,\r\n  },\r\n  updateCoord ([coord, state]) {\r\n    const coordToAction = [\r\n      ['z', -1, 'KeyW'],\r\n      ['z', 1, 'KeyS'],\r\n      ['x', -1, 'KeyA'],\r\n      ['x', 1, 'KeyD'],\r\n      ['y', 1, 'Space'], // todo jump\r\n      ['y', -1, 'ShiftLeft'], // todo jump\r\n    ]\r\n    // todo refactor\r\n    const actionAndState = state === 0 ? coordToAction.filter(([axis]) => axis === coord) : coordToAction.find(([axis, value]) => axis === coord && value === state)\r\n    if (!bot) return\r\n    if (state === 0) {\r\n      // @ts-expect-error\r\n      for (const action of actionAndState) {\r\n        contro.pressedKeyOrButtonChanged({ code: action[2] }, false)\r\n      }\r\n    } else {\r\n      //@ts-expect-error\r\n      contro.pressedKeyOrButtonChanged({ code: actionAndState[2] }, true)\r\n    }\r\n  }\r\n})\r\n\r\nwatchValue(options, (o) => {\r\n  useInterfaceState.setState({\r\n    uiCustomization: {\r\n      touchButtonSize: o.touchButtonsSize,\r\n    },\r\n  })\r\n})\r\n\r\nexport default () => {\r\n  // todo setting\r\n  const usingTouch = useUsingTouch()\r\n  const { usingGamepadInput } = useSnapshot(miscUiState)\r\n  const modals = useSnapshot(activeModalStack)\r\n  const { touchMovementType } = useSnapshot(options)\r\n\r\n  if (!usingTouch || usingGamepadInput || touchMovementType !== 'classic') return null\r\n  return (\r\n    <div\r\n      style={{ zIndex: modals.length ? 7 : 8 }}\r\n      className={css`\r\n        position: fixed;\r\n        bottom: 0;\r\n        /* height: 100%; */\r\n        display: flex;\r\n        width: 100%;\r\n        justify-content: space-between;\r\n        align-items: flex-end;\r\n        pointer-events: none;\r\n        touch-action: none;\r\n        & > div {\r\n            pointer-events: auto;\r\n        }\r\n    `}\r\n    >\r\n      <LeftTouchArea />\r\n      <div />\r\n      <RightTouchArea />\r\n    </div>\r\n  )\r\n}\r\n","import { useEffect, useState } from 'react'\r\nimport { useSnapshot } from 'valtio'\r\nimport { options } from '../optionsStorage'\r\nimport { activeModalStack } from '../globalState'\r\nimport PixelartIcon, { pixelartIcons } from './PixelartIcon'\r\nimport styles from './TouchInteractionHint.module.css'\r\nimport { useUsingTouch } from './utilsApp'\r\n\r\nexport default () => {\r\n  const usingTouch = useUsingTouch()\r\n  const modalStack = useSnapshot(activeModalStack)\r\n  const { touchInteractionType } = useSnapshot(options)\r\n  const [hintText, setHintText] = useState<string | null>(null)\r\n\r\n  useEffect(() => {\r\n    const update = () => {\r\n      const cursorState = bot.mouse.getCursorState()\r\n      if (cursorState.entity) {\r\n        const entityName = cursorState.entity.displayName ?? cursorState.entity.name\r\n        setHintText(`Attack ${entityName}`)\r\n      } else {\r\n        setHintText(null)\r\n      }\r\n    }\r\n\r\n    // Initial update\r\n    update()\r\n\r\n    // Subscribe to physics ticks\r\n    bot.on('physicsTick', update)\r\n\r\n    return () => {\r\n      bot?.removeListener('physicsTick', update)\r\n    }\r\n  }, [])\r\n\r\n  if (!usingTouch || touchInteractionType !== 'classic' || modalStack.length > 0) return null\r\n  if (!hintText) return null\r\n\r\n  return (\r\n    <div className={`${styles.hint_container} interaction-hint`}>\r\n      <PixelartIcon iconName={pixelartIcons['sun-alt']} width={14} />\r\n      <span className={styles.hint_text}>{hintText}</span>\r\n    </div>\r\n  )\r\n}\r\n","import { createContext, useContext, useEffect, useState } from 'react'\r\nimport { useMedia } from 'react-use'\r\n\r\nexport const ScaleContext = createContext<number>(1)\r\n\r\nexport const useScale = () => useContext(ScaleContext)\r\n\r\nexport const UIProvider = ({ children, scale = 1 }) => {\r\n  return (\r\n    <ScaleContext.Provider value={scale}>\r\n      {children}\r\n    </ScaleContext.Provider>\r\n  )\r\n}\r\n\r\n\r\nexport const usePassesScaledDimensions = (minWidth: number | null = null, minHeight: number | null = null) => {\r\n  const scale = useScale()\r\n  const conditions: string[] = []\r\n\r\n  if (minWidth !== null) {\r\n    conditions.push(`(min-width: ${minWidth * scale}px)`)\r\n  }\r\n  if (minHeight !== null) {\r\n    conditions.push(`(min-height: ${minHeight * scale}px)`)\r\n  }\r\n\r\n  const media = conditions.join(' and ') || 'all'\r\n  return useMedia(media)\r\n}\r\n","import SharedHudVars from './SharedHudVars'\r\nimport styles from './XPBar.module.css'\r\n\r\nexport default ({ progress, level, gamemode }: { progress: number; level: number, gamemode: string }) => (\r\n  <SharedHudVars>\r\n    <div\r\n      id=\"xp-bar-bg\"\r\n      className={styles['xp-bar-bg']}\r\n      style={{ display: gamemode === 'creative' || gamemode === 'spectator' ? 'none' : 'block' }}\r\n    >\r\n      <div className={styles['xp-bar']} style={{ width: `${182 * progress}px` }} />\r\n      <span className={styles['xp-label']} style={{ display: level > 0 ? 'block' : 'none' }}>{level}</span>\r\n    </div>\r\n  </SharedHudVars>\r\n)\r\n","import { useState, useMemo } from 'react'\r\nimport { GameMode } from 'mineflayer'\r\nimport XPBar from './XPBar'\r\n\r\n\r\nexport default () => {\r\n  const [progress, setProgress] = useState(0)\r\n  const [level, setLevel] = useState(0)\r\n  const [gamemode, setGamemode] = useState<GameMode | ''>(bot.game.gameMode)\r\n\r\n  useMemo(() => {\r\n    const onXpUpdate = () => {\r\n      setProgress(bot.experience.progress)\r\n      setLevel(bot.experience.level)\r\n    }\r\n    onXpUpdate()\r\n\r\n    bot.on('experience', onXpUpdate)\r\n\r\n    bot.on('game', () => {\r\n      setGamemode(prev => bot.game.gameMode)\r\n    })\r\n  }, [])\r\n\r\n  return <XPBar progress={progress} level={level} gamemode={gamemode} />\r\n}\r\n","import { proxy, ref, subscribe } from 'valtio'\r\nimport { UserOverridesConfig } from 'contro-max/build/types/store'\r\nimport { subscribeKey } from 'valtio/utils'\r\nimport { CustomCommand } from './KeybindingsCustom'\r\nimport { AuthenticatedAccount } from './serversStorage'\r\nimport type { BaseServerInfo } from './AddServerOrConnect'\r\n\r\n// when opening html file locally in browser, localStorage is shared between all ever opened html files, so we try to avoid conflicts\r\nconst localStoragePrefix = process.env?.SINGLE_FILE_BUILD ? 'minecraft-web-client:' : ''\r\n\r\nexport interface SavedProxiesData {\r\n  proxies: string[]\r\n  selected: string\r\n}\r\n\r\nexport interface ServerHistoryEntry {\r\n  ip: string\r\n  version?: string\r\n  numConnects: number\r\n  lastConnected: number\r\n}\r\n\r\nexport interface StoreServerItem extends BaseServerInfo {\r\n  lastJoined?: number\r\n  description?: string\r\n  optionsOverride?: Record<string, any>\r\n  autoLogin?: Record<string, string>\r\n  numConnects?: number // Track number of connections\r\n}\r\n\r\ntype StorageData = {\r\n  customCommands: Record<string, CustomCommand> | undefined\r\n  username: string | undefined\r\n  keybindings: UserOverridesConfig | undefined\r\n  options: any\r\n  proxiesData: SavedProxiesData | undefined\r\n  serversHistory: ServerHistoryEntry[]\r\n  authenticatedAccounts: AuthenticatedAccount[]\r\n  serversList: StoreServerItem[] | undefined\r\n}\r\n\r\nconst oldKeysAliases: Partial<Record<keyof StorageData, string>> = {\r\n  serversHistory: 'serverConnectionHistory',\r\n}\r\n\r\nconst migrateLegacyData = () => {\r\n  const proxies = localStorage.getItem('proxies')\r\n  const selectedProxy = localStorage.getItem('selectedProxy')\r\n  if (proxies && selectedProxy) {\r\n    appStorage.proxiesData = {\r\n      proxies: JSON.parse(proxies),\r\n      selected: selectedProxy,\r\n    }\r\n  }\r\n\r\n  const username = localStorage.getItem('username')\r\n  if (username && !username.startsWith('\"')) {\r\n    appStorage.username = username\r\n  }\r\n\r\n  const serversHistoryLegacy = localStorage.getItem('serverConnectionHistory')\r\n  if (serversHistoryLegacy) {\r\n    appStorage.serversHistory = JSON.parse(serversHistoryLegacy)\r\n  }\r\n  localStorage.removeItem('proxies')\r\n  localStorage.removeItem('selectedProxy')\r\n  localStorage.removeItem('serverConnectionHistory')\r\n}\r\n\r\nconst defaultStorageData: StorageData = {\r\n  customCommands: undefined,\r\n  username: undefined,\r\n  keybindings: undefined,\r\n  options: {},\r\n  proxiesData: undefined,\r\n  serversHistory: [],\r\n  authenticatedAccounts: [],\r\n  serversList: undefined,\r\n}\r\n\r\nexport const setStorageDataOnAppConfigLoad = () => {\r\n  appStorage.username ??= `mcrafter${Math.floor(Math.random() * 1000)}`\r\n}\r\n\r\nexport const appStorage = proxy({ ...defaultStorageData })\r\nwindow.appStorage = appStorage\r\n\r\n// Restore data from localStorage\r\nfor (const key of Object.keys(defaultStorageData)) {\r\n  const prefixedKey = `${localStoragePrefix}${key}`\r\n  const aliasedKey = oldKeysAliases[key]\r\n  const storedValue = localStorage.getItem(prefixedKey) ?? (aliasedKey ? localStorage.getItem(aliasedKey) : undefined)\r\n  if (storedValue) {\r\n    try {\r\n      const parsed = JSON.parse(storedValue)\r\n      // appStorage[key] = parsed && typeof parsed === 'object' ? ref(parsed) : parsed\r\n      appStorage[key] = parsed\r\n    } catch (e) {\r\n      console.error(`Failed to parse stored value for ${key}:`, e)\r\n    }\r\n  }\r\n}\r\n\r\nconst saveKey = (key: keyof StorageData) => {\r\n  const prefixedKey = `${localStoragePrefix}${key}`\r\n  const value = appStorage[key]\r\n  if (value === undefined) {\r\n    localStorage.removeItem(prefixedKey)\r\n  } else {\r\n    localStorage.setItem(prefixedKey, JSON.stringify(value))\r\n  }\r\n}\r\n\r\nsubscribe(appStorage, (ops) => {\r\n  for (const op of ops) {\r\n    const [type, path, value] = op\r\n    const key = path[0]\r\n    saveKey(key as keyof StorageData)\r\n  }\r\n})\r\n// Subscribe to changes and save to localStorage\r\n\r\nexport const resetAppStorage = () => {\r\n  for (const key of Object.keys(appStorage)) {\r\n    appStorage[key as keyof StorageData] = defaultStorageData[key as keyof StorageData]\r\n  }\r\n\r\n  for (const key of Object.keys(localStorage)) {\r\n    if (key.startsWith(localStoragePrefix)) {\r\n      localStorage.removeItem(key)\r\n    }\r\n  }\r\n}\r\n\r\nmigrateLegacyData()\r\n","interface Armor {\r\n  'helmet': number;\r\n  'chestplate': number | null;\r\n  'leggings': number | null;\r\n  'boots': number | null;\r\n}\r\n\r\nexport const armor: { [material: string]: Armor } = {\r\n  'turtle': {\r\n    'helmet': 2,\r\n    'chestplate': null,\r\n    'leggings': null,\r\n    'boots': null\r\n  },\r\n  'leather': {\r\n    'helmet': 1,\r\n    'chestplate': 3,\r\n    'leggings': 2,\r\n    'boots': 1\r\n  },\r\n  'golden': {\r\n    'helmet': 2,\r\n    'chestplate': 5,\r\n    'leggings': 3,\r\n    'boots': 1\r\n  },\r\n  'chainmail': {\r\n    'helmet': 2,\r\n    'chestplate': 5,\r\n    'leggings': 4,\r\n    'boots': 1\r\n  },\r\n  'iron': {\r\n    'helmet': 2,\r\n    'chestplate': 6,\r\n    'leggings': 5,\r\n    'boots': 2\r\n  },\r\n  'diamond': {\r\n    'helmet': 3,\r\n    'chestplate': 8,\r\n    'leggings': 6,\r\n    'boots': 3\r\n  },\r\n  'netherite': {\r\n    'helmet': 3,\r\n    'chestplate': 8,\r\n    'leggings': 6,\r\n    'boots': 3\r\n  }\r\n}\r\n\r\n","import { useEffect, useRef, useState } from 'react'\r\nimport { DARK_COLORS } from './constants'\r\n\r\ninterface Props {\r\n  value: string\r\n  onChange: (value: string) => void\r\n  hiddenCount: number\r\n  shownCount: number\r\n  onClearFilter: () => void\r\n  clientPacketsAutocomplete: string[]\r\n  serverPacketsAutocomplete: string[]\r\n}\r\n\r\nexport default function FilterInput ({\r\n  value,\r\n  onChange,\r\n  hiddenCount,\r\n  shownCount,\r\n  onClearFilter,\r\n  clientPacketsAutocomplete,\r\n  serverPacketsAutocomplete\r\n}: Props) {\r\n  const inputRef = useRef<HTMLInputElement>(null)\r\n  const [showAutocomplete, setShowAutocomplete] = useState(false)\r\n  const [selectedIndex, setSelectedIndex] = useState(0)\r\n\r\n  const allSuggestions = [\r\n    ...clientPacketsAutocomplete.map(name => ({ name, isClient: true })),\r\n    ...serverPacketsAutocomplete.map(name => ({ name, isClient: false }))\r\n  ].sort((a, b) => a.name.localeCompare(b.name))\r\n\r\n  const currentWord = value.split(/,\\s*/).pop() || ''\r\n  const filteredSuggestions = allSuggestions.filter(\r\n    ({ name }) => name.toLowerCase().includes(currentWord.toLowerCase().replace(/^\\$/, ''))\r\n  )\r\n\r\n  useEffect(() => {\r\n    setSelectedIndex(0)\r\n  }, [currentWord])\r\n\r\n  const acceptSuggestion = (suggestion: string) => {\r\n    const parts = value.split(/,\\s*/)\r\n    parts[parts.length - 1] = suggestion\r\n    onChange(parts.join(', '))\r\n    setShowAutocomplete(false)\r\n    inputRef.current?.focus()\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div style={{ position: 'relative' }}>\r\n        <input\r\n          ref={inputRef}\r\n          type=\"text\"\r\n          value={value}\r\n          onChange={e => onChange(e.target.value)}\r\n          onFocus={() => setShowAutocomplete(true)}\r\n          onBlur={() => {\r\n            setTimeout(() => setShowAutocomplete(false), 200)\r\n          }}\r\n          onKeyDown={e => {\r\n            if (!showAutocomplete) {\r\n              if (e.key === 'Tab') {\r\n                e.preventDefault()\r\n                setShowAutocomplete(true)\r\n              }\r\n              return\r\n            }\r\n\r\n            if (e.key === 'ArrowDown') {\r\n              e.preventDefault()\r\n              setSelectedIndex(i => (i + 1) % filteredSuggestions.length)\r\n            } else if (e.key === 'ArrowUp') {\r\n              e.preventDefault()\r\n              setSelectedIndex(i => (i - 1 + filteredSuggestions.length) % filteredSuggestions.length)\r\n            } else if (e.key === 'Enter' && filteredSuggestions.length > 0) {\r\n              e.preventDefault()\r\n              acceptSuggestion(filteredSuggestions[selectedIndex].name)\r\n            } else if (e.key === 'Escape') {\r\n              e.preventDefault()\r\n              setShowAutocomplete(false)\r\n            }\r\n          }}\r\n          placeholder=\"Filter packets (e.g. entity, $block_display, !position)\"\r\n          style={{\r\n            width: '100%',\r\n            padding: '8px',\r\n            border: `1px solid ${DARK_COLORS.border}`,\r\n            borderRadius: '4px',\r\n            background: DARK_COLORS.input,\r\n            color: DARK_COLORS.text\r\n          }}\r\n        />\r\n        {showAutocomplete && filteredSuggestions.length > 0 && (\r\n          <div style={{\r\n            position: 'absolute',\r\n            top: '100%',\r\n            left: 0,\r\n            right: 0,\r\n            backgroundColor: DARK_COLORS.bg,\r\n            border: `1px solid ${DARK_COLORS.border}`,\r\n            borderRadius: '4px',\r\n            marginTop: '4px',\r\n            maxHeight: '200px',\r\n            overflowY: 'auto',\r\n            zIndex: 1\r\n          }}>\r\n            {filteredSuggestions.map(({ name, isClient }, index) => (\r\n              <div\r\n                key={name}\r\n                onClick={() => acceptSuggestion(name)}\r\n                style={{\r\n                  padding: '4px 8px',\r\n                  cursor: 'pointer',\r\n                  backgroundColor: index === selectedIndex ? DARK_COLORS.hover : DARK_COLORS.bg,\r\n                  color: isClient ? DARK_COLORS.client : DARK_COLORS.server\r\n                }}\r\n              >\r\n                {name}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n      <div style={{\r\n        marginTop: '4px',\r\n        fontSize: '12px',\r\n        color: DARK_COLORS.textDim,\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        gap: '4px'\r\n      }}>\r\n        <span>Showing: {shownCount}</span>\r\n        <span></span>\r\n        <span>Hidden: {hiddenCount}</span>\r\n\r\n        <div style={{\r\n          opacity: value ? 1 : 0,\r\n          gap: '4px',\r\n          display: 'flex',\r\n          alignItems: 'center'\r\n        }}>\r\n          <span></span>\r\n          <button\r\n            onClick={onClearFilter}\r\n            style={{\r\n              background: 'none',\r\n              border: 'none',\r\n              padding: 0,\r\n              color: DARK_COLORS.text,\r\n              cursor: 'pointer',\r\n              textDecoration: 'underline',\r\n            }}\r\n          >\r\n            clear all\r\n          </button>\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import { useRef, useState } from 'react'\r\nimport { processPacketDataForLogging } from 'mcraft-fun-mineflayer/build/packetsLogger'\r\nimport { PacketData } from '../../ReplayPanel'\r\nimport { useScrollBehavior } from '../../hooks/useScrollBehavior'\r\nimport { ClientOnMap } from '../../../generatedServerPackets'\r\nimport { DARK_COLORS } from './constants'\r\n\r\nconst formatters: Record<string, (data: any) => string> = {\r\n  position: (data) => `x:${data.x.toFixed(2)} y:${data.y.toFixed(2)} z:${data.z.toFixed(2)}`,\r\n  // chat: (data) => data,\r\n  map_chunk (data: ClientOnMap['map_chunk'] | any) {\r\n    const sizeOfChunk = data.chunkData?.length\r\n    const blockEntitiesCount = data.blockEntities?.length\r\n    return `x:${data.x} z:${data.z} C:${sizeOfChunk} E:${blockEntitiesCount}`\r\n  },\r\n  default: (data) => processPacketDataForLogging(data)\r\n}\r\n\r\nconst getPacketIcon = (name: string): string => {\r\n  if (name.includes('position')) return ''\r\n  if (name.includes('chat')) return ''\r\n  if (name.includes('block') || name.includes('chunk') || name.includes('light')) return ''\r\n  if (name.includes('entity') || name.includes('player') || name.includes('passenger')) return ''\r\n  return ''\r\n}\r\n\r\ninterface Props {\r\n  packets: PacketData[]\r\n  filter: string\r\n  maxHeight?: number\r\n}\r\n\r\nconst ROW_HEIGHT = 24\r\nconst EXPANDED_HEIGHT = 120\r\n\r\nfunction formatTimeDiff (current: number, prev: number | null): string {\r\n  if (prev === null) return ''\r\n  const diff = current - prev\r\n  return `+${Math.floor(diff / 1000)}`\r\n}\r\n\r\nconst styles = {\r\n  packetRow: {\r\n    height: ROW_HEIGHT,\r\n    padding: '0 8px',\r\n    fontSize: '12px',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '8px',\r\n    whiteSpace: 'nowrap',\r\n    overflow: 'hidden',\r\n    cursor: 'pointer',\r\n    transition: 'background-color 0.1s'\r\n  } as const,\r\n  expandedPacket: {\r\n    height: EXPANDED_HEIGHT,\r\n    padding: '8px',\r\n    background: DARK_COLORS.input,\r\n    fontSize: '12px',\r\n    overflow: 'auto',\r\n    borderBottom: `1px solid ${DARK_COLORS.border}`\r\n  } as const\r\n}\r\n\r\nexport default function PacketList ({ packets, filter, maxHeight = 300 }: Props) {\r\n  const listRef = useRef<HTMLDivElement>(null)\r\n  const [expandedPacket, setExpandedPacket] = useState<number | null>(null)\r\n  const { scrollToBottom } = useScrollBehavior(listRef, { messages: packets, opened: true })\r\n\r\n  let prevTimestamp: number | null = null\r\n\r\n  return (\r\n    <>\r\n      <style>\r\n        {`\r\n          .packet-row:hover {\r\n            background: ${DARK_COLORS.hover} !important;\r\n          }\r\n        `}\r\n      </style>\r\n      <div\r\n        ref={listRef}\r\n        style={{\r\n          overflowY: 'auto',\r\n          height: maxHeight,\r\n          display: 'flex',\r\n          flexDirection: 'column'\r\n        }}\r\n      >\r\n        <div style={{ minHeight: '100%' }}>\r\n          {packets.map((packet, index) => {\r\n            const timeDiff = formatTimeDiff(packet.timestamp, prevTimestamp)\r\n            prevTimestamp = packet.timestamp\r\n            return (\r\n              <div key={`${packet.timestamp}-${packet.position}`}>\r\n                <div\r\n                  className=\"packet-row\"\r\n                  onClick={() => setExpandedPacket(expandedPacket === packet.position ? null : packet.position)}\r\n                  style={{\r\n                    ...styles.packetRow,\r\n                    background: packet.isFromClient ? DARK_COLORS.client : DARK_COLORS.server,\r\n                    opacity: packet.isUpcoming ? 0.5 : 1\r\n                  }}\r\n                >\r\n                  <span>{getPacketIcon(packet.name)}</span>\r\n                  <span style={{ color: DARK_COLORS.textDim }}>\r\n                    #{packet.position}\r\n                    {timeDiff && <span style={{ marginLeft: '4px' }}>{timeDiff}</span>}\r\n                  </span>\r\n                  {filter && (\r\n                    <span style={{ color: DARK_COLORS.textDim }}>#{index + 1}</span>\r\n                  )}\r\n                  <span style={{\r\n                    color: packet.actualVersion ? DARK_COLORS.modified : DARK_COLORS.text,\r\n                    fontWeight: 'bold'\r\n                  }}>\r\n                    {packet.name}\r\n                  </span>\r\n                  <span style={{ color: DARK_COLORS.textDim, flex: 1, overflow: 'hidden', textOverflow: 'ellipsis' }}>\r\n                    {formatters[packet.name]?.(packet.data) ?? formatters.default(packet.data)}\r\n                  </span>\r\n                </div>\r\n                {expandedPacket === packet.position && (\r\n                  <div style={styles.expandedPacket}>\r\n                    <div style={{ marginBottom: '8px' }}>\r\n                      <strong>Data:</strong>\r\n                      <pre style={{ margin: '4px 0', color: DARK_COLORS.textDim }}>\r\n                        {JSON.stringify(JSON.parse(formatters.default(packet.data)), null, 2)}\r\n                      </pre>\r\n                    </div>\r\n                    {packet.actualVersion && (\r\n                      <div>\r\n                        <strong>Actual Version:</strong>\r\n                        <pre style={{ margin: '4px 0', color: DARK_COLORS.textDim }}>\r\n                          {JSON.stringify(JSON.parse(formatters.default(packet.actualVersion)), null, 2)}\r\n                        </pre>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )\r\n          })}\r\n        </div>\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n","import { DARK_COLORS } from './constants'\r\n\r\ninterface Props {\r\n  current: number\r\n  total: number\r\n}\r\n\r\nfunction padNumber (num: number): string {\r\n  return String(num).padStart(3, '0')\r\n}\r\n\r\nexport default function ProgressBar ({ current, total }: Props) {\r\n  return (\r\n    <div style={{ display: 'flex', alignItems: 'center', gap: '8px', flex: 1 }}>\r\n      <div style={{ color: DARK_COLORS.textDim, fontSize: '12px', minWidth: '70px' }}>\r\n        {padNumber(current)}/{padNumber(total)}\r\n      </div>\r\n      <div style={{\r\n        flex: 1,\r\n        height: '4px',\r\n        background: DARK_COLORS.border,\r\n        borderRadius: '2px'\r\n      }}>\r\n        <div\r\n          style={{\r\n            width: `${(current / total) * 100}%`,\r\n            height: '100%',\r\n            background: DARK_COLORS.text,\r\n            borderRadius: '2px',\r\n            transition: 'width 0.2s'\r\n          }}\r\n        />\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","export const DARK_COLORS = {\r\n  bg: '#1e1e1e',\r\n  input: '#2d2d2d',\r\n  text: '#ffffff',\r\n  textDim: '#888888',\r\n  client: '#144218',\r\n  server: '#750200',\r\n  modified: '#f57f17',\r\n  border: '#333333',\r\n  hover: '#404040'\r\n}\r\n","import absorption from 'mc-assets/dist/other-textures/latest/mob_effect/absorption.png'\r\nimport glowing from 'mc-assets/dist/other-textures/latest/mob_effect/glowing.png'\r\nimport instant_health from 'mc-assets/dist/other-textures/latest/mob_effect/instant_health.png'\r\nimport nausea from 'mc-assets/dist/other-textures/latest/mob_effect/nausea.png'\r\nimport slow_falling from 'mc-assets/dist/other-textures/latest/mob_effect/slow_falling.png'\r\nimport weakness from 'mc-assets/dist/other-textures/latest/mob_effect/weakness.png'\r\nimport bad_omen from 'mc-assets/dist/other-textures/latest/mob_effect/bad_omen.png'\r\nimport haste from 'mc-assets/dist/other-textures/latest/mob_effect/haste.png'\r\nimport invisibility from 'mc-assets/dist/other-textures/latest/mob_effect/invisibility.png'\r\nimport night_vision from 'mc-assets/dist/other-textures/latest/mob_effect/night_vision.png'\r\nimport slowness from 'mc-assets/dist/other-textures/latest/mob_effect/slowness.png'\r\nimport wither from 'mc-assets/dist/other-textures/latest/mob_effect/wither.png'\r\nimport blindness from 'mc-assets/dist/other-textures/latest/mob_effect/blindness.png'\r\nimport health_boost from 'mc-assets/dist/other-textures/latest/mob_effect/health_boost.png'\r\nimport jump_boost from 'mc-assets/dist/other-textures/latest/mob_effect/jump_boost.png'\r\nimport poison from 'mc-assets/dist/other-textures/latest/mob_effect/poison.png'\r\nimport speed from 'mc-assets/dist/other-textures/latest/mob_effect/speed.png'\r\nimport conduit_power from 'mc-assets/dist/other-textures/latest/mob_effect/conduit_power.png'\r\nimport hero_of_the_village from 'mc-assets/dist/other-textures/latest/mob_effect/hero_of_the_village.png'\r\nimport levitation from 'mc-assets/dist/other-textures/latest/mob_effect/levitation.png'\r\nimport regeneration from 'mc-assets/dist/other-textures/latest/mob_effect/regeneration.png'\r\nimport strength from 'mc-assets/dist/other-textures/latest/mob_effect/strength.png'\r\nimport dolphins_grace from 'mc-assets/dist/other-textures/latest/mob_effect/dolphins_grace.png'\r\nimport hunger from 'mc-assets/dist/other-textures/latest/mob_effect/hunger.png'\r\nimport luck from 'mc-assets/dist/other-textures/latest/mob_effect/luck.png'\r\nimport resistance from 'mc-assets/dist/other-textures/latest/mob_effect/resistance.png'\r\nimport unluck from 'mc-assets/dist/other-textures/latest/mob_effect/unluck.png'\r\nimport fire_resistance from 'mc-assets/dist/other-textures/latest/mob_effect/fire_resistance.png'\r\nimport instant_damage from 'mc-assets/dist/other-textures/latest/mob_effect/instant_damage.png'\r\nimport mining_fatigue from 'mc-assets/dist/other-textures/latest/mob_effect/mining_fatigue.png'\r\nimport saturation from 'mc-assets/dist/other-textures/latest/mob_effect/saturation.png'\r\nimport water_breathing from 'mc-assets/dist/other-textures/latest/mob_effect/water_breathing.png'\r\nimport darkness from 'mc-assets/dist/other-textures/latest/mob_effect/darkness.png'\r\n\r\ninterface Images {\r\n  [key: string]: string;\r\n}\r\n\r\n// Export an object containing image URLs\r\nexport const images: Images = {\r\n  absorption,\r\n  glowing,\r\n  instant_health,\r\n  nausea,\r\n  slow_falling,\r\n  weakness,\r\n  bad_omen,\r\n  haste,\r\n  invisibility,\r\n  night_vision,\r\n  slowness,\r\n  wither,\r\n  blindness,\r\n  health_boost,\r\n  jump_boost,\r\n  poison,\r\n  speed,\r\n  conduit_power,\r\n  hero_of_the_village,\r\n  levitation,\r\n  regeneration,\r\n  strength,\r\n  dolphins_grace,\r\n  hunger,\r\n  luck,\r\n  resistance,\r\n  unluck,\r\n  bad_luck: unluck,\r\n  good_luck: luck,\r\n  fire_resistance,\r\n  instant_damage,\r\n  mining_fatigue,\r\n  saturation,\r\n  water_breathing,\r\n  darkness\r\n}\r\n","import { RefObject, useEffect, useLayoutEffect, useRef } from 'react'\r\nimport { pixelartIcons } from '../PixelartIcon'\r\n\r\nexport const useScrollBehavior = (\r\n  elementRef: RefObject<HTMLElement>,\r\n  {\r\n    messages,\r\n    opened\r\n  }: {\r\n    messages: readonly any[],\r\n    opened?: boolean\r\n  }\r\n) => {\r\n  const openedWasAtBottom = useRef(true) // before new messages\r\n\r\n  const isAtBottom = () => {\r\n    if (!elementRef.current) return true\r\n    const { scrollTop, scrollHeight, clientHeight } = elementRef.current\r\n    const distanceFromBottom = Math.abs(scrollHeight - clientHeight - scrollTop)\r\n    return distanceFromBottom < 1\r\n  }\r\n\r\n  const scrollToBottom = () => {\r\n    if (elementRef.current) {\r\n      elementRef.current.scrollTop = elementRef.current.scrollHeight\r\n    }\r\n  }\r\n\r\n  // Handle scroll position tracking\r\n  useEffect(() => {\r\n    const element = elementRef.current\r\n    if (!element) return\r\n\r\n    const handleScroll = () => {\r\n      openedWasAtBottom.current = isAtBottom()\r\n    }\r\n\r\n    element.addEventListener('scroll', handleScroll)\r\n    return () => element.removeEventListener('scroll', handleScroll)\r\n  }, [])\r\n\r\n  // Handle opened state changes\r\n  useLayoutEffect(() => {\r\n    if (opened) {\r\n      openedWasAtBottom.current = true\r\n    } else {\r\n      scrollToBottom()\r\n    }\r\n  }, [opened])\r\n\r\n  // Handle messages changes\r\n  useLayoutEffect(() => {\r\n    if ((!opened || (opened && openedWasAtBottom.current)) && elementRef.current) {\r\n      scrollToBottom()\r\n    }\r\n  }, [messages])\r\n\r\n  return {\r\n    scrollToBottom,\r\n    isAtBottom\r\n  }\r\n}\r\n","import { PacketData } from './ReplayPanel'\r\n\r\nfunction wildcardToRegExp (pattern: string): RegExp {\r\n  const escaped = pattern.replaceAll(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\r\n  return new RegExp(`^${escaped.replaceAll('\\\\*', '.*')}$`)\r\n}\r\n\r\nfunction patternToRegExp (pattern: string): RegExp {\r\n  if (pattern.startsWith('$')) {\r\n    return new RegExp(`^${pattern.slice(1)}$`)\r\n  }\r\n  return wildcardToRegExp(`*${pattern}*`)\r\n}\r\n\r\nexport function parseFilterString (filter: string): { include: RegExp[]; exclude: RegExp[] } {\r\n  const parts = filter.split(/,\\s*/)\r\n  const include: RegExp[] = []\r\n  const exclude: RegExp[] = []\r\n\r\n  for (const part of parts) {\r\n    if (!part) continue\r\n    if (part.startsWith('!')) {\r\n      exclude.push(patternToRegExp(part.slice(1)))\r\n    } else {\r\n      include.push(patternToRegExp(part))\r\n    }\r\n  }\r\n\r\n  return { include, exclude }\r\n}\r\n\r\nexport function filterPackets (packets: PacketData[], filter: string): { filtered: PacketData[]; hiddenCount: number } {\r\n  if (!filter.trim()) {\r\n    return { filtered: packets, hiddenCount: 0 }\r\n  }\r\n\r\n  const { include, exclude } = parseFilterString(filter)\r\n  const filtered = packets.filter(packet => {\r\n    // If packet matches any exclude pattern, filter it out\r\n    if (exclude.some(pattern => pattern.test(packet.name))) {\r\n      return false\r\n    }\r\n    // If there are include patterns, packet must match at least one\r\n    if (include.length > 0) {\r\n      return include.some(pattern => pattern.test(packet.name))\r\n    }\r\n    // If no include patterns, keep the packet (unless it was excluded)\r\n    return true\r\n  })\r\n\r\n  return {\r\n    filtered,\r\n    hiddenCount: packets.length - filtered.length\r\n  }\r\n}\r\n","export async function parseBindingName (binding: string) {\r\n  if (!binding) return ''\r\n\r\n  const { keyboard } = (typeof navigator === 'undefined' ? undefined : navigator) ?? {}\r\n  const layoutMap = await keyboard?.getLayoutMap?.() ?? new Map<string, string>()\r\n\r\n  const mapKey = (key: string) => layoutMap.get(key) || key\r\n\r\n  const cut = binding.replaceAll(/(Digit|Key)/g, '')\r\n  const parts = cut.includes('+') ? cut.split('+') : [cut]\r\n\r\n  for (let i = 0; i < parts.length; i++) {\r\n    parts[i] = mapKey(parts[i]).split(/(?<=[a-z])(?=\\d)/).join(' ').split(/(?=[A-Z])/).reverse().join(' ')\r\n  }\r\n\r\n  return parts.join(' + ')\r\n}\r\n","import { appQueryParams } from '../appParams'\r\nimport { miscUiState } from '../globalState'\r\nimport { BaseServerInfo } from './AddServerOrConnect'\r\nimport { appStorage, StoreServerItem } from './appStorageProvider'\r\n\r\nconst serversListQs = appQueryParams.serversList\r\n\r\nexport interface AuthenticatedAccount {\r\n  // type: 'microsoft'\r\n  username: string\r\n  cachedTokens?: {\r\n    data: any\r\n    expiresOn: number\r\n  }\r\n}\r\n\r\nexport interface ServerConnectionHistory {\r\n  ip: string\r\n  numConnects: number\r\n  lastConnected: number\r\n  version?: string\r\n}\r\n\r\nexport function updateServerConnectionHistory (ip: string, version?: string) {\r\n  try {\r\n    const history = [...(appStorage.serversHistory ?? [])]\r\n    const existingServer = history.find(s => s.ip === ip)\r\n    if (existingServer) {\r\n      existingServer.numConnects++\r\n      existingServer.lastConnected = Date.now()\r\n      if (version) existingServer.version = version\r\n    } else {\r\n      history.push({\r\n        ip,\r\n        numConnects: 1,\r\n        lastConnected: Date.now(),\r\n        version\r\n      })\r\n    }\r\n    appStorage.serversHistory = history\r\n  } catch (err) {\r\n    console.error('Failed to update server connection history:', err)\r\n  }\r\n}\r\n\r\nexport const updateLoadedServerData = (callback: (data: StoreServerItem) => StoreServerItem, index = miscUiState.loadedServerIndex) => {\r\n  if (index === undefined) index = miscUiState.loadedServerIndex\r\n  if (index === undefined) return\r\n\r\n  const servers = [...(appStorage.serversList ?? [])]\r\n  const server = servers[index]\r\n  if (!server) return\r\n  servers[index] = callback(server)\r\n  setNewServersList(servers)\r\n}\r\n\r\nexport const setNewServersList = (serversList: StoreServerItem[], force = false) => {\r\n  if (serversListQs && !force) return\r\n  appStorage.serversList = serversList\r\n}\r\n\r\nexport const getInitialServersList = () => {\r\n  // If we already have servers in appStorage, use those\r\n  if (appStorage.serversList) return appStorage.serversList\r\n\r\n  const servers = [] as StoreServerItem[]\r\n\r\n  if (servers.length === 0) {\r\n    // server list is empty, let's suggest some\r\n    for (const server of miscUiState.appConfig?.promoteServers ?? []) {\r\n      servers.push({\r\n        ip: server.ip,\r\n        description: server.description,\r\n        versionOverride: server.version,\r\n      })\r\n    }\r\n  }\r\n\r\n  return servers\r\n}\r\n\r\nexport const updateAuthenticatedAccountData = (callback: (data: AuthenticatedAccount[]) => AuthenticatedAccount[]) => {\r\n  const accounts = appStorage.authenticatedAccounts\r\n  const newAccounts = callback(accounts)\r\n  appStorage.authenticatedAccounts = newAccounts\r\n}\r\n\r\nexport function getServerConnectionHistory (): ServerConnectionHistory[] {\r\n  return appStorage.serversHistory ?? []\r\n}\r\n","import { useUtilsEffect } from '@zardoy/react-util'\r\nimport { useEffect, useState } from 'react'\r\nimport { useMedia } from 'react-use'\r\n\r\nconst SMALL_SCREEN_MEDIA = '@media (max-width: 440px)'\r\nexport const useIsSmallWidth = () => {\r\n  return useMedia(SMALL_SCREEN_MEDIA.replace('@media ', ''))\r\n}\r\n\r\nexport const usePassesWindowDimensions = (minWidth: number | null = null, minHeight: number | null = null) => {\r\n  let media = '('\r\n  if (minWidth !== null) {\r\n    media += `min-width: ${minWidth}px, `\r\n  }\r\n  if (minHeight !== null) {\r\n    media += `min-height: ${minHeight}px, `\r\n  }\r\n  media += ')'\r\n  return useMedia(media)\r\n}\r\n\r\nexport const useCopyKeybinding = (getCopyText: () => string | undefined) => {\r\n  useUtilsEffect(({ signal }) => {\r\n    addEventListener('keydown', (e) => {\r\n      if (e.code === 'KeyC' && (e.ctrlKey || e.metaKey) && !e.shiftKey && !e.altKey) {\r\n        const { activeElement } = document\r\n        if (activeElement instanceof HTMLInputElement || activeElement instanceof HTMLTextAreaElement) {\r\n          return\r\n        }\r\n        if (window.getSelection()?.toString()) {\r\n          return\r\n        }\r\n        e.preventDefault()\r\n        const copyText = getCopyText()\r\n        if (!copyText) return\r\n        void navigator.clipboard.writeText(copyText)\r\n      }\r\n    }, { signal })\r\n  }, [getCopyText])\r\n}\r\n\r\nexport const useIsHashActive = (hash: `#${string}`) => {\r\n  const [isActive, setIsActive] = useState(false)\r\n\r\n  useEffect(() => {\r\n    const checkHash = () => {\r\n      setIsActive(location.hash === hash)\r\n    }\r\n    checkHash()\r\n    addEventListener('hashchange', checkHash)\r\n    return () => {\r\n      removeEventListener('hashchange', checkHash)\r\n    }\r\n  }, [])\r\n  return isActive\r\n}\r\n","import prettyBytes from 'pretty-bytes'\r\n\r\nexport const getFixedFilesize = (bytes: number) => {\r\n  return prettyBytes(bytes, { minimumFractionDigits: 2, maximumFractionDigits: 2 })\r\n}\r\n","import { proxy } from 'valtio'\r\nimport type { PacketData } from '../ReplayPanel'\r\nimport { appQueryParams, updateQsParam } from '../../appParams'\r\n\r\nexport const packetsReplayState = proxy({\r\n  packetsPlayback: [] as PacketData[],\r\n  isOpen: false,\r\n  isMinimized: false,\r\n  replayName: '',\r\n  isPlaying: false,\r\n  progress: {\r\n    current: 0,\r\n    total: 0\r\n  },\r\n  speed: appQueryParams.replaySpeed ? parseFloat(appQueryParams.replaySpeed) : 1,\r\n  customButtons: {\r\n    validateClientPackets: {\r\n      state: appQueryParams.replayValidateClient === 'true',\r\n      label: 'C',\r\n      tooltip: 'Validate client packets'\r\n    },\r\n    stopOnError: {\r\n      state: appQueryParams.replayStopOnError === 'true',\r\n      label: 'E',\r\n      tooltip: 'Stop the replay when an error occurs'\r\n    },\r\n    skipMissingOnTimeout: {\r\n      state: appQueryParams.replaySkipMissingOnTimeout === 'true',\r\n      label: 'T',\r\n      tooltip: 'Skip missing packets on timeout'\r\n    },\r\n    packetsSenderDelay: {\r\n      state: appQueryParams.replayPacketsSenderDelay === 'true',\r\n      label: 'D',\r\n      tooltip: 'Send packets with an additional delay'\r\n    }\r\n  }\r\n})\r\n\r\nexport const onChangeButtonState = (button: keyof typeof packetsReplayState.customButtons, state: boolean) => {\r\n  packetsReplayState.customButtons[button].state = state\r\n  switch (button) {\r\n    case 'validateClientPackets': {\r\n      updateQsParam('replayValidateClient', String(state))\r\n      break\r\n    }\r\n    case 'stopOnError': {\r\n      updateQsParam('replayStopOnError', String(state))\r\n      break\r\n    }\r\n    case 'skipMissingOnTimeout': {\r\n      updateQsParam('replaySkipMissingOnTimeout', String(state))\r\n      break\r\n    }\r\n    case 'packetsSenderDelay': {\r\n      updateQsParam('replayPacketsSenderDelay', String(state))\r\n      break\r\n    }\r\n  }\r\n}\r\n","import { proxy, subscribe } from 'valtio'\r\nimport * as THREE from 'three'\r\nimport { useEffect } from 'react'\r\n\r\nexport const motionState = proxy({\r\n  offset: { x: 0, y: 0 }\r\n})\r\n\r\nconst MOTION_DAMPING = 0.92\r\nconst MAX_MOTION_OFFSET = 100\r\nconst motionVelocity = { x: 0, y: 0 }\r\nlet lastUpdate = performance.now()\r\nlet lastYaw = 0\r\nlet lastPitch = 0\r\n\r\nexport function updateMotion () {\r\n  if (!bot?.entity) return\r\n  const now = performance.now()\r\n  const deltaTime = (now - lastUpdate) / 1000 // Convert to seconds\r\n  lastUpdate = now\r\n\r\n  // Get camera movement contribution\r\n  const yawDiff = (bot.entity.yaw - lastYaw)\r\n  const pitchDiff = (bot.entity.pitch - lastPitch)\r\n  lastYaw = bot.entity.yaw\r\n  lastPitch = bot.entity.pitch\r\n\r\n  // Create a vector for velocity in world space\r\n  const { velocity } = bot.entity\r\n  const velocityVector = new THREE.Vector3(velocity.x, 0, velocity.z)\r\n\r\n  // Get camera's forward direction\r\n  const cameraQuat = new THREE.Quaternion()\r\n  cameraQuat.setFromEuler(new THREE.Euler(0, -bot.entity.yaw, 0))\r\n\r\n  // Transform velocity to camera space\r\n  velocityVector.applyQuaternion(cameraQuat)\r\n\r\n  // Calculate motion contribution\r\n  const velocityContribution = {\r\n    x: -velocityVector.x * 150,\r\n    y: -velocityVector.z * 150\r\n  }\r\n\r\n  // Combine camera and velocity effects\r\n  motionVelocity.x += (yawDiff * 300 + velocityContribution.x) * deltaTime\r\n  motionVelocity.y += (pitchDiff * 300 + velocityContribution.y) * deltaTime\r\n\r\n  // Apply damping\r\n  motionVelocity.x *= MOTION_DAMPING\r\n  motionVelocity.y *= MOTION_DAMPING\r\n\r\n  // Clamp values\r\n  motionVelocity.x = Math.max(-MAX_MOTION_OFFSET, Math.min(MAX_MOTION_OFFSET, motionVelocity.x))\r\n  motionVelocity.y = Math.max(-MAX_MOTION_OFFSET, Math.min(MAX_MOTION_OFFSET, motionVelocity.y))\r\n\r\n  // Update the motion state\r\n  motionState.offset = {\r\n    x: motionVelocity.x,\r\n    y: motionVelocity.y\r\n  }\r\n}\r\n\r\nlet motionEnabled = false\r\nexport function initMotionTracking () {\r\n  if (motionEnabled) return\r\n  motionEnabled = true\r\n\r\n  function animate () {\r\n    updateMotion()\r\n    requestAnimationFrame(animate)\r\n  }\r\n  animate()\r\n}\r\n\r\nexport function useUiMotion (ref: React.RefObject<HTMLElement>, enabled = true) {\r\n  useEffect(() => {\r\n    if (!enabled || !ref.current) return\r\n\r\n    const unsubscribe = subscribe(motionState, () => {\r\n      const el = ref.current\r\n      if (!el) return\r\n      el.style.transform = `translate(${motionState.offset.x.toFixed(2)}px, ${motionState.offset.y.toFixed(2)}px)`\r\n    })\r\n\r\n    return () => unsubscribe()\r\n  }, [enabled, ref])\r\n}\r\n","import { useCallback, useRef, useState } from 'react'\r\n\r\ninterface LongPressOptions {\r\n  shouldPreventDefault?: boolean;\r\n  delay?: number;\r\n}\r\n\r\nconst useLongPress = (\r\n  onLongPress: () => void,\r\n  onClick: () => void,\r\n  { shouldPreventDefault = false, delay = 300 }: LongPressOptions = {}\r\n) => {\r\n  const [longPressTriggered, setLongPressTriggered] = useState(false)\r\n  const timeout = useRef<number | undefined>()\r\n  const target = useRef<EventTarget | null>(null)\r\n\r\n  const start = useCallback(\r\n    (event: React.MouseEvent | React.TouchEvent) => {\r\n      if (shouldPreventDefault && event.target) {\r\n        event.target.addEventListener('touchend', preventDefault, {\r\n          passive: false\r\n        })\r\n        target.current = event.target\r\n      }\r\n      timeout.current = window.setTimeout(() => {\r\n        onLongPress()\r\n        setLongPressTriggered(true)\r\n      }, delay)\r\n    },\r\n    [onLongPress, delay, shouldPreventDefault]\r\n  )\r\n\r\n  const clear = useCallback(\r\n    (event: React.MouseEvent | React.TouchEvent) => {\r\n      if (timeout.current) {\r\n        clearTimeout(timeout.current)\r\n        timeout.current = undefined\r\n      }\r\n\r\n      setLongPressTriggered(false)\r\n\r\n      if (shouldPreventDefault && target.current) {\r\n        target.current.removeEventListener('touchend', preventDefault)\r\n        target.current = null\r\n      }\r\n    },\r\n    [shouldPreventDefault, onClick, longPressTriggered]\r\n  )\r\n\r\n  return {\r\n    onMouseDown: (e: React.MouseEvent) => start(e),\r\n    onTouchStart: (e: React.TouchEvent) => start(e),\r\n    onMouseUp: (e: React.MouseEvent) => clear(e),\r\n    onMouseLeave: (e: React.MouseEvent) => clear(e),\r\n    onTouchEnd: (e: React.TouchEvent) => clear(e),\r\n    onClick (e: React.MouseEvent) {\r\n      onClick()\r\n    }\r\n  }\r\n}\r\n\r\nconst preventDefault = (event: Event) => {\r\n  if (!('touches' in event)) return\r\n\r\n  const touchEvent = event as TouchEvent\r\n  if (touchEvent.touches.length < 2 && event.preventDefault) {\r\n    event.preventDefault()\r\n  }\r\n}\r\n\r\nexport default useLongPress\r\n","import { useEffect, useRef } from 'react'\r\nimport { UAParser } from 'ua-parser-js'\r\n\r\nexport function useDidUpdateEffect (fn, inputs) {\r\n  const isMountingRef = useRef(false)\r\n\r\n  useEffect(() => {\r\n    isMountingRef.current = true\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    if (isMountingRef.current) {\r\n      isMountingRef.current = false\r\n    } else {\r\n      return fn()\r\n    }\r\n  }, inputs)\r\n}\r\n\r\nexport const ua = new UAParser(navigator.userAgent)\r\n\r\nexport const isIos = ua.getOS().name === 'iOS'\r\n\r\nexport const reactKeyForMessage = (message) => {\r\n  return typeof message === 'string' ? message : JSON.stringify(message)\r\n}\r\n","import { proxy, useSnapshot } from 'valtio'\r\nimport { useEffect, useMemo } from 'react'\r\nimport { useMedia } from 'react-use'\r\nimport { activeModalStack, miscUiState } from '../globalState'\r\n\r\nexport const watchedModalsFromHooks = proxy({\r\n  value: new Set<string>()\r\n})\r\n// todo should not be there\r\nexport const hardcodedKnownModals = [\r\n  'player_win:',\r\n  'full-map' // todo\r\n]\r\n\r\nexport const useUsingTouch = () => {\r\n  return useSnapshot(miscUiState).currentTouch\r\n}\r\nexport const useIsModalActive = (modal: string, useIncludes = false) => {\r\n  useMemo(() => {\r\n    watchedModalsFromHooks.value.add(modal)\r\n  }, [])\r\n  useEffect(() => {\r\n    // watchedModalsFromHooks.add(modal)\r\n    return () => {\r\n      watchedModalsFromHooks.value.delete(modal)\r\n    }\r\n  }, [])\r\n\r\n  const allStack = useSnapshot(activeModalStack)\r\n  return useIncludes ? allStack.some(x => x.reactType === modal) : allStack.at(-1)?.reactType === modal\r\n}\r\n\r\nexport const useIsWidgetActive = (name: string) => {\r\n  return useIsModalActive(`widget-${name}`)\r\n}\r\n\r\nexport const useIsSmallWidth = () => {\r\n  return useMedia('(max-width: 550px)')\r\n}\r\n","import * as ModuleSignsViewer from './ModuleSignsViewer'\r\n\r\nexport default [ModuleSignsViewer]\r\n","//@ts-check\r\nimport { renderToDom, ErrorBoundary } from '@zardoy/react-util'\r\nimport { useSnapshot } from 'valtio'\r\nimport { QRCodeSVG } from 'qrcode.react'\r\nimport { createPortal } from 'react-dom'\r\nimport { useEffect, useMemo, useState } from 'react'\r\nimport { activeModalStack, miscUiState } from './globalState'\r\nimport DeathScreenProvider from './react/DeathScreenProvider'\r\nimport OptionsRenderApp from './react/OptionsRenderApp'\r\nimport MainMenuRenderApp from './react/MainMenuRenderApp'\r\nimport SingleplayerProvider from './react/SingleplayerProvider'\r\nimport CreateWorldProvider from './react/CreateWorldProvider'\r\nimport AppStatusProvider from './react/AppStatusProvider'\r\nimport SelectOption from './react/SelectOption'\r\nimport EnterFullscreenButton from './react/EnterFullscreenButton'\r\nimport ChatProvider from './react/ChatProvider'\r\nimport TitleProvider from './react/TitleProvider'\r\nimport ScoreboardProvider from './react/ScoreboardProvider'\r\nimport SignEditorProvider from './react/SignEditorProvider'\r\nimport IndicatorEffectsProvider from './react/IndicatorEffectsProvider'\r\nimport PlayerListOverlayProvider from './react/PlayerListOverlayProvider'\r\nimport MinimapProvider, { DrawerAdapterImpl } from './react/MinimapProvider'\r\nimport HudBarsProvider from './react/HudBarsProvider'\r\nimport XPBarProvider from './react/XPBarProvider'\r\nimport DebugOverlay from './react/DebugOverlay'\r\nimport MobileTopButtons from './react/MobileTopButtons'\r\nimport PauseScreen from './react/PauseScreen'\r\nimport SoundMuffler from './react/SoundMuffler'\r\nimport TouchControls from './react/TouchControls'\r\nimport widgets from './react/widgets'\r\nimport { useIsModalActive, useIsWidgetActive } from './react/utilsApp'\r\nimport GlobalSearchInput from './react/GlobalSearchInput'\r\nimport TouchAreasControlsProvider from './react/TouchAreasControlsProvider'\r\nimport NotificationProvider, { showNotification } from './react/NotificationProvider'\r\nimport HotbarRenderApp from './react/HotbarRenderApp'\r\nimport Crosshair from './react/Crosshair'\r\nimport ButtonAppProvider from './react/ButtonAppProvider'\r\nimport ServersListProvider from './react/ServersListProvider'\r\nimport GamepadUiCursor from './react/GamepadUiCursor'\r\nimport KeybindingsScreenProvider from './react/KeybindingsScreenProvider'\r\nimport HeldMapUi from './react/HeldMapUi'\r\nimport BedTime from './react/BedTime'\r\nimport NoModalFoundProvider from './react/NoModalFoundProvider'\r\nimport SignInMessageProvider from './react/SignInMessageProvider'\r\nimport BookProvider from './react/BookProvider'\r\nimport { options } from './optionsStorage'\r\nimport BossBarOverlayProvider from './react/BossBarOverlayProvider'\r\nimport DebugEdges from './react/DebugEdges'\r\nimport GameInteractionOverlay from './react/GameInteractionOverlay'\r\nimport MineflayerPluginHud from './react/MineflayerPluginHud'\r\nimport MineflayerPluginConsole from './react/MineflayerPluginConsole'\r\nimport { UIProvider } from './react/UIProvider'\r\nimport { useAppScale } from './scaleInterface'\r\nimport PacketsReplayProvider from './react/PacketsReplayProvider'\r\nimport TouchInteractionHint from './react/TouchInteractionHint'\r\n\r\nconst RobustPortal = ({ children, to }) => {\r\n  return createPortal(<PerComponentErrorBoundary>{children}</PerComponentErrorBoundary>, to)\r\n}\r\n\r\nconst DisplayQr = () => {\r\n  const { currentDisplayQr } = useSnapshot(miscUiState)\r\n\r\n  if (!currentDisplayQr) return null\r\n\r\n  return <div\r\n    style={{\r\n      position: 'fixed',\r\n      top: 0,\r\n      left: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      display: 'flex',\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n      zIndex: 15\r\n    }}\r\n    onClick={() => {\r\n      miscUiState.currentDisplayQr = null\r\n    }}\r\n  >\r\n    <QRCodeSVG size={384} value={currentDisplayQr} style={{ display: 'block', border: '2px solid black' }} />\r\n  </div>\r\n}\r\n\r\n// mounted earlier than ingame ui TODO\r\nconst GameHud = ({ children }) => {\r\n  const { loadedDataVersion } = useSnapshot(miscUiState)\r\n  const [gameLoaded, setGameLoaded] = useState(false)\r\n\r\n  useEffect(() => {\r\n    customEvents.on('mineflayerBotCreated', () => {\r\n      bot.once('inject_allowed', () => {\r\n        setGameLoaded(true)\r\n      })\r\n    })\r\n  }, [])\r\n  useEffect(() => {\r\n    if (!loadedDataVersion) setGameLoaded(false)\r\n  }, [loadedDataVersion])\r\n\r\n  return gameLoaded ? children : null\r\n}\r\n\r\nconst InGameComponent = ({ children }) => {\r\n  const { gameLoaded } = useSnapshot(miscUiState)\r\n  if (!gameLoaded) return null\r\n  return children\r\n}\r\n\r\n// for Fullmap and Minimap in InGameUi\r\nlet adapter: DrawerAdapterImpl\r\n\r\nconst InGameUi = () => {\r\n  const { gameLoaded, showUI: showUIRaw } = useSnapshot(miscUiState)\r\n  const { disabledUiParts, displayBossBars, showMinimap } = useSnapshot(options)\r\n  const modalsSnapshot = useSnapshot(activeModalStack)\r\n  const hasModals = modalsSnapshot.length > 0\r\n  const showUI = showUIRaw || hasModals\r\n  const displayFullmap = modalsSnapshot.some(modal => modal.reactType === 'full-map') || true\r\n  // bot can't be used here\r\n\r\n  if (!gameLoaded || !bot || disabledUiParts.includes('*')) return\r\n\r\n  if (!adapter) adapter = new DrawerAdapterImpl(bot.entity.position)\r\n\r\n  return <>\r\n    <RobustPortal to={document.querySelector('#ui-root')}>\r\n      {/* apply scaling */}\r\n      <div style={{ display: showUI ? 'block' : 'none' }}>\r\n        <PerComponentErrorBoundary>\r\n          <GameInteractionOverlay zIndex={7} />\r\n          {!disabledUiParts.includes('death-screen') && <DeathScreenProvider />}\r\n          {!disabledUiParts.includes('debug-overlay') && <DebugOverlay />}\r\n          {!disabledUiParts.includes('mobile-top-buttons') && <MobileTopButtons />}\r\n          {!disabledUiParts.includes('players-list') && <PlayerListOverlayProvider />}\r\n          {!disabledUiParts.includes('chat') && <ChatProvider />}\r\n          <SoundMuffler />\r\n          {showMinimap !== 'never' && <MinimapProvider adapter={adapter} displayMode='minimapOnly' />}\r\n          {!disabledUiParts.includes('title') && <TitleProvider />}\r\n          {!disabledUiParts.includes('scoreboard') && <ScoreboardProvider />}\r\n          {!disabledUiParts.includes('effects-indicators') && <IndicatorEffectsProvider />}\r\n          {!disabledUiParts.includes('crosshair') && <Crosshair />}\r\n          {!disabledUiParts.includes('books') && <BookProvider />}\r\n          {!disabledUiParts.includes('bossbars') && displayBossBars && <BossBarOverlayProvider />}\r\n        </PerComponentErrorBoundary>\r\n      </div>\r\n\r\n      <PerComponentErrorBoundary>\r\n        <PauseScreen />\r\n        <MineflayerPluginHud />\r\n        <MineflayerPluginConsole />\r\n        {showUI && <TouchInteractionHint />}\r\n        <div style={{ display: showUI ? 'block' : 'none' }}>\r\n          {!disabledUiParts.includes('xp-bar') && <XPBarProvider />}\r\n          {!disabledUiParts.includes('hud-bars') && <HudBarsProvider />}\r\n          <BedTime />\r\n        </div>\r\n        {showUI && !disabledUiParts.includes('hotbar') && <HotbarRenderApp />}\r\n      </PerComponentErrorBoundary>\r\n    </RobustPortal>\r\n    <PerComponentErrorBoundary>\r\n      <SignEditorProvider />\r\n      <DisplayQr />\r\n    </PerComponentErrorBoundary>\r\n    <RobustPortal to={document.body}>\r\n      {displayFullmap && <MinimapProvider adapter={adapter} displayMode='fullmapOnly' />}\r\n      {/* because of z-index */}\r\n      {showUI && <TouchControls />}\r\n      <GlobalSearchInput />\r\n    </RobustPortal>\r\n  </>\r\n}\r\n\r\nconst AllWidgets = () => {\r\n  return widgets.map(widget => <WidgetDisplay key={widget.name} name={widget.name} Component={widget.default} />)\r\n}\r\n\r\nconst WidgetDisplay = ({ name, Component }) => {\r\n  const isWidgetActive = useIsWidgetActive(name)\r\n  if (!isWidgetActive) return null\r\n\r\n  return <Component />\r\n}\r\n\r\nconst App = () => {\r\n  const scale = useAppScale()\r\n  return (\r\n    <UIProvider scale={scale}>\r\n      <div>\r\n        <ButtonAppProvider>\r\n          <RobustPortal to={document.body}>\r\n            <div className='overlay-bottom-scaled'>\r\n              <InGameComponent>\r\n                <HeldMapUi />\r\n              </InGameComponent>\r\n            </div>\r\n            <div />\r\n          </RobustPortal>\r\n          <EnterFullscreenButton />\r\n          <InGameUi />\r\n          <RobustPortal to={document.querySelector('#ui-root')}>\r\n            <AllWidgets />\r\n            <SingleplayerProvider />\r\n            <CreateWorldProvider />\r\n            <AppStatusProvider />\r\n            <KeybindingsScreenProvider />\r\n            <SelectOption />\r\n            <ServersListProvider />\r\n            <OptionsRenderApp />\r\n            <MainMenuRenderApp />\r\n            <TouchAreasControlsProvider />\r\n            <SignInMessageProvider />\r\n            <NoModalFoundProvider />\r\n            <PacketsReplayProvider />\r\n            <NotificationProvider />\r\n          </RobustPortal>\r\n          <RobustPortal to={document.body}>\r\n            <div className='overlay-top-scaled'>\r\n              <GamepadUiCursor />\r\n            </div>\r\n            <div />\r\n            <DebugEdges />\r\n          </RobustPortal>\r\n        </ButtonAppProvider>\r\n      </div>\r\n    </UIProvider>\r\n  )\r\n}\r\n\r\nconst PerComponentErrorBoundary = ({ children }) => {\r\n  return children.map((child, i) => <ErrorBoundary\r\n    key={i}\r\n    renderError={(error) => {\r\n      const componentNameClean = (child.type.name || child.type.displayName || 'Unknown').replaceAll(/__|_COMPONENT/g, '')\r\n      showNotification(`UI component ${componentNameClean} crashed!`, 'Please report this. Use console for more.', true, undefined)\r\n      return null\r\n    }}\r\n  >\r\n    {child}\r\n  </ErrorBoundary>)\r\n}\r\n\r\nrenderToDom(<App />, {\r\n  strictMode: false,\r\n  selector: '#react-root',\r\n})\r\n\r\ndisableReactProfiling()\r\nfunction disableReactProfiling () {\r\n  //@ts-expect-error\r\n  window.performance.markOrig = window.performance.mark\r\n  //@ts-expect-error\r\n  window.performance.mark = (name, options) => {\r\n    // ignore react internal marks\r\n    if (!name.startsWith('') && !localStorage.enableReactProfiling) {\r\n      //@ts-expect-error\r\n      window.performance.markOrig(name, options)\r\n    }\r\n  }\r\n}\r\n","import { subscribeKey } from 'valtio/utils'\r\nimport { gameAdditionalState } from './globalState'\r\nimport { options } from './optionsStorage'\r\nimport { playerState } from './mineflayer/playerState'\r\n\r\nlet currentFov = 0\r\nlet targetFov = 0\r\nlet lastUpdateTime = 0\r\nconst FOV_TRANSITION_DURATION = 200 // milliseconds\r\n\r\n// TODO: These should be configured based on your game's settings\r\nconst BASE_MOVEMENT_SPEED = 0.1 // Default walking speed in Minecraft\r\nconst FOV_EFFECT_SCALE = 1 // Equivalent to Minecraft's FOV Effects slider\r\n\r\nconst updateFovAnimation = () => {\r\n  if (!bot) return\r\n\r\n  // Calculate base FOV modifier\r\n  let fovModifier = 1\r\n\r\n  // Flying modifier\r\n  if (gameAdditionalState.isFlying) {\r\n    fovModifier *= 1.05\r\n  }\r\n\r\n  // Movement speed modifier\r\n  // TODO: Get actual movement speed attribute value\r\n  const movementSpeedAttr = (bot.entity?.attributes?.['generic.movement_speed'] || bot.entity?.attributes?.['minecraft:movement_speed'] || bot.entity?.attributes?.['movement_speed'] || bot.entity?.attributes?.['minecraft:movementSpeed'])?.value || BASE_MOVEMENT_SPEED\r\n  let currentSpeed = BASE_MOVEMENT_SPEED\r\n  // todo\r\n  if (bot.controlState?.sprint && !bot.controlState?.sneak) {\r\n    currentSpeed *= 1.3\r\n  }\r\n  fovModifier *= (currentSpeed / movementSpeedAttr + 1) / 2\r\n\r\n  // Validate fov modifier\r\n  if (Math.abs(BASE_MOVEMENT_SPEED) < Number.EPSILON || isNaN(fovModifier) || !isFinite(fovModifier)) {\r\n    fovModifier = 1\r\n  }\r\n\r\n  // Item usage modifier\r\n  if (playerState.getHeldItem()) {\r\n    const heldItem = playerState.getHeldItem()\r\n    if (heldItem?.name === 'bow' && playerState.getItemUsageTicks() > 0) {\r\n      const ticksUsingItem = playerState.getItemUsageTicks()\r\n      let usageProgress = ticksUsingItem / 20\r\n      if (usageProgress > 1) {\r\n        usageProgress = 1\r\n      } else {\r\n        usageProgress *= usageProgress\r\n      }\r\n      fovModifier *= 1 - usageProgress * 0.15\r\n    }\r\n    // TODO: Add spyglass/scope check here if needed\r\n  }\r\n\r\n  // Apply FOV effect scale\r\n  fovModifier = 1 + (fovModifier - 1) * FOV_EFFECT_SCALE\r\n\r\n  // Calculate target FOV\r\n  const baseFov = gameAdditionalState.isZooming ? 30 : options.fov\r\n  targetFov = baseFov * fovModifier\r\n\r\n  // Smooth transition\r\n  const now = performance.now()\r\n  if (currentFov !== targetFov) {\r\n    const elapsed = now - lastUpdateTime\r\n    const progress = Math.min(elapsed / FOV_TRANSITION_DURATION, 1)\r\n    const easeOutCubic = (t: number) => 1 - (1 - t) ** 3\r\n\r\n    currentFov += (targetFov - currentFov) * easeOutCubic(progress)\r\n\r\n    if (Math.abs(currentFov - targetFov) < 0.01) {\r\n      currentFov = targetFov\r\n    }\r\n\r\n    viewer.camera.fov = currentFov\r\n    viewer.camera.updateProjectionMatrix()\r\n  }\r\n  lastUpdateTime = now\r\n}\r\n\r\nexport const watchFov = () => {\r\n  // Initial FOV setup\r\n  if (!beforeRenderFrame.includes(updateFovAnimation)) {\r\n    beforeRenderFrame.push(updateFovAnimation)\r\n  }\r\n\r\n  customEvents.on('gameLoaded', () => {\r\n    updateFovAnimation()\r\n  })\r\n\r\n  subscribeKey(gameAdditionalState, 'isSneaking', () => {\r\n    viewer.setFirstPersonCamera(bot.entity.position, bot.entity.yaw, bot.entity.pitch)\r\n  })\r\n}\r\n","/* eslint-disable no-await-in-loop */\r\nimport { join, dirname, basename } from 'path'\r\nimport fs from 'fs'\r\nimport JSZip from 'jszip'\r\nimport { proxy, subscribe } from 'valtio'\r\nimport { WorldRendererThree } from 'renderer/viewer/lib/worldrendererThree'\r\nimport { armorTextures } from 'renderer/viewer/lib/entity/armorModels'\r\nimport { collectFilesToCopy, copyFilesAsyncWithProgress, mkdirRecursive, removeFileRecursiveAsync } from './browserfs'\r\nimport { showNotification } from './react/NotificationProvider'\r\nimport { options } from './optionsStorage'\r\nimport { showOptionsModal } from './react/SelectOption'\r\nimport { appStatusState } from './react/AppStatusProvider'\r\nimport { appReplacableResources, resourcesContentOriginal } from './generated/resources'\r\nimport { gameAdditionalState, miscUiState } from './globalState'\r\nimport { watchUnloadForCleanup } from './gameUnload'\r\nimport { createConsoleLogProgressReporter, createFullScreenProgressReporter, ProgressReporter } from './core/progressReporter'\r\n\r\nexport const resourcePackState = proxy({\r\n  resourcePackInstalled: false,\r\n  isServerDownloading: false,\r\n  isServerInstalling: false\r\n})\r\n\r\nconst getLoadedImage = async (url: string) => {\r\n  const img = new Image()\r\n  img.src = url\r\n  await new Promise((resolve, reject) => {\r\n    img.onload = resolve\r\n    img.onerror = reject\r\n  })\r\n  return img\r\n}\r\n\r\nconst resourcepackPackBasePath = '/data/resourcePacks/'\r\nexport const uninstallResourcePack = async (name = 'default') => {\r\n  if (await existsAsync('/resourcepack/pack.mcmeta')) {\r\n    await removeFileRecursiveAsync('/resourcepack')\r\n    gameAdditionalState.usingServerResourcePack = false\r\n  }\r\n  const basePath = resourcepackPackBasePath + name\r\n  if (!(await existsAsync(basePath))) return\r\n  await removeFileRecursiveAsync(basePath)\r\n  options.enabledResourcepack = null\r\n  await updateTexturePackInstalledState()\r\n}\r\n\r\nexport const getResourcePackNames = async () => {\r\n  // TODO\r\n  try {\r\n    return { [await fs.promises.readFile(join(resourcepackPackBasePath, 'default', 'name.txt'), 'utf8')]: true }\r\n  } catch (err) {\r\n    return {}\r\n  }\r\n}\r\n\r\nexport const fromTexturePackPath = (path) => {\r\n  // return join(texturePackBasePath, path)\r\n}\r\n\r\nexport const updateTexturePackInstalledState = async () => {\r\n  try {\r\n    resourcePackState.resourcePackInstalled = await existsAsync(resourcepackPackBasePath + 'default')\r\n  } catch {\r\n  }\r\n}\r\n\r\nexport const installTexturePackFromHandle = async () => {\r\n  // await mkdirRecursive(texturePackBasePath)\r\n  // await copyFilesAsyncWithProgress('/world', texturePackBasePath)\r\n  // await completeTexturePackInstall()\r\n}\r\n\r\nexport const installResourcepackPack = async (file: File | ArrayBuffer, progressReporter: ProgressReporter, displayName = file['name'], name = 'default', isServer = false) => {\r\n  console.time('processResourcePack')\r\n  const installPath = isServer ? '/resourcepack/' : resourcepackPackBasePath + name\r\n  try {\r\n    await progressReporter.executeWithMessage('Uninstalling resource pack', async () => {\r\n      await uninstallResourcePack(name)\r\n    })\r\n  } catch (err) {\r\n  }\r\n  const status = 'Installing resource pack: copying all files'\r\n  progressReporter.beginStage('copy-files-resourcepack', status)\r\n\r\n  // extract the zip and write to fs every file in it\r\n  const zip = new JSZip()\r\n  const zipFile = await zip.loadAsync(file)\r\n  if (!zipFile.file('pack.mcmeta')) throw new Error('Not a resource pack: missing /pack.mcmeta')\r\n  await mkdirRecursive(installPath)\r\n\r\n  const allFilesArr = Object.entries(zipFile.files)\r\n    .filter(([path]) => !path.startsWith('.') && !path.startsWith('_') && !path.startsWith('/')) // ignore dot files and __MACOSX\r\n  let done = 0\r\n  const upStatus = () => {\r\n    progressReporter.reportProgress('copy-files-resourcepack', done / allFilesArr.length)\r\n  }\r\n  const createdDirs = new Set<string>()\r\n  const copyTasks = [] as Array<Promise<void>>\r\n  console.time('resourcePackCopy')\r\n  await Promise.all(allFilesArr.map(async ([path, file]) => {\r\n    const writePath = join(installPath, path)\r\n    if (path.endsWith('/')) return\r\n    const dir = dirname(writePath)\r\n    if (!createdDirs.has(dir)) {\r\n      await mkdirRecursive(dir)\r\n      createdDirs.add(dir)\r\n    }\r\n    if (copyTasks.length > 100) {\r\n      await Promise.all(copyTasks)\r\n      copyTasks.length = 0\r\n    }\r\n    const promise = fs.promises.writeFile(writePath, Buffer.from(await file.async('arraybuffer')) as any)\r\n    copyTasks.push(promise)\r\n    await promise\r\n    done++\r\n    upStatus()\r\n  }))\r\n  console.timeEnd('resourcePackCopy')\r\n  await completeResourcepackPackInstall(displayName, name, isServer, progressReporter)\r\n  console.log('resource pack install done')\r\n  console.timeEnd('processResourcePack')\r\n}\r\n\r\n// or enablement\r\nexport const completeResourcepackPackInstall = async (displayName: string | undefined, name: string, isServer: boolean, progressReporter: ProgressReporter) => {\r\n  const basePath = isServer ? '/resourcepack/' : resourcepackPackBasePath + name\r\n  if (displayName) {\r\n    await fs.promises.writeFile(join(basePath, 'name.txt'), displayName, 'utf8')\r\n  }\r\n\r\n  await updateTextures(progressReporter)\r\n  if (currentErrors.length > 0) {\r\n    showNotification(`Resource pack installed & enabled with ${currentErrors.length} errors`)\r\n    console.error('Resource pack installed & enabled with errors:', currentErrors)\r\n  } else {\r\n    showNotification('Resource pack installed & enabled')\r\n  }\r\n  await updateTexturePackInstalledState()\r\n  if (isServer) {\r\n    gameAdditionalState.usingServerResourcePack = true\r\n  } else {\r\n    options.enabledResourcepack = name\r\n  }\r\n\r\n  progressReporter.end()\r\n}\r\n\r\nconst existsAsync = async (path) => {\r\n  try {\r\n    await fs.promises.stat(path)\r\n    return true\r\n  } catch (err) {\r\n    return false\r\n  }\r\n}\r\n\r\nconst arrEqual = (a: any[], b: any[]) => a.length === b.length && a.every((x) => b.includes(x))\r\n\r\nconst getSizeFromImage = async (filePath: string) => {\r\n  const probeImg = new Image()\r\n  const file = await fs.promises.readFile(filePath, 'base64')\r\n  probeImg.src = `data:image/png;base64,${file}`\r\n  await new Promise((resolve, reject) => {\r\n    probeImg.addEventListener('load', resolve)\r\n  })\r\n  if (probeImg.width !== probeImg.height) throw new Error(`Probe texture ${filePath} is not square`)\r\n  return probeImg.width\r\n}\r\n\r\nexport const getActiveResourcepackBasePath = async () => {\r\n  if (await existsAsync('/resourcepack/pack.mcmeta')) {\r\n    return '/resourcepack'\r\n  }\r\n  const { enabledResourcepack } = options\r\n  // const enabledResourcepack = 'default'\r\n  if (!enabledResourcepack) {\r\n    return null\r\n  }\r\n  if (await existsAsync(`/data/resourcePacks/${enabledResourcepack}/pack.mcmeta`)) {\r\n    return `/data/resourcePacks/${enabledResourcepack}`\r\n  }\r\n  return null\r\n}\r\n\r\nconst isDirSafe = async (filePath: string) => {\r\n  try {\r\n    return await fs.promises.stat(filePath).then(stat => stat.isDirectory()).catch(() => false)\r\n  } catch (err) {\r\n    return false\r\n  }\r\n}\r\n\r\nconst getFilesMapFromDir = async (dir: string) => {\r\n  const files = [] as string[]\r\n  const scan = async (dir) => {\r\n    const dirFiles = await fs.promises.readdir(dir)\r\n    for (const file of dirFiles) {\r\n      const filePath = join(dir, file)\r\n      if (await isDirSafe(filePath)) {\r\n        await scan(filePath)\r\n      } else {\r\n        files.push(filePath)\r\n      }\r\n    }\r\n  }\r\n  await scan(dir)\r\n  return files\r\n}\r\n\r\nlet currentErrors = [] as string[]\r\n\r\nexport const getResourcepackTiles = async (type: 'blocks' | 'items' | 'armor', existingTextures: string[], progressReporter: ProgressReporter) => {\r\n  const basePath = await getActiveResourcepackBasePath()\r\n  if (!basePath) return\r\n  let firstTextureSize: number | undefined\r\n  const namespaces = await fs.promises.readdir(join(basePath, 'assets'))\r\n  progressReporter.beginStage(`generate-atlas-texture-${type}`, `Generating atlas texture for ${type}`)\r\n\r\n  const textures = {} as Record<string, HTMLImageElement>\r\n  let path\r\n  switch (type) {\r\n    case 'blocks':\r\n      path = 'block'\r\n      break\r\n    case 'items':\r\n      path = 'item'\r\n      break\r\n    case 'armor':\r\n      path = 'models/armor'\r\n      break\r\n    default:\r\n      throw new Error('Invalid type')\r\n  }\r\n  for (const namespace of namespaces) {\r\n    const texturesCommonBasePath = `${basePath}/assets/${namespace}/textures`\r\n    const isMinecraftNamespace = namespace === 'minecraft'\r\n    let texturesBasePath = `${texturesCommonBasePath}/${path}`\r\n    const texturesBasePathAlt = `${texturesCommonBasePath}/${path}s`\r\n    if (!(await existsAsync(texturesBasePath))) {\r\n      if (await existsAsync(texturesBasePathAlt)) {\r\n        texturesBasePath = texturesBasePathAlt\r\n      }\r\n    }\r\n    const allInterestedPaths = new Set(\r\n      existingTextures\r\n        .filter(tex => (isMinecraftNamespace && !tex.includes(':')) || (tex.includes(':') && tex.split(':')[0] === namespace))\r\n        .map(tex => {\r\n          tex = tex.split(':')[1] ?? tex\r\n          if (tex.includes('/')) {\r\n            return join(`${texturesCommonBasePath}/${tex}`)\r\n          }\r\n          return join(texturesBasePath, tex)\r\n        })\r\n    )\r\n    // add all files from texturesCommonBasePath\r\n    // if (!isMinecraftNamespace) {\r\n    //   const commonBasePathFiles = await getFilesMapFromDir(texturesCommonBasePath)\r\n    //   for (const file of commonBasePathFiles) {\r\n    //     allInterestedPaths.add(file)\r\n    //   }\r\n    // }\r\n    const allInterestedPathsPerDir = new Map<string, string[]>()\r\n    for (const path of allInterestedPaths) {\r\n      const dir = dirname(path)\r\n      if (!allInterestedPathsPerDir.has(dir)) {\r\n        allInterestedPathsPerDir.set(dir, [])\r\n      }\r\n      const file = basename(path)\r\n      allInterestedPathsPerDir.get(dir)!.push(file)\r\n    }\r\n\r\n    const allInterestedImages = [] as string[]\r\n    for (const [dir, paths] of allInterestedPathsPerDir) {\r\n      if (!await existsAsync(dir)) {\r\n        continue\r\n      }\r\n      const dirImages = (await fs.promises.readdir(dir)).filter(f => f.endsWith('.png')).map(f => f.replace('.png', ''))\r\n      allInterestedImages.push(...dirImages.filter(image => paths.includes(image)).map(image => `${dir}/${image}`))\r\n    }\r\n\r\n    if (allInterestedImages.length === 0) {\r\n      continue\r\n    }\r\n\r\n    const firstImageFile = allInterestedImages[0]!\r\n    try {\r\n      firstTextureSize ??= await getSizeFromImage(`${firstImageFile}.png`)\r\n    } catch (err) { }\r\n    // eslint-disable-next-line @typescript-eslint/no-loop-func\r\n    const newTextures = Object.fromEntries(await Promise.all(allInterestedImages.map(async (image) => {\r\n      try {\r\n        const imagePath = `${image}.png`\r\n        const contents = await fs.promises.readFile(imagePath, 'base64')\r\n        const img = await getLoadedImage(`data:image/png;base64,${contents}`)\r\n        const imageRelative = image.replace(`${texturesBasePath}/`, '').replace(`${texturesCommonBasePath}/`, '')\r\n        const textureName = isMinecraftNamespace ? imageRelative : `${namespace}:${imageRelative}`\r\n\r\n        return [textureName, img]\r\n      } catch (err) {\r\n        const imageRelative = image.replace(`${texturesBasePath}/`, '').replace(`${texturesCommonBasePath}/`, '')\r\n        const textureName = isMinecraftNamespace ? imageRelative : `${namespace}:${imageRelative}`\r\n        currentErrors.push(`[${imageRelative}] ${err.message}`)\r\n        return [textureName, undefined]\r\n      }\r\n    })))\r\n    Object.assign(textures, Object.fromEntries(Object.entries(newTextures).filter(([, img]) => img !== undefined)))\r\n  }\r\n  return {\r\n    firstTextureSize,\r\n    textures,\r\n  }\r\n}\r\n\r\nconst prepareBlockstatesAndModels = async (progressReporter: ProgressReporter) => {\r\n  viewer.world.customBlockStates = {}\r\n  viewer.world.customModels = {}\r\n  const usedBlockTextures = new Set<string>()\r\n  const usedItemTextures = new Set<string>()\r\n  const basePath = await getActiveResourcepackBasePath()\r\n  if (!basePath) return\r\n  progressReporter.beginStage('read-resource-pack-blockstates-and-models', 'Reading resource pack blockstates and models')\r\n\r\n  const readModelData = async (path: string, type: 'models' | 'blockstates', namespaceDir: string) => {\r\n    if (!(await existsAsync(path))) return\r\n    const files = await fs.promises.readdir(path)\r\n    const jsons = {} as Record<string, any>\r\n    await Promise.all(files.map(async (file) => {\r\n      const filePath = `${path}/${file}`\r\n      if (file.endsWith('.json')) {\r\n        const contents = await fs.promises.readFile(filePath, 'utf8')\r\n        let name = file.replace('.json', '')\r\n        const isBlock = path.endsWith('block')\r\n        if (type === 'models') {\r\n          name = `${isBlock ? 'block' : 'item'}/${name}`\r\n        }\r\n        const parsed = JSON.parse(contents)\r\n        if (namespaceDir === 'minecraft') {\r\n          jsons[name] = parsed\r\n        }\r\n        jsons[`${namespaceDir}:${name}`] = parsed\r\n        if (type === 'models') {\r\n          for (let texturePath of Object.values(parsed.textures ?? {})) {\r\n            if (typeof texturePath !== 'string') continue\r\n            if (texturePath.startsWith('#')) continue\r\n            if (!texturePath.includes(':')) texturePath = `minecraft:${texturePath}`\r\n            if (isBlock) {\r\n              usedBlockTextures.add(texturePath as string)\r\n            } else {\r\n              usedItemTextures.add(texturePath as string)\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }))\r\n    return jsons\r\n  }\r\n\r\n  const readData = async (namespaceDir: string) => {\r\n    const blockstatesPath = `${basePath}/assets/${namespaceDir}/blockstates`\r\n    const blockModelsPath = `${basePath}/assets/${namespaceDir}/models/block`\r\n    const itemModelsPath = `${basePath}/assets/${namespaceDir}/models/item`\r\n\r\n    Object.assign(viewer.world.customBlockStates!, await readModelData(blockstatesPath, 'blockstates', namespaceDir))\r\n    Object.assign(viewer.world.customModels!, await readModelData(blockModelsPath, 'models', namespaceDir))\r\n    Object.assign(viewer.world.customModels!, await readModelData(itemModelsPath, 'models', namespaceDir))\r\n  }\r\n\r\n  try {\r\n    const assetsDirs = await fs.promises.readdir(join(basePath, 'assets'))\r\n    for (const assetsDir of assetsDirs) {\r\n      await readData(assetsDir)\r\n    }\r\n  } catch (err) {\r\n    console.error('Failed to read some of resource pack blockstates and models', err)\r\n    viewer.world.customBlockStates = undefined\r\n    viewer.world.customModels = undefined\r\n  }\r\n  return {\r\n    usedBlockTextures,\r\n    usedItemTextures\r\n  }\r\n}\r\n\r\nconst downloadAndUseResourcePack = async (url: string, progressReporter: ProgressReporter): Promise<void> => {\r\n  progressReporter.beginStage('install-resource-pack', 'Installing server resource pack')\r\n  try {\r\n    resourcePackState.isServerInstalling = true\r\n    resourcePackState.isServerDownloading = true\r\n    progressReporter.beginStage('download-resource-pack', 'Downloading server resource pack')\r\n    console.log('Downloading server resource pack', url)\r\n    console.time('downloadServerResourcePack')\r\n    const response = await fetch(url).catch((err) => {\r\n      console.log(`Ensure server on ${url} support CORS which is not required for regular client, but is required for the web client`)\r\n      console.error(err)\r\n      progressReporter.error('Failed to download resource pack: ' + err.message)\r\n    })\r\n    console.timeEnd('downloadServerResourcePack')\r\n    if (!response) return\r\n\r\n    const contentLength = response.headers.get('Content-Length')\r\n    const total = contentLength ? parseInt(contentLength, 10) : 0\r\n    let loaded = 0\r\n\r\n    const reader = response.body!.getReader()\r\n    const chunks: Uint8Array[] = []\r\n\r\n    // eslint-disable-next-line no-constant-condition\r\n    while (true) {\r\n      const { done, value } = await reader.read()\r\n      if (done) break\r\n\r\n      chunks.push(value)\r\n      loaded += value.length\r\n\r\n      if (total) {\r\n        const progress = Math.round((loaded / total) * 100)\r\n        progressReporter.reportProgress('download-resource-pack', progress / 100)\r\n      }\r\n    }\r\n\r\n    resourcePackState.isServerDownloading = false\r\n    const resourcePackData = await new Blob(chunks).arrayBuffer()\r\n    progressReporter.endStage('install-resource-pack')\r\n    await installResourcepackPack(resourcePackData, progressReporter, undefined, undefined, true).catch((err) => {\r\n      console.error(err)\r\n      showNotification('Failed to install resource pack: ' + err.message)\r\n    })\r\n  } catch (err) {\r\n    progressReporter.error('Could not install resource pack: ' + err.message)\r\n  } finally {\r\n    progressReporter.endStage('download-resource-pack')\r\n    resourcePackState.isServerInstalling = false\r\n    resourcePackState.isServerDownloading = false\r\n  }\r\n}\r\n\r\nconst waitForGameEvent = async () => {\r\n  if (miscUiState.gameLoaded) return\r\n  await new Promise<void>(resolve => {\r\n    const listener = () => resolve()\r\n    customEvents.once('gameLoaded', listener)\r\n    watchUnloadForCleanup(() => {\r\n      customEvents.removeListener('gameLoaded', listener)\r\n    })\r\n  })\r\n}\r\n\r\nexport const onAppLoad = () => {\r\n  customEvents.on('mineflayerBotCreated', () => {\r\n    // todo also handle resourcePack\r\n    const handleResourcePackRequest = async (packet) => {\r\n      const start = Date.now()\r\n      console.log('Received resource pack request', packet)\r\n      const promptMessagePacket = ('promptMessage' in packet && packet.promptMessage) ? packet.promptMessage : undefined\r\n      const promptMessageText = promptMessagePacket ? '' : 'Do you want to use server resource pack?'\r\n      // TODO!\r\n      const hash = 'hash' in packet ? packet.hash : '-'\r\n      const forced = 'forced' in packet ? packet.forced : false\r\n      const choice = options.serverResourcePacks === 'never'\r\n        ? false\r\n        : options.serverResourcePacks === 'always'\r\n          ? true\r\n          : await showOptionsModal(promptMessageText, ['Download & Install (recommended)', 'Pretend Installed (not recommended)'], {\r\n            cancel: !forced,\r\n            minecraftJsonMessage: promptMessagePacket,\r\n          })\r\n      if (Date.now() - start < 700) { // wait for state protocol switch\r\n        await new Promise(resolve => {\r\n          setTimeout(resolve, 700)\r\n        })\r\n      }\r\n      if (choice === false) {\r\n        bot.acceptResourcePack()\r\n        return\r\n      }\r\n      if (!choice) {\r\n        bot.denyResourcePack()\r\n        return\r\n      }\r\n      console.log('accepting resource pack')\r\n      bot.acceptResourcePack()\r\n      if (choice === true || choice === 'Download & Install (recommended)') {\r\n        await downloadAndUseResourcePack(packet.url, createFullScreenProgressReporter()).catch((err) => {\r\n          console.error(err)\r\n          showNotification('Failed to download resource pack: ' + err.message)\r\n        })\r\n      }\r\n    }\r\n    bot._client.on('resource_pack_send', handleResourcePackRequest)\r\n    bot._client.on('add_resource_pack' as any, handleResourcePackRequest)\r\n  })\r\n\r\n  subscribe(resourcePackState, () => {\r\n    if (!resourcePackState.resourcePackInstalled) return\r\n    void updateAllReplacableTextures()\r\n  })\r\n}\r\n\r\nconst updateAllReplacableTextures = async () => {\r\n  const basePath = await getActiveResourcepackBasePath()\r\n  const setCustomCss = async (path: string | null, varName: string, repeat = 1) => {\r\n    if (path && await existsAsync(path)) {\r\n      const contents = await fs.promises.readFile(path, 'base64')\r\n      const dataUrl = `data:image/png;base64,${contents}`\r\n      document.body.style.setProperty(varName, repeatArr(`url(${dataUrl})`, repeat).join(', '))\r\n    } else {\r\n      document.body.style.setProperty(varName, '')\r\n    }\r\n  }\r\n  const setCustomPicture = async (key: string, path: string) => {\r\n    let contents = resourcesContentOriginal[key]\r\n    if (await existsAsync(path)) {\r\n      const file = await fs.promises.readFile(path, 'base64')\r\n      const dataUrl = `data:image/png;base64,${file}`\r\n      contents = dataUrl\r\n    }\r\n    appReplacableResources[key].content = contents\r\n  }\r\n  const vars = Object.entries(appReplacableResources).filter(([, x]) => x.cssVar)\r\n  for (const [key, { cssVar, cssVarRepeat, resourcePackPath }] of vars) {\r\n    const resPath = `${basePath}/assets/${resourcePackPath}`\r\n    if (cssVar) {\r\n\r\n      await setCustomCss(resPath, cssVar, cssVarRepeat ?? 1)\r\n    } else {\r\n\r\n      await setCustomPicture(key, resPath)\r\n    }\r\n  }\r\n}\r\n\r\nconst repeatArr = (arr, i) => Array.from({ length: i }, () => arr)\r\n\r\nconst updateTextures = async (progressReporter = createConsoleLogProgressReporter()) => {\r\n  currentErrors = []\r\n  const origBlocksFiles = Object.keys(viewer.world.sourceData.blocksAtlases.latest.textures)\r\n  const origItemsFiles = Object.keys(viewer.world.sourceData.itemsAtlases.latest.textures)\r\n  const origArmorFiles = Object.keys(armorTextures)\r\n  const { usedBlockTextures, usedItemTextures } = await prepareBlockstatesAndModels(progressReporter) ?? {}\r\n  const blocksData = await getResourcepackTiles('blocks', [...origBlocksFiles, ...usedBlockTextures ?? []], progressReporter)\r\n  const itemsData = await getResourcepackTiles('items', [...origItemsFiles, ...usedItemTextures ?? []], progressReporter)\r\n  const armorData = await getResourcepackTiles('armor', origArmorFiles, progressReporter)\r\n  await updateAllReplacableTextures()\r\n  viewer.world.customTextures = {}\r\n  if (blocksData) {\r\n    viewer.world.customTextures.blocks = {\r\n      tileSize: blocksData.firstTextureSize,\r\n      textures: blocksData.textures\r\n    }\r\n  }\r\n  if (itemsData) {\r\n    viewer.world.customTextures.items = {\r\n      tileSize: itemsData.firstTextureSize,\r\n      textures: itemsData.textures\r\n    }\r\n  }\r\n  if (armorData) {\r\n    viewer.world.customTextures.armor = {\r\n      tileSize: armorData.firstTextureSize,\r\n      textures: armorData.textures\r\n    }\r\n  }\r\n\r\n  if (viewer.world.active) {\r\n    await viewer.world.updateAssetsData()\r\n    if (viewer.world instanceof WorldRendererThree) {\r\n      viewer.world.rerenderAllChunks?.()\r\n    }\r\n  }\r\n}\r\n\r\nexport const resourcepackReload = async (version) => {\r\n  await updateTextures()\r\n}\r\n\r\nexport const copyServerResourcePackToRegular = async (name = 'default') => {\r\n  // Check if server resource pack exists\r\n  if (!(await existsAsync('/resourcepack/pack.mcmeta'))) {\r\n    throw new Error('No server resource pack is currently installed')\r\n  }\r\n\r\n  // Get display name from server resource pack if available\r\n  let displayName\r\n  try {\r\n    displayName = await fs.promises.readFile('/resourcepack/name.txt', 'utf8')\r\n  } catch {\r\n    displayName = 'Server Resource Pack'\r\n  }\r\n\r\n  // Copy all files from server resource pack to regular location\r\n  const destPath = resourcepackPackBasePath + name\r\n  await mkdirRecursive(destPath)\r\n\r\n  const reporter = createFullScreenProgressReporter()\r\n  reporter.setMessage('Copying server resource pack to user location')\r\n  await copyFilesAsyncWithProgress('/resourcepack', destPath, true, ' (server -> user)')\r\n\r\n  // Complete the installation\r\n  await completeResourcepackPackInstall(displayName, name, false, reporter)\r\n  showNotification('Server resource pack copied to user location')\r\n\r\n  reporter.end()\r\n}\r\n","import { Item } from 'prismarine-item'\r\nimport { ItemSpecificContextProperties } from 'renderer/viewer/lib/basePlayerState'\r\nimport { getItemDefinition } from 'mc-assets/dist/itemDefinitions'\r\nimport { playerState } from './mineflayer/playerState'\r\nimport { GeneralInputItem, getItemMetadata } from './mineflayer/items'\r\n\r\nexport const getItemModelName = (item: GeneralInputItem, specificProps: ItemSpecificContextProperties) => {\r\n  let itemModelName = item.name\r\n  const { customModel } = getItemMetadata(item)\r\n  if (customModel) {\r\n    itemModelName = customModel\r\n  }\r\n\r\n  const itemSelector = playerState.getItemSelector({\r\n    ...specificProps\r\n  })\r\n  const modelFromDef = getItemDefinition(viewer.world.itemsDefinitionsStore, {\r\n    name: itemModelName,\r\n    version: viewer.world.texturesVersion!,\r\n    properties: itemSelector\r\n  })?.model\r\n  const model = (modelFromDef === 'minecraft:special' ? undefined : modelFromDef) ?? itemModelName\r\n  return model\r\n}\r\n","import { proxy, useSnapshot } from 'valtio'\r\nimport { subscribeKey } from 'valtio/utils'\r\nimport { useMedia } from 'react-use'\r\nimport { options, watchValue } from './optionsStorage'\r\nimport { useScale } from './react/UIProvider'\r\n\r\nexport const currentScaling = proxy({\r\n  scale: 1,\r\n})\r\nwindow.currentScaling = currentScaling\r\n\r\nconst setScale = () => {\r\n  const scaleValues = [\r\n    { maxWidth: 980, maxHeight: null, scale: 2 },\r\n    { maxWidth: null, maxHeight: 390, scale: 1.5 }, // todo allow to set the scaling at 360-400 (dynamic scaling setting)\r\n    { maxWidth: 620, maxHeight: null, scale: 1 },\r\n\r\n    { maxWidth: 620, minHeight: 240, scale: 1.4 },\r\n  ]\r\n\r\n  const { innerWidth, innerHeight } = window\r\n\r\n  let result = options.guiScale\r\n  for (const { maxWidth, maxHeight, scale, minHeight } of scaleValues) {\r\n    if ((!maxWidth || innerWidth <= maxWidth) && (!maxHeight || innerHeight <= maxHeight) && (!minHeight || innerHeight >= minHeight)) {\r\n      result = scale\r\n    }\r\n  }\r\n\r\n  currentScaling.scale = result\r\n}\r\n\r\n\r\nsetScale()\r\nsubscribeKey(options, 'guiScale', setScale)\r\nwatchValue(currentScaling, (c) => {\r\n  document.documentElement.style.setProperty('--guiScale', String(c.scale))\r\n})\r\nwindow.addEventListener('resize', setScale)\r\n\r\nexport const useAppScale = () => {\r\n  return useSnapshot(currentScaling).scale\r\n}\r\n","import { isCypress } from './standaloneUtils'\r\n\r\n// might not resolve at all\r\nexport const registerServiceWorker = async () => {\r\n  if (!('serviceWorker' in navigator) || process.env.SINGLE_FILE_BUILD) return\r\n  if (process.env.DISABLE_SERVICE_WORKER) return\r\n  if (!isCypress() && process.env.NODE_ENV !== 'development') {\r\n    return new Promise<void>(resolve => {\r\n      window.addEventListener('load', async () => {\r\n        await navigator.serviceWorker.register('./service-worker.js').then(registration => {\r\n          console.log('SW registered:', registration)\r\n          resolve()\r\n        }).catch(registrationError => {\r\n          console.log('SW registration failed:', registrationError)\r\n        })\r\n      })\r\n    })\r\n  } else {\r\n    // force unregister service worker in development mode\r\n    const registrations = await navigator.serviceWorker.getRegistrations()\r\n    for (const registration of registrations) {\r\n      await registration.unregister() // eslint-disable-line no-await-in-loop\r\n    }\r\n    if (registrations.length) {\r\n      location.reload()\r\n    }\r\n  }\r\n}\r\n","//@ts-check\r\nexport * from 'crypto-browserify'\r\nexport function createPublicKey() { }\r\n\r\n// CUSTOM SIGN ASYNC IMPLEMENTATION FOR BROWSERS\r\n\r\nexport async function sign(signatureAlgorithm, data, privateKeyPem) {\r\n  if (signatureAlgorithm !== 'RSA-SHA256') throw new Error(`Unsupported signature algorithm ${signatureAlgorithm}`)\r\n  if (typeof privateKeyPem !== 'string') throw new Error(`This implementation only supports strings as private keys`)\r\n  const privateKeyBuffer = pemToArrayBuffer(privateKeyPem)\r\n  const privateKey = await crypto.subtle.importKey(\r\n    'pkcs8', // Chrome has difficulties with pkcs1 and the recommended format is pkcs8\r\n    privateKeyBuffer,\r\n    {\r\n      name: 'RSASSA-PKCS1-v1_5',\r\n      hash: { name: 'SHA-256' },\r\n    },\r\n    true,\r\n    ['sign']\r\n  )\r\n  const signature = await crypto.subtle.sign(\r\n    {\r\n      name: 'RSASSA-PKCS1-v1_5',\r\n      hash: { name: 'SHA-256' }, // SHA-256 hash function\r\n    },\r\n    privateKey,\r\n    data\r\n  )\r\n  return signature\r\n}\r\n\r\nfunction pemToArrayBuffer(pem) {\r\n  pem = pem.trim()\r\n  const pemHeader = '-----BEGIN RSA PRIVATE KEY-----'\r\n  const pemFooter = '-----END RSA PRIVATE KEY-----'\r\n  const pemContents = pem.slice(pemHeader.length, pem.length - pemFooter.length).trim()\r\n  const binaryDerString = atob(pemContents.replaceAll(/\\s/g, ''))\r\n  const binaryDer = new Uint8Array(binaryDerString.length)\r\n  for (let i = 0; i < binaryDerString.length; i++) {\r\n    //@ts-expect-error\r\n    binaryDer[i] = binaryDerString.codePointAt(i)\r\n  }\r\n  return binaryDer.buffer\r\n}\r\n","/* global XMLHttpRequest */\r\n\r\n// Custom DNS resolver made by SiebeDW. Powered by google dns.\r\n// Supported: SRV (not all errors support)\r\nmodule.exports.resolveSrv = function (hostname, callback) {\r\n  const Http = new XMLHttpRequest()\r\n  const url = `https://dns.google.com/resolve?name=${hostname}&type=SRV`\r\n  Http.open('GET', url)\r\n  Http.responseType = 'json'\r\n  Http.send()\r\n\r\n  const minecraftServerHostname = hostname.startsWith('_minecraft._tcp.') ? hostname.slice('_minecraft._tcp.'.length) : null\r\n  if (minecraftServerHostname) {\r\n    Http.onerror = async function () {\r\n      try {\r\n        if (!globalThis.resolveDnsFallback) return\r\n        const result = await globalThis.resolveDnsFallback(minecraftServerHostname)\r\n        callback(null, result ? [{\r\n          priority: 0,\r\n          weight: 0,\r\n          port: result.port,\r\n          name: result.host\r\n        }] : [])\r\n      } catch (err) {\r\n        callback(err)\r\n      }\r\n    }\r\n  }\r\n\r\n  Http.onload = function () {\r\n    const { response } = Http\r\n    if (response.Status === 3) {\r\n      const err = new Error('querySrv ENOTFOUND')\r\n      err.code = 'ENOTFOUND'\r\n      callback(err)\r\n      return\r\n    }\r\n    if (!response.Answer || response.Answer.length < 1) {\r\n      const err = new Error('querySrv ENODATA')\r\n      err.code = 'ENODATA'\r\n      callback(err)\r\n      return\r\n    }\r\n    const willreturn = []\r\n    for (const object of response.Answer) {\r\n      const data = object.data.split(' ')\r\n      if (data[3] === undefined || data[2] === undefined) continue\r\n      willreturn.push({\r\n        priority: data[0],\r\n        weight: data[1],\r\n        port: data[2],\r\n        name: data[3]\r\n      })\r\n    }\r\n    console.log(willreturn)\r\n    callback(null, willreturn)\r\n  }\r\n}\r\n","export { }\r\n","const BrowserFS = require('browserfs')\r\n\r\nmodule.exports = BrowserFS.BFSRequire('fs')\r\n","import { versionToNumber } from 'renderer/viewer/prepare/utils'\r\nimport { restoreMinecraftData } from '../optimizeJson'\r\n// import minecraftInitialDataJson from '../../generated/minecraft-initial-data.json'\r\nimport { toMajorVersion } from '../utils'\r\nimport { importLargeData } from '../../generated/large-data-aliases'\r\n\r\nconst customResolver = () => {\r\n  const resolver = Promise.withResolvers()\r\n  let resolvedData\r\n  return {\r\n    ...resolver,\r\n    get resolvedData () {\r\n      return resolvedData\r\n    },\r\n    resolve (data) {\r\n      resolver.resolve(data)\r\n      resolvedData = data\r\n    }\r\n  }\r\n}\r\n\r\nconst optimizedDataResolver = customResolver()\r\nwindow._MC_DATA_RESOLVER = optimizedDataResolver\r\nwindow._LOAD_MC_DATA = async () => {\r\n  if (optimizedDataResolver.resolvedData) return\r\n  optimizedDataResolver.resolve(await importLargeData('mcData'))\r\n}\r\n\r\n// 30 seconds\r\nconst cacheTtl = 30 * 1000\r\nconst cache = new Map<string, any>()\r\nconst cacheTime = new Map<string, number>()\r\nconst possiblyGetFromCache = (version: string) => {\r\n  // if (minecraftInitialDataJson[version] && !optimizedDataResolver.resolvedData) {\r\n  //   return minecraftInitialDataJson[version]\r\n  // }\r\n  if (cache.has(version)) {\r\n    return cache.get(version)\r\n  }\r\n  const inner = () => {\r\n    if (!optimizedDataResolver.resolvedData) {\r\n      throw new Error(`Data for ${version} is not ready yet`)\r\n    }\r\n    const dataTypes = Object.keys(optimizedDataResolver.resolvedData)\r\n    const allRestored = {}\r\n    for (const dataType of dataTypes) {\r\n      if (dataType === 'blockCollisionShapes' && versionToNumber(version) >= versionToNumber('1.13')) {\r\n        const shapes = window.globalGetCollisionShapes?.(version)\r\n        if (shapes) {\r\n          allRestored[dataType] = shapes\r\n          continue\r\n        }\r\n      }\r\n\r\n      const data = optimizedDataResolver.resolvedData[dataType]\r\n      if (data.__IS_OPTIMIZED__) {\r\n        allRestored[dataType] = restoreMinecraftData(optimizedDataResolver.resolvedData, dataType, version)\r\n      } else {\r\n        allRestored[dataType] = data[version] ?? data[toMajorVersion(version)]\r\n      }\r\n    }\r\n    return allRestored\r\n  }\r\n  const data = inner()\r\n  cache.set(version, data)\r\n  cacheTime.set(version, Date.now())\r\n  return data\r\n}\r\nwindow.allLoadedMcData = new Proxy({}, {\r\n  get (t, version: string) {\r\n    // special properties like $typeof\r\n    if (version.includes('$')) return\r\n    // todo enumerate all props\r\n    return new Proxy({}, {\r\n      get (target, prop) {\r\n        return possiblyGetFromCache(version)[prop]\r\n      },\r\n    })\r\n  }\r\n})\r\n\r\nsetInterval(() => {\r\n  const now = Date.now()\r\n  for (const [version, time] of cacheTime) {\r\n    if (now - time > cacheTtl) {\r\n      cache.delete(version)\r\n      cacheTime.delete(version)\r\n    }\r\n  }\r\n}, 1000)\r\n\r\nexport const pc = window.allLoadedMcData\r\nexport default { pc }\r\n","import { EventEmitter } from 'events'\r\n\r\nconst oldEmit = EventEmitter.prototype.emit\r\nEventEmitter.prototype.emit = function (...args) {\r\n  if (args[0] === 'error' && !this._events.error) {\r\n    console.log('Unhandled error event', args.slice(1))\r\n    args[1] = { message: String(args[1]) }\r\n  }\r\n  return oldEmit.apply(this, args)\r\n}\r\n","module.exports.performance = window.performance\r\n","// Auth is done in the connection option callback. In this app the auth implementation is server side.\r\n\r\nconst Titles = {}\r\n\r\nexport {\r\n  Titles\r\n}\r\n","export const server = ({ host: sessionServer }) => {\r\n  return {\r\n    async join (accessToken, sessionSelectedProfileId, serverId, sharedSecret, publicKey, cb) {\r\n      try {\r\n        const result = await fetch(`${sessionServer}`, {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n          body: JSON.stringify({\r\n            accessToken,\r\n            selectedProfile: sessionSelectedProfileId,\r\n            serverId,\r\n            sharedSecret,\r\n            publicKey,\r\n          }),\r\n        })\r\n        if (!result.ok) {\r\n          throw new Error(`Request failed ${await result.text()}`)\r\n        }\r\n        cb(null)\r\n      } catch (err) {\r\n        cb(err)\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { Vec3 } from 'vec3'\r\nimport { versionToNumber } from 'renderer/viewer/prepare/utils'\r\nimport { loadScript } from 'renderer/viewer/lib/utils'\r\nimport type { Block } from 'prismarine-block'\r\nimport { subscribeKey } from 'valtio/utils'\r\nimport { miscUiState } from '../globalState'\r\nimport { options } from '../optionsStorage'\r\nimport { loadOrPlaySound } from '../basicSounds'\r\nimport { getActiveResourcepackBasePath, resourcePackState } from '../resourcePack'\r\nimport { showNotification } from '../react/NotificationProvider'\r\nimport { createSoundMap, SoundMap } from './soundsMap'\r\nimport { musicSystem } from './musicSystem'\r\n\r\nlet soundMap: SoundMap | undefined\r\n\r\nconst updateResourcePack = async () => {\r\n  if (!soundMap) return\r\n  // todo, rework to await\r\n  void soundMap.updateActiveResourcePackBasePath(await getActiveResourcepackBasePath() ?? undefined)\r\n}\r\n\r\nlet musicInterval: ReturnType<typeof setInterval> | null = null\r\n\r\nsubscribeKey(miscUiState, 'gameLoaded', async () => {\r\n  if (!miscUiState.gameLoaded) {\r\n    stopMusicSystem()\r\n    soundMap?.quit()\r\n    return\r\n  }\r\n\r\n  console.log(`Loading sounds for version ${bot.version}. Resourcepack state: ${JSON.stringify(resourcePackState)}`)\r\n  soundMap = createSoundMap(bot.version) ?? undefined\r\n  globalThis.soundMap = soundMap\r\n  if (!soundMap) return\r\n  if (soundMap.noVersionIdMapping) {\r\n    showNotification('No sound ID mapping for this version', undefined, true)\r\n  }\r\n  void updateResourcePack()\r\n  startMusicSystem()\r\n\r\n  const playGeneralSound = async (soundKey: string, position?: Vec3, volume = 1, pitch?: number) => {\r\n    if (!options.volume || !soundMap) return\r\n    const soundData = await soundMap.getSoundUrl(soundKey, volume)\r\n    if (!soundData) return\r\n\r\n    const isMuted = options.mutedSounds.includes(soundKey) || options.volume === 0\r\n    if (position) {\r\n      if (!isMuted) {\r\n        viewer.playSound(\r\n          position,\r\n          soundData.url,\r\n          soundData.volume * (options.volume / 100),\r\n          Math.max(Math.min(pitch ?? 1, 2), 0.5)\r\n        )\r\n      }\r\n      if (getDistance(bot.entity.position, position) < 4 * 16) {\r\n        lastPlayedSounds.lastServerPlayed[soundKey] ??= { count: 0, last: 0 }\r\n        lastPlayedSounds.lastServerPlayed[soundKey].count++\r\n        lastPlayedSounds.lastServerPlayed[soundKey].last = Date.now()\r\n      }\r\n    } else {\r\n      if (!isMuted) {\r\n        await loadOrPlaySound(soundData.url, volume)\r\n      }\r\n      lastPlayedSounds.lastClientPlayed.push(soundKey)\r\n      if (lastPlayedSounds.lastClientPlayed.length > 10) {\r\n        lastPlayedSounds.lastClientPlayed.shift()\r\n      }\r\n    }\r\n  }\r\n\r\n  const musicStartCheck = async (force = false) => {\r\n    if (!soundMap) return\r\n    // 20% chance to start music\r\n    if (Math.random() > 0.2 && !force && !options.enableMusic) return\r\n\r\n    const musicKeys = ['music.game']\r\n    if (bot.game.gameMode === 'creative') {\r\n      musicKeys.push('music.creative')\r\n    }\r\n    const randomMusicKey = musicKeys[Math.floor(Math.random() * musicKeys.length)]\r\n    const soundData = await soundMap.getSoundUrl(randomMusicKey)\r\n    if (!soundData) return\r\n    await musicSystem.playMusic(soundData.url, soundData.volume)\r\n  }\r\n\r\n  function startMusicSystem () {\r\n    if (musicInterval) return\r\n    musicInterval = setInterval(() => {\r\n      void musicStartCheck()\r\n    }, 10_000)\r\n  }\r\n\r\n  window.forceStartMusic = () => {\r\n    void musicStartCheck(true)\r\n  }\r\n\r\n\r\n  function stopMusicSystem () {\r\n    if (musicInterval) {\r\n      clearInterval(musicInterval)\r\n      musicInterval = null\r\n    }\r\n  }\r\n\r\n  const playHardcodedSound = async (soundKey: string, position?: Vec3, volume = 1, pitch?: number) => {\r\n    await playGeneralSound(soundKey, position, volume, pitch)\r\n  }\r\n\r\n  bot.on('soundEffectHeard', async (soundId, position, volume, pitch) => {\r\n    await playHardcodedSound(soundId, position, volume, pitch)\r\n  })\r\n\r\n  bot._client.on('sound_effect', async (packet) => {\r\n    const soundResource = packet['soundEvent']?.resource as string | undefined\r\n    const pos = new Vec3(packet.x / 8, packet.y / 8, packet.z / 8)\r\n    if (packet.soundId !== 0 || !soundResource) {\r\n      const soundKey = soundMap!.soundsIdToName[packet.soundId]\r\n      if (soundKey === undefined) return\r\n      await playGeneralSound(soundKey, pos, packet.volume, packet.pitch)\r\n      return\r\n    }\r\n\r\n    await playHardcodedSound(soundResource.replace('minecraft:', ''), pos, packet.volume, packet.pitch)\r\n  })\r\n\r\n  bot.on('entityHurt', async (entity) => {\r\n    if (entity.id === bot.entity.id) {\r\n      await playHardcodedSound('entity.player.hurt')\r\n    }\r\n  })\r\n\r\n  let lastStepSound = 0\r\n  const movementHappening = async () => {\r\n    if (!bot.player || !soundMap) return // no info yet\r\n    const VELOCITY_THRESHOLD = 0.1\r\n    const { x, z, y } = bot.player.entity.velocity\r\n    if (bot.entity.onGround && Math.abs(x) < VELOCITY_THRESHOLD && (Math.abs(z) > VELOCITY_THRESHOLD || Math.abs(y) > VELOCITY_THRESHOLD)) {\r\n      // movement happening\r\n      if (Date.now() - lastStepSound > 300) {\r\n        const blockUnder = bot.world.getBlock(bot.entity.position.offset(0, -1, 0))\r\n        if (blockUnder) {\r\n          const stepSound = soundMap.getStepSound(blockUnder.name)\r\n          if (stepSound) {\r\n            await playHardcodedSound(stepSound, undefined, 0.6)\r\n            lastStepSound = Date.now()\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  const playBlockBreak = async (blockName: string, position?: Vec3) => {\r\n    if (!soundMap) return\r\n    const sound = soundMap.getBreakSound(blockName)\r\n    await playHardcodedSound(sound, position, 0.6, 1)\r\n  }\r\n\r\n  const registerEvents = () => {\r\n    bot.on('move', () => {\r\n      void movementHappening()\r\n    })\r\n    bot._client.on('world_event', async ({ effectId, location, data, global: disablePosVolume }) => {\r\n      const position = disablePosVolume ? undefined : new Vec3(location.x, location.y, location.z)\r\n      if (effectId === 2001) {\r\n        // break event\r\n        const block = loadedData.blocksByStateId[data]\r\n        await playBlockBreak(block.name, position)\r\n      }\r\n      // these produce glass break sound\r\n      if (effectId === 2002 || effectId === 2003 || effectId === 2007) {\r\n        await playHardcodedSound('block.glass.break', position, 1, 1)\r\n      }\r\n      if (effectId === 1004) {\r\n        // firework shoot\r\n        await playHardcodedSound('entity.firework_rocket.launch', position, 1, 1)\r\n      }\r\n      if (effectId === 1006 || effectId === 1007 || effectId === 1014) {\r\n        // wooden door open/close\r\n        await playHardcodedSound('block.wooden_door.open', position, 1, 1)\r\n      }\r\n      if (effectId === 1002) {\r\n        // dispenser shoot\r\n        await playHardcodedSound('block.dispenser.dispense', position, 1, 1)\r\n      }\r\n      if (effectId === 1024) {\r\n        // wither shoot\r\n        await playHardcodedSound('entity.wither.shoot', position, 1, 1)\r\n      }\r\n      if (effectId === 1031) {\r\n        // anvil land\r\n        await playHardcodedSound('block.anvil.land', position, 1, 1)\r\n      }\r\n      if (effectId === 1010) {\r\n        console.log('play record', data)\r\n      }\r\n    })\r\n\r\n    let diggingBlock: Block | null = null\r\n    customEvents.on('digStart', () => {\r\n      diggingBlock = bot.blockAtCursor(5)\r\n    })\r\n    bot.on('diggingCompleted', async () => {\r\n      if (diggingBlock) {\r\n        await playBlockBreak(diggingBlock.name, diggingBlock.position)\r\n      }\r\n    })\r\n  }\r\n\r\n  registerEvents()\r\n})\r\n\r\nsubscribeKey(resourcePackState, 'resourcePackInstalled', async () => {\r\n  await updateResourcePack()\r\n})\r\n\r\nexport const downloadSoundsIfNeeded = async () => {\r\n  if (!window.allSoundsMap) {\r\n    try {\r\n      await loadScript('./sounds.js')\r\n    } catch (err) {\r\n      console.warn('Sounds map was not generated. Sounds will not be played.')\r\n    }\r\n  }\r\n}\r\n\r\nexport const lastPlayedSounds = {\r\n  lastClientPlayed: [] as string[],\r\n  lastServerPlayed: {} as Record<string, { count: number, last: number }>,\r\n}\r\n\r\nconst getDistance = (pos1: Vec3, pos2: Vec3) => {\r\n  return Math.hypot((pos1.x - pos2.x), (pos1.y - pos2.y), (pos1.z - pos2.z))\r\n}\r\n","import { loadOrPlaySound } from '../basicSounds'\r\nimport { options } from '../optionsStorage'\r\n\r\nclass MusicSystem {\r\n  private currentMusic: string | null = null\r\n\r\n  async playMusic (url: string, musicVolume = 1) {\r\n    if (!options.enableMusic || this.currentMusic) return\r\n\r\n    try {\r\n      const { onEnded } = await loadOrPlaySound(url, 0.5 * musicVolume, 5000) ?? {}\r\n\r\n      if (!onEnded) return\r\n\r\n      this.currentMusic = url\r\n\r\n      onEnded(() => {\r\n        this.currentMusic = null\r\n      })\r\n    } catch (err) {\r\n      console.warn('Failed to play music:', err)\r\n      this.currentMusic = null\r\n    }\r\n  }\r\n\r\n  stopMusic () {\r\n    if (this.currentMusic) {\r\n      this.currentMusic = null\r\n    }\r\n  }\r\n}\r\n\r\nexport const musicSystem = new MusicSystem()\r\n","import fs from 'fs'\r\nimport path from 'path'\r\nimport { versionsMapToMajor, versionToMajor, versionToNumber } from 'renderer/viewer/prepare/utils'\r\n\r\nimport { stopAllSounds } from '../basicSounds'\r\nimport { musicSystem } from './musicSystem'\r\n\r\ninterface SoundMeta {\r\n  format: string\r\n  baseUrl: string\r\n}\r\n\r\ninterface SoundData {\r\n  volume: number\r\n  path: string\r\n}\r\n\r\ninterface SoundMapData {\r\n  allSoundsMap: Record<string, Record<string, string>>\r\n  soundsLegacyMap: Record<string, string[]>\r\n  soundsMeta: SoundMeta\r\n}\r\n\r\ninterface BlockSoundMap {\r\n  [blockName: string]: string\r\n}\r\n\r\ninterface SoundEntry {\r\n  file: string\r\n  weight: number\r\n  volume: number\r\n}\r\n\r\ninterface ResourcePackSoundEntry {\r\n  name: string\r\n  stream?: boolean\r\n  volume?: number\r\n}\r\n\r\ninterface ResourcePackSound {\r\n  category: string\r\n  sounds: ResourcePackSoundEntry[]\r\n}\r\n\r\ninterface ResourcePackSoundsJson {\r\n  [soundId: string]: ResourcePackSound\r\n}\r\n\r\nexport class SoundMap {\r\n  private readonly soundsPerName: Record<string, SoundEntry[]>\r\n  soundsIdToName: Record<string, string>\r\n  private readonly existingResourcePackPaths: Set<string>\r\n  private activeResourcePackBasePath: string | undefined\r\n  private activeResourcePackSoundsJson: ResourcePackSoundsJson | undefined\r\n  noVersionIdMapping = false\r\n\r\n  constructor (\r\n    private readonly soundData: SoundMapData,\r\n    private readonly version: string\r\n  ) {\r\n    // First try exact version match\r\n    let soundsMap = soundData.allSoundsMap[this.version]\r\n\r\n    if (!soundsMap) {\r\n      // If no exact match, try major version\r\n      const allSoundsMajor = versionsMapToMajor(soundData.allSoundsMap)\r\n      soundsMap = allSoundsMajor[versionToMajor(version)]\r\n\r\n      if (!soundsMap) {\r\n        // If still no match, use first available mapping\r\n        soundsMap = Object.values(allSoundsMajor)[0]\r\n      }\r\n\r\n      this.noVersionIdMapping = true\r\n    }\r\n\r\n    // Create both mappings\r\n    this.soundsIdToName = {}\r\n    this.soundsPerName = {}\r\n\r\n    for (const [id, soundsStr] of Object.entries(soundsMap)) {\r\n      const sounds = soundsStr.split(',').map(s => {\r\n        const [volume, name, weight] = s.split(';')\r\n        if (isNaN(Number(volume))) throw new Error('volume is not a number')\r\n        if (isNaN(Number(weight))) throw new TypeError('weight is not a number')\r\n        return {\r\n          file: name,\r\n          weight: Number(weight),\r\n          volume: Number(volume)\r\n        }\r\n      })\r\n\r\n      const [idPart, namePart] = id.split(';')\r\n      this.soundsIdToName[idPart] = namePart\r\n\r\n      this.soundsPerName[namePart] = sounds\r\n    }\r\n  }\r\n\r\n  async updateActiveResourcePackBasePath (basePath: string | undefined) {\r\n    this.activeResourcePackBasePath = basePath\r\n    if (!basePath) {\r\n      this.activeResourcePackSoundsJson = undefined\r\n      return\r\n    }\r\n\r\n    let soundsJsonContent: string | undefined\r\n    try {\r\n      const soundsJsonPath = path.join(basePath, 'assets/minecraft/sounds.json')\r\n      soundsJsonContent = await fs.promises.readFile(soundsJsonPath, 'utf8')\r\n    } catch (err) {}\r\n    try {\r\n      if (soundsJsonContent) {\r\n        this.activeResourcePackSoundsJson = JSON.parse(soundsJsonContent)\r\n      }\r\n    } catch (err) {\r\n      console.warn('Failed to parse sounds.json from resourcepack', err)\r\n      this.activeResourcePackSoundsJson = undefined\r\n    }\r\n  }\r\n\r\n  async updateExistingResourcePackPaths () {\r\n    if (!this.activeResourcePackBasePath) return\r\n    // todo support sounds.js from resource pack\r\n    const soundsBasePath = path.join(this.activeResourcePackBasePath, 'assets/minecraft/sounds')\r\n    // scan recursively for sounds files\r\n    const scan = async (dir: string) => {\r\n      const entries = await fs.promises.readdir(dir, { withFileTypes: true })\r\n      for (const entry of entries) {\r\n        const entryPath = path.join(dir, entry.name)\r\n        if (entry.isDirectory()) {\r\n          await scan(entryPath)\r\n        } else if (entry.isFile() && entry.name.endsWith('.ogg')) {\r\n          const relativePath = path.relative(soundsBasePath, entryPath)\r\n          this.existingResourcePackPaths.add(relativePath)\r\n        }\r\n      }\r\n    }\r\n\r\n    await scan(soundsBasePath)\r\n  }\r\n\r\n  async getSoundUrl (soundKey: string, volume = 1): Promise<{ url: string; volume: number } | undefined> {\r\n    // First check resource pack sounds.json\r\n    if (this.activeResourcePackSoundsJson && soundKey in this.activeResourcePackSoundsJson) {\r\n      const rpSound = this.activeResourcePackSoundsJson[soundKey]\r\n      // Pick a random sound from the resource pack\r\n      const sound = rpSound.sounds[Math.floor(Math.random() * rpSound.sounds.length)]\r\n      const soundVolume = sound.volume ?? 1\r\n\r\n      if (this.activeResourcePackBasePath) {\r\n        const tryFormat = async (format: string) => {\r\n          try {\r\n            const resourcePackPath = path.join(this.activeResourcePackBasePath!, `/assets/minecraft/sounds/${sound.name}.${format}`)\r\n            const fileData = await fs.promises.readFile(resourcePackPath)\r\n            return {\r\n              url: `data:audio/${format};base64,${fileData.toString('base64')}`,\r\n              volume: soundVolume * Math.max(Math.min(volume, 1), 0)\r\n            }\r\n          } catch (err) {\r\n            return null\r\n          }\r\n        }\r\n\r\n        const result = await tryFormat(this.soundData.soundsMeta.format)\r\n        if (result) return result\r\n\r\n        if (this.soundData.soundsMeta.format !== 'ogg') {\r\n          const oggResult = await tryFormat('ogg')\r\n          if (oggResult) return oggResult\r\n        }\r\n      }\r\n    }\r\n\r\n    // Fall back to vanilla sounds if no resource pack sound found\r\n    const sounds = this.soundsPerName[soundKey]\r\n    if (!sounds?.length) return undefined\r\n\r\n    // Pick a random sound based on weights\r\n    const totalWeight = sounds.reduce((sum, s) => sum + s.weight, 0)\r\n    let random = Math.random() * totalWeight\r\n    const sound = sounds.find(s => {\r\n      random -= s.weight\r\n      return random <= 0\r\n    }) ?? sounds[0]\r\n\r\n    const versionedSound = this.getVersionedSound(sound.file)\r\n\r\n    const url = this.soundData.soundsMeta.baseUrl.replace(/\\/$/, '') +\r\n      (versionedSound ? `/${versionedSound}` : '') +\r\n      '/minecraft/sounds/' +\r\n      sound.file +\r\n      '.' +\r\n      this.soundData.soundsMeta.format\r\n\r\n    return {\r\n      url,\r\n      volume: sound.volume * Math.max(Math.min(volume, 1), 0)\r\n    }\r\n  }\r\n\r\n  private getVersionedSound (item: string): string | undefined {\r\n    const verNumber = versionToNumber(this.version)\r\n    const entries = Object.entries(this.soundData.soundsLegacyMap)\r\n    for (const [itemsVer, items] of entries) {\r\n      if (items.includes(item) && verNumber <= versionToNumber(itemsVer)) {\r\n        return itemsVer\r\n      }\r\n    }\r\n    return undefined\r\n  }\r\n\r\n  getBlockSound (blockName: string, category: string, fallback: string): string {\r\n    const mappedName = blockSoundAliases[blockName] ?? blockName\r\n    const key = `block.${mappedName}.${category}`\r\n    return this.soundsPerName[key] ? key : fallback\r\n  }\r\n\r\n  getStepSound (blockName: string): string {\r\n    return this.getBlockSound(blockName, 'step', 'block.stone.step')\r\n  }\r\n\r\n  getBreakSound (blockName: string): string {\r\n    return this.getBlockSound(blockName, 'break', 'block.stone.break')\r\n  }\r\n\r\n  quit () {\r\n    musicSystem.stopMusic()\r\n    stopAllSounds()\r\n  }\r\n}\r\n\r\nexport function createSoundMap (version: string): SoundMap | null {\r\n  const globalObject = window as {\r\n    allSoundsMap?: Record<string, Record<string, string>>,\r\n    allSoundsVersionedMap?: Record<string, string[]>,\r\n    allSoundsMeta?: { format: string, baseUrl: string }\r\n  }\r\n  if (!globalObject.allSoundsMap) return null\r\n  return new SoundMap({\r\n    allSoundsMap: globalObject.allSoundsMap,\r\n    soundsLegacyMap: globalObject.allSoundsVersionedMap ?? {},\r\n    soundsMeta: globalObject.allSoundsMeta!\r\n  }, version)\r\n}\r\n\r\n// Block name mappings for sound effects\r\nconst blockSoundAliases: BlockSoundMap = {\r\n  // Grass-like blocks\r\n  grass_block: 'grass',\r\n  tall_grass: 'grass',\r\n  fern: 'grass',\r\n  large_fern: 'grass',\r\n  dead_bush: 'grass',\r\n  seagrass: 'grass',\r\n  tall_seagrass: 'grass',\r\n  kelp: 'grass',\r\n  kelp_plant: 'grass',\r\n  sugar_cane: 'grass',\r\n  bamboo: 'grass',\r\n  vine: 'grass',\r\n  nether_sprouts: 'grass',\r\n  twisting_vines: 'grass',\r\n  weeping_vines: 'grass',\r\n  sweet_berry_bush: 'grass',\r\n  glow_lichen: 'grass',\r\n  moss_carpet: 'grass',\r\n  moss_block: 'grass',\r\n  hanging_roots: 'grass',\r\n  spore_blossom: 'grass',\r\n  small_dripleaf: 'grass',\r\n  big_dripleaf: 'grass',\r\n  flowering_azalea: 'grass',\r\n  azalea: 'grass',\r\n  azalea_leaves: 'grass',\r\n  flowering_azalea_leaves: 'grass',\r\n\r\n  // Dirt and ground blocks\r\n  dirt: 'gravel',\r\n  coarse_dirt: 'gravel',\r\n  podzol: 'gravel',\r\n  mycelium: 'gravel',\r\n  farmland: 'gravel',\r\n  dirt_path: 'gravel',\r\n  rooted_dirt: 'rooted_dirt',\r\n\r\n  // Crop blocks\r\n  wheat: 'crop',\r\n  potatoes: 'crop',\r\n  carrots: 'crop',\r\n  beetroots: 'crop',\r\n  melon_stem: 'crop',\r\n  pumpkin_stem: 'crop',\r\n  sweet_berries: 'crop',\r\n  cocoa: 'crop',\r\n  nether_wart: 'crop',\r\n  torchflower_crop: 'crop',\r\n  pitcher_crop: 'crop',\r\n\r\n  // Stone-like blocks\r\n  cobblestone: 'stone',\r\n  stone_bricks: 'stone',\r\n  mossy_stone_bricks: 'stone',\r\n  cracked_stone_bricks: 'stone',\r\n  chiseled_stone_bricks: 'stone',\r\n  stone_brick_slab: 'stone',\r\n  stone_brick_stairs: 'stone',\r\n  stone_brick_wall: 'stone',\r\n  polished_granite: 'stone',\r\n  granite: 'stone',\r\n  andesite: 'stone',\r\n  diorite: 'stone',\r\n  polished_andesite: 'stone',\r\n  polished_diorite: 'stone',\r\n  deepslate: 'deepslate',\r\n  cobbled_deepslate: 'deepslate',\r\n  polished_deepslate: 'deepslate',\r\n  deepslate_bricks: 'deepslate_bricks',\r\n  deepslate_tiles: 'deepslate_tiles',\r\n  calcite: 'stone',\r\n  tuff: 'stone',\r\n  smooth_stone: 'stone',\r\n  smooth_sandstone: 'stone',\r\n  smooth_quartz: 'stone',\r\n  smooth_red_sandstone: 'stone',\r\n\r\n  // Wood-like blocks\r\n  oak_planks: 'wood',\r\n  spruce_planks: 'wood',\r\n  birch_planks: 'wood',\r\n  jungle_planks: 'wood',\r\n  acacia_planks: 'wood',\r\n  dark_oak_planks: 'wood',\r\n  crimson_planks: 'wood',\r\n  warped_planks: 'wood',\r\n  oak_log: 'wood',\r\n  spruce_log: 'wood',\r\n  birch_log: 'wood',\r\n  jungle_log: 'wood',\r\n  acacia_log: 'wood',\r\n  dark_oak_log: 'wood',\r\n  crimson_stem: 'stem',\r\n  warped_stem: 'stem',\r\n\r\n  // Metal blocks\r\n  iron_block: 'metal',\r\n  gold_block: 'metal',\r\n  copper_block: 'copper',\r\n  exposed_copper: 'copper',\r\n  weathered_copper: 'copper',\r\n  oxidized_copper: 'copper',\r\n  netherite_block: 'netherite_block',\r\n  ancient_debris: 'ancient_debris',\r\n  lodestone: 'lodestone',\r\n  chain: 'chain',\r\n  anvil: 'anvil',\r\n  chipped_anvil: 'anvil',\r\n  damaged_anvil: 'anvil',\r\n\r\n  // Glass blocks\r\n  glass: 'glass',\r\n  glass_pane: 'glass',\r\n  white_stained_glass: 'glass',\r\n  orange_stained_glass: 'glass',\r\n  magenta_stained_glass: 'glass',\r\n  light_blue_stained_glass: 'glass',\r\n  yellow_stained_glass: 'glass',\r\n  lime_stained_glass: 'glass',\r\n  pink_stained_glass: 'glass',\r\n  gray_stained_glass: 'glass',\r\n  light_gray_stained_glass: 'glass',\r\n  cyan_stained_glass: 'glass',\r\n  purple_stained_glass: 'glass',\r\n  blue_stained_glass: 'glass',\r\n  brown_stained_glass: 'glass',\r\n  green_stained_glass: 'glass',\r\n  red_stained_glass: 'glass',\r\n  black_stained_glass: 'glass',\r\n  tinted_glass: 'glass',\r\n\r\n  // Wool blocks\r\n  white_wool: 'wool',\r\n  orange_wool: 'wool',\r\n  magenta_wool: 'wool',\r\n  light_blue_wool: 'wool',\r\n  yellow_wool: 'wool',\r\n  lime_wool: 'wool',\r\n  pink_wool: 'wool',\r\n  gray_wool: 'wool',\r\n  light_gray_wool: 'wool',\r\n  cyan_wool: 'wool',\r\n  purple_wool: 'wool',\r\n  blue_wool: 'wool',\r\n  brown_wool: 'wool',\r\n  green_wool: 'wool',\r\n  red_wool: 'wool',\r\n  black_wool: 'wool',\r\n\r\n  // Nether blocks\r\n  netherrack: 'netherrack',\r\n  nether_bricks: 'nether_bricks',\r\n  red_nether_bricks: 'nether_bricks',\r\n  nether_wart_block: 'wart_block',\r\n  warped_wart_block: 'wart_block',\r\n  soul_sand: 'soul_sand',\r\n  soul_soil: 'soul_soil',\r\n  basalt: 'basalt',\r\n  polished_basalt: 'basalt',\r\n  blackstone: 'gilded_blackstone',\r\n  gilded_blackstone: 'gilded_blackstone',\r\n\r\n  // Amethyst blocks\r\n  amethyst_block: 'amethyst_block',\r\n  amethyst_cluster: 'amethyst_cluster',\r\n  large_amethyst_bud: 'large_amethyst_bud',\r\n  medium_amethyst_bud: 'medium_amethyst_bud',\r\n  small_amethyst_bud: 'small_amethyst_bud',\r\n\r\n  // Miscellaneous\r\n  sand: 'sand',\r\n  red_sand: 'sand',\r\n  gravel: 'gravel',\r\n  snow: 'snow',\r\n  snow_block: 'snow',\r\n  powder_snow: 'powder_snow',\r\n  ice: 'glass',\r\n  packed_ice: 'glass',\r\n  blue_ice: 'glass',\r\n  slime_block: 'slime_block',\r\n  honey_block: 'honey_block',\r\n  scaffolding: 'scaffolding',\r\n  ladder: 'ladder',\r\n  lantern: 'lantern',\r\n  soul_lantern: 'lantern',\r\n  pointed_dripstone: 'pointed_dripstone',\r\n  dripstone_block: 'dripstone_block',\r\n  sculk_sensor: 'sculk_sensor',\r\n  shroomlight: 'shroomlight'\r\n}\r\n","export const isCypress = () => {\r\n  return localStorage.cypress === 'true'\r\n}\r\n","import { supportedVersions, postNettyVersionsByProtocolVersion } from 'minecraft-data'\r\n\r\nexport const ignoredVersionsRegex = /(^0\\.30c$)|w|-pre|-rc/\r\n\r\n/** @type {string[]} */\r\nconst versionsFromProtocol = Object.values(postNettyVersionsByProtocolVersion.pc).flat().filter(x => !ignoredVersionsRegex.test(x.minecraftVersion)).map(x => x.minecraftVersion)\r\n\r\nexport const notTestedVersions = '1.19.3 1.20 1.19.1 1.19 1.18.1 1.15.1 1.14.1'.split(' ')\r\n\r\nexport default versionsFromProtocol.filter(x => x !== '1.7' && !x.startsWith('1.7.'))\r\n","import { appQueryParams } from './appParams'\r\n\r\nif (appQueryParams.testCrashApp === '1') {\r\n  throw new Error('test error')\r\n}\r\n","import Stats from 'stats.js'\r\nimport StatsGl from 'stats-gl'\r\nimport { isCypress } from './standaloneUtils'\r\n\r\nconst stats = new Stats()\r\nconst stats2 = new Stats()\r\nconst hasRamPanel = stats2.dom.children.length === 3\r\nconst statsGl = new StatsGl({ minimal: true })\r\n// in my case values are good: gpu: < 0.5, cpu < 0.15\r\n\r\nstats2.showPanel(2)\r\n\r\n// prod or small screen\r\nconst denseMode = process.env.NODE_ENV === 'production' || window.innerHeight < 500\r\n\r\nlet total = 0\r\nconst addStat = (dom, size = 80) => {\r\n  dom.style.position = 'absolute'\r\n  if (denseMode) dom.style.height = '12px'\r\n  dom.style.overflow = 'hidden'\r\n  dom.style.left = ''\r\n  dom.style.top = 0\r\n  dom.style.right = `${total}px`\r\n  dom.style.width = '80px'\r\n  dom.style.zIndex = 1\r\n  dom.style.opacity = '0.8'\r\n  document.body.appendChild(dom)\r\n  total += size\r\n}\r\nconst addStatsGlStat = (canvas) => {\r\n  const container = document.createElement('div')\r\n  canvas.style.position = 'static'\r\n  canvas.style.display = 'block'\r\n  container.appendChild(canvas)\r\n  addStat(container)\r\n}\r\naddStat(stats.dom)\r\nif (hasRamPanel) {\r\n  addStat(stats2.dom)\r\n}\r\n\r\nexport const toggleStatsVisibility = (visible: boolean) => {\r\n  if (visible) {\r\n    stats.dom.style.display = 'block'\r\n    stats2.dom.style.display = 'block'\r\n    statsGl.container.style.display = 'block'\r\n  } else {\r\n    stats.dom.style.display = 'none'\r\n    stats2.dom.style.display = 'none'\r\n    statsGl.container.style.display = 'none'\r\n  }\r\n}\r\n\r\nconst hideStats = localStorage.hideStats || isCypress()\r\nif (hideStats) {\r\n  toggleStatsVisibility(false)\r\n}\r\n\r\nexport const initWithRenderer = (canvas) => {\r\n  if (hideStats) return\r\n  statsGl.init(canvas)\r\n  // if (statsGl.gpuPanel && process.env.NODE_ENV !== 'production') {\r\n  //   addStatsGlStat(statsGl.gpuPanel.canvas)\r\n  // }\r\n  // addStatsGlStat(statsGl.msPanel.canvas)\r\n  statsGl.container.style.display = 'flex'\r\n  statsGl.container.style.justifyContent = 'flex-end'\r\n  let i = 0\r\n  for (const _child of statsGl.container.children) {\r\n    const child = _child as HTMLElement\r\n    if (i++ === 0) {\r\n      child.style.display = 'none'\r\n    }\r\n    child.style.position = ''\r\n  }\r\n}\r\n\r\nexport const statsStart = () => {\r\n  stats.begin()\r\n  stats2.begin()\r\n  statsGl.begin()\r\n}\r\nexport const statsEnd = () => {\r\n  stats.end()\r\n  stats2.end()\r\n  statsGl.end()\r\n}\r\n\r\n// for advanced debugging, use with watch expression\r\n\r\nwindow.statsPerSecAvg = {}\r\nlet currentStatsPerSec = {} as Record<string, number[]>\r\nconst waitingStatsPerSec = {}\r\nwindow.markStart = (label) => {\r\n  waitingStatsPerSec[label] ??= []\r\n  waitingStatsPerSec[label][0] = performance.now()\r\n}\r\nwindow.markEnd = (label) => {\r\n  if (!waitingStatsPerSec[label]?.[0]) return\r\n  currentStatsPerSec[label] ??= []\r\n  currentStatsPerSec[label].push(performance.now() - waitingStatsPerSec[label][0])\r\n  delete waitingStatsPerSec[label]\r\n}\r\nconst updateStatsPerSecAvg = () => {\r\n  window.statsPerSecAvg = Object.fromEntries(Object.entries(currentStatsPerSec).map(([key, value]) => {\r\n    return [key, {\r\n      avg: value.reduce((a, b) => a + b, 0) / value.length,\r\n      count: value.length\r\n    }]\r\n  }))\r\n  currentStatsPerSec = {}\r\n}\r\n\r\n\r\nwindow.statsPerSec = {}\r\nlet statsPerSecCurrent = {}\r\nlet lastReset = performance.now()\r\nwindow.addStatPerSec = (name) => {\r\n  statsPerSecCurrent[name] ??= 0\r\n  statsPerSecCurrent[name]++\r\n}\r\nwindow.statsPerSecCurrent = statsPerSecCurrent\r\nsetInterval(() => {\r\n  window.statsPerSec = { duration: Math.floor(performance.now() - lastReset), ...statsPerSecCurrent, }\r\n  statsPerSecCurrent = {}\r\n  window.statsPerSecCurrent = statsPerSecCurrent\r\n  updateStatsPerSecAvg()\r\n  lastReset = performance.now()\r\n}, 1000)\r\n","import { gameAdditionalState, isGameActive, miscUiState } from './globalState'\r\nimport { options } from './optionsStorage'\r\nimport { notificationProxy, showNotification } from './react/NotificationProvider'\r\nimport { packetsReplayState } from './react/state/packetsReplayState'\r\n\r\nexport const goFullscreen = async (doToggle = false) => {\r\n  if (!document.fullscreenElement) {\r\n    // todo display a message or repeat?\r\n    await document.documentElement.requestFullscreen().catch(() => { })\r\n    // request full keyboard access\r\n    await navigator.keyboard?.lock?.(['Escape', 'KeyW'])\r\n  } else if (doToggle) {\r\n    await document.exitFullscreen().catch(() => { })\r\n  }\r\n}\r\n\r\nexport const toNumber = val => {\r\n  const num = Number(val)\r\n  return isNaN(num) ? undefined : num\r\n}\r\n\r\nexport const inGameError = err => {\r\n  console.error(err)\r\n  window.reportError?.(err)\r\n  // todo report\r\n  miscUiState.hasErrors = true\r\n}\r\n\r\nexport const pointerLock = {\r\n  get hasPointerLock () {\r\n    return document.pointerLockElement\r\n  },\r\n  justHitEscape: false,\r\n  async requestPointerLock () {\r\n    if (!isGameActive(true) || !document.documentElement.requestPointerLock || miscUiState.currentTouch) {\r\n      return\r\n    }\r\n    if (options.autoFullScreen) {\r\n      void goFullscreen()\r\n    }\r\n    const displayBrowserProblem = () => {\r\n      showNotification('Browser Delay Limitation', navigator['keyboard'] ? 'Click on screen, enable Auto Fullscreen or F11' : 'Click on screen or use fullscreen in Chrome')\r\n      notificationProxy.id = 'pointerlockchange'\r\n    }\r\n    if (!(document.fullscreenElement && navigator['keyboard']) && this.justHitEscape) {\r\n      displayBrowserProblem()\r\n    } else {\r\n      //@ts-expect-error\r\n      const promise: any = document.documentElement.requestPointerLock({\r\n        unadjustedMovement: options.mouseRawInput\r\n      })\r\n      promise?.catch(error => {\r\n        if (error.name === 'NotSupportedError') {\r\n          // Some platforms may not support unadjusted movement, request again a regular pointer lock.\r\n          document.documentElement.requestPointerLock()\r\n        } else if (error.name === 'SecurityError') {\r\n          // cause: https://discourse.threejs.org/t/how-to-avoid-pointerlockcontrols-error/33017/4\r\n          displayBrowserProblem()\r\n        } else {\r\n          console.error(error)\r\n        }\r\n      })\r\n    }\r\n    this.justHitEscape = false\r\n  }\r\n}\r\n\r\nexport const isInRealGameSession = () => {\r\n  return isGameActive(true) && (!packetsReplayState.isOpen || packetsReplayState.isMinimized) && !gameAdditionalState.viewerConnection\r\n}\r\n\r\nwindow.getScreenRefreshRate = getScreenRefreshRate\r\n\r\n/**\r\n * Allows to obtain the estimated Hz of the primary monitor in the system.\r\n */\r\nexport async function getScreenRefreshRate (): Promise<number> {\r\n  let requestId = null as number | null\r\n  let callbackTriggered = false\r\n  let resolve\r\n\r\n  const DOMHighResTimeStampCollection = [] as number[]\r\n\r\n  const triggerAnimation = DOMHighResTimeStamp => {\r\n    DOMHighResTimeStampCollection.unshift(DOMHighResTimeStamp)\r\n\r\n    if (DOMHighResTimeStampCollection.length > 10) {\r\n      const t0 = DOMHighResTimeStampCollection.pop()!\r\n      const fps = Math.floor(1000 * 10 / (DOMHighResTimeStamp - t0))\r\n\r\n      if (!callbackTriggered || fps > 1000) {\r\n        resolve(Math.min(fps, 1000)/* , DOMHighResTimeStampCollection */)\r\n      }\r\n\r\n      callbackTriggered = true\r\n    }\r\n\r\n    requestId = window.requestAnimationFrame(triggerAnimation)\r\n  }\r\n\r\n  window.requestAnimationFrame(triggerAnimation)\r\n\r\n  window.setTimeout(() => {\r\n    window.cancelAnimationFrame(requestId!)\r\n    requestId = null\r\n  }, 500)\r\n\r\n  return new Promise(_resolve => {\r\n    resolve = _resolve\r\n  })\r\n}\r\n\r\nexport const getGamemodeNumber = bot => {\r\n  switch (bot.game.gameMode) {\r\n    case 'survival': return 0\r\n    case 'creative': return 1\r\n    case 'adventure': return 2\r\n    case 'spectator': return 3\r\n    default: return -1\r\n  }\r\n}\r\n\r\nexport const isMajorVersionGreater = (ver1: string, ver2: string) => {\r\n  const [a1, b1] = ver1.split('.')\r\n  const [a2, b2] = ver2.split('.')\r\n  return +a1 > +a2 || (+a1 === +a2 && +b1 > +b2)\r\n}\r\n\r\n// doesn't support snapshots\r\nexport const toMajorVersion = version => {\r\n  const [a, b] = (String(version)).split('.')\r\n  return `${a}.${b}`\r\n}\r\n\r\nlet prevRenderDistance = options.renderDistance\r\nexport const setRenderDistance = () => {\r\n  assertDefined(worldView)\r\n  const { renderDistance: singleplayerRenderDistance, multiplayerRenderDistance } = options\r\n  let renderDistance = miscUiState.singleplayer ? singleplayerRenderDistance : multiplayerRenderDistance\r\n  const zeroRenderDistance = miscUiState.singleplayer && renderDistance === 0\r\n  if (zeroRenderDistance) {\r\n    renderDistance = 1 // mineflayer limitation workaround\r\n  }\r\n  bot.setSettings({\r\n    viewDistance: renderDistance\r\n  })\r\n  if (zeroRenderDistance) {\r\n    localServer!.players[0].view = 0\r\n    renderDistance = 0\r\n  }\r\n  worldView.updateViewDistance(renderDistance)\r\n  prevRenderDistance = renderDistance\r\n}\r\nexport const reloadChunks = async () => {\r\n  if (!worldView) return\r\n  setRenderDistance()\r\n  await worldView.updatePosition(bot.entity.position, true)\r\n}\r\n\r\nexport const openGithub = (addUrl = '') => {\r\n  window.open(`${process.env.GITHUB_URL}${addUrl}`, '_blank')\r\n}\r\n\r\nexport const resolveTimeout = async (promise, timeout = 10_000) => {\r\n  return new Promise((resolve, reject) => {\r\n    promise.then(resolve, reject)\r\n    setTimeout(() => {\r\n      reject(new Error('timeout'))\r\n    }, timeout)\r\n  })\r\n}\r\n\r\nexport function assertDefined<T> (x: T | undefined): asserts x is T {\r\n  if (!x) throw new Error('Assertion failed. Something is not available')\r\n}\r\n\r\nexport const haveDirectoryPicker = () => {\r\n  return !!window.showDirectoryPicker\r\n}\r\n\r\nconst reportedWarnings = new Set<string>()\r\n\r\nexport const reportWarningOnce = (id: string, message: string) => {\r\n  if (reportedWarnings.has(id)) return\r\n  reportedWarnings.add(id)\r\n  console.warn(message)\r\n}\r\n","import { EventEmitter } from 'events'\r\nimport { Duplex } from 'stream'\r\nimport states from 'minecraft-protocol/src/states'\r\nimport { createClient } from 'minecraft-protocol'\r\nimport { proxy, subscribe } from 'valtio'\r\nimport * as Gui from 'lil-gui'\r\nimport { CustomChannelPacketFromClient, CustomChannelPacketFromServer, UIDefinition } from 'mcraft-fun-mineflayer/build/customChannel'\r\nimport { activeModalStack } from './globalState'\r\nimport { mineflayerPluginHudState } from './react/MineflayerPluginHud'\r\nimport { mineflayerConsoleState } from './react/MineflayerPluginConsole'\r\n\r\nexport const viewerVersionState = proxy({\r\n  forwardChat: true,\r\n  version: '',\r\n  time: 0,\r\n  replEnabled: false,\r\n  consoleEnabled: false,\r\n  requiresPass: false,\r\n  clientIgnoredPackets: [] as string[]\r\n})\r\n\r\nclass CustomDuplex extends Duplex {\r\n  constructor (options, public writeAction) {\r\n    super(options)\r\n  }\r\n\r\n  override _read () {}\r\n\r\n  override _write (chunk, encoding, callback) {\r\n    this.writeAction(chunk)\r\n    callback()\r\n  }\r\n}\r\n\r\nexport const getViewerVersionData = async (url: string) => {\r\n  const ws = await openWebsocket(url)\r\n  ws.send('version')\r\n  const result = await new Promise<{\r\n    version: string\r\n    time: number,\r\n    replEnabled: boolean,\r\n    consoleEnabled: boolean,\r\n    requiresPass: boolean,\r\n    forwardChat: boolean,\r\n    clientIgnoredPackets?: string[]\r\n  }>((resolve, reject) => {\r\n    ws.addEventListener('message', async (message) => {\r\n      const { data } = message\r\n      const parsed = JSON.parse(data.toString())\r\n      resolve(parsed)\r\n      ws.close()\r\n      // Update viewer version state\r\n      Object.assign(viewerVersionState, parsed)\r\n      // todo\r\n      customEvents.on('mineflayerBotCreated', () => {\r\n        const client = bot._client as any\r\n        const oldWrite = client.write.bind(client)\r\n        client.write = (...args) => {\r\n          const [name] = args\r\n          if (parsed?.clientIgnoredPackets?.includes(name)) {\r\n            return\r\n          }\r\n          oldWrite(...args)\r\n        }\r\n      })\r\n    })\r\n  })\r\n  mineflayerConsoleState.consoleEnabled = result.consoleEnabled\r\n  mineflayerConsoleState.replEnabled = result.replEnabled\r\n  return result\r\n}\r\n\r\nconst openWebsocket = async (url: string) => {\r\n  if (url.startsWith(':')) url = `ws://localhost${url}`\r\n  if (!url.startsWith('ws')) url = `ws://${url}`\r\n  const ws = new WebSocket(url)\r\n  await new Promise<void>((resolve, reject) => {\r\n    ws.onopen = () => resolve()\r\n    ws.onerror = (err) => reject(new Error(`[websocket] Failed to connect to ${url}`))\r\n    ws.onclose = (ev) => reject(ev.reason)\r\n  })\r\n  return ws\r\n}\r\n\r\nexport const getWsProtocolStream = async (url: string) => {\r\n  const ws = await openWebsocket(url)\r\n  const clientDuplex = new CustomDuplex(undefined, data => {\r\n    // console.log('send', Buffer.from(data).toString('hex'))\r\n    ws.send(data)\r\n  })\r\n  // todo use keep alive instead?\r\n  let lastMessageTime = performance.now()\r\n  ws.addEventListener('message', async (message) => {\r\n    let { data } = message\r\n    if (data instanceof Blob) {\r\n      data = await data.arrayBuffer()\r\n    }\r\n    clientDuplex.push(Buffer.from(data))\r\n    lastMessageTime = performance.now()\r\n  })\r\n  setInterval(() => {\r\n    // if (clientDuplex.destroyed) return\r\n    // if (performance.now() - lastMessageTime > 10_000) {\r\n    //   console.log('no packats received in 10s!')\r\n    //   clientDuplex.end()\r\n    // }\r\n  }, 5000)\r\n\r\n  ws.addEventListener('close', () => {\r\n    console.log('ws closed')\r\n    clientDuplex.end()\r\n    setTimeout(() => {\r\n      bot?.emit('end', 'Connection lost')\r\n    }, 500)\r\n  })\r\n\r\n  ws.addEventListener('error', err => {\r\n    console.log('ws error', err)\r\n  })\r\n\r\n  return {\r\n    clientDuplex\r\n  }\r\n}\r\n\r\nconst CHANNEL_NAME = 'minecraft-web-client:data'\r\n\r\nexport const handleCustomChannel = async () => {\r\n  bot._client.registerChannel(CHANNEL_NAME, ['string', []])\r\n  const toCleanup = [] as Array<() => void>\r\n  subscribe(activeModalStack, () => {\r\n    if (activeModalStack.length === 1 && activeModalStack[0].reactType === 'main-menu') {\r\n      for (const fn of toCleanup) fn()\r\n      toCleanup.length = 0\r\n      // Clear console state when disconnecting\r\n      mineflayerConsoleState.messages = []\r\n      mineflayerConsoleState.replEnabled = false\r\n      mineflayerConsoleState.consoleEnabled = false\r\n    }\r\n  })\r\n\r\n  const send = (data: CustomChannelPacketFromClient) => {\r\n    bot._client.writeChannel(CHANNEL_NAME, JSON.stringify(data))\r\n  }\r\n\r\n  // Set up console execution handler\r\n  mineflayerConsoleState.onExecute = (code) => {\r\n    send({\r\n      type: 'eval',\r\n      code\r\n    })\r\n  }\r\n\r\n  const on = (callback: (data: CustomChannelPacketFromServer) => void) => {\r\n    bot._client.on(CHANNEL_NAME as any, (data) => {\r\n      const parsed = JSON.parse(data.toString())\r\n      callback(parsed)\r\n    })\r\n  }\r\n\r\n  const lils = {} as Record<string, Gui.GUI>\r\n\r\n  on((data) => {\r\n    switch (data.type) {\r\n      case 'eval': {\r\n        // Handle eval results\r\n        mineflayerConsoleState.messages.push({\r\n          id: Date.now(),\r\n          text: data.isError ? `${data.result}` : JSON.stringify(data.result),\r\n          isRepl: true,\r\n          level: data.isError ? 'error' : undefined\r\n        })\r\n        // Limit to 500 messages by removing oldest ones\r\n        if (mineflayerConsoleState.messages.length > 500) {\r\n          mineflayerConsoleState.messages = mineflayerConsoleState.messages.slice(-500)\r\n        }\r\n        break\r\n      }\r\n      case 'console': {\r\n        // Handle console messages\r\n        mineflayerConsoleState.messages.push({\r\n          id: Date.now(),\r\n          text: data.message,\r\n          level: data.level\r\n        })\r\n        // Limit to 500 messages by removing oldest ones\r\n        if (mineflayerConsoleState.messages.length > 500) {\r\n          mineflayerConsoleState.messages = mineflayerConsoleState.messages.slice(-500)\r\n        }\r\n        break\r\n      }\r\n      // todo\r\n      case 'kick' as any: {\r\n        bot.emit('end', (data as any).reason)\r\n        break\r\n      }\r\n      case 'ui': {\r\n        const { update } = data\r\n        if (update.data === null) {\r\n          // Remove UI element\r\n          mineflayerPluginHudState.ui = mineflayerPluginHudState.ui.filter(ui => ui.id !== update.id)\r\n\r\n          const gui = lils[update.id]\r\n          if (gui) {\r\n            gui.destroy()\r\n            delete lils[update.id]\r\n          }\r\n        } else {\r\n        // Add or update UI element\r\n          const existingIndex = mineflayerPluginHudState.ui.findIndex(ui => ui.id === update.id)\r\n          if (existingIndex === -1) {\r\n            mineflayerPluginHudState.ui.push({ ...update.data, id: update.id })\r\n          } else {\r\n            mineflayerPluginHudState.ui[existingIndex] = { ...update.data, id: update.id }\r\n          }\r\n\r\n          if (update.data.type === 'lil') {\r\n            let gui = lils[update.id]\r\n            if (!gui) {\r\n              gui = new Gui.GUI({\r\n                title: update.data.title,\r\n              })\r\n              lils[update.id] = gui\r\n            }\r\n\r\n            // Update or add controllers\r\n            const { params, buttons } = update.data\r\n            for (const button of buttons ?? []) {\r\n              params[button] = (() => {\r\n                send({\r\n                  type: 'ui',\r\n                  id: update.id,\r\n                  param: button,\r\n                  value: true\r\n                })\r\n              }) as any\r\n            }\r\n            // eslint-disable-next-line guard-for-in\r\n            for (const paramName in params) {\r\n              const value = params[paramName]\r\n              const controller = gui.controllers.find(c => c.property === paramName)\r\n\r\n              if (controller) {\r\n                // Update existing controller value\r\n                controller.object[paramName] = value\r\n                controller.updateDisplay()\r\n              } else {\r\n                // Add new controller if doesn't exist\r\n                const obj = { [paramName]: value }\r\n                const controller = gui.add(obj, paramName)\r\n                if (!buttons?.includes(paramName)) {\r\n                  controller.onChange((value) => {\r\n                    send({\r\n                      type: 'ui',\r\n                      id: update.id,\r\n                      param: paramName,\r\n                      value\r\n                    })\r\n                  })\r\n                }\r\n              }\r\n            }\r\n\r\n            // Remove controllers that are no longer in params\r\n            const paramNames = Object.keys(params)\r\n            gui.controllers = gui.controllers.filter(c => {\r\n              if (!paramNames.includes(c.property)) {\r\n                c.destroy()\r\n                return false\r\n              }\r\n              return true\r\n            })\r\n          }\r\n        }\r\n\r\n        break\r\n      }\r\n\r\n      case 'stats': {\r\n        globalThis.botStats = data\r\n        break\r\n      }\r\n\r\n      case 'method': {\r\n        console.log('Method result', data.result)\r\n        break\r\n      }\r\n      // No default\r\n    }\r\n  })\r\n}\r\n","import { VRButton } from 'three/examples/jsm/webxr/VRButton.js'\r\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js'\r\nimport { XRControllerModelFactory } from 'three/examples/jsm/webxr/XRControllerModelFactory.js'\r\nimport { buttonMap as standardButtonsMap } from 'contro-max/build/gamepad'\r\nimport * as THREE from 'three'\r\nimport { subscribeKey } from 'valtio/utils'\r\nimport { subscribe } from 'valtio'\r\nimport { activeModalStack, hideModal } from './globalState'\r\nimport { watchUnloadForCleanup } from './gameUnload'\r\nimport { options } from './optionsStorage'\r\n\r\nexport async function initVR () {\r\n  options.vrSupport = true\r\n  const { renderer } = viewer\r\n  if (!('xr' in navigator)) return\r\n\r\n  const isSupported = await checkVRSupport()\r\n  if (!isSupported) return\r\n\r\n  enableVr(renderer)\r\n\r\n  const vrButtonContainer = createVrButtonContainer(renderer)\r\n  const updateVrButtons = () => {\r\n    vrButtonContainer.hidden = !options.vrSupport || activeModalStack.length !== 0\r\n  }\r\n\r\n  const unsubWatchSetting = subscribeKey(options, 'vrSupport', updateVrButtons)\r\n  const unsubWatchModals = subscribe(activeModalStack, updateVrButtons)\r\n\r\n  function enableVr (renderer) {\r\n    renderer.xr.enabled = true\r\n  }\r\n\r\n  function disableVr () {\r\n    renderer.xr.enabled = false\r\n    viewer.cameraObjectOverride = undefined\r\n    viewer.scene.remove(user)\r\n    vrButtonContainer.hidden = true\r\n    unsubWatchSetting()\r\n    unsubWatchModals()\r\n  }\r\n\r\n  function createVrButtonContainer (renderer) {\r\n    const container = document.createElement('div')\r\n    const vrButton = VRButton.createButton(renderer)\r\n    styleContainer(container)\r\n\r\n    const closeButton = createCloseButton(container)\r\n\r\n    container.appendChild(vrButton)\r\n    container.appendChild(closeButton)\r\n    document.body.appendChild(container)\r\n\r\n    return container\r\n  }\r\n\r\n  function styleContainer (container: HTMLElement) {\r\n    typedAssign(container.style, {\r\n      position: 'absolute',\r\n      bottom: '80px',\r\n      left: '0',\r\n      right: '0',\r\n      display: 'flex',\r\n      justifyContent: 'center',\r\n      zIndex: '8',\r\n      gap: '8px',\r\n    })\r\n  }\r\n\r\n  function createCloseButton (container: HTMLElement) {\r\n    const closeButton = document.createElement('button')\r\n    closeButton.textContent = 'X'\r\n    typedAssign(closeButton.style, {\r\n      padding: '0 12px',\r\n      color: 'white',\r\n      fontSize: '14px',\r\n      lineHeight: '20px',\r\n      cursor: 'pointer',\r\n      background: 'transparent',\r\n      border: '1px solid rgb(255, 255, 255)',\r\n      borderRadius: '4px',\r\n      opacity: '0.7',\r\n    })\r\n\r\n    closeButton.addEventListener('click', () => {\r\n      container.hidden = true\r\n      options.vrSupport = false\r\n    })\r\n\r\n    return closeButton\r\n  }\r\n\r\n\r\n  async function checkVRSupport () {\r\n    try {\r\n      const supported = await navigator.xr?.isSessionSupported('immersive-vr')\r\n      return supported && !!XRSession.prototype.updateRenderState\r\n    } catch (err) {\r\n      console.error('Error checking if VR is supported', err)\r\n      return false\r\n    }\r\n  }\r\n\r\n  // hack for vr camera\r\n  const user = new THREE.Group()\r\n  user.add(viewer.camera)\r\n  viewer.scene.add(user)\r\n  const controllerModelFactory = new XRControllerModelFactory(new GLTFLoader())\r\n  const controller1 = renderer.xr.getControllerGrip(0)\r\n  const controller2 = renderer.xr.getControllerGrip(1)\r\n\r\n  // todo the logic written here can be hard to understand as it was designed to work in gamepad api emulation mode, will be refactored once there is a contro-max rewrite is done\r\n  const virtualGamepadIndex = 4\r\n  let connectedVirtualGamepad\r\n  //@ts-expect-error\r\n  const manageXrInputSource = ({ gamepad, handedness = defaultHandedness }, defaultHandedness, removeAction = false) => {\r\n    if (handedness === 'right') {\r\n      const event: any = new Event(removeAction ? 'gamepaddisconnected' : 'gamepadconnected') // todo need to expose and use external gamepads api in contro-max instead\r\n      event.gamepad = removeAction ? connectedVirtualGamepad : { ...gamepad, mapping: 'standard', index: virtualGamepadIndex }\r\n      connectedVirtualGamepad = event.gamepad\r\n      window.dispatchEvent(event)\r\n    }\r\n  }\r\n  let hand1: any = controllerModelFactory.createControllerModel(controller1)\r\n  controller1.addEventListener('connected', (event) => {\r\n    hand1.xrInputSource = event.data\r\n    manageXrInputSource(event.data, 'left')\r\n    user.add(controller1)\r\n  })\r\n  controller1.add(hand1)\r\n  let hand2: any = controllerModelFactory.createControllerModel(controller2)\r\n  controller2.addEventListener('connected', (event) => {\r\n    hand2.xrInputSource = event.data\r\n    manageXrInputSource(event.data, 'right')\r\n    user.add(controller2)\r\n  })\r\n  controller2.add(hand2)\r\n\r\n  controller1.addEventListener('disconnected', () => {\r\n    // don't handle removal of gamepads for now as is don't affect contro-max\r\n    manageXrInputSource(hand1.xrInputSource, 'left', true)\r\n    hand1.xrInputSource = undefined\r\n  })\r\n  controller2.addEventListener('disconnected', () => {\r\n    manageXrInputSource(hand1.xrInputSource, 'right', true)\r\n    hand2.xrInputSource = undefined\r\n  })\r\n\r\n  const originalGetGamepads = navigator.getGamepads.bind(navigator)\r\n  // is it okay to patch this?\r\n  //@ts-expect-error\r\n  navigator.getGamepads = () => {\r\n    const originalGamepads = originalGetGamepads()\r\n    if (!hand1.xrInputSource || !hand2.xrInputSource) return originalGamepads\r\n    return [\r\n      ...originalGamepads,\r\n      {\r\n        axes: remapAxes(hand2.xrInputSource.gamepad.axes, hand1.xrInputSource.gamepad.axes),\r\n        buttons: remapButtons(hand2.xrInputSource.gamepad.buttons, hand1.xrInputSource.gamepad.buttons),\r\n        connected: true,\r\n        mapping: 'standard',\r\n        id: '',\r\n        index: virtualGamepadIndex\r\n      }\r\n    ]\r\n  }\r\n\r\n  let rotSnapReset = true\r\n  let yawOffset = 0\r\n  renderer.setAnimationLoop(() => {\r\n    if (!renderer.xr.isPresenting) return\r\n    if (hand1.xrInputSource && hand2.xrInputSource) {\r\n      hand1.xAxis = hand1.xrInputSource.gamepad.axes[2]\r\n      hand1.yAxis = hand1.xrInputSource.gamepad.axes[3]\r\n      hand2.xAxis = hand2.xrInputSource.gamepad.axes[2]\r\n      hand2.yAxis = hand2.xrInputSource.gamepad.axes[3]\r\n      // hand2 should be right\r\n      if (hand1.xrInputSource.handedness === 'right') {\r\n        const tmp = hand2\r\n        hand2 = hand1\r\n        hand1 = tmp\r\n      }\r\n    }\r\n\r\n    if (rotSnapReset) {\r\n      if (Math.abs(hand1.xAxis) > 0.8) {\r\n        yawOffset -= Math.PI / 4 * Math.sign(hand1.xAxis)\r\n        rotSnapReset = false\r\n      }\r\n    } else if (Math.abs(hand1.xAxis) < 0.1) {\r\n      rotSnapReset = true\r\n    }\r\n\r\n    // viewer.setFirstPersonCamera(null, yawOffset, 0)\r\n    viewer.setFirstPersonCamera(null, bot.entity.yaw, bot.entity.pitch)\r\n\r\n    // todo restore this logic (need to preserve ability to move camera)\r\n    // const xrCamera = renderer.xr.getCamera()\r\n    // const d = xrCamera.getWorldDirection(new THREE.Vector3())\r\n    // bot.entity.yaw = Math.atan2(-d.x, -d.z)\r\n    // bot.entity.pitch = Math.asin(d.y)\r\n\r\n    // todo ?\r\n    // bot.physics.stepHeight = 1\r\n\r\n    viewer.render()\r\n  })\r\n  renderer.xr.addEventListener('sessionstart', () => {\r\n    viewer.cameraObjectOverride = user\r\n    // close all modals to be in game\r\n    for (const _modal of activeModalStack) {\r\n      hideModal(undefined, {}, { force: true })\r\n    }\r\n  })\r\n  renderer.xr.addEventListener('sessionend', () => {\r\n    viewer.cameraObjectOverride = undefined\r\n  })\r\n\r\n  watchUnloadForCleanup(disableVr)\r\n}\r\n\r\nconst xrStandardRightButtonsMap = [\r\n  [0 /* trigger */, 'Right Trigger'],\r\n  [1 /* squeeze */, 'Right Bumper'],\r\n  // need to think of a way to support touchpad input\r\n  [3 /* Thumbstick Press */, 'Right Stick'],\r\n  [4 /* A */, 'A'],\r\n  [5 /* B */, 'B'],\r\n]\r\nconst xrStandardLeftButtonsMap = [\r\n  [0 /* trigger */, 'Left Trigger'],\r\n  [1 /* squeeze */, 'Left Bumper'],\r\n  // need to think of a way to support touchpad input\r\n  [3 /* Thumbstick Press */, 'Left Stick'],\r\n  [4 /* A */, 'X'],\r\n  [5 /* B */, 'Y'],\r\n]\r\nconst remapButtons = (rightButtons: any[], leftButtons: any[]) => {\r\n  // return remapped buttons\r\n  const remapped = [] as string[]\r\n  const remapWithMap = (buttons, map) => {\r\n    for (const [index, standardName] of map) {\r\n      const standardMappingIndex = standardButtonsMap.findIndex((aliases) => aliases.find(alias => standardName === alias))\r\n      remapped[standardMappingIndex] = buttons[index]\r\n    }\r\n  }\r\n  remapWithMap(rightButtons, xrStandardRightButtonsMap)\r\n  remapWithMap(leftButtons, xrStandardLeftButtonsMap)\r\n  return remapped\r\n}\r\nconst remapAxes = (axesRight, axesLeft) => {\r\n  // 0, 1 are reserved for touch\r\n  return [\r\n    axesLeft[2],\r\n    axesLeft[3],\r\n    axesRight[2],\r\n    axesRight[3]\r\n  ]\r\n}\r\n\r\nfunction typedAssign<T extends Record<string, any>> (target: T, source: Partial<T>) {\r\n  Object.assign(target, source)\r\n}\r\n","// not all options are watched here\r\n\r\nimport { subscribeKey } from 'valtio/utils'\r\nimport { WorldRendererThree } from 'renderer/viewer/lib/worldrendererThree'\r\nimport { isMobile } from 'renderer/viewer/lib/simpleUtils'\r\nimport { options, watchValue } from './optionsStorage'\r\nimport { reloadChunks } from './utils'\r\nimport { miscUiState } from './globalState'\r\nimport { toggleStatsVisibility } from './topRightStats'\r\n\r\nsubscribeKey(options, 'renderDistance', reloadChunks)\r\nsubscribeKey(options, 'multiplayerRenderDistance', reloadChunks)\r\n\r\nwatchValue(options, o => {\r\n  document.documentElement.style.setProperty('--chatScale', `${o.chatScale / 100}`)\r\n  document.documentElement.style.setProperty('--chatWidth', `${o.chatWidth}px`)\r\n  document.documentElement.style.setProperty('--chatHeight', `${o.chatHeight}px`)\r\n  // gui scale is set in scaleInterface.ts\r\n})\r\n\r\n/** happens once */\r\nexport const watchOptionsAfterViewerInit = () => {\r\n  const updateTouch = (o) => {\r\n    miscUiState.currentTouch = o.alwaysShowMobileControls || isMobile()\r\n  }\r\n\r\n  watchValue(options, updateTouch)\r\n  window.matchMedia('(pointer: coarse)').addEventListener('change', (e) => {\r\n    updateTouch(options)\r\n  })\r\n\r\n  watchValue(options, o => {\r\n    if (!viewer) return\r\n    viewer.world.config.showChunkBorders = o.showChunkBorders\r\n    viewer.entities.setDebugMode(o.showChunkBorders ? 'basic' : 'none')\r\n  })\r\n\r\n  watchValue(options, o => {\r\n    if (!viewer) return\r\n    // todo ideally there shouldnt be this setting and we don't need to send all same chunks to all workers\r\n    viewer.world.config.numWorkers = o.lowMemoryMode ? 1 : o.numWorkers\r\n  })\r\n\r\n  watchValue(options, o => {\r\n    viewer.entities.setRendering(o.renderEntities)\r\n  })\r\n\r\n  if (options.renderDebug === 'none') {\r\n    toggleStatsVisibility(false)\r\n  }\r\n  subscribeKey(options, 'renderDebug', () => {\r\n    if (options.renderDebug === 'none') {\r\n      toggleStatsVisibility(false)\r\n    } else {\r\n      toggleStatsVisibility(true)\r\n    }\r\n  })\r\n  watchValue(options, o => {\r\n    viewer.world.displayStats = o.renderDebug === 'advanced'\r\n  })\r\n  watchValue(options, (o, isChanged) => {\r\n    viewer.world.mesherConfig.clipWorldBelowY = o.clipWorldBelowY\r\n    viewer.world.mesherConfig.disableSignsMapsSupport = o.disableSignsMapsSupport\r\n    if (isChanged) {\r\n      (viewer.world as WorldRendererThree).rerenderAllChunks()\r\n    }\r\n  })\r\n\r\n  viewer.world.mesherConfig.smoothLighting = options.smoothLighting\r\n  subscribeKey(options, 'smoothLighting', () => {\r\n    viewer.world.mesherConfig.smoothLighting = options.smoothLighting;\r\n    (viewer.world as WorldRendererThree).rerenderAllChunks()\r\n  })\r\n  subscribeKey(options, 'newVersionsLighting', () => {\r\n    viewer.world.mesherConfig.enableLighting = !bot.supportFeature('blockStateId') || options.newVersionsLighting;\r\n    (viewer.world as WorldRendererThree).rerenderAllChunks()\r\n  })\r\n  customEvents.on('mineflayerBotCreated', () => {\r\n    viewer.world.mesherConfig.enableLighting = !bot.supportFeature('blockStateId') || options.newVersionsLighting\r\n  })\r\n\r\n  watchValue(options, o => {\r\n    if (!(viewer.world instanceof WorldRendererThree)) return\r\n    viewer.world.starField.enabled = o.starfieldRendering\r\n  })\r\n\r\n  watchValue(options, o => {\r\n    viewer.world.neighborChunkUpdates = o.neighborChunkUpdates\r\n  })\r\n}\r\n\r\nlet viewWatched = false\r\nexport const watchOptionsAfterWorldViewInit = () => {\r\n  if (viewWatched) return\r\n  viewWatched = true\r\n  watchValue(options, o => {\r\n    if (!worldView) return\r\n    worldView.keepChunksDistance = o.keepChunksDistance\r\n    viewer.world.config.renderEars = o.renderEars\r\n    viewer.world.config.showHand = o.showHand\r\n    viewer.world.config.viewBobbing = o.viewBobbing\r\n  })\r\n}\r\n","import * as THREE from 'three'\r\nimport { watchUnloadForCleanup } from './gameUnload'\r\n\r\nlet inWater = false\r\n\r\ncustomEvents.on('gameLoaded', () => {\r\n  const cleanup = () => {\r\n    viewer.scene.fog = null\r\n  }\r\n  watchUnloadForCleanup(cleanup)\r\n\r\n  const updateInWater = () => {\r\n    const waterBr = Object.keys(bot.entity.effects).find((effect: any) => loadedData.effects[effect.id].name === 'water_breathing')\r\n    if (inWater) {\r\n      viewer.scene.fog = new THREE.Fog(0x00_00_ff, 0.1, waterBr ? 100 : 20) // Set the fog color to blue if the bot is in water.\r\n    } else {\r\n      cleanup()\r\n    }\r\n    updateBackground()\r\n  }\r\n  bot.on('physicsTick', () => {\r\n    // todo\r\n    const _inWater = bot.world.getBlock(bot.entity.position.offset(0, 1, 0))?.name === 'water'\r\n    if (_inWater !== inWater) {\r\n      inWater = _inWater\r\n      updateInWater()\r\n    }\r\n  })\r\n})\r\n\r\nlet sceneBg = { r: 0, g: 0, b: 0 }\r\nexport const updateBackground = (newSceneBg = sceneBg) => {\r\n  sceneBg = newSceneBg\r\n  const color: [number, number, number] = inWater ? [0, 0, 1] : [sceneBg.r, sceneBg.g, sceneBg.b]\r\n  viewer.world.changeBackgroundColor(color)\r\n}\r\n"],"names":["pako","decompressFromBase64","input","console","binaryString","atob","len","bytes","Uint8Array","i","decompressedData","importLargeData","mod","dynamicMcDataFiles","WorldLoader","ChunkLoader","makeError","str","reportError","makeErrorCritical","Error","getSyncWorld","version","World","Chunk","world","methods","getAllMethods","method","oldMethod","args","arg","undefined","Math","obj","Set","currentObj","name","Object","delayedIterator","arr","delay","exec","chunkSize","Promise","resolve","setTimeout","module","require","GUI","DebugGui","id","target","params","paramsMeta","param","value","saved","localStorage","values","JSON","e","deleteKey","meta","min","max","step","Array","AnimationController","createAnimation","onCancelled","callback","callComplete","tween","callbacks","cb","EventEmitter","Vec3","proxy","BasePlayerState","state","CameraBobbing","BOB_FREQUENCY","BOB_BASE_AMPLITUDE","VERTICAL_MULTIPLIER","ROTATION_MULTIPLIER_Z","ROTATION_MULTIPLIER_X","GameTimer","distance","isMoving","targetBob","ticks","deltaTime","bobDelta","walkDist","bob","totalDist","xOffset","yOffset","zRot","xRot","tickRate","performance","currentMs","deltaSinceLastTick","tickDelta","wholeTicks","buildCleanupDecorator","cleanupMethod","_target","propertyKey","key","originalMethod","Reflect","arguments","nbt","TWEEN","THREE","PlayerObject","loadEarsToCanvasFromSkin","inferModelType","loadCapeToCanvas","degreesToRadians","NameTagObject","flat","fromFormattedString","mojangson","snakeCase","Entity","getMesh","WalkingGeneralSwing","disposeObject","armorModel","armorTextures","getBlockMeshFromModel","loadSkinImage","getLookupUrl","stevePngUrl","steveTexture","loadTexture","TWEEN_DURATION","convert2sComplementToHex","complement","toRgba","color","parseInt","hex","toQuaternion","quaternion","defaultValue","poseToEuler","pose","getUsernameTexture","username","nameTagBackgroundColor","nameTagTextOpacity","fontFamily","canvas","document","ctx","fontSize","padding","lines","String","textWidth","line","width","addNametag","entity","options","mesh","c","tex","nameTag","geometry","material","spriteMat","nametags","isFirstUpperCase","getEntityMesh","overrides","entityName","err","cube","nametagCount","Entities","byName","viewer1","mode","boxHelper","rendering","ent","dt","botPos","VISIBLE_DISTANCE","entityId","playerObject","dx","dy","dz","distanceSquared","chunkX","chunkZ","chunkKey","channel","uuid","skinUrl","capeUrl","renderEars","playerCustomSkinImage","skinTexture","skinCanvas","image","earsCanvas","earsTexture","error","capeCanvas","capeImage","capeTexture","entityPlayerId","animation","jsonLike","parsed","text","component","item","specificProps","previousModel","textureUv","SCALE","outerGroup","u","v","size","su","sv","texture","itemsTexture","sizeY","sizeX","itemsTextureFlipped","materialFlipped","visible","isPlayerModel","group","m","object","clock","delta","wrapper","scale","addArmorModel","getGeneralEntitiesMetadata","isInvisible","child","textDisplayMeta","getSpecificEntityMetadata","displayTextRaw","displayText","nameTagFixed","rawOpacity","armorStandMeta","isSmall","hasArms","hasBasePlate","isMarker","itemFrameMeta","existingMapNumber","rotation","mapNumber","x","itemMesh","headRotationDiff","da","data","itemFrameMeshes","entityMesh","imageData","parameters","mapMesh","hand","parentName","itemObject","damageAmount","clonedMaterial","originalColor","entityData","loadedData","Proxy","p","receiver","index","slotType","layer","overlay","removeArmorModel","itemParts","texturePath","isPlayerHead","itemNbt","textureData","decodedData","Buffer","armorMaterial","armorTextureName","viewer","meshName","r","g","b","skeletonHelper","OBJLoader","huskPng","arrowTexture","spectralArrowTexture","tippedArrowTexture","entities","externalModels","externalTexturesJson","elemFaces","dot","a","addCube","attr","boneId","bone","sameTextureForAllFaces","texWidth","texHeight","mirror","errors","cubeRotation","dir","corners","u0","v0","u1","v1","ndx","eastOrWest","faceUvs","pos","posX","posY","posZ","inflate","vecPos","faceIndex","tempFaceUvs","worldRenderer","jsonModel","debugFlags","textureWidth","textureHeight","textureOffset","useBlockTexture","blocksTexture","blockName","textureInfo","bones","geoData","jsonBone","rootBones","skeleton","loadedTexture","actualWidth","actualHeight","rendererSpecialHandled","temporaryMappings","getEntityMapping","type","mapping","getEntity","scaleEntity","offsetEntity","EntityMesh","originalType","mappedValue","objLoader","texturePathMap","tempTextureMap","offset","PlayerAnimation","player","t","updateT","reset","tHand","basicArmRotationZ","basicCapeRotationX","default","chainmailLayer1","chainmailLayer2","diamondLayer1","diamondLayer2","goldenLayer1","goldenLayer2","ironLayer1","ironLayer2","leatherLayer1","leatherLayer1Overlay","leatherLayer2","leatherLayer2Overlay","netheriteLayer1","netheriteLayer2","turtleLayer1","allay","axolotl","blaze","camel","cat","chicken","cod","creeper","dolphin","ender_dragon","enderman","endermite","fox","frog","ghast","goat","guardian","horse","llama","minecart","parrot","piglin","pillager","rabbit","sheep","arrow","shulker","sniffer","spider","tadpole","turtle","vex","villager","warden","witch","wolf","zombie_villager","boat","ItemRenderer","Identifier","ItemStack","NbtString","BlockDefinition","BlockModel","TextureAtlas","ItemModel","AssetsParser","getLoadedImage","getLoadedBlockstatesStore","getLoadedModelsStore","makeTextureAtlas","ref","getItemDefinition","versionToNumber","activeGuiAtlas","getNonFullBlocksModels","itemsDefinitions","blockModelsResolved","itemsModelsResolved","fullBlocksWithNonStandardDisplay","handledItemsWithDefinitions","assetsParser","standardGuiDisplay","arrEqual","addModelIfNotFullblock","model","isFullBlock","definition","resolvedModel","hasStandardDisplay","notSideLight","blockstate","RENDER_SIZE","generateItemsGui","models","isItems","img","canvasTemp","atlasParser","textureAtlas","PREVIEW_ID","PREVIEW_DEFINITION","modelData","currentModelName","resources","Map","isSpecial","gl","resetGLContext","includeOnly","images","renderer","missingTextures","modelName","patchMissingTextures","element","faceName","face","url","generateAtlas","atlas","generateGuiAtlas","blockImages","itemImages","getMyHand","userName","newMap","box","slim","setSkinUVs","setUVs","height","depth","toFaceVertices","x1","y1","x2","y2","top","bottom","left","front","right","back","uvAttr","uvRight","uvLeft","uvTop","uvBottom","uvFront","uvBack","newUVData","uvArray","uv","Float32Array","tweenJs","worldBlockProvider","getThreeBlockModelGroup","SmoothSwitcher","watchProperty","rotationPositionData","HoldingBlock","playerState","config","offHand","_","isOffHand","newHand","oldHand","originalCamera","ambientLight","directionalLight","now","scene","viewerSize","minSize","offHandDisplay","forceState","property","newState","targetY","cancelled","block","camera","aspect","position","scaleData","side","handItem","blockInner","result","isBlock","rotationDeg","switchRequest","playAppearAnimation","blockOuterGroup","HandSwingAnimator","HandIdleAnimator","itemData","blockData","handMesh","Infinity","time","speed","amplitude","noTransition","stateTransform","stage","swingProgress","sqrtProgress","sinProgress","sinSqrtProgress","zOffset","blockProvider","worldRenderModel","buildRotationMatrix","axis","degree","radians","cos","sin","axis0","axis1","axis2","matrix","vecadd3","vecsub3","matmul3","vector","matmulmat3","te","a11","a12","a13","a21","a22","a23","a31","a32","a33","b11","b12","b13","b21","b22","b23","b31","b32","b33","defaultMesherConfig","getBlockAssetsCacheKey","stateId","modelNameOverride","tintToGl","tint","renderElement","doAO","globalMatrix","globalShift","biome","neighbors","cursor","eFace","mask1","mask2","minx","miny","minz","maxx","maxy","maxz","grassTint","uvcs","uvsn","localMatrix","localShift","aos","baseLight","vertex","baseu","basev","light","cornerLightResult","side1Block","side2Block","cornerBlock","ao","renderBlockThreeAttr","mcData","variants","sx","sy","sz","modelVars","renderBlockThree","globalThis","setBlockPosition","INVISIBLE_BLOCKS","getBufferFromStream","stream","reject","buffer","buf","openURL","newTab","window","isMobile","navigator","chunkPos","z","sectionPos","y","DEFAULT_SPEEDS","getState","setState","speeds","maxDuration","currentState","targetValue","currentValue","diff","duration","stateName","onEnd","easing","cleanTextures","rightOffset","stats","lastY","addNewStat","pane","updateStatText","customEvents","chunksLoaded","chunksTotal","textureCache","imagesPromises","onLoad","cached","promise","clearTextureCache","loadScript","scriptSrc","existingScript","scriptElement","subscribeKey","asyncGetter","valtioProxy","readySetter","cleanup","lastRes","request","req","res","loadSkinToCanvas","stevePng","loadImageFromUrl","imageUrl","Image","generateSpiralMatrix","WorldRendererThree","defaultWorldRendererConfig","Viewer","worldConfig","userVersion","texturesVersion","chunk","isLightUpdate","set","sectionX","sectionZ","cursorBlockRel","helper","yaw","pitch","cam","path","volume","sound","audioLoader","start","Date","worldEmitter","currentLoadChunkBatch","fn","blockEntities","d","timeOfDay","skyLight","statsEnd","statsStart","activeModalStack","ViewerWrapper","startRendering","pixelRatio","setInterval","clearInterval","renderInterval","beforeRenderFrame","ViewRect","WorldDataEmitter","viewDistance","click","ori","val","bot","emitEntity","oldBlock","newBlock","posKey","Number","evt","listener","botX","botZ","positions","sliceSize","promises","clonedLoadedChunks","loadedChunk","column","coords","force","lastX","lastZ","newViewToUnload","chunksToUnload","mcDataRaw","blocksAtlases","blocksAtlasLatest","blocksAtlasLegacy","itemsAtlases","itemsAtlasLatest","itemsAtlasLegacy","AtlasParser","getLoadedItemDefinitionsStore","LineMaterial","christmasPack","ItemsRenderer","itemDefinitionsJson","toMajorVersion","n","worldCleanup","WorldRendererCommon","loadedChunks","numWorkers","workerName","src","__dirname","worker","process","workerCode","blob","Blob","Worker","handleMessage","highest","currHighest","chunkCoords","loadingKeys","cacheKey","info","allFinished","isAnimationPlaying","isLeftHand","message","posAbsolute","allMcData","resourcePackUpdate","prioritizeBlockTextures","blocksAssetsParser","itemsAssetsParser","blockTexturesChanges","date","customBlockTextures","customItemTextures","blocksAtlas","blocksCanvas","textureName","itemsAtlas","itemsCanvas","blockstatesModels","dataUrl","customBlockModels","loc","startX","startZ","endX","endZ","needAoRecalculation","blockPosKey","updateAction","cantUseChangeWorker","hash","useChangeWorker","workerIndex","updateHandler","PrismarineChatLoader","LineSegmentsGeometry","Wireframe","renderSign","acc","StarField","isLeft","holdingBlock","newTime","nightTime","morningStart","displayStars","chunkDistance","section","cameraPos","staticChunkMesh","isWall","isHanging","signBlockEntity","sign","headBlockEntity","head","blockEntity","backSide","textures","texturekey","PrismarineChat","lineHeight","scaleFactor","thickness","wallSpacing","heightOffset","textPosition","oldSections","worldView","includeY","currentX","currentY","currentZ","o","xRaw","yRaw","zRaw","setKey","children","blockPos","shapePositions","wireframe","radius","count","factor","saturation","genStar","colors","sizes","increment","StarfieldMaterial","ver","versionToMajor","versionsMapToMajor","versionsMap","majorVersions","major","render","parseSafe","task","ctxHook","signboardY","heightScalar","_ctx","getCtx","texts","defaultColor","lineNum","patchExtra","extra","rendered","toRenderCanvas","plainText","MAX_LENGTH","renderText","node","stop","renderedWidth","fillStyle","fontStyle","strikeStyle","underlineStyle","hostname","response","fetchServerStatus","isServerValid","ip","isInLocalNetwork","VALID_IP_OR_DOMAIN","signal","versionOverride","fetch","versionClean","disabledSettings","qsOptions","miscUiState","setLoadingScreenStatus","setStorageDataOnAppConfigLoad","loadAppConfig","appConfig","isBundledConfigUsed","qsParams","URLSearchParams","initialAppConfig","appQueryParams","qsParam","appQueryParamsArray","updateQsParam","URL","hasQueryParam","getRawQueryParams","hideModal","showModal","appStatusState","resetAppStatusState","ourLastStatus","status","isError","hideDots","fromFlyingSquid","minecraftJsonMessage","isCypress","reportWarningOnce","audioContext","sounds","activeSounds","loadingSounds","convertedSounds","loadSound","contents","arrayBuffer","audioBuffer","loadOrPlaySound","soundVolume","loadTimeout","soundBuffer","playSound","gainNode","source","s","stopAllSounds","changeVolumeOfCurrentlyPlayingSounds","newVolume","normalizedVolume","volumeMultiplier","displayClientChat","parseFormattedMessagePacket","join","promisify","fs","sanitizeFilename","oneOf","browserfs","resetOptions","fsState","loadSave","installResourcepackPack","updateTexturePackInstalledState","VALID_REPLAY_EXTENSIONS","openFile","createFullScreenProgressReporter","showNotification","resetAppStorage","GoogleDriveFileSystem","defaultMountablePoints","fallbackMountablePoints","e2","forceCachedDataPaths","forceRedirectPaths","toRemap","from","readonly","fd","bytesRead","removeFileRecursiveSync","file","curPath","mkdirRecursive","parts","current","part","uniqueFileNameFromWorldName","title","savePath","resultPath","free","mountExportFolder","handle","showDirectoryPicker","DOMException","googleDriveFileSystem","googleDriveGetFileIdFromPath","mountGoogleDriveFolder","rootId","removeFileRecursiveAsync","files","SUPPORT_WRITE","openWorldDirectory","dragndropHandle","_directoryHandle","directoryHandle","requestResult","writeAccess","doContinue","confirm","tryToDetectResourcePack","askInstall","alert","possiblyCleanHandle","readdirSafe","collectFilesToCopy","basePath","safe","countFiles","relPath","resolvedPath","copyFilesAsyncWithProgress","pathSrc","pathDest","throwRootNotExist","addMsg","stat","existsViaStats","filesCount","copied","copyFilesAsync","fileExistsAsyncOptimized","fileCopied","curPathSrc","curPathDest","openWorldFromHttpDir","fileDescriptorUrls","baseUrlParam","baseUrl","controller","AbortController","openWorldZipInner","File","dirs","availableWorlds","openWorldZip","resetLocalStorage","openFilePicker","specificCase","picker","ext","resetStateAfterDisconnect","JSZip","readLevelDat","closeWan","openToWanAndCopyJoinLink","saveServer","notImplemented","addFolderToZip","folderPath","zip","relativePath","entries","entry","entryPath","zipEntryPath","subZip","fileData","exportWorld","zipName","zipContent","downloadLink","dest","levelDat","exportLoadedWorld","worldFolder","localServer","writeText","commands","playerPos","formatted","getBuiltinCommandsList","command","tryHandleBuiltinCommand","userCommand","contro","isGameActive","hideNotification","notificationProxy","pointerLock","updateMotion","lastMouseMove","onCameraMove","mouseSensX","mouseSensY","moveCameraRawHandler","maxPitch","minPitch","onControInit","stick","pointerLockChangeCallback","global","formatMessage","msglist","readMsg","msg","styles","tText","splitted","j","msgWith","ex","newMsg","blockToItemRemaps","getItemFromBlock","MinecraftData","PrismarineBlock","PrismarineItem","pathfinder","supportedVersions","downloadSoundsIfNeeded","getVersionAutoSelect","autoVersionSelect","loadMinecraftData","importBlockstatesModels","downloadAllMinecraftData","loadFonts","FONT_FAMILY","downloadOtherGameData","subscribe","ControMax","stringStartsWith","gameAdditionalState","hideCurrentModal","hideAllModals","goFullscreen","isInRealGameSession","reloadChunks","openPlayerInventory","chatInputValueGlobal","customCommandsConfig","showOptionsModal","widgets","gamepadUiCursorState","moveGamepadCursorByPx","completeResourcepackPackInstall","copyServerResourcePackToRegular","resourcePackState","lastConnectOptions","createNotificationProgressReporter","appStorage","switchGameMode","customKeymaps","controlOptions","updateBinds","updateDoPreventDefault","setSprinting","soleVector","gamepadIndex","deadzone","emitMousemove","direction","moveSpeed","coordToAction","coord","foundAction","mapV","action","lastCommandTrigger","secondActionActivationTimeout","secondActionCommands","toggleFly","xAbs","yAbs","MouseEvent","lastClickedEl","lastClickedElTimeout","inModalCommand","pressed","el","clearTimeout","cameraRotationControls","movement","directionMap","setSneaking","onTriggerOrReleased","alwaysPressedHandledCommand","lockUrl","newQs","save","qs","server","botVersion","cycleHotbarSlot","newHotbarSlot","customCommandsHandler","willContinue","secondActionCommand","commandToTrigger","slot","selectItem","isActive","f3Keybinds","widgetNames","widget","nextGameMode","playerPing","proxyPing","hardcodedPressedKeys","keybind","makeInterval","interval","intervalId","isFlying","endFlyLoop","currentFlyVector","flyingPressedKeys","startFlyLoop","originalSetControlState","patchedSetControlState","actionPerFlyVector","changeVec","toAddVec","startFlying","sendAbilities","endFlying","standardAirborneAcceleration","allowFlying","onBotCreate","wasSpectatorFlying","flags","gamemodeCheck","itemId","Item","addEventListener","hideAll","Event","link","actions","newValue","NO_STAGES_ACTION_END","createProgressReporter","implementation","stages","currentMessage","ended","end","updateStatus","activeStages","currentStage","num","isFinite","reporter","subStageTitle","progress","tempStage","fullScreenReporters","endMessage","createConsoleLogProgressReporter","createWrappedProgressReporter","LocalServer","createMCServer","startLocalServer","serverOptions","passOptions","unsupportedLocalServerFeatures","registerBlockModelsChannel","CHANNEL_NAME","packetStructure","worldName","chunkModels","registeredJeiChannel","categoryTitle","items","debug","states","customCommunication","processData","CustomChannelClient","isServer","newProperty","oldProperty","reason","packets","tryFindOptionConfig","setting","getBase","currentIndex","nextIndex","code","Function","customPackets","hideErrors","assertDefined","updateBackground","timeUpdated","dayTotal","evening","night","morningEnd","timeProgress","dayColorRainy","dayColor","int","progressNorm","progressMax","colorInt","eruda","enable","disable","enabled","newPos","xRel","zRel","yRel","sessionStorage","oldEmit","packetName","isFromClient","fullOrListener","displayName","pattern","RegExp","packetNameListener","packetListener","attach","detach","returnobj","keysToKeep","prettyBytes","getResourcePackNames","getFixedFilesize","inner","replayFileUrl","contentLength","filename","downloadedBytes","Response","ReadableStream","reader","done","decoder","TextDecoder","mapUrlDir","mapUrlDirGuess","mapUrlDirBaseUrl","mapUrl","texturepack","downloadThing","contentType","contentLengthStr","RegionFile","versions","parseNbt","simplifyNbt","event","filehandle","handleDroppedFile","tempPath","region","chunks","versionDetected","k","simplified","mapped","tracker","loader","autoJumpPlugin","watchValue","updateAutoJump","autoJump","playerPerAnimation","lastCall","tracking","WALKING_SPEED","SPRINTING_SPEED","isWalking","isSprinting","newAnimation","damage","entityStatus","loadedSkinEntityIds","playerRenderSkin","MAX_DISTANCE_SKIN_LOAD","packet","playerEntry","textureProperty","prop","entId","guessProblem","errorMessage","loadingTexts","watchUnloadForCleanup","autoSaveInterval","crypto","UUID","javaUUID","nameToMcOfflineUUID","savePlayers","autoSave","location","worlds","disconnect","toCleanup","func","latest_gui_title_minecraft","other_textures_1_19_gui_icons","other_textures_latest_gui_widgets","other_textures_latest_gui_bars","latest_gui_container_inventory","latest_gui_container_shulker_box","latest_gui_container_generic_54","latest_gui_container_furnace","latest_gui_container_crafting_table","latest_gui_container_dispenser","latest_gui_container_hopper","latest_gui_container_horse","latest_gui_container_villager2","latest_gui_container_enchanting_table","latest_gui_container_anvil","latest_gui_container_beacon","appReplacableResources","resourcesContentOriginal","getRenamedData","outputInteractionShapesJson","renamedBlocksInteraction","interactionShapes","shape","collisionShapesInit","versionFrom","renamedBlocks","collisionShapes","notHideableModalsWithoutForce","insertActiveModalStack","newModalStack","activeModalStacks","last","showModalInner","modal","cancel","elem","resolved","curModal","restorePrevious","lastModal","newModal","_data","onHide","openOptionsMenu","currentContextMenu","showContextmenu","clientX","clientY","foregroundCheck","GoogleOAuthProvider","useGoogleLogin","React","loadGoogleDriveApi","loadInMemorySave","CLIENT_ID","SCOPES","APP_ID","GoogleDriveProvider","isGoogleDriveAvailable","useGoogleLogIn","login","tokenResponse","googleProviderState","accessDenied","possiblyHandleStateVariable","stateParam","tokenClient","choice","getServerInfo","onGameLoad","renderSlot","initCollisionShapes","protocolMicrosoftAuth","microsoftAuthflow","initWithRenderer","watchOptionsAfterViewerInit","watchOptionsAfterWorldViewInit","downloadAndOpenFile","net","mineflayer","defaultsDeep","initializePacketsReplay","initVR","parseServerAddress","removePanorama","defaultServerOptions","dayCycle","onAppLoad","resourcepackReload","connectToPeer","registerServiceWorker","watchFov","ua","flyingSquidEvents","saveToBrowserMemory","signInMessageState","updateAuthenticatedAccountData","updateLoadedServerData","updateServerConnectionHistory","packetsPatcher","mainMenuState","getViewerVersionData","getWsProtocolStream","handleCustomChannel","getWebsocketStream","initMotionTracking","UserError","ping","mouse","startLocalReplayServer","localRelayServerPlugin","getItemModelName","renderWrapper","isFirefox","isIphone","idOrName","renderInfo","textureThree","w","h","hideCurrentScreens","loadSingleplayer","serverOverrides","flattenedServerOverrides","serverSettingsQsRaw","serverSettingsQs","connect","listenGlobalEvents","listeners","cleanupFunctions","registerListener","removeAllListeners","cleanupFunction","connectOptions","singleplayer","p2pMultiplayer","parsedServer","renderDistanceSingleplayer","multiplayerRenderDistance","https","parsedProxy","loggingInMsg","destroyAll","cleanFs","lastPacket","onPossibleErrorDisconnect","handleError","errorAbortController","clientDataStream","renderDistance","updateDataAfterJoin","localReplaySession","dataDownloaded","downloadMcData","finalVersion","newStatus","initialLoadingText","versionAutoSelect","newTokensCacheResult","cachedTokens","authData","requiresPass","password","prompt","client","_r","accounts","existingAccount","_supportFeature","feature","setupConnectHandlers","originalSetSocket","socket","p2pConnectTimeout","kickReason","kickReasonFormatted","kickReasonString","packetBeforePlay","__","___","fullBuffer","playStateSwitch","endReason","worldWasReady","spawnEarlier","center","botPosition","waitForChunks","wasFinished","perc","saveName","reconnectOptions","unsubscribe","activeTouch","ignoreElem","firstClickable","downloadAction","lastConnect","waitAppConfigLoad","openServerEditor","checkCanDisplay","peerId","peerOptions","viewerWsConnect","modals","initialLoader","showInventory","splitEvery","equals","PItem","Generic95","inGameError","currentScaling","getItemDescription","getItemNameRaw","loadedImagesCache","cleanLoadedImagesCache","lastWindow","allImagesLoadedState","jeiCustomCategories","checkIfLoaded","mapWindowType","inventoryStart","win","implementedWindow","implementedContainersGuiMap","openWindow","getItemName","Boolean","skipUpdate","_oldSlot","oldItem","newItem","currentSlot","craftingResultSlot","craftingSlots","resultingItem","getResultingRecipe","q","upJei","getImageSrc","getImage","loadPath","imageSrc","debugIsQuickbar","fullBlockModelSupport","itemModelName","originalItemName","isItem","itemTexture","lastMappedSots","itemToVisualKey","mapSlots","slots","isJei","newSlots","oldKey","slotCustomProps","itemCustomName","icon","rest","upInventoryItems","isInventory","invWindow","customSlots","onModalClose","search","itemsArray","matchedSlots","openItemsCanvas","_bot","inv","allRecipes","getAllItemRecipes","itemDescription","allItemUsages","getAllItemUsages","skipClosePacketSending","destroyFn","upWindowItems","oldOnInventoryEvent","containing","windowIndex","inventoryIndex","isRightClick","isLeftClick","slotItem","_index","isRightclick","freeSlot","isJeiEnabled","gridRows","inputSlotsItems","blockSlot","currentShape","slotX","otherY","slotsIngredients","shapelessResult","shapeResult","outer","recipeVariants","recipeVariant","metadata","ingredientToItem","recipeItem","itemName","recipes","results","recipe","resultId","resultCount","resultMetadata","resultItem","ingredients","ingredientsItems","description","foundRecipeIds","row","descriptionGenerators","moreGeneratedBlocks","lowerCaseFirstLetter","string","obtainedFrom","names","gzip","isMajorVersionGreater","PROPOSE_BACKUP","longArrayToNumber","longArray","high","low","levelDatContent","root","disablePrompts","warnings","dataRaw","isFlat","newVersion","lastSupportedVersion","firstSupportedVersion","lowerBound","upperBound","playerUuid","playerDatPath","playerDataOverride","playerDat","rootRemapFiles","rootRemapFile","CustomEvent","Duplex","Peer","Client","resolveTimeout","CustomDuplex","writeAction","encoding","peerInstance","overridePeerJsServer","getJoinLink","host","copyJoinLink","joinLink","doCopy","parseUrl","peer","connection","serverDuplex","endConnection","disconnected","fallbackServer","hasFallback","hadErrorReported","timeout","destroy","urlObj","clientDuplex","remark","markdown","ast","md","transformToMinecraftJSON","transformedChildren","getProxyDetails","proxyBaseUrl","isPageSecure","tokenCaches","setProgressText","setCacheResult","connectingServer","onMsaCodeCallback","connectingVersion","authEndpoint","sessionEndpoint","json","urlWithBase","authFlow","processText","processChunk","chunkStr","strings","restoredData","restoreData","tryRestorePublicKey","isNaN","parent","der","pemToArrayBuffer","originalName","exported","exportedBuffer","pem","pemHeader","pemFooter","pemContents","binaryDerString","binaryDer","base","defaultBase","CameraShake","startRoll","targetRoll","elapsed","rollQuat","camQuat","finalQuat","cameraShake","health","getItemMetadata","customText","customModel","componentMap","customTextComponent","customModelComponent","loreComponent","customName","customStickNbt","tags","cmd","wrapIntoQuotes","writeCmd","LIMIT_MSG","javaServerTester","mapDownloader","setImageConverter","png","pingServerVersion","validatePacket","lastPacketTime","packetMeta","port","preferredVersion","isWebSocket","clientAutoVersion","mergeOptions","fakeClient","latency","fullInfo","MAX_PACKET_SIZE","CHAT_MAX_PACKET_DEPTH","CHAT_VALIDATE_PACKETS","isFromServer","maxDepth","getObjectMaxDepth","currentDepth","PlayerStateManager","velocity","isOnGround","VELOCITY_THRESHOLD","SPRINTING_VELOCITY","OFF_GROUND_THRESHOLD","blockProperties","specificProperties","createMouse","destroyStage0","destroyStage1","destroyStage2","destroyStage3","destroyStage4","destroyStage5","destroyStage6","destroyStage7","destroyStage8","destroyStage9","createDisplayManager","bot1","destroyStagesImages","breakMaterial","updateLineMaterial","inCreative","updateDisplay","updateBreakAnimation","hideBreakAnimation","mergedShape","updateCursorBlock","domListeners","otherListeners","isOffhand","botInit","waitingPackets","clientWrite","sendAllPackets","viewerConnector","PACKETS_REPLAY_FILE_EXTENSION","WORLD_STATE_FILE_EXTENSION","CircularBuffer","PacketsLogger","packetsRecordingState","packetsReplayState","AUTO_CAPTURE_PACKETS_COUNT","circularBuffer","lastConnectVersion","downloadFile","worldState","timestamp","logger","l","upPacketsReplayPanel","getLastAutoCapturedPackets","downloadAutoCapturedPackets","textContents","curI","onPong","received","pingId","curId","BigInt","baseProtocol","hostClean","ws","WebSocket","lastElement","getRecipesProcessorProcessRecipes","blocks","itemsIdsMap","blocksIdsMap","keys","mapId","processRecipe","parseRecipeItem","maybeProccessShape","shapeRow","ingredient","restoreMinecraftData","allVersionData","restorer","JsonOptimizer","arrKey","ignoreChanges","ignoreRemoved","properties","diffs","diffing","removed","changed","removedProps","added","diffingObj","possiblyNewKeys","lastRootKeyId","lastItemKeyId","DEBUG","addDiff","newVal","prevVal","valueMapped","isItemObj","keyId","removedPropsLocal","isEqualStructured","keyMapped","sourceVal","diffVal","previousKey","toRemove","diffObj","changePossiblyArrDiff","targetKey","dataRestorer","structuredClone","keysById","propertiesById","dataByKeys","versionKey","toAdd","change","isOptimizedChange","propId","removePropsId","removePropId","removeProp","propsValueCount","valJson","defaults","count1","count2","newData","noData","val1","val2","useState","useSnapshot","noCase","getChangedSettings","Button","OptionSlider","Slider","getScreenRefreshRate","uninstallResourcePack","downloadPacketsReplay","showInputsModal","guiOptionsScheme","frameLimitValue","frameLimitMax","setFrameLimitMax","rate","Category","sp","resourcePackInstalled","usingServerResourcePack","enabledResourcepack","choices","UiToggleButton","touchInteractionType","touchMovementType","active","hasRecordedPackets","serversAutoVersionSelect","allVersions","getDisplayValue","fileName","addUiText","label","disabledUiParts","currentlyDisabled","newDisabledUiParts","option","optionConfig","omitObj","isDev","defaultOptions","getDefaultTouchControlsPositions","qsOptionsRaw","migrateOptions","isDeepEqual","keysA","keysB","saveOptions","watchedProps","unsubscribes","useOptionValue","valueCallback","replayLogger","isBufferData","processPacketData","processed","handleServerPacket","encodeURIComponent","createServer","parseReplayContents","SUPPORTED_FORMAT_VERSION","filesize","dispatchEvent","header","mainPacketsReplayer","FLATTEN_CLIENT_PACKETS","addPacketToReplayer","wasUpcoming","lastUpcoming","IGNORE_SERVER_PACKETS","ADDITIONAL_DELAY","ignoreClientPacketsWait","writePacket","playPackets","clientPackets","clientsPacketsWaiter","createPacketsWaiter","originalConsoleError","lastSentPacket","playServerPacket","clientPacket","gameMode","gamemodes","packetHandler","queuedPackets","isWaiting","unexpectedPacketsCount","handlePacket","isArrayEqual","panoramaCubeMap","shouldDisplayPanorama","panoramaFiles","unloadPanoramaCallbacks","addPanoramaCubeMap","initDemoWorld","panorGeo","panorMaterials","panoramaBox","unloadPanoramaCallback","abortController","Block","fullBlocks","Z","initPos","initX","initY","prevTwin","to","address","removeHttp","useEffect","Screen","INPUT_LABEL_WIDTH","InputWithLabel","SelectGameVersion","usePassesScaledDimensions","onBack","onConfirm","initialData","parseQs","onQsConnect","placeholders","allowAutoConnect","isSmallHeight","qsParamName","qsParamIp","qsParamVersion","qsParamProxy","qsParamUsername","qsParamLockConnect","qsParamAutoConnect","parsedQsIp","parsedInitialIp","serverName","setServerName","serverIp","setServerIp","serverPort","setServerPort","setVersionOverride","proxyOverride","setProxyOverride","usernameOverride","setUsernameOverride","lockConnect","smallWidth","initialAccount","accountIndex","setAccountIndex","freshAccount","noAccountSelected","authenticatedAccountOverride","ipFinal","commonUseOptions","fetchedServerInfoIp","setFetchedServerInfoIp","serverOnline","setServerOnline","onlinePlayersList","setOnlinePlayersList","checkServer","validateUsername","MINECRAFT_USERNAME_REGEX","validateServerIp","displayConnectButton","fallbackIfNotFound","account","ButtonWrapper","props","lastStatus","backAction","actionsSlot","showReconnect","onReconnect","loadingDotIndex","setLoadingDotIndex","statusRunner","timer","ms","load","useRef","AppStatus","DiveTransition","useDidUpdateEffect","useIsModalActive","LoadingChunks","MessageFormattedString","initialState","saveReconnectOptions","reconnectReload","lastState","replayActive","isOpen","usingState","maybeRecoverable","descriptionHint","loadingChunksData","loadingChunksDataPlayerChunk","divingElem","reconnect","displayAuthButton","displayVpnButton","authReconnectAction","oldAccounts","lastAutoCapturedPackets","PossiblyVpnBypassProxyButton","DisplayingIndicator","requestAnimationFrame","vpnBypassProxy","setVpnBypassProxy","useVpnBypassProxyAction","capabilities","SharedHudVars","armorValue","style","armorRef","armorElement","armors","armor","getEffectClass","effect","barEffectAdded","htmlElement","effectClass","barEffectEnded","isModalActive","useCallback","insideIcon","insideHalfIcon","singlePageInsideIcon","titleIcon","Book","textPages","editable","onSign","onEdit","onClose","author","pages","setPages","currentPage","setCurrentPage","isSinglePage","setIsSinglePage","insideImage","setInsideImage","animateInsideIcon","setAnimateInsideIcon","animatePageIcon","setAnimatePageIcon","animateTitleIcon","setAnimateTitleIcon","signClickedOnce","setSignClickedOnce","textAreaRefs","inputRef","handleResize","isSingle","handlePageChange","prevPage","updatePage","prevPages","updatedPages","handleTextChange","pageIndex","nextPageIndex","isMaxLengthReached","handlePaste","pasteText","currentText","selectionStart","selectionEnd","newText","remainingText","handlePasteRemainingText","focusOnTextArea","handleSign","handleEdit","handleCancel","setRef","getAnimationClass","animationState","baseClass","renderPage","modalActive","openedBook","setOpenedBook","signEditBook","openBookWithNbt","book","parsedData","page","parsedPage","divs","bar","setTitle","bossBarStyles","setBossBarStyles","fillStyles","setFillStyles","div1Styles","setDiv1Styles","div2Styles","setDiv2Styles","prevStyles","BossBar","currentTouch","bossBars","setBossBars","addBossBar","bossBar","prevBossBars","removeBossBar","newBossBars","oxygen","breathRef","breathbar","breaths","breath","classNames","createContext","useContext","buttonCss","PixelartIcon","ButtonContext","ButtonProvider","onClick","inScreen","rootRef","postLabel","overlayColor","buttonClickMp3","useFloating","FloatingArrow","offsetMiddleware","ARROW_HEIGHT","GAP","initialTooltip","localStorageKey","showTooltips","setShowTooltips","hide","arrowRef","refs","floatingStyles","context","useMemo","MessagePart","isIos","reactKeyForMessage","pixelartIcons","useScrollBehavior","MessageLine","classes","fadeMessage","initialTimeout","requestUpdate","messages","opacity","fetchCompletionItems","opened","sendMessage","usingTouch","allowSelection","inputDisabled","placeholder","sendHistoryRef","isInputFocused","setIsInputFocused","spellCheckEnabled","completePadText","setCompletePadText","completeRequestValue","completionItemsSource","setCompletionItemsSource","completionItems","setCompletionItems","chatInput","chatMessages","chatHistoryPos","inputCurrentlyEnteredValue","scrollToBottom","setSendHistory","newHistory","acceptComplete","getCompleteValue","updateInputValue","onMainInputChange","handleArrowUp","handleArrowDown","auxInputFocus","resetCompletionItems","handleKeyDown","isSingleChar","isPaste","unsubscribeValtio","completeValue","updateFilteredCompleteItems","fetchCompletions","implicit","inputValue","newItems","sourceItems","newCompleteItems","lastWord","getDefaultCompleteValue","raw","valueParts","lastLength","viewerVersionState","Chat","setMessages","isChatActive","messagesLimit","chatOpacity","chatOpacityOpened","lastMessageId","chatSelect","isUsingMicrosoftAuth","forwardChat","viewerConnection","jsonMsg","newMessage","builtinHandled","triggerKind","Input","worldTypes","gameModes","creatingWorldState","cancelClick","createClick","customizeClick","defaultVersion","quota","setQuota","usage","WorldCustomize","backClick","defaultLocalServerOptions","CreateWorld","getWorldsPath","activeCreate","activeCustomize","versionsPerMinor","generation","itemBeingUsed","usingItem","displayIndicator","setDisplayIndicator","indicatorProgress","setIndicatorProgress","alternativeIndicator","setAlternativeIndicator","boxMaxTimeMs","indicatorSize","displayBar","food","startTime","maxTime","isFood","MessageFormatted","dieReasonMessage","respawnCallback","disconnectCallback","DeathScreen","dieReasonProxy","messageParsed","useIsHashActive","MODES_COUNT","setMode","isHashActive","defaultPacketsCount","sent","customEntries","receivedTotal","packetsCountByNamePerSec","packetsCountByNamePer10Sec","packetsCountByName","ignoredPackets","packetsString","setPacketsString","showDebug","setShowDebug","setPos","skyL","setSkyL","blockL","setBlockL","biomeId","setBiomeId","day","setDay","entitiesCount","setEntitiesCount","dimension","setDimension","cursorBlock","setCursorBlock","minecraftYaw","minecraftQuad","rendererDevice","quadsDescription","viewDegToMinecraft","handleF3","prev","readPacket","_buf","managePackets","hardcodedListOfDebugPacketsToIgnore","update","packetsUpdateInterval","freqUpdateInterval","idx","customBlockName","modelInfo","issue","autoPlacement","DiscordButton","links","DropdownButton","setIsOpen","Transition","startStyle","endExitStyle","endStyle","stateStyles","basicStyle","open","mounted","setMounted","useUsingTouch","hideOnModals","fullScreen","setFullScreen","gameLoaded","activeStack","inMainMenu","hideButton","effectToAdd","effectToRemove","resetEffects","foodRef","foodbar","foods","useIsWidgetActive","isWidgetActive","TransformWrapper","TransformComponent","adapter","toggleFullMap","grid","setGrid","zoomRef","redraw","setRedraw","lastWarpPos","setLastWarpPos","stateRef","cells","isWarpInfoOpened","setIsWarpInfoOpened","initWarp","setInitWarp","warpPreview","setWarpPreview","updateGrid","wrapperRect","cellSize","columns","rows","leftBorder","topBorder","newGrid","col","cellCoords","playerChunkLeft","playerChunkTop","offsetX","offsetY","MapChunk","WarpInfo","worldX","worldZ","containerRef","touchTimer","canvasRef","longPress","handleClick","getXZ","mapX","mapZ","warp","rect","handleMouseMove","handleRedraw","warpPos","afterWarpIsSet","setWarp","posInputStyle","fieldCont","updateChunk","tpNow","quickTp","thisWarp","useUtilsEffect","handleMovementStickDelta","joystickPointer","touchStartBreakingBlockMs","GameInteractionOverlayInner","zIndex","setJoystickOrigin","updateJoystick","overlayRef","cameraControlEl","virtualClickActive","virtualClickTimeout","screenTouches","capturedPointer","pointerDownHandler","clickedEl","usingModernMovement","pointerMoveHandler","supportsPressure","allowedJitter","sourceX","sourceY","xDiff","yDiff","pointerUpHandler","MOUSE_BUTTON_RIGHT","MOUSE_BUTTON_LEFT","gonnaAttack","contextMenuHandler","blurHandler","detectAndResetZoom","visualViewport","viewport","OverlayElement","divRef","GameInteractionOverlay","modalStack","isX","valueToPercentage","hasModals","usingGamepadInput","doDisplay","InnerSearch","displaySearchInput","isHardcore","damaged","healthValue","healthRef","healthElement","hearts","heart","setDataUrl","updateHeldMap","createPortal","ItemName","itemKey","nodeRef","show","setShow","setItemName","defaultStyle","transitionStyles","customDisplay","HotbarInner","container","setItemKey","mouseButton","hotbarSlot","canvasManager","setSize","upHotbarItems","unsub2","setSelectedSlot","heldItemChanged","newSlot","numPressed","touchStart","Portal","setGameMode","HealthBar","FoodBar","ArmorBar","BreathBar","setDamaged","setHealthValue","setFood","setOxygen","setArmorValue","setIsHardcore","setEffectToAdd","setEffectToRemove","hurtTimeout","onDamage","updateHealth","hValue","upArmour","armorSlots","points","slotIndex","armorName","formatTime","seconds","minutes","remainingSeconds","formattedMinutes","formattedSeconds","EffectBox","level","formattedTime","defaultIndicatorsState","indicatorIcons","colorOverrides","indicators","effects","effectsRef","indicatorsMapped","indicator","IndicatorEffects","addEffect","newEffect","effectIndex","getEffectIndex","reduceTime","removeEffect","stateIndicators","hasErrors","isReadonly","openReadOperations","openWriteOperations","noConnection","poorConnection","allIndicators","alreadyWaiting","effectsImages","nameKebab","letter","autoFocus","rootStyles","validateInput","inputProps","validationStyle","setValidationStyle","setValue","span","triangle","square","circle","cross","parseBindingName","isPS","bindName","setBindName","setBind","bind","buttonsMap","ButtonWithMatchesAlert","Context","customCommands","updateCurrBind","resetBinding","userConfig","setUserConfig","customConfig","setCustomConfig","addNewCommand","newKey","newCustomConf","commandData","indexOption","CustomCommandContainer","groupData","commandKey","gamepad","inputs","setInputValue","optionKey","indexInput","newConfig","commandToRemove","controEx","KeybindingsCustom","BindingActionsContext","Keybinding","bindsMap","awaitingInputType","setAwaitingInputType","groupName","setGroupName","actionName","setActionName","buttonNum","setButtonNum","setCustomCommands","setBinding","buttonIndex","inputType","updateBindMap","updateBinding","pressedModifiers","currKeys","currButtons","preventDefault","AwaitingInputOverlay","parseActionName","buttonSign","setButtonSign","customValue","isGamepad","KeyboardEvent","KeybindingsScreen","bindingActions","bindActions","setBindActions","hasPsGamepad","gp","regionFiles","stateMap","playerChunk","regionNumbers","minX","maxX","minZ","maxZ","xChunks","zChunks","currentPlayer","haveDirectoryPicker","ButtonWithTooltip","useLongPress","PauseLinkButtons","httpsRegex","connectToServerAction","mapsProvider","singleplayerAction","optionsAction","githubAction","openFileAction","versionText","onVersionTextClick","versionStatus","versionTitle","onVersionStatusClick","bottomRightLinks","singleplayerAvailable","linksParsed","singleplayerLongPress","versionLongPress","buildDate","hoursAgo","connectToServerLongPress","origin","openGithub","MainMenu","isMainMenu","refreshApp","failedUpdate","registration","clients","unregisterPromise","timeoutPromise","disableAnimation","haveModals","fsReady","noDisplay","setVersionStatus","setVersionTitle","f","isLatest","upStatus","mapsProviderUrl","hoverItemToText","hoverEvent","clickEventToProps","clickEvent","promptMessageText","italic","bold","underlined","strikethrough","obfuscated","clickProps","hoverMessageRaw","hoverItemText","applyStyles","messageFormatStylesMap","colorF","getColorShadow","parseInlineStyle","className","dim","rule","cssInJsProp","ErrorBoundary","fallbackColor","messageJson","mineflayerConsoleState","messageClass","replEnabled","consoleEnabled","onExecute","consoleInput","consoleMessages","Fragment","useUiMotion","mineflayerPluginHudState","parseTextWithIcons","endBrace","iconName","TextElement","motion","css","onTab","motionRef","innerRef","ImageElement","ui","Fullmap","showMinimap","showFullmap","fullMap","displayMode","full","canvasTick","setPosition","updateMap","rotateMap","requestIdleCallback","updateWarps","MinimapDrawer","loadChunk","warps","loadingChunksQueue","chunksStore","mapSize","viewX","viewZ","worldCenterX","worldCenterZ","leftViewBorder","rightViewBorder","topViewBorder","bottomViewBorder","chunkInfo","chunkWorldX","chunkWorldZ","chunkCanvasX","chunkCanvasY","pixelX","pixelY","mousePos","centerPos","circleDist","angle","circleZ","circleX","angleS","angleW","angleE","canvasWorldCenterX","canvasWorldCenterZ","disableTurn","simplify","TypedEventEmitter","BlockData","preflatMap","Minimap","findHeightMap","DrawerAdapterImpl","regionX","regionZ","regionKey","readX","readZ","rawChunk","heightmap","storageWarps","blockKey","renamedKey","newWarps","remove","minY","blockX","blockZ","hBlock","blockY","isLighterOrDarker","ur","dl","linkedIndex","linkedColor","rgbArray","newColor","blockNamePieces","piece","match","Inner","fullMapOpened","elRef","showMobileControls","bl","onLongPress","select","f3Keybind","longPressEvent","onChatLongPress","onChatClick","chatLongPressEvent","FullScreenWidget","selected","setSelected","allSignsPos","signs","signPosKey","isSelected","AddElem","setProxyPing","serverPing","setServerPing","isProxyStale","setIsProxyStale","isServerStale","setIsServerStale","proxyTimeoutRef","serverTimeoutRef","setProxyPingWithTimeout","setServerPingWithTimeout","updatePing","updateServerPing","updateProxyPing","proxyUrl","pingTotal","ICON_SIZE","hardcodedKnownModals","watchedModalsFromHooks","componentActive","checkModalAvailability","withWildCardModal","subMessage","addStyles","useAppScale","Notification","autoHide","titleCase","OptionsItems","optionValueToType","optionValue","finalItemsScheme","optionsArr","optionsObj","metaMerge","backButtonAction","isLocked","useCommonComponentsProps","disabledBecauseOfSetting","disableIfSetting","OptionButton","valuesTitlesMap","disabledReason","getOptionValue","arrItem","valueDisplay","OptionElement","RenderOption","baseElement","OptionsGroup","reactType","settingsGroup","onChangeButtonState","ReplayPanel","PacketsReplayProvider","autocomplete","isPlaying","filter","button","PauseLinkButtonsInner","pauseLinksConfig","renderButton","usedServerPathsV1","NetworkStatus","waitForPotentialRender","saveRootPath","allRootPaths","allFilesToCopy","dirBase","pathsSplitBasic","isRegionFiles","upProgress","totalSize","copyFiles","copyPaths","totalSIze","copyFileGroup","copyPath","srcPath","regionFile","splitByCopySize","regionFilesNumbers","xMin","zMin","xMax","zMax","playerPosRegion","maxDistantRegion","spiral","filesWithSpiral","copySize","cur","fsStateSnap","activeModalStackSnap","wanOpened","wanOpening","packetsReplaceActive","packetsReplaceHasRecordedPackets","displayPacketsButtons","handlePointerLockChange","onReturnPress","clickWebShareButton","shareData","clickJoinLinkButton","qr","openWorldActions","playersLists","clientId","tablistHeader","tablistFooter","serverIP","list","PlayerListOverlay","MAX_ROWS_PER_COL","setClientId","players","setPlayers","handleKeyUp","playersArray","lists","tempList","filterPackets","DARK_COLORS","FilterInput","PacketList","ProgressBar","replayName","defaultFilter","customButtons","onPlayPause","onRestart","onSpeedChange","onFilterChange","onCustomButtonToggle","clientPacketsAutocomplete","serverPacketsAutocomplete","setFilter","isMinimized","filteredPackets","hiddenCount","handlePlayPauseClick","playPauseButton","baseContainerStyle","buttonId","tooltip","Scoreboard","ScoreboardProvider","setItems","setOpen","updateSidebarScoreboard","addStatPerSec","backdrop","titleSelectable","titleMarginTop","Creatable","initialOptions","updateOptions","getCssOnInput","onValueChange","containerStyle","disabled","currValue","setCurrValue","inputStyle","setInputStyle","isFirstClick","setIsFirstClick","Select","onChange","newSel","parsedsupportedVersions","parsedValue","compareVersions","v2","num1","num2","minVersion","maxVersion","isWithinRange","minecraftJsonMessageParsed","parseResult","_resolve","showCancel","inputsConfirmButton","inputValues","resolveClose","Singleplayer","useIsSmallWidth","getInitialProxies","proxies","getCurrentProxy","getCurrentUsername","joinServer","onProfileClick","setQuickConnectIp","snap","setSave","activeHighlight","setActiveHighlight","updateProxies","setUsername","getActiveHighlightStyles","isSmallWidth","initialProxies","proxiesData","checked","hovered","ServersList","AddServerOrConnect","useCopyKeybinding","getInitialServersList","setNewServersList","normalizeIp","FETCH_DELAY","MAX_CONCURRENT_REQUESTS","hidden","customServersList","serverEditScreen","setServerEditScreen","authenticatedAccounts","quickConnectIp","selectedIndex","setSelectedIndex","savedServersList","serversListDisplay","_ip","_port","additionalServerData","setAdditionalServerData","newIndex","newList","serversListSorted","isEditScreenModal","queue","activeRequests","lastRequestStart","pingResult","old","editModalJsx","lastJoined","serversListJsx","overridesOrIp","shouldSave","msAuth","indexOrIp","lastJoinedUsername","promptUsername","authenticatedAccount","newServersList","thisItem","additional","serversListQs","setCustomServersList","isJson","hasServersListModal","editServerModalActive","isServersListModalActive","eitherModal","repeat","repeatArr","times","focusable","markdownToFormattedText","imageSource","handleInput","ProseMirrorView","isWysiwyg","prosemirrorContainer","editorView","elements","focusedElemIndex","nextElem","SignEditor","setLocation","isFrontText","setIsFrontText","enableWysiwyg","setEnableWysiwyg","proseMirrorView","setProseMirrorView","smallSymbols","largeSymbols","addLength","QRCodeSVG","loginLink","expiresEnd","setSaveToken","defaultSaveToken","onCancel","directLink","timeLeft","setTimeLeft","SignInMessage","expiresOn","shouldSaveToken","signInTestModal","missingWorldPreview","useTypedEventListener","Tabs","GroupHeader","expanded","onToggle","isFocused","lastPlayed","detail","onFocus","onInteraction","iconSrc","formattedTextOverride","worldNameRight","worldNameRightGrayed","elemRef","offline","timeRelativeFormatted","formatter","Intl","hours","days","sizeFormatted","worldData","onGeneralAction","onWorldAction","firstRowChildrenOverride","serversLayout","searchRowChildrenOverride","activeProvider","setActiveProvider","providerActions","providers","disabledProviders","warning","warningAction","warningActionLabel","onRowSelect","defaultSelectedRow","selectedRow","listStyle","setListHovered","secondRowStyles","lockedEditing","firstButton","worldRefs","setSearch","focusedWorld","setFocusedWorld","expandedGroups","setExpandedGroups","onRowSelectHandler","toggleGroup","tab","filtered","groups","interaction","GoogleButton","worldsProxy","providersEnableFeatures","readWorlds","brokenWorlds","loggedIn","worldsPath","provider","newMappedWorlds","folder","levelDatStat","iconBase64","iconPath","levelName","getScore","worldPath","scriptEl","gapi","selectedProvider","selectedGoogleId","readWorldsAbortController","googleDriveReadonly","exists","googleLogIn","googlePicker","selectGoogleFolder","google","view","isGoogleProviderReady","brokenWorld","openInGoogleDrive","fileId","selectedVariant","success","unit","valueProp","updateOnDragEnd","updateValue","divProps","getRatio","ratio","setRatio","fireValueUpdate","dragEnd","lastPlayedSounds","SoundRow","mutedSounds","isMuted","showMuted","setShowMuted","setI","tabs","activeTab","labels","onTabChange","fullSize","disabledTabs","Title","subtitle","actionBar","transitionTimes","openTitle","openActionBar","useEnterTransition","setUseEnterTransition","defaultFadeIn","defaultFadeOut","defaultText","defaultTimings","ticksToMs","getComponent","setSubtitle","setActionBar","animTimes","setAnimTimes","setOpenTitle","setOpenActionBar","mes","getCurrentAppScaling","guiScale","getComputedStyle","parseFloat","Z_INDEX_INTERACTIBLE","setupActive","closeButtonsSetup","foregroundGameActive","touchControlsPositions","buttonsPositions","joystickOuter","joystickInner","pointer","newButtonPositions","buttonProps","holdDown","holdUp","pointerup","pointerToggledUpdate","setupPointer","xPerc","yPerc","MineIcon","TouchAreasControls","newPositions","LeftTouchArea","RightTouchArea","useInterfaceState","actionAndState","hintText","setHintText","cursorState","useMedia","ScaleContext","useScale","UIProvider","minWidth","minHeight","conditions","media","gamemode","XPBar","setProgress","setLevel","setGamemode","onXpUpdate","localStoragePrefix","oldKeysAliases","migrateLegacyData","selectedProxy","serversHistoryLegacy","defaultStorageData","prefixedKey","aliasedKey","storedValue","saveKey","ops","op","shownCount","onClearFilter","showAutocomplete","setShowAutocomplete","allSuggestions","currentWord","filteredSuggestions","acceptSuggestion","suggestion","isClient","processPacketDataForLogging","formatters","sizeOfChunk","blockEntitiesCount","getPacketIcon","ROW_HEIGHT","EXPANDED_HEIGHT","formatTimeDiff","maxHeight","listRef","expandedPacket","setExpandedPacket","prevTimestamp","timeDiff","padNumber","total","absorption","glowing","instant_health","nausea","slow_falling","weakness","bad_omen","haste","invisibility","night_vision","slowness","wither","blindness","health_boost","jump_boost","poison","conduit_power","hero_of_the_village","levitation","regeneration","strength","dolphins_grace","hunger","luck","resistance","unluck","fire_resistance","instant_damage","mining_fatigue","water_breathing","darkness","useLayoutEffect","elementRef","openedWasAtBottom","isAtBottom","scrollTop","scrollHeight","clientHeight","distanceFromBottom","handleScroll","wildcardToRegExp","escaped","patternToRegExp","parseFilterString","include","exclude","binding","keyboard","layoutMap","mapKey","cut","history","existingServer","servers","serversList","newAccounts","getServerConnectionHistory","SMALL_SCREEN_MEDIA","usePassesWindowDimensions","getCopyText","activeElement","HTMLInputElement","HTMLTextAreaElement","copyText","setIsActive","checkHash","removeEventListener","motionState","MOTION_DAMPING","MAX_MOTION_OFFSET","motionVelocity","lastUpdate","lastYaw","lastPitch","yawDiff","pitchDiff","velocityVector","cameraQuat","velocityContribution","motionEnabled","animate","shouldPreventDefault","longPressTriggered","setLongPressTriggered","clear","touchEvent","UAParser","isMountingRef","useIncludes","allStack","ModuleSignsViewer","renderToDom","DeathScreenProvider","OptionsRenderApp","MainMenuRenderApp","SingleplayerProvider","CreateWorldProvider","AppStatusProvider","SelectOption","EnterFullscreenButton","ChatProvider","TitleProvider","SignEditorProvider","IndicatorEffectsProvider","PlayerListOverlayProvider","MinimapProvider","HudBarsProvider","XPBarProvider","DebugOverlay","MobileTopButtons","PauseScreen","SoundMuffler","TouchControls","GlobalSearchInput","TouchAreasControlsProvider","NotificationProvider","HotbarRenderApp","Crosshair","ButtonAppProvider","ServersListProvider","GamepadUiCursor","KeybindingsScreenProvider","HeldMapUi","BedTime","NoModalFoundProvider","SignInMessageProvider","BookProvider","BossBarOverlayProvider","DebugEdges","MineflayerPluginHud","MineflayerPluginConsole","TouchInteractionHint","RobustPortal","PerComponentErrorBoundary","DisplayQr","currentDisplayQr","GameHud","loadedDataVersion","setGameLoaded","InGameComponent","InGameUi","showUIRaw","displayBossBars","modalsSnapshot","showUI","displayFullmap","AllWidgets","WidgetDisplay","Component","App","componentNameClean","disableReactProfiling","currentFov","targetFov","lastUpdateTime","FOV_TRANSITION_DURATION","BASE_MOVEMENT_SPEED","FOV_EFFECT_SCALE","updateFovAnimation","fovModifier","movementSpeedAttr","currentSpeed","heldItem","ticksUsingItem","usageProgress","baseFov","easeOutCubic","dirname","basename","resourcepackPackBasePath","existsAsync","fromTexturePackPath","installTexturePackFromHandle","progressReporter","installPath","zipFile","allFilesArr","createdDirs","copyTasks","writePath","updateTextures","currentErrors","getSizeFromImage","filePath","probeImg","getActiveResourcepackBasePath","isDirSafe","getFilesMapFromDir","scan","dirFiles","getResourcepackTiles","existingTextures","firstTextureSize","namespaces","namespace","texturesCommonBasePath","isMinecraftNamespace","texturesBasePath","texturesBasePathAlt","allInterestedPaths","allInterestedPathsPerDir","allInterestedImages","paths","dirImages","firstImageFile","newTextures","imagePath","imageRelative","prepareBlockstatesAndModels","usedBlockTextures","usedItemTextures","readModelData","namespaceDir","jsons","readData","blockstatesPath","blockModelsPath","itemModelsPath","assetsDirs","assetsDir","downloadAndUseResourcePack","loaded","resourcePackData","waitForGameEvent","handleResourcePackRequest","promptMessagePacket","forced","updateAllReplacableTextures","setCustomCss","varName","setCustomPicture","vars","cssVar","cssVarRepeat","resourcePackPath","resPath","origBlocksFiles","origItemsFiles","origArmorFiles","blocksData","itemsData","armorData","destPath","itemSelector","modelFromDef","setScale","scaleValues","innerWidth","innerHeight","maxWidth","registrationError","registrations","createPublicKey","signatureAlgorithm","privateKeyPem","privateKeyBuffer","privateKey","signature","Http","XMLHttpRequest","minecraftServerHostname","willreturn","BrowserFS","customResolver","resolver","resolvedData","optimizedDataResolver","cacheTtl","cache","cacheTime","possiblyGetFromCache","dataTypes","allRestored","dataType","shapes","pc","Titles","sessionServer","accessToken","sessionSelectedProfileId","serverId","sharedSecret","publicKey","createSoundMap","musicSystem","soundMap","updateResourcePack","musicInterval","stopMusicSystem","startMusicSystem","playGeneralSound","soundKey","soundData","getDistance","musicStartCheck","musicKeys","randomMusicKey","playHardcodedSound","soundId","soundResource","lastStepSound","movementHappening","blockUnder","stepSound","playBlockBreak","registerEvents","effectId","disablePosVolume","diggingBlock","pos1","pos2","MusicSystem","musicVolume","onEnded","SoundMap","soundsMap","allSoundsMajor","soundsStr","weight","TypeError","idPart","namePart","soundsJsonContent","soundsJsonPath","soundsBasePath","rpSound","tryFormat","format","oggResult","totalWeight","sum","random","versionedSound","verNumber","itemsVer","category","fallback","mappedName","blockSoundAliases","globalObject","postNettyVersionsByProtocolVersion","ignoredVersionsRegex","versionsFromProtocol","notTestedVersions","Stats","StatsGl","stats2","hasRamPanel","statsGl","denseMode","addStat","dom","addStatsGlStat","toggleStatsVisibility","hideStats","_child","currentStatsPerSec","waitingStatsPerSec","updateStatsPerSecAvg","statsPerSecCurrent","lastReset","doToggle","toNumber","displayBrowserProblem","requestId","callbackTriggered","DOMHighResTimeStampCollection","triggerAnimation","DOMHighResTimeStamp","t0","fps","getGamemodeNumber","ver1","ver2","a1","b1","a2","b2","prevRenderDistance","setRenderDistance","singleplayerRenderDistance","zeroRenderDistance","addUrl","reportedWarnings","Gui","openWebsocket","oldWrite","ev","lastMessageTime","send","on","lils","gui","existingIndex","buttons","paramName","paramNames","VRButton","GLTFLoader","XRControllerModelFactory","buttonMap","standardButtonsMap","isSupported","checkVRSupport","enableVr","vrButtonContainer","createVrButtonContainer","updateVrButtons","unsubWatchSetting","unsubWatchModals","disableVr","user","vrButton","styleContainer","closeButton","createCloseButton","typedAssign","supported","XRSession","controllerModelFactory","controller1","controller2","virtualGamepadIndex","connectedVirtualGamepad","manageXrInputSource","handedness","defaultHandedness","removeAction","hand1","hand2","originalGetGamepads","originalGamepads","remapAxes","remapButtons","rotSnapReset","yawOffset","tmp","_modal","xrStandardRightButtonsMap","xrStandardLeftButtonsMap","rightButtons","leftButtons","remapped","remapWithMap","map","standardName","standardMappingIndex","aliases","alias","axesRight","axesLeft","updateTouch","isChanged","viewWatched","inWater","updateInWater","waterBr","_inWater","sceneBg","newSceneBg"],"mappings":"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"}